id: CVE-2024-4367

info:
  name: Arbitrary JavaScript execution in PDF.js
  author: ProjectDiscoveryAI
  severity: high
  description: |
    CVE-2024-4367 is a vulnerability in PDF.js, a JavaScript-based PDF viewer by Mozilla. It allows arbitrary JavaScript code execution when a malicious PDF is opened. This affects all Firefox versions below 126 and many applications using PDF.js.
  reference:
    - https://example.com/cve-2024-4367

variables:
  vulnerable_versions:
    - "4.1.392"
    - "1.10.88"
    - "1.4.20"
    - "0.8.1181"

http:
  - raw:
      - |
        GET /pdfjs/version HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - '"version":\s*"(.*?)"'
      - type: dsl
        dsl:
          - contains(template.version, template.vulnerable_versions)