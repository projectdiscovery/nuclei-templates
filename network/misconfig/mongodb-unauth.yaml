id: mongodb-unauth

info:
  name: MongoDB - Unauthenticated Access
  author: pdteam
  severity: high
  description: MongoDB was able to be accessed with no password. Note that MongoDB does not require a password by default.
  remediation: Enable Authentication in MongoDB
  reference:
    - https://github.com/orleven/Tentacle
    - https://book.hacktricks.wiki/en/network-services-pentesting/27017-27018-mongodb.html
    - https://www.mongodb.com/features/mongodb-authentication
  metadata:
    max-request: 1
  tags: network,mongodb,unauth,misconfig,tcp,vuln
tcp:
  - inputs:
      - data: 480000000200000000000000d40700000000000061646d696e2e24636d6400000000000100000021000000026765744c6f670010000000737461727475705761726e696e67730000
        type: hex

    host:
      - "{{Hostname}}"
    port: 27017

    read-size: 2048
    matchers:
      - type: word
        words:
          - "totalLinesWritten"
# digest: 490a00463044022017ed6e7c6940f1850d335c6b58b03a451c7d49a8c34c60b23d7330991ce54dc9022024bcafc49c1c1b2f764158fa78b3c08b885ea62174d78b3a3a1fc1bbbc12e08d:922c64590222798bb761d5b6d8e72950