id: ftp-anonymous-login

info:
  name: FTP Anonymous Login
  author: C3l3si4n,pussycat0x
  severity: medium
  description: |
    Anonymous FTP access allows anyone to access your public_ftp folder, allowing unidentified visitors to download (and possibly upload) files on your website. Anonymous FTP creates the potential for a security hole for hackers and is not recommended.
  reference:
    - https://tools.ietf.org/html/rfc2577
  metadata:
    max-request: 1
    verified: true
  tags: network,ftp,default-login,tcp,vuln

tcp:
  - inputs:
      - data: "USER anonymous\r\n"
        read: 1024
      - data: "PASS anonymous\r\n"
        read: 1024

    host:
      - "{{Hostname}}"
    port: 21

    matchers-condition: and
    matchers:
      - type: word
        part: raw
        words:
          - "Anonymous access allowed,"
          - "Logged in anonymously"
          - "Anonymous user logged"
          - "Login successful"
          - "Guest login ok"
        condition: or

      - type: word
        part: raw
        words:
          - "HTTP/1.1"
          - "230."
          - ".230"
          - "User cannot log"
          - "ESMTP"
        negative: true
        condition: or
# digest: 4a0a00473045022100e4e9c21cd42c1ad22b952a0b3603b21f9885ca92e53201e08e1769d2b4c008b202202e14100b4627d1634e59c98681bbe8e7b51e19072b6b0739a709198643650267:922c64590222798bb761d5b6d8e72950