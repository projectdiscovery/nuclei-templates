id: detect-defaul-config-honeypot-snap7

info:
  name: detect default configurations for snap7 honeypot
  author: biero-el-corridor
  severity: info
  description: |
    Default configurations of the snap7 python parser.
  metadata:
    max-request: 2
    vendor: Snap7
    product: s7comm
  tags: ICS,s7comm,honeypot

tcp:
  - host:
      - "{{Hostname}}"
      - "{{Host}}:102"
    inputs:
      - data: "0300001611e00000001400c1020100c2020102c0010a"
        type: hex
      - data: "0300001902f08032010000000000080000f0000001000101e0"
        type: hex
      - data: "0300002102f080320700000000000800080001120411440100ff09000400110001"
        type: hex
      - data: "0300002102f080320700000000000800080001120411440100ff09000400110001"
        type: hex
      - data: "0300002102f080320700000000000800080001120411440100ff090004001c0001"


    read-size: 512
    matchers:
      - type: binary
        binary:
          - "0300001611d00014000100c1020100c2020102c0010a0300001b02f080320300000000000800000000f0000001000101e00300009902f080320700000000000c007c000112081284010000000000ff09007800110000001c0004000136455337203331352d32454831342d304142302000c000040001000636455337203331352d32454831342d304142302000c0000400010007202020202020202020202020202020202020202000c0560302060081426f6f74204c6f61646572202020202020202020000041200909"