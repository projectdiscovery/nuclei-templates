id: unauth-java-message-broker-detect

info:
  name: Unauthenticated Java Message Broker - Detect
  author: matejsmycka
  severity: low
  description: |
    Detection of a Java Message Service (JMS) broker, typically used by Oracle GlassFish Message Queue and Payara Application Server. This port should remain closed to the internet, as it enables unauthenticated access to messaging services.
  metadata:
    verified: true
    shodan-query: product:"Java Message Service"
  tags: network,tcp,jms,openmq,unauth

tcp:
  - inputs:
      - data: "\n"

    host:
      - "{{Hostname}}"
    port: 7676

    matchers:
      - type: word
        words:
          - "101 imqbroker"
          - "cluster_discovery"
        condition: and

    extractors:
      - type: regex
        regex:
          - "imqbroker ([0-9.]+)"
# digest: 4a0a0047304502207955a30cbf698aaa43e48c6cf901e87f3ec1276cc36efa07fb896b86eaf40dd1022100bd6fec844d1a3ebe864e1f4990b7db1d2a4da6ef8bb6c347d1f1a22080023529:922c64590222798bb761d5b6d8e72950