id: direct-connect-detect

info:
  name: Direct Connect P2P - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://en.wikipedia.org/wiki/Direct_Connect_(protocol)
  metadata:
    verfied: true
    shodan-query: product:"Direct Connect P2P"
    max-request: 1
  tags: js,network,detect,dc,direct-connect,p2p,discovery

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"

    port: 548
    read-size: 1024

    matchers:
      - type: word
        words:
          - "$MyNick bb3096"
          - "$Lock EXTENDEDPROTOCOL"
        condition: or
# digest: 490a00463044022074d456c7b8827e794b263a22f97658b97db7055d6f534288354073862bead42b022036986f3f6aff897de106460b79789ba5ec3f089ea71f83424d60c3ce5ac2c6fe:922c64590222798bb761d5b6d8e72950