id: sap-router-detect

info:
  name: SAProuter  - Detect
  author: pussycat0x
  severity: info
  description: |
    The SAProuter is a proxy program that controls and secures communication between SAP systems and external networks.
  metadata:
    verified: true
    shodan-query: product:"SAProuter"
  tags: network,tcp,sap,tech,discovery

tcp:
  - inputs:
      - data: "00000000"
        type: hex

    host:
      - "{{Hostname}}"
    port: 3200

    read-size: 1024

    matchers:
      - type: word
        part: raw
        words:
          - "SAProuter"
          - "network interface"
        condition: and

    extractors:
      - type: regex
        regex:
          - "SAProuter ([0-9.]+)"
# digest: 490a00463044022015540ece6b25c85d94cecd11cba060f31812d773ec487295f1cdc867a60ca64802200bd95a4b5e7ffb8e5b3d4cc1bfa5fe7c23d9e4ca505855cf680f740adb92427c:922c64590222798bb761d5b6d8e72950