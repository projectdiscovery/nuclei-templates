id: adsb-ultrafeeder-detect

info:
  name: ADSB Ultrafeeder Beast Mode - Detection
  author: Random-Robbie
  severity: info
  description: |
    Detected ADS-B (Automatic Dependent Surveillanceâ€“Broadcast) ultrafeeders operating with the Beast Mode protocol on port 30005. These devices capture aircraft transponder signals using software-defined radios (SDRs) and distribute the decoded data over the internet.
  reference:
    - https://github.com/flightaware/dump1090
    - https://github.com/wiedehopf/readsb
    - https://mode-s.org/decode/content/ads-b/1-basics.html
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"ADSB"
    fofa-query: port="30005" && body="ADSB"
  tags: network,tcp,flight,adsb,enum

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 30005
    read-size: 2048

    matchers:
      - type: binary
        binary:
          - "1a31"
          - "1a32"
          - "1a33"
        condition: or

    extractors:
      - type: regex
        name: beast_message_types
        regex:
          - "1a(3[1-3])"

      - type: regex
        name: feed_quality
        regex:
          - "(1a)"
