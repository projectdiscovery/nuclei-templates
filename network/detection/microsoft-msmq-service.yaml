id: microsoft-msmq-service

info:
  name: Microsoft MSMQ - Detect
  author: matejsmykca
  severity: info
  description: |
    Detects Microsoft Message Queuing (MSMQ) services.
  reference:
    - https://en.wikipedia.org/wiki/Microsoft_Message_Queuing
    - https://gist.github.com/goncalor/a01ba66927c0dc704000d7bf1327d36e
    - https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-mqmq/058cdeb4-7a3c-405b-989c-d32b9d6bddae
  metadata:
    verified: true
    max-request: 1
    shodan-query: product:"Microsoft Message Queuing"
  tags: network,windows,detect,detection,tcp
tcp:
  - inputs:
      - data: 10000b004c494f523c020000ffffffff0000020006553d5136dfc7409643175c3ce76caa00000000000000000000000000000000d2291d06100300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 1801

    matchers:
      - type: word
        part: raw
        words:
          - "\x10Z\x0b\x00LIOR<\x02\x00"
