id: adsb-ultrafeeder-detection

info:
  name: ADSB Ultrafeeder Beast Mode Detection
  author: Random-Robbie
  severity: info
  description: |
    Detected ADSB (Automatic Dependent Surveillance-Broadcast) ultrafeeders running the Beast mode protocol on port 30005. These devices received aircraft transponder data via software-defined radio and redistributed it over the internet.
  reference:
    - https://github.com/flightaware/dump1090
    - https://github.com/wiedehopf/readsb
    - https://mode-s.org/decode/content/ads-b/1-basics.html
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.7
    cwe-id: CWE-200
  metadata:
    max-request: 1
    shodan-query: '"1a" port:30005'
    verified: true
  tags: network,tcp,adsb,aviation,ultrafeeder,beast-mode,dump1090,readsb,flight-tracking

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 30005
    read-size: 2048

    matchers-condition: and
    matchers:
      - type: binary
        binary:
          - "1a31"  # Beast mode message type 31 (DF 17/18 Extended Squitter)
          - "1a32"  # Beast mode message type 32 (DF 5/21 Surveillance ID Reply)
          - "1a33"  # Beast mode message type 33 (DF 4/20 Surveillance Altitude Reply)
        condition: or

      - type: binary
        binary:
          - "1a"  # Multiple Beast start markers indicate active feed

    extractors:
      - type: regex
        name: beast_message_types
        regex:
          - "1a(3[1-3])"
        group: 1

      - type: regex
        name: feed_quality
        regex:
          - "(1a)"
