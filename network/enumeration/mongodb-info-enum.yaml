id: mongodb-version

info:
  name: MongoDB Version Check
  author: h4sh5
  severity: info
  description: MongoDB Version Check
  metadata:
    max-request: 1
    shodan-query: mongodb server information
  tags: network,mongodb,enum,tcp,discovery,detect,version
tcp:
  - inputs:
      - data: 3b0000003c300000ffffffffd40700000000000061646d696e2e24636d640000000000ffffffff14000000106275696c64696e666f000100000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 27017
    read-size: 2048

    extractors:
      - type: regex
        group: 1
        regex:
          - "version.....([0-9.]+)"
