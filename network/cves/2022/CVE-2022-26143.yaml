id: CVE-2022-26143

info:
  name: Mitel MiCollab TP-240 (tp240dvr) - DDoS Amplification Vulnerability
  author: aybanda
  severity: critical
  description: |
    The TP-240 (tp240dvr) component in Mitel MiCollab before 9.4 SP1 FP1 and MiVoice Business Express through 8.1 allows remote attackers to cause a denial of service (amplification attack) by sending a small UDP packet and receiving a much larger response. This vulnerability was exploited in the wild in February and March 2022 for the TP240PhoneHome DDoS attack, which could amplify traffic by a factor of 4 billion. The attack involves sending a 4-byte UDP packet to port 10074 and receiving a response that is significantly larger, making it an effective DDoS amplification vector.
  reference:
    - https://arstechnica.com/information-technology/2022/03/ddosers-use-new-method-capable-of-amplifying-traffic-by-a-factor-of-4-billion/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-26143
    - https://www.rapid7.com/blog/post/2022/03/10/mitel-tp240-phonehome-ddos-amplification-cve-2022-26143/
  classification:
    cve-id: CVE-2022-26143
    cwe-id: CWE-400
  metadata:
    shodan-query: port:10074
    max-request: 1
    vendor: mitel
    product: micollab
    verified: true
  tags: cve,cve2022,mitel,ddos,amplification,tp240,kev

tcp:
  - host:
      - "{{Hostname}}"
    port: 10074
    inputs:
      - data: "00000000"
        type: hex
        read: 4096
    read-size: 4096
    matchers:
      - type: word
        part: raw
        words:
          - "tp240"
          - "mitel"
          - "tp240dvr"
        condition: or
      
      - type: size
        part: raw
        size:
          gt: 1000 