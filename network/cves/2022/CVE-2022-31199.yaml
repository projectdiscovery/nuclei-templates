id: CVE-2022-31199

info:
  name: Netwrix Auditor UAVR Service - RCE Vulnerability Detector
  author: neel3o115
  severity: critical
  description: |
    Detects the vulnerable Netwrix Auditor User Activity Video Recording (UAVR)
    service affected by CVE-2022-31199. The service exposes an unauthenticated
    binary protocol that can lead to remote code execution. This template performs
    a harmless initial handshake to identify the vulnerable UAVR endpoint.
  impact: |
    Remote unauthenticated attackers can achieve SYSTEM-level RCE through the
    exposed UAVR service.
  remediation: |
    Update Netwrix Auditor to a patched version and restrict port 8550.
  reference:
    - https://bishopfox.com/blog/netwrix-auditor-advisory
    - https://nvd.nist.gov/vuln/detail/CVE-2022-31199
  classification:
    cve-id: CVE-2022-31199
    cwe-id: CWE-121
    cvss-score: 9.8
  tags: cve,cve2022,netwrix,auditor,rce,uavr,tcp,kev
  metadata:
    max-request: 1
    verified: false

tcp:
  - host:
      - "{{Hostname}}:8550"
    inputs:
      - data: "\x01\x00\x00\x00"
    read-size: 32
    matchers:
      - type: word
        words:
          - "UAVR"
        part: body
