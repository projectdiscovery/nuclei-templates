id: CVE-2019-3980

info:
  name: SolarWinds Dameware Mini Remote Client - Unauthenticated RCE
  author: KrE80r
  severity: critical
  description: |
    SolarWinds Dameware Mini Remote Control before 12.1.0 Hotfix 3 allows unauthenticated remote code execution via the smart card authentication feature. An attacker can upload and execute arbitrary executables with Local System privileges by requesting smart card login on port 6129. The vulnerability exploits weak Diffie-Hellman parameters (128-bit) in the encryption handshake.
  impact: |
    Complete system compromise with Local System privileges. Arbitrary code execution without authentication allows attackers to take full control of affected Windows systems.
  remediation: |
    Upgrade to SolarWinds Dameware Mini Remote Control 12.1.2 or later. Disable smart card authentication if not required. Restrict network access to port 6129 using firewall rules.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-3980
    - https://www.tenable.com/security/research/tra-2019-43
    - https://github.com/tenable/poc/blob/master/Solarwinds/Dameware/dwrcs_dwDrvInst_rce.py
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-3980
    cwe-id: CWE-346
    epss-score: 0.94469
    epss-percentile: 0.99995
    cpe: cpe:2.3:a:solarwinds:dameware_mini_remote_control:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: solarwinds
    product: dameware_mini_remote_control
    shodan-query: port:6129
  tags: cve,cve2019,solarwinds,dameware,rce,kev,network,tcp

tcp:
  - host:
      - "{{Hostname}}"
      - "{{Host}}:6129"

    inputs:
      # Step 1: Read server MSG_TYPE_VERSION (0x1130) - 40 bytes
      - read: 40
      # Step 2: Send client MSG_TYPE_VERSION with smart card auth request (type=3)
      - data: "{{hex_decode('30110000000000000000000000002840000000000000000004000000000000000000000003000000')}}"

    read-size: 2048

    matchers:
      - type: binary
        binary:
          # MSG_CLIENT_INFORMATION_V7: 0x00011171 (little-endian)
          # This message type indicates successful smart card auth negotiation
          - "71110100"
