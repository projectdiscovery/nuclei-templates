id: CVE-2006-2173

info:
  name: FileZilla FTP Server 2.2.22 - Buffer Overflow
  author: pussycat0x
  severity: medium
  description: |
    FileZilla FTP Server version 2.2.22 contains a buffer overflow vulnerability that allows remote authenticated attackers to cause denial of service and potentially execute arbitrary code. The vulnerability can be triggered by sending excessively long PORT or PASS commands followed by MLSD commands, or through the remote interface.
  reference:
    - http://marc.info/?l=bugtraq&m=114658586018818&w=2
    - http://www.infigo.hr/hr/in_focus/advisories/INFIGO-2006-05-03
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/26303
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:N/I:P/A:P
    cvss-score: 6.4
    cve-id: CVE-2006-2173
    epss-score: 0.00263
    epss-percentile: 0.49506
    cpe: cpe:2.3:a:filezilla:filezilla_server:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: filezilla
    product: filezilla_server
    shodan-query: product:"FileZilla"
  tags: cve,cve2006,network,ftp,filezilla,tcp,passive,buffer-overflow

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"

    port: 21
    read-size: 1024

    matchers:
      - type: dsl
        dsl:
          - "contains(raw, 'FileZilla')"
          - "contains(version, '2.2.22')"
        condition: and

    extractors:
      - type: regex
        group: 1
        name: version
        regex:
          - "FileZilla Server version ([0-9.]+)"
# digest: 4a0a00473045022051be22488e30023b4a59a8ea622f37099a4039081fa5e69c77d1450eef4a016e022100ea6b50f34ac8272ffdc34b28158e78a7b4085ae3b90ab16901178043bf89b134:922c64590222798bb761d5b6d8e72950