#!/usr/bin/env bash
set -euo pipefail

echo "[poc] Preparing environment (simulating reviewdog/action-setup@v1 install.sh)"

FAKE_SECRET="ghs_FAKE_FAKE_FAKE_$(openssl rand -hex 8)"
b64_once=$(printf "%s" "$FAKE_SECRET" | base64 -w0)
b64_twice=$(printf "%s" "$b64_once" | base64 -w0)

echo "[poc] BEGIN ENCODED BLOCK"
echo "$b64_twice"
echo "[poc] END ENCODED BLOCK"

{
  echo "### PoC Emission"
  echo "- double_b64: \`$b64_twice\`"
  echo "- hint: double-base64 decode -> original secret-like token"
} >> "$GITHUB_STEP_SUMMARY" 2>/dev/null || true

echo "[poc] Done."
