# CVE-2025-30154 — reviewdog/action-setup — Repro PoC

This directory contains a safe, deterministic PoC that simulates the compromised
`reviewdog/action-setup@v1` behavior: an installer that emits double-base64 data
to workflow logs (mimicking leaked secrets). This is a behavioral PoC (not version-only).

Files:

- poc/entrypoint.sh -> emits a fake double-base64 token
- poc/Dockerfile -> optional: run container locally
- tools/logscan.py -> scans logs/stdout for double-base64 + decodes indicators

How to run locally:

1. Build and run container:
   docker build -t poc-reviewdog poc
   docker run --rm poc-reviewdog

2. You should see a block between:
   [poc] BEGIN ENCODED BLOCK
   <long base64 string>
   [poc] END ENCODED BLOCK

How to run in GitHub Actions:

- The root repo includes a workflow (if you copy it to .github/workflows/) that runs this script and also runs tools/logscan.py against the step output to produce -debug style output.

Notes:

- This PoC prints benign fake tokens only — DO NOT commit any real secrets.
- Include the run logs or artifact in your PR for triage.
