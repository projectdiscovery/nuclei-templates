FROM ubuntu:18.04

# Install dependencies
RUN apt-get update && apt-get install -y \
    curl \
    git \
    build-essential \
    python \
    libxml2-dev \
    libicu-dev \
    && rm -rf /var/lib/apt/lists/*

# Download vulnerable Node-ChakraCore (v10.6.0 includes ChakraCore v1.10.0 which is vulnerable)
# Using a pre-built binary if available or building from source is slow.
# Let's try to find a binary or use a specific version.
RUN curl -L https://nodejs.org/download/chakracore-release/v10.13.0/node-v10.13.0-linux-x64.tar.gz | tar -xz --strip-components=1 -C /usr/local

WORKDIR /app

# Create a simple server that evaluates JS
COPY server.js .

RUN npm install express@4

EXPOSE 8080

CMD ["node", "server.js"]
