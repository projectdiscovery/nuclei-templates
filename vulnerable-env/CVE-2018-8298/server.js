const express = require('express');
const app = express();
const { vm } = require('node:vm');

app.use(express.json());

app.post('/eval', (req, res) => {
    const code = req.body.code;
    if (!code) {
        return res.status(400).send('No code provided');
    }

    try {
        // In Node-ChakraCore, this will execute using the Chakra engine
        const result = eval(code);
        res.send({ result: String(result) });
    } catch (e) {
        res.status(500).send({ error: e.message });
    }
});

app.listen(8080, '0.0.0.0', () => {
    console.log('Vulnerable server listening on port 8080');
});
