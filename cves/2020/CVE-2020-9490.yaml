id: CVE-2020-9490

info:
  name: Apache HTTP Server 2.4.20-2.4.43 - HTTP/2 Cache-Digest DoS
  author: philippedelteil
  severity: high
  description: Apache HTTP Server versions 2.4.20 to 2.4.43. A specially crafted value for the 'Cache-Digest' header in a HTTP/2 request would result in a crash when the server actually tries to HTTP/2 PUSH a resource afterwards. Configuring the HTTP/2 feature via "H2Push off" will mitigate this vulnerability for unpatched servers.
  reference:
    - https://httpd.apache.org/security/vulnerabilities_24.html
    - https://bugs.chromium.org/p/project-zero/issues/detail?id=2030
    - https://bugs.chromium.org/p/project-zero/issues/attachmentText?aid=443369
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9490
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2020-9490
    cwe-id: CWE-444
  tags: cve,cve2020,apache,dos

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: regex
        regex:
          - "Apache/2\\.4\\.([3-3][0-9]|2[0-9]|4[0-3])"
        part: header
