id: CVE-2022-0218

info:
  name: HTML Email Template Designer < 3.1 - Stored Cross-Site Scripting (XSS)
  author: hexcat
  severity: high
  description: WordPress Email Template Designer â€“ WP HTML Mail allows stored XSS through an unprotected REST-API endpoint (CVE-2022-0218).
  reference:
    - https://www.wordfence.com/blog/2022/01/unauthenticated-xss-vulnerability-patched-in-html-email-template-designer-plugin/
    - https://wordpress.org/plugins/wp-html-mail/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0218
  tags: wordpress,wp-plugin,xss,cve,cve2022

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?rest_route=/whm/v3/themesettings"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"background":'
          - '"footer":'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
