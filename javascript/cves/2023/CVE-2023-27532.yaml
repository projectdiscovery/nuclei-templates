id: CVE-2023-27532

info:
  name: Veeam Backup & Replication - Credential Disclosure (CVE-2023-27532)
  author: jobin-johnson-22
  severity: high
  description: |
    Detection template for CVE-2023-27532 affecting Veeam Backup & Replication.
    The template safely detects a vulnerable instance by querying the /api/v1/serverinfo
    and /api/v1/config/database endpoints. These endpoints return sensitive configuration
    metadata (such as databaseVendor and databaseContentVersion) without authentication
    in versions 11.0.1.1261 and 12.0.0.1420.
  impact: |
    If vulnerable, unauthenticated users can access encrypted credential information
    or configuration metadata from the backup database, which may lead to privilege escalation.
  remediation: Update Veeam Backup & Replication to version 12.0.0.1421 or later.
  reference:
    - https://www.veeam.com/kb4424
    - https://github.com/horizon3ai/CVE-2023-27532
    - https://github.com/sfewer-r7/CVE-2023-27532
    - https://github.com/puckiestyle/CVE-2023-27532-RCE-Only
  classification:
    cve-id: CVE-2023-27532
    cwe-id: CWE-306
    cvss-score: 7.5
  tags: veeam, cve, cve2023, credential-disclosure, http, backup

http:
  # 1️⃣ Detect Veeam installation
  - method: GET
    path:
      - '{{BaseURL}}/api/v1/serverinfo'
    headers:
      User-Agent: nuclei-scanner
      X-Api-Version: '1.1-rev1'
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"databaseVendor"'
          - '"databaseContentVersion"'
      - type: regex
        part: body
        regex:
          - "(11\\.0\\.1\\.1261|12\\.0\\.0\\.1420)"
      - type: status
        status:
          - 200
    extractors:
      - type: json
        json:
          - '.databaseVendor'
          - '.databaseContentVersion'
        name: db_info

  # 2️⃣ Optional secondary endpoint (mock lab / validation)
  - method: GET
    path:
      - '{{BaseURL}}/api/v1/config/database'
    headers:
      User-Agent: nuclei-scanner
      X-Api-Version: '1.1-rev1'
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'VeeamConfiguration'
          - 'connectionString'
          - 'encrypted'
      - type: regex
        part: body
        regex:
          - "(11\\.0\\.1\\.1261|12\\.0\\.0\\.1420)"
      - type: status
        status:
          - 200
# Optional out-of-band validation (for local testing only)
# variables:
#   oast_domain: "{{oast_domain}}"
#
# http:
#   - method: GET
#     path:
#       - "{{BaseURL}}/api/v1/serverinfo?ping={{oast_domain}}"
#     matchers:
#       - type: dsl
#         dsl:
#           - contains(interactsh_protocol, 'dns')
