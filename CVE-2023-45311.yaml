id: CVE-2023-45311

info:
  name: fsevents < 1.2.11 - Remote Code Execution
  author: princechaddha
  severity: critical
  description: |
    fsevents versions before 1.2.11 depend on a URL that allows an adversary to execute arbitrary code if malicious code is distributed from that URL.
    The vulnerability exists because the package resolves binaries from an insecure S3 bucket (fsevents-binaries.s3-us-west-2.amazonaws.com) which is susceptible to takeover.
  impact: |
    Remote Code Execution (RCE) if the S3 bucket is compromised or hijacked.
  remediation: |
    Upgrade fsevents to version 1.2.11 or higher.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-45311
    - https://github.com/advisories/GHSA-8r6j-v8pm-fqw3
    - https://security.snyk.io/vuln/SNYK-JS-FSEVENTS-5487987
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-45311
    cwe-id: CWE-73
    epss-score: 0.0043
    epss-percentile: 0.7422
  metadata:
    verified: true
    max-request: 1
  tags: cve,cve2023,fsevents,rce,nodejs,file

file:
  - extensions:
      - json
      - lock

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "fsevents"
          - "resolved"
        condition: and

      - type: word
        words:
          - "fsevents-binaries.s3-us-west-2.amazonaws.com"
