id: vanish-detect
info:
  name: Vanish Cache Detection
  author: 0xelkomy
  severity: low
  # https://stackoverflow.com/questions/41480688/what-is-the-difference-between-bans-and-purge-in-varnish-http-cache
requests:
  - raw:
      - |
        PURGE / HTTP/1.1

    matchers:
      - type: dsl
        name: multi-req
        dsl:
          - 'contains(body_1, "200 Purged") == true'
    req-condition: true
