id: tls-session-renegotiation

info:
  name: TLS Session Renegotiation Vulnerability
  author: ProjectDiscoveryAI
  severity: medium
  description: |
    This template detects the presence of the TLS session renegotiation vulnerability, which allows attackers to inject arbitrary content into ongoing TLS sessions, potentially leading to man-in-the-middle attacks.
  remediation: |
    Disable TLS renegotiation on the server side or upgrade to a version of the TLS library that properly handles renegotiation securely.

tcp:
  - host:
      - "{{Hostname}}"
    port: 443
    inputs:
      - data: |
          16030100d6010000d203035ee8b7d0b7e832b9d6a3a7c45f6a03c49e5f1e0c5b4e1f6
          77e0b8a0c8a0c3a0cfa0cba0c7a0c2a000000e1303131303130303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030
          30303030303030303030303030303030303030303030303030303030303030303030

    read-size: 2048

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "HTTP/1.1 400 Bad Request"
        part: data
      - type: word
        words:
          - "Renegotiation"
        part: data