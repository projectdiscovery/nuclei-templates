id: talk-client

info:
  name: Ensure Talk Client is Not Installed
  author: Th3l0newolf
  severity: info
  description: |
    The talk package provides a client for user-to-user messaging on local or remote systems.Since it uses unencrypted communication, it should be removed to minimize security risks.
  remediation: |
    Ensure the talk package is not installed unless explicitly required.To remove the package, run: sudo apt-get remove talk -y
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,local,cisecurity,audit,linux,ubuntu,talk

self-contained: true

code:
  - engine:
      - bash

    args:
      - "-c"
      - |
        # Check if the talk package is installed
        if dpkg-query -W -f='${Status}' talk 2>/dev/null | grep -q "install ok installed"; then
          echo "[cis-talk-client-check:Policy-Fail] [talk is installed] [CIS_FAIL]"
        else
          echo "[cis-talk-client-check:Policy-Pass] [talk is not installed] [CIS_PASS]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a0046304402201c824ba110feb30361f8e6b4084b712b8a4efcc1be7f11097fff3afd3a0018d102202224c841dd09c1e2eb771ab5a730dc6a9cc06e21a5fb5766591d0efd3ffd2475:922c64590222798bb761d5b6d8e72950