id: CVE-2025-32463

info:
  name: CVE-2025-32463 ï¿½~@~S vulnerable sudo detection (SSH remote, hardened)
  author: SeungAh-Hong
  severity: high
  description: |
    Sudo before 1.9.17p1 allows local users to obtain root access because /etc/nsswitch.conf
    from a user-controlled directory is used with the --chroot option.
  tags: cve,cve-2025-32463,sudo,code,bash

self-contained: true
code:
  - engine:
      - sh
      - bash
    source: |
      OUT="$(sudo -n -R woot woot 2>&1 || true)"
      printf "%s\n" "$OUT"

    matchers:
      - type: dsl
        dsl:
          - |
            contains(to_lower(response), 'sudo: woot: no such file or directory') || contains(to_lower(code_1_response), 'sudo: woot: no such file or directory') || contains(to_lower(code_1_stderr), 'sudo: woot: no such file or directory')
# digest: 490a00463044022032674c7c0d00d8ddbcbbd72a72a177b6dc09f910fd95b11c9acc776ae37d3e39022032ab6024c95742060c0fa4167b23da86bb54f53aeed257133e0cbd2fe51b6a61:e2f3b8c1167af995a7704c938c2c62ea