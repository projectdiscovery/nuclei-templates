id: nis-client-check

info:
  name: Ensure NIS Client is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The NIS (Network Information Service) client package should not be installed on the system, as it is considered insecure and deprecated. Removing it helps reduce the system's attack surface.
  remediation: |
    Run 'sudo apt-get remove nis -y' to uninstall the NIS client package.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,package,security,audit,ubuntu,benchmark

self-contained: true

code:
  - engine:
      - bash

    args:
      - "-c"
      - |
        # Check if the nis package is installed
        if dpkg-query -W -f='${Status}' nis 2>/dev/null | grep -q "install ok installed"; then
          echo "[cis-nis-client-check:Policy-Fail] [NIS is installed] [CIS_FAIL] [medium]"
        else
          echo "[cis-nis-client-check:Policy-Pass] [NIS is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 490a0046304402206e9b164d788e7f54a00853f6595449d00e0c72bf80bd65d2cf23fc04b6fdace4022002823de5c384e5b3bc547aff780e2d062b4f78f8625017931baa18a2b28a7261:a335a84a8b55aca14338a3237976ce9a