id: inactive-password-lock-default-check

info:
  name: Ensure Inactive Password Lock is Configured (Default Setting)
  author: Th3l0newolf
  severity: high
  description: |
    Checks if the default user inactivity lock is configured properly.
    The system should disable user accounts that remain inactive for more than 45 days after password expiration.
  remediation: |
    Run: sudo useradd -D -f 45
    This sets the default INACTIVE parameter for new user accounts.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,password,inactive,useradd,audit,ubuntu

self-contained: true

code:
  - engine:
      - bash
    args:
      - "-c"
      - |
        INACTIVE_DAYS=$(useradd -D | grep -i INACTIVE | awk -F= '{print $2}')
        if [ -z "$INACTIVE_DAYS" ] || [ "$INACTIVE_DAYS" -gt 45 ]; then
          echo "[inactive-password-lock-default-check:Policy-Fail] [INACTIVE=$INACTIVE_DAYS (invalid)] [CIS_FAIL] [high]"
        else
          echo "[inactive-password-lock-default-check:Policy-Pass] [INACTIVE=$INACTIVE_DAYS (valid)] [CIS_PASS] [high]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4a0a00473045022100815788db6bfa9a571f3ce360efa3ea8d3df25787748a70b84e37682a29949971022000a7194afc6e6032178bfb52ec0c3dd80d25be8c7a3d189e80a4028b5c195a30:a335a84a8b55aca14338a3237976ce9a
