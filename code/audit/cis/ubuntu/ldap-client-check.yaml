id: ldap-client-check

info:
  name: Ensure LDAP Client is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The LDAP client package (`ldap-utils`) allows systems to query and interact with LDAP directories. If not required, it should be removed to minimize the systemâ€™s attack surface and comply with security best practices.
  remediation: |
    Run 'sudo apt-get remove ldap-utils -y' to uninstall the LDAP client package.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,package,security,audit,ubuntu,benchmark,ldap

self-contained: true

code:
  - engine:
      - bash

    args:
      - "-c"
      - |
        # Check if the ldap-utils package is installed
        if dpkg-query -W -f='${Status}' ldap-utils 2>/dev/null | grep -q "install ok installed"; then
          echo "[cis-ldap-client-check:Policy-Fail] [ldap-utils is installed] [CIS_FAIL] [medium]"
        else
          echo "[cis-ldap-client-check:Policy-Pass] [ldap-utils is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4b0a00483046022100edbc051ebe862b3868c3bb06d49d69574ec3a4bdf06e071ec8e189c485716633022100afca6fcb19895f564c7e357c11d4766d756ad9be0bf9fe0cbea1318dac410ac1:a335a84a8b55aca14338a3237976ce9a