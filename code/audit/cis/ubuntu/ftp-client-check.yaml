id: ftp-client-check

info:
  name: Ensure FTP Client is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    FTP clients (`ftp`, `tnftp`) use an unencrypted protocol that exposes sensitive data during transmission. These packages should be removed unless explicitly required to reduce security risk and ensure compliance with best practices.
  remediation: |
    Run 'sudo apt-get remove ftp tnftp -y' to uninstall FTP client packages.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,package,security,audit,ubuntu,benchmark,ftp

self-contained: true

code:
  - engine:
      - bash

    args:
      - "-c"
      - |
        # Check if ftp or tnftp packages are installed
        if dpkg-query -W -f='${Package} ${Status}\n' ftp tnftp 2>/dev/null | grep -q "install ok installed"; then
          echo "[cis-ftp-client-check:Policy-Fail] [FTP client is installed] [CIS_FAIL] [medium]"
        else
          echo "[cis-ftp-client-check:Policy-Pass] [FTP client is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4a0a004730450221009f63edbb529256bd693c8a6fe038b14fbd4fd693c8f90544e54e0c1116664c7902205a4d1cb3ba52622ad3c82bccfc87055c3e6dfe4b3af6e8f8e8baa96400bacd26:a335a84a8b55aca14338a3237976ce9a
