id: rsh-client-check

info:
  name: Ensure rsh Client is Not Installed
  author: Th3l0newolf
  severity: medium
  description: |
    The rsh (Remote Shell) client package should not be installed on the system. It transmits data in plaintext and is considered insecure. Removing it reduces exposure to unauthorized remote access.
  remediation: |
    Run 'sudo apt-get remove rsh-client -y' to uninstall the rsh client package.
  reference:
    - https://www.cisecurity.org/benchmark/ubuntu_linux
  metadata:
    verified: true
  tags: cis,linux,package,security,audit,ubuntu,benchmark

self-contained: true

code:
  - engine:
      - bash

    args:
      - "-c"
      - |
        # Check if the rsh-client package is installed
        if dpkg-query -W -f='${Status}' rsh-client 2>/dev/null | grep -q "install ok installed"; then
          echo "[cis-rsh-client-check:Policy-Fail] [rsh-client is installed] [CIS_FAIL] [medium]"
        else
          echo "[cis-rsh-client-check:Policy-Pass] [rsh-client is not installed] [CIS_PASS] [medium]"
        fi

    matchers:
      - type: word
        name: policy-pass
        words:
          - "Policy-Pass"

      - type: word
        name: policy-fail
        words:
          - "Policy-Fail"
# digest: 4a0a00473045022100b8809b803457e8b8edf6015d1c1ebfbffa52f4f4aaf64e6e81bf3d583238fb7c02207472a53497a6585be4b7e43ebd236d5e4f8ba91d54faecac39b74bf84bcdf566:a335a84a8b55aca14338a3237976ce9a
