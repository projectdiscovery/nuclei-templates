id: linux-root-remote-login

info:
  name: Linux Root Remote Login Enabled - Misconfig
  author: songyaeji
  severity: high
  description: |
    Root remote login was enabled either through /etc/securetty or via SSH configuration.This misconfiguration increased the risk of unauthorized system access.
  reference:
    - https://isms.kisa.or.kr/main/csap/notice/
  metadata:
    verified: true
  tags: local,linux,ssh,root,misconfig,kisa,compliance

self-contained: true

code:
  - engine:
      - sh
      - bash
    source: |
      cat /etc/securetty 2>/dev/null | grep -E 'pts/[0-9]+' || echo "no-securetty"

  - engine:
      - sh
      - bash
    source: |
      cat /etc/ssh/sshd_config 2>/dev/null | grep -E '^PermitRootLogin\s+yes' || echo "no-root-ssh"

    matchers:
      - type: word
        name: tty
        part: code_1_response
        words:
          - "pts/"

      - type: word
        name: ssh
        part: code_2_response
        words:
          - "PermitRootLogin yes"