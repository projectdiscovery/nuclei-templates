id: dvwa-xss-stored

info:
  name: DVWA Stored XSS
  author: van
  severity: medium
  description: |
    Kiểm thử lỗi Stored XSS trên DVWA - phần vulnerabilities/xss_s/
    Lỗi Stored XSS xảy ra khi dữ liệu độc hại được lưu trữ
    và được hiển thị lại cho người dùng khác mà không được mã hóa an toàn.
  tags: dvwa,xss,stored-xss

http:
  - raw:
      - |
        POST /DVWA/vulnerabilities/xss_s/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: security=impossible; PHPSESSID={{phpsessid}}
        Connection: close

        txtName=vanxssimpo2&mtxMessage=<script>alert('xssim')</script>&btnSign=Sign+Guestbook

      - |
        GET /DVWA/vulnerabilities/xss_s/ HTTP/1.1
        Host: {{Hostname}}
        Cookie: security=impossible; PHPSESSID={{phpsessid}}
        Connection: close

    payloads:
      phpsessid:
        - "12g9sj6gdknke4870ld4boosib"

    matchers:
      - type: word
        part: body
        words:
          - "<script>alert('xssim')</script>"

