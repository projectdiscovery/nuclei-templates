# CVE-2020-14756 - Oracle Coherence Remote Code Execution

## Vulnerability Overview

**CVE ID:** CVE-2020-14756  
**Severity:** Critical (CVSS 9.8)  
**Affected Product:** Oracle Coherence (part of Oracle Fusion Middleware / WebLogic)  
**Protocols:** T3, IIOP  
**Attack Type:** Insecure Deserialization → Remote Code Execution  
**KEV:** True (Known Exploited Vulnerability)

## Description

Oracle Coherence component of Oracle Fusion Middleware contains a remote code execution vulnerability. An unauthenticated attacker with network access via T3 or IIOP protocols can exploit insecure deserialization in the `ExternalizableHelper` class to execute arbitrary code on the server.

## Affected Versions

- Oracle Coherence 3.7.1.0
- Oracle Coherence 12.1.3.0.0
- Oracle Coherence 12.2.1.3.0
- Oracle Coherence 12.2.1.4.0
- Oracle Coherence 14.1.1.0.0

## Technical Details

### Gadget Chain (AttributeHolder → TopNAggregator → MvelExtractor)

```
AttributeHolder.readExternal()
  └── ExternalizableHelper.readObject()
        └── TopNAggregator.PartialResult.readExternal()
              └── TreeMap.put()
                    └── SortedBag.WrapperComparator.compare()
                          └── MvelExtractor.extract()
                                └── MVEL expression execution → RCE
```

### Key Classes

| Class | Package | Role |
|-------|---------|------|
| `AttributeHolder` | com.tangosol.coherence.servlet | Entry point (Externalizable) |
| `TopNAggregator.PartialResult` | com.tangosol.util.aggregator | Gadget chain link |
| `MvelExtractor` | com.tangosol.coherence.rest.util.extractor | Code execution sink |
| `ExternalizableHelper` | com.tangosol.io | Deserialization handler |

## Templates Available

### 1. TCP Protocol Template (Network)
**File:** `CVE-2020-14756.yaml`

This template:
- Performs T3 handshake
- Sends the serialized AttributeHolder → TopNAggregator → MvelExtractor payload
- Uses OOB (Out-of-Band) verification via interactsh to confirm code execution
- Confirms vulnerability by receiving HTTP callback

### 2. JavaScript Template
**File:** `javascript/cves/2020/CVE-2020-14756.yaml`

This template:
- First checks WebLogic version via HTTP
- Uses JavaScript to build and send the T3 exploit payload
- Supports both Linux and Windows targets
- Validates RCE via interactsh callbacks

## Files in This Package

| File | Description |
|------|-------------|
| `CVE-2020-14756.yaml` | Nuclei TCP template for detection with OOB verification |
| `Dockerfile` | Vulnerable WebLogic environment |
| `docker-compose.yml` | Docker Compose configuration |
| `weblogic_t3.py` | T3 protocol exploit script |
| `gen_payload.py` | Payload generator |
| `run_test.sh` | Automated test script |
| `README.md` | This documentation |

## Setup Vulnerable Environment

### Using Docker Compose (Recommended)

```bash
docker-compose up -d

docker-compose logs -f
```

WebLogic will be accessible at:
- T3/IIOP: localhost:7001
- Console: http://localhost:7001/console

## Testing with Nuclei

### TCP Template
```bash
nuclei -t cve-2020-14756/CVE-2020-14756.yaml -u 127.0.0.1:7001 -debug -vvv -oast-server oast.fun
```

### JavaScript Template
```bash
nuclei -t javascript/cves/2020/CVE-2020-14756.yaml -u http://127.0.0.1:7001 -debug -vvv
```

## Exploitation Flow

1. **T3 Handshake** - Establish T3 protocol connection
2. **Payload Delivery** - Send serialized gadget chain wrapped in T3 protocol
3. **Deserialization Trigger** - ExternalizableHelper processes AttributeHolder
4. **Gadget Chain Execution** - TopNAggregator → TreeMap → MvelExtractor
5. **MVEL Expression Execution** - Runtime.exec() triggers OOB callback
6. **OOB Verification** - Interactsh confirms code execution

## Remediation

1. **Apply Patch:** Install Oracle Critical Patch Update (January 2021 or later)
2. **Disable Protocols:** Disable T3/IIOP if not required
3. **Network Segmentation:** Restrict access to ports 7001/7002
4. **IDS/IPS:** Enable detection signatures for WebLogic deserialization attacks

## References

- [NVD - CVE-2020-14756](https://nvd.nist.gov/vuln/detail/CVE-2020-14756)
- [Oracle CPU January 2021](https://www.oracle.com/security-alerts/cpujan2021.html)
- [Y4er CVE-2020-14756 PoC](https://github.com/Y4er/CVE-2020-14756)
- [Bounty Team Analysis](https://bounty-team.github.io/vulnerability%20analysis/2021/01/27/CVE-2020-14756/)
- [VulnCheck](https://vulncheck.com/xdb/d5d4e15a3fd1)

## Disclaimer

This template and associated tools are provided for educational and authorized security testing purposes only. Unauthorized access to computer systems is illegal. Always obtain proper authorization before testing.

## Authors

- princechaddha
- kajal1322705

## Bounty Claim

`/claim #14152`
