# CVE-2020-14756 - Vulnerable Oracle WebLogic 12.2.1.4.0 Environment
#
# This Dockerfile creates a vulnerable WebLogic environment with Coherence
# for testing CVE-2020-14756 (T3/IIOP deserialization RCE).
#
# Build: docker build -t weblogic-vuln .
# Run:   docker run -d -p 7001:7001 -p 7002:7002 --name weblogic-vuln weblogic-vuln
#
# Note: Oracle WebLogic requires accepting the license agreement.
# This uses the official Oracle WebLogic image from Oracle Container Registry.
#
# Author: princechaddha
# CVE: CVE-2020-14756

FROM container-registry.oracle.com/middleware/weblogic:12.2.1.4-dev-ol8

LABEL maintainer="princechaddha"
LABEL description="Vulnerable WebLogic 12.2.1.4.0 for CVE-2020-14756 testing"
LABEL cve="CVE-2020-14756"

ENV DOMAIN_NAME="base_domain"
ENV ADMIN_NAME="AdminServer"
ENV ADMIN_USER="weblogic"
ENV ADMIN_PASSWORD="weblogic1"
ENV ADMIN_PORT="7001"

USER root

RUN mkdir -p /u01/oracle/properties && \
    echo "username=${ADMIN_USER}" > /u01/oracle/properties/boot.properties && \
    echo "password=${ADMIN_PASSWORD}" >> /u01/oracle/properties/boot.properties && \
    chown -R oracle:oracle /u01/oracle/properties

USER oracle

EXPOSE 7001 7002

CMD ["startAdminServer.sh"]
