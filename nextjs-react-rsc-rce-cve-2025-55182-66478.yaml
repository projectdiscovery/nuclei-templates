id: nextjs-react-rsc-rce-cve-2025-55182-66478

info:
  name: Next.js React Server Components RCE (CVE-2025-55182 & CVE-2025-66478)
  author: gaurang-sec
  severity: critical
  description: |
    Detects vulnerable Next.js applications using React Server Components
    that are exploitable via the React2Shell RCE vector. The template sends
    a crafted multipart/form-data POST with a colon-delimited reference in
    the RSC flight data, causing a 500 error and a text/x-component response
    containing an RSC digest marker.
  reference:
    - https://slcyber.io/research-center/high-fidelity-detection-mechanism-for-rsc-next-js-rce-cve-2025-55182-cve-2025-66478/
    - https://react2shell.com/
    - https://github.com/assetnote/react2shell-scanner
    - https://nvd.nist.gov/vuln/detail/CVE-2025-55182
  tags: cve,cve2025,rce,nextjs,react,rsc,text-x-component

http:
  - method: POST
    path:
      - "{{BaseURL}}/"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.113 Safari/537.36 Assetnote/1.0.0
      Next-Action: x
      X-Nextjs-Request-Id: b5dce965
      Next-Router-State-Tree: "%5B%22%22%2C%7B%22children%22%3A%5B%22__PAGE__%22%2C%7B%7D%2Cnull%2Cnull%5D%7D%2Cnull%2Cnull%2Ctrue%5D"
      X-Nextjs-Html-Request-Id: SSTMXm7OJ_g0Ncx6jpQt9
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad

    body: |
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="1"

      {}
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="0"

      ["$1:a:a"]
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad--

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500

      - type: word
        part: header
        words:
          - "text/x-component"

      - type: word
        part: body
        words:
          - 'E{"digest"'

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'E{"digest":"([^"]+)"'