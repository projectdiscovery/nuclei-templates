version: "3.8"
services:
  vulnerable-fortiweb-mock:
    build: .
    ports:
      - "8080:8080"
    container_name: fortiweb-poc

  nuclei-tester:
    image: projectdiscovery/nuclei:latest
    container_name: nuclei-poc
    depends_on:
      - vulnerable-fortiweb-mock
    volumes:
      - ./http/cves/2025/CVE-2025-52970.yaml:/root/template.yaml
    command:
      [
        "-t",
        "/root/template.yaml",
        "-u",
        "http://vulnerable-fortiweb-mock:8080",
        "-var",
        "aps_magic=123",
        "-var",
        "payload=test",
        "-var",
        "authhash=test",
        "-debug",
      ]
