id: ssl-certificate-transparency

info:
  name: SSL Certificate Transparency - Detection
  author: rxerium
  severity: info
  description: |
    Detects if the SSL certificate includes Certificate Transparency (CT) log information via the Signed Certificate Timestamp (SCT) extension.
    CT helps detect mis-issued certificates and improves transparency in the certificate ecosystem.
  reference:
    - https://certificate.transparency.dev/
    - https://tools.ietf.org/html/rfc6962
  metadata:
    verified: true
    max-request: 1
  tags: ssl,tls,ct,certificate-transparency,discovery

ssl:
  - address: "{{Host}}:{{Port}}"

    matchers:
      - type: word
        part: certificate_signed_certificate_timestamps
        words:
          - "log_id"
          - "timestamp"
        condition: and

    extractors:
      - type: json
        part: response
        json:
          - ".certificate_signed_certificate_timestamps"
