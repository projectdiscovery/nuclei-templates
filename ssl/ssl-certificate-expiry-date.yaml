id: ssl-certificate-expiry-date-info

info:
  name: SSL Certificate Expiry Date Information
  author: Kazgangap
  severity: info
  description: |
    SSL Certificate Expiry Date Information. This rule extracts the expiry date of the SSL certificate.
  reference:
    - https://tools.ietf.org/html/rfc5280
    - https://www.openssl.org/docs/manmaster/man1/openssl-x509.html
  metadata:
    max-request: 1
  tags: ssl,tls,certificate,validity,expiration,info

ssl:
  - address: "{{Host}}:{{Port}}"
    
    matchers:
      - type: dsl
        dsl:
          - "len(not_after) > 0"

    # Date format is ISO 8601 (YYYY-MM-DDTHH:MM:SSZ) in UTC
    extractors:
      - type: json
        json:
          - ".not_after"
