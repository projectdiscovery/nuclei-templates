id: ssl-certificate-chain-length

info:
  name: SSL Certificate Chain Length - Detection
  author: rxerium
  severity: info
  description: |
    Detects and reports the length of the SSL certificate chain presented by the server.
    A typical chain includes the leaf certificate, intermediate CA(s), and optionally the root CA.
  reference:
    - https://www.ssl.com/faqs/what-is-an-ssl-certificate-chain/
  metadata:
    verified: true
    max-request: 1
  tags: ssl,tls,certificate,chain,discovery

ssl:
  - address: "{{Host}}:{{Port}}"

    extractors:
      - type: json
        json:
          - ".subject_cn"
          - ".issuer_cn"
          - ".not_after"
          - ".not_before"