id: ssl-protocol-support

info:
  name: SSL/TLS Protocol Support - Detection
  author: rxerium
  severity: info
  description: |
    Detects which SSL/TLS protocol versions are supported by the server.
    This provides a comprehensive view of the server's TLS configuration and helps identify legacy protocol support.
  reference:
    - https://www.ssllabs.com/ssltest/
    - https://tools.ietf.org/html/rfc8446
  metadata:
    verified: true
    max-request: 5
  tags: ssl,tls,protocol,discovery

ssl:
  - address: "{{Host}}:{{Port}}"
    min_version: ssl30
    max_version: ssl30

    matchers:
      - type: word
        part: response
        words:
          - "ssl30"
        
    extractors:
      - type: json
        name: ssl30-support
        json:
          - ".tls_version"
          - ".subject_cn"

  - address: "{{Host}}:{{Port}}"
    min_version: tls10
    max_version: tls10

    matchers:
      - type: word
        part: response
        words:
          - "tls10"
        
    extractors:
      - type: json
        name: tls10-support
        json:
          - ".tls_version"
          - ".subject_cn"

  - address: "{{Host}}:{{Port}}"
    min_version: tls11
    max_version: tls11

    matchers:
      - type: word
        part: response
        words:
          - "tls11"
        
    extractors:
      - type: json
        name: tls11-support
        json:
          - ".tls_version"
          - ".subject_cn"

  - address: "{{Host}}:{{Port}}"
    min_version: tls12
    max_version: tls12

    matchers:
      - type: word
        part: response
        words:
          - "tls12"
        
    extractors:
      - type: json
        name: tls12-support
        json:
          - ".tls_version"
          - ".subject_cn"

  - address: "{{Host}}:{{Port}}"
    min_version: tls13
    max_version: tls13

    matchers:
      - type: word
        part: response
        words:
          - "tls13"
        
    extractors:
      - type: json
        name: tls13-support
        json:
          - ".tls_version"
          - ".subject_cn"