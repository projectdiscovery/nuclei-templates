id: file-or-dir-without-owner

info:
  name: Files or Directories Without Valid Owner or Group
  author: songyaeji
  severity: medium
  description: >
    Files or directories without a valid owner or group may result from improper user/group deletion or administrative errors.
    These files could be exploited or misused if not properly reviewed and removed or reassigned.
  reference:
    - https://isms.kisa.or.kr/main/csap/notice/
    - Cloud Vulnerability Assessment Guide (2024) by KISA
  tags: linux,local,ownership,compliance,file-permissions
  metadata:
    verified: true
    os: linux
    max-request: 1
  classification:
    cwe-id: CWE-732
    cvss-metrics: CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L
    cvss-score: 4.6

self-contained: true

code:
  - engine:
      - bash
    source: |
      find /etc /tmp /bin /sbin \( -nouser -o -nogroup \) -xdev -exec ls -al {} \; 2>/dev/null | head -n 1 || echo "no-unowned"
    matchers:
      - type: word
        part: code_1_response
        words:
          - " /"
        condition: contains