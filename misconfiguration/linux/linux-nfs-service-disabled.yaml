id: linux-nfs-service-disabled

info:
  name: NFS Service Daemon Should Be Disabled
  author: songyaeji
  severity: high
  description: >
    If the NFS service is running, unauthorized users may exploit it to access, modify, or delete system files.
    It is recommended to ensure the NFS daemon is disabled when not explicitly required.
  reference:
    - https://isms.kisa.or.kr
    - Cloud Vulnerability Assessment Guide(2024) by KISA
  tags: linux,nfs,misconfiguration,daemon
  metadata:
    verified: true
    os: linux
    max-request: 1
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cwe-id: CWE-284

self-contained: true

code:
  - engine:
      - bash
    source: |
      if ps -ef | grep -v grep | grep -q nfsd; then
        echo "[VULNERABLE] NFS service is active (nfsd is running)"
      else
        echo "[SAFE] NFS service is not running"
      fi
    matchers:
      - type: word
        part: code_1_response
        words:
          - "[VULNERABLE]"