id: linux-os-kernel-eol-check

info:
  name: Linux OS or Kernel End of Life (EOL) Version Check
  author: songyaeji
  severity: high
  description: >
    Systems running outdated or EOL (End-of-Life) versions of Linux OS or Kernel may be vulnerable to
    known exploits due to lack of vendor support and patch updates. This template checks the current OS
    and Kernel version to assess patch compliance status.
  reference:
    - https://isms.kisa.or.kr
    - Cloud Vulnerability Assessment Guide(2024) by KISA
  tags: linux,patch,eol,os,kernel,local
  metadata:
    verified: true
    os: linux
    max-request: 2
  classification:
    cvss-metrics: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cwe-id: CWE-1104

self-contained: true

code:
  - engine:
      - bash
    source: |
      cat /etc/os-release 2>/dev/null | grep -E '^VERSION_ID=' || echo "os-version-not-found"
    matchers:
      - type: word
        part: code_1_response
        words:
          - "VERSION_ID="
    extractors:
      - type: regex
        part: code_1_response
        name: os_version_id
        regex:
          - '^VERSION_ID="?([^"\n]+)'

  - engine:
      - bash
    source: |
      uname -r 2>/dev/null || echo "kernel-version-not-found"
    matchers:
      - type: regex
        part: code_2_response
        regex:
          - '^[0-9]+\.[0-9]+(\.[0-9]+)?'
    extractors:
      - type: regex
        part: code_2_response
        name: kernel_version
        regex:
          - '^([0-9]+\.[0-9]+(\.[0-9]+)?)'