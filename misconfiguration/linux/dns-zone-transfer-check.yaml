id: dns-zone-transfer-check

info:
  name: DNS Zone Transfer - Configuration Check
  author: songyaeji
  severity: high
  description: >
    If DNS Zone Transfer is allowed to all hosts, it may expose sensitive information such as hostnames, 
    network structure, and system data. This template checks whether the BIND DNS server restricts 
    zone transfers via allow-transfer directive in /etc/named.conf.
  reference:
    - https://isms.kisa.or.kr
    - Cloud Vulnerability Assessment Guide(2024) by KISA
  tags: linux,dns,bind,zonetransfer,misconfiguration,local
  metadata:
    verified: true
    os: linux
    max-request: 1
  classification:
    cvss-metrics: CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cwe-id: CWE-200

self-contained: true
code:
  - engine:
      - bash
    source: |
      cat /etc/named.conf 2>/dev/null | grep -E 'allow-transfer' || echo "no-allow-transfer"
    matchers:
      - type: word
        part: code_1_response
        words:
          - "allow-transfer"
        condition: contains