id: root-path-includes-current-dir

info:
  name: Root PATH Environment Variable Includes Current Directory (".")
  author: songyaeji
  severity: high
  description: >
    If the root user's PATH variable includes the current directory (".") at the beginning or middle,
    unauthorized scripts or binaries in the current working directory could be executed with root privileges,
    potentially leading to privilege escalation or unintended behavior.
  reference:
    - https://isms.kisa.or.kr/main/csap/notice/
    - Cloud Vulnerability Assessment Guide (2024) by KISA
  tags: linux,local,misconfiguration,path,privilege-escalation
  metadata:
    verified: true
    os: linux
    max-request: 1
  classification:
    cwe-id: CWE-427
    cvss-metrics: CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 6.7

self-contained: true

code:
  - engine:
      - bash
    source: |
      echo $PATH | grep -q '\.:.*' && echo "dot-in-path" || echo "safe-path"
    matchers:
      - type: word
        part: code_1_response
        words:
          - "dot-in-path"