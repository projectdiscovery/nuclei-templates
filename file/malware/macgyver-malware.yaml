id: macgyver-malware

info:
  name: MacGyver.cap Malware - Detect
  author: daffainfo
  severity: info
  reference:
    - https://github.com/fboldewin/MacGyver-s-return---An-EMV-Chip-cloning-case/blob/master/MacGyver's%20return%20-%20An%20EMV%20Chip%20cloning%20case.pdf
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_MacGyver.yar
  tags: malware,file
file:
  - extensions:
      - all
    matchers:
      - type: word
        part: raw
        words:
          - "src/MacGyver/javacard/Header.cap"
          - "src/MacGyver/javacard/Directory.cap"
          - "src/MacGyver/javacard/Applet.cap"
          - "src/MacGyver/javacard/Import.cap"
          - "src/MacGyver/javacard/ConstantPool.cap"
          - "src/MacGyver/javacard/Class.cap"
          - "src/MacGyver/javacard/Method.cap"
        condition: and
# digest: 4b0a00483046022100a7209620c244f9593e95e6e71fa07eaa138c05a788ae1028fa1c89b452a56b92022100ae234b81c48fdbacc96d299d97d3749254b84c80b8aa5c55c3de916dcb180a11:922c64590222798bb761d5b6d8e72950