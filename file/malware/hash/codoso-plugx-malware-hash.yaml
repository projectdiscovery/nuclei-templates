id: codoso-plugx-malware-hash
info:
  name: Codoso APT PlugX Malware Hash - Detect
  author: pussycat0x
  severity: info
  description: |
    Detects Codoso APT PlugX Malware.
  reference:
    - https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_Codoso.yar
  tags: malware,apt,codoso

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == 'b9510e4484fa7e3034228337768176fce822162ad819539c6ca3631deac043eb'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
          - "sha256(raw) == '74e1e83ac69e45a3bee78ac2fac00f9e897f281ea75ed179737e9b6fe39971e3'"
        condition: or
# digest: 490a0046304402207fd234440a24bffdea2a464906f468ddf2a10875a9e8b6fc5452f0da537d30de02201bae0c53c5b9c60b2adcd4977aad563bb0c18097292c66137db3ac0d883c2d10:922c64590222798bb761d5b6d8e72950