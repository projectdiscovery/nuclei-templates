id: cheshirecat-malware-hash
info:
  name: CheshireCat Malware Hash - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/
    - https://github.com/Yara-Rules/rules/blob/master/malware/APT_CheshireCat.yar
  tags: malware,apt

file:
  - extensions:
      - all

    matchers:
      - type: dsl
        dsl:
          - "sha256(raw) == 'ec41b029c3ff4147b6a5252cb8b659f851f4538d4af0a574f7e16bc1cd14a300'"
          - "sha256(raw) == '32159d2a16397823bc882ddd3cd77ecdbabe0fde934e62f297b8ff4d7b89832a'"
          - "sha256(raw) == '63735d555f219765d486b3d253e39bd316bbcb1c0ec595ea45ddf6e419bef3cb'"
          - "sha256(raw) == 'c074aeef97ce81e8c68b7376b124546cabf40e2cd3aff1719d9daa6c3f780532'"
        condition: or
# digest: 4a0a00473045022100adbb636ae85e2e1a0ac05393956093ac08d06aa58823c397ed410934e6df3e53022043da56808b1ece6fde13639cf6fb3fc93f39c123b31ad7cec1c7e55125807364:922c64590222798bb761d5b6d8e72950