id: malware_madness

info:
  name: Madness DDOS Malware Detector
  author: daffainfo
  severity: critical
  reference:
    - https://github.com/arbor/yara/blob/master/madness.yara
    - https://github.com/Yara-Rules/rules/blob/master/malware/MALW_Madness.yar
  tags: malware,file

file:
  - extensions:
      - all

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "TW96aWxsYS81LjAgKFdpbmRvd3M7IFU7IFdpbmRvd3MgTlQgNS4xOyBlbi1VUzsgcnY6MS44LjAuNSkgR2Vja28vMjAwNjA3MzEgRmlyZWZveC8xLjUuMC41IEZsb2NrLzAuNy40LjE"
          - "TW96aWxsYS81LjAgKFgxMTsgVTsgTGludXggMi40LjItMiBpNTg2OyBlbi1VUzsgbTE4KSBHZWNrby8yMDAxMDEzMSBOZXRzY2FwZTYvNi4wMQ=="
          - "document.cookie="
          -  "[\"cookie\",\""
          -  "\"realauth="
          -  "\"location\"];"
          -  "d3Rm"
          -  "ZXhl"
        condition: and