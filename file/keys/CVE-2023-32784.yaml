id: CVE-2023-32784

info:
  name: KeePass 2.x Memory Password Disclosure
  author: neha
  severity: high
  description: |
    KeePass 2.x before 2.54 contains a vulnerability that allows recovery of the cleartext master password from memory dumps, even when the workspace is locked or KeePass is not running, caused by insecure memory handling, letting attackers extract sensitive data, exploit requires access to memory dumps such as process dumps, swap files, or RAM.
  impact: |
    Attackers can retrieve the master password from memory dumps, leading to complete compromise of stored credentials.
  remediation: |
    Update to KeePass 2.54 or later, which uses different API and/or inserts random strings to mitigate this issue.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-32784
    - https://keepass.info/news/n230603_2.54.html
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 5.5
    cve-id: CVE-2023-32784
    cwe-id: CWE-200
    epss-score: 0.01723
    epss-percentile: 0.85437
    cpe: cpe:2.3:a:keepass:keepass:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: keepass
    product: keepass
    framework: dotnet
    tags: cve,cve2023,keepass,password-disclosure,memory-dump,windows,linux,macos
  tags: cve,cve2023,keepass,file,keys,password-disclosure,memory,vuln,kev

file:
  - extensions:
      - exe
      - dll
      - kdbx
      - kdb
      - dmp
      - sys
      - bin
      - mem
      - raw
      - all

    matchers:
      - type: regex
        regex:
          - "KeePass Password Safe"
          - "KeePass\\x20database"
          - "System\\.Windows\\.Forms"
          - "SecureTextBoxEx"
          - "MasterKey"
          - "masterPassword"
          - "KPv2\\x01"
          - "KPv2\\x02"
          - "KeePass\\.exe"
          - "KeePass\\.config"
        condition: or
