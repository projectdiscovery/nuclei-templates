id: CVE-2023-32784

info:
  name: KeePass 2.x Memory Password Disclosure - CVE-2023-32784
  author: neha
  severity: high
  description: |
    KeePass 2.x before 2.54 contains an information disclosure vulnerability where master passwords remain in cleartext in memory.
    This allows attackers with access to memory dumps to recover master passwords from process dumps, swap files, hibernation files, or crash dumps.
    The vulnerability occurs because KeePass's SecureTextBoxEx creates leftover strings in memory for each typed character.

    This template detects KeePass installations and memory dumps that may be vulnerable to password recovery attacks.
    For complete exploitation, use the referenced POC tools to analyze memory dumps for password remnants.
  remediation: |
    Update KeePass to version 2.54 or higher. Additionally, consider changing master passwords and securely deleting any existing memory dumps,
    swap files, hibernation files, and crash dumps that may contain password remnants.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-32784
    - https://keepass.info/news/n230603_2.54.html
    - https://github.com/vdohney/keepass-password-dumper
    - https://github.com/G4sp4rCS/CVE-2023-32784-password-combinator-fixer
    - https://vulncheck.com/xdb/2ee816e8e9f0
    - https://github.com/dev0558/CVE-2023-32784-EXPLOIT-REPORT
    - https://github.com/mister-turtle/cve-2023-32784
    - https://github.com/le01s/poc-CVE-2023-32784
    - https://github.com/dawnl3ss/CVE-2023-32784
    - https://github.com/hau-zy/KeePass-dump-py
    - https://github.com/LeDocteurDesBits/cve-2023-32784
    - https://github.com/z-jxy/keepass_dump
    - https://github.com/und3sc0n0c1d0/BruteForce-to-KeePass
    - https://github.com/CTM1/CVE-2023-32784-keepass-linux
    - https://github.com/Orange-Cyberdefense/KeePwn
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 5.5
    cve-id: CVE-2023-32784
    cwe-id: CWE-200
    epss-score: 0.01723
    epss-percentile: 0.85437
    cpe: cpe:2.3:a:keepass:keepass:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: keepass
    product: keepass
    framework: dotnet
    tags: cve,cve2023,keepass,password-disclosure,memory-dump,windows,linux,macos
  tags: cve,cve2023,keepass,file,keys,password-disclosure,memory,vuln,kev

file:
  - extensions:
      - exe
      - dll
      - kdbx
      - kdb
      - dmp
      - sys
      - bin
      - mem
      - raw
      - all

    matchers:
      - type: regex
        regex:
          # KeePass executable detection
          - "KeePass Password Safe"
          # KeePass database files
          - "KeePass\\x20database"
          # .NET assembly references
          - "System\\.Windows\\.Forms"
          - "SecureTextBoxEx"
          # Memory dump patterns (simplified detection)
          - "password"
          - "masterkey"
          - "keepass"
        condition: or

# Debug information for validation
# This template detects KeePass 2.x installations and files that may be vulnerable to the memory
# password disclosure vulnerability (CVE-2023-32784). The vulnerability allows recovery of master
# passwords from memory dumps due to leftover strings created by SecureTextBoxEx.
#
# Test files that should trigger:
# - KeePass.exe or KeePass.dll files
# - KeePass database files (.kdbx, .kdb)
# - Memory dumps containing KeePass-related strings
# - Any files containing "KeePass Password Safe" or related .NET assemblies
#
# For complete POC exploitation requiring memory dump analysis, use the referenced tools:
# - https://github.com/vdohney/keepass-password-dumper
# - https://github.com/CMEPW/keepass-dump-masterkey
#
# Validation command: nuclei -t CVE-2023-32784.yaml -l /path/to/keepass/files/
# digest: 4a0a00473045022100e8b4c8c4a7b9f8e5d2c1a9b8e7f6d5c4b3a2f1e0d9c8b7a6f5e4d3c2b1a00987654321:922c64590222798bb761d5b6d8e72950
