id: deep-link-custom-scheme-detect

info:
  name: Android Deep Link - Detect Custom Schemes
  author: 7h3b4dger
  severity: info
  description: Detects custom URI schemes (non-http/https) declared in Deep Link intent filters.
  tags: android,file,deeplink

file:
  - extensions:
      - xml

    matchers:
      - type: xpath
        part: body
        xpath:
          - "//activity/intent-filter/action[@android:name='android.intent.action.VIEW']"
          - "//activity/intent-filter/category[@android:name='android.intent.category.BROWSABLE']"
        condition: and

    extractors:
      - type: xpath
        part: body
        attribute: android:scheme
        xpath:
          - "/manifest/application/activity/intent-filter/data[@android:scheme!='http' and @android:scheme!='https']"

