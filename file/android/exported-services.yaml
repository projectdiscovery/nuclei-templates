id: exported-services

info:
  name: Android Exported Services - Detect
  author: 7h3b4dger
  severity: info
  description: Detect exported services in AndroidManifest.xml, excluding disabled and common Google/Jetpack library services.
  tags: android,file,exportedcomponents

file:
  - extensions:
      - xml

    matchers:
      - type: xpath
        part: body
        xpath:
          - "//service[@android:exported='true']"

    extractors:
      - type: xpath
        part: body
        attribute: android:name
        xpath:
          - "//service[@android:exported='true' and not(contains(@android:name, 'androidx')) and not(contains(@android:name, 'google'))]"
# digest: 4b0a004830460221009100a81cea6ccb3105977ace3ad5131a1a677f7f332e6192c1dcbb5a24705025022100ce7022ee4b51071412405072a5899d71af706efe2c9f965dff02f3d434d6f63e:922c64590222798bb761d5b6d8e72950