id: exported-activities

info:
  name: Android Exported Activities - Detect
  author: 7h3b4dger
  severity: info
  description: Detect exported (android:exported="true") activities in AndroidManifest.xml, excluding launcher activities and common Google/Jetpack libraries.
  tags: android,file,exportedcomponents

file:
  - extensions:
      - xml

    matchers:
      - type: xpath
        part: body
        xpath:
          - "//activity[@android:exported='true']"
          - "//activity/intent-filter/action[@android:name!='android.intent.category.LAUNCHER']"
        condition: and

    extractors:
      - type: xpath
        part: body
        attribute: android:name
        xpath:
          - "//activity[@android:exported='true'and not(contains(@android:name, 'androidx')) and not(contains(@android:name, 'google'))]"
# digest: 490a004630440220457f58399dc08789899303ee923debaeabb34e6378d3cf92a8990917197c49a6022024f33e09d43b6ec9eb9a496ae9902d84a51e6ab5705a83bf695423d5a7143a89:922c64590222798bb761d5b6d8e72950