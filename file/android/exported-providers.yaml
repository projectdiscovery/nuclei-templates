id: exported-providers

info:
  name: Android Exported Providers - Detect
  author: 7h3b4dger
  severity: info
  description: Detect exported providers in AndroidManifest.xml filtering out those included in Android libraries
  tags: android,file,exportedcomponents

file:
  - extensions:
      - xml

    matchers-condition: and
    matchers:
      - type: xpath
        part: body
        xpath:
          - "//provider[@android:exported='true']"
    extractors:
      - type: xpath
        part: body
        attribute: android:name
        xpath:
          - "//provider[@android:exported='true' and not(contains(@android:name, 'androidx')) and not(contains(@android:name, 'google'))]"

