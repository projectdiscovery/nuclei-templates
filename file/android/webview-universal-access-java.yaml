id: webview-universal-access-java

info:
  name: Android WebView Universal Access - Detect in Java sources
  author: 7h3b4dger
  severity: info
  description: Android WebView Universal Access enabling was detected - Java source version.
  tags: android,file,webview

file:
  - extensions:
      - java

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "setAllowUniversalAccessFromFileURLs(true)"

      - type: regex
        part: body
        regex:
          - package\s+(?:.*)

    extractors:
          - type: regex
            part: body
            name: package
            group: 1
            regex:
              - (?m)^\s*package\s+([A-Za-z_][A-Za-z0-9_\.]*)\s*;
# digest: 4b0a00483046022100d97bfa826a719b689104f03ffe7ceb0756eeae3d8184f8690d45f1f67092c39f022100c94f9fb31c6c44b038351a772c6b1a950c43e004a2492a1a866d72e2e3c0eeb4:922c64590222798bb761d5b6d8e72950