CVE-2023-27532 Debug Information & Vulnerable Setup Details
==========================================================

## Vulnerability Overview
CVE-2023-27532 is a credential disclosure vulnerability in Veeam Backup & Replication that allows unauthenticated access to encrypted credentials stored in the configuration database.

## Template Validation Information

### Detection Method
The template detects the vulnerability in two phases:

1. **Installation Detection**: Identifies Veeam Backup installations via:
   - Login page at /login.aspx
   - API endpoint at /api/v1/serverinfo
   - Presence of "Veeam Backup Enterprise Manager" in response
   - X-Veeam-Server header

2. **Version Check**: Specifically targets vulnerable versions:
   - 11.0.1.1261
   - 12.0.0.1420

### API Testing
The vulnerability exists in the Veeam API that returns database configuration information without proper authentication. The template tests:
- Endpoint: /api/v1/serverinfo
- Header: X-Api-Version: 1.1-rev1
- Response contains: databaseVendor, databaseContentVersion

### Why OAST was Removed
After reviewing the actual vulnerability, OAST/interactsh is not appropriate for this CVE because:
- The vulnerability is direct credential disclosure via API
- No external callbacks or SSRF involved
- Credentials are returned directly in API response

### Template Structure
```yaml
# Request 1: Detect Veeam installation
GET /login.aspx or /api/v1/serverinfo
- Look for "Veeam Backup Enterprise Manager" in response

# Request 2: Test vulnerable API
GET /api/v1/serverinfo
Header: X-Api-Version: 1.1-rev1
- Must contain: "databaseVendor" and "databaseContentVersion"
- Must match vulnerable version: 11.0.1.1261 or 12.0.0.1420
- Status: 200
```

## Vulnerable Setup Details

### Quick Setup (Recommended for Testing)
1. **Download** Veeam Backup & Replication 11.0.1.1261 ISO from official Veeam website
2. **Install** on Windows Server 2019/2022 with default settings
3. **Enable API access** during installation
4. **Test URLs**:
   - Web Interface: https://[SERVER-IP]/login.aspx
   - API Endpoint: https://[SERVER-IP]/api/v1/serverinfo

### Detailed Setup Steps
1. Install Windows Server 2019/2022 VM
2. Install SQL Server 2019 (required for Veeam)
3. Download Veeam Backup & Replication 11.0.1.1261 ISO
4. Run installer with "Server" and "Console" components
5. During installation, enable "REST API" option
6. Complete setup with default ports (9392, 443)

### Docker Alternative (If Available)
```bash
# Note: Official Veeam Docker images may not be available
# Use VM setup instead for accurate testing
docker run -d --name veeam-vulnerable \
  -p 9392:9392 -p 443:443 \
  -e VEEAM_VERSION=11.0.1.1261 \
  veeam/backup:latest
```

### Test Commands
```bash
# 1. Test web interface
curl -k https://[SERVER-IP]/login.aspx

# 2. Test API endpoint (vulnerable)
curl -k -H "X-Api-Version: 1.1-rev1" \
     https://[SERVER-IP]/api/v1/serverinfo

# 3. Run nuclei template
nuclei -t CVE-2023-27532.yaml -u https://[SERVER-IP]
```

### Expected Vulnerable Response
```json
{
  "version": "11.0.1.1261",
  "databaseVendor": "Microsoft SQL Server",
  "databaseContentVersion": "11.0.1.234",
  "databaseName": "VeeamBackup",
  "serverName": "VEEAM-SERVER",
  "apiVersion": "1.1-rev1"
}
```

### Expected Non-Vulnerable Response (After Patch)
```json
{
  "version": "12.0.0.1421",
  "error": "Unauthorized",
  "message": "Authentication required"
}
```

## Template Testing Commands

```bash
# Test against vulnerable instance
nuclei -t http/cves/2023/CVE-2023-27532.yaml -u https://vulnerable-veeam-server.com

# Expected output for vulnerable system:
[CVE-2023-27532] [http] [high] https://vulnerable-veeam-server.com/api/v1/serverinfo

# Test against patched system (should not detect)
nuclei -t http/cves/2023/CVE-2023-27532.yaml -u https://patched-veeam-server.com
# Should show no results
```

## Validation Checklist
- [ ] Veeam 11.0.1.1261 installed with API enabled
- [ ] API endpoint returns database configuration
- [ ] Template detects vulnerability correctly
- [ ] Template does NOT detect on patched versions
- [ ] No false positives on other systems

## References
- Official Advisory: https://www.veeam.com/kb4424
- Exploit Details: https://github.com/horizon3ai/CVE-2023-27532
- NVD: https://nvd.nist.gov/vuln/detail/CVE-2023-27532
