id: CVE-2018-1207

info:
  name: Dell iDRAC7/8 Devices - Remote Code Injection
  author: dwisiswant0
  severity: critical
  description: |
    Dell EMC iDRAC7/iDRAC8, versions prior to 2.52.52.52, contain a CGI injection vulnerability
    which could be used to execute remote code. A remote unauthenticated attacker may
    potentially be able to use CGI variables to execute remote code.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected device.
  remediation: |
    Apply the latest firmware updates provided by Dell to mitigate this vulnerability.
  reference:
    - https://downloads.dell.com/solutions/dell-management-solution-resources/iDRAC_CVE%201207_1211_1000116.pdf
    - https://github.com/KraudSecurity/Exploits/blob/master/CVE-2018-1207/CVE-2018-1207.py
    - https://nvd.nist.gov/vuln/detail/CVE-2018-1207
    - http://en.community.dell.com/techcenter/extras/m/white_papers/20485410
    - https://twitter.com/nicowaisman/status/977279766792466432
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-1207
    cwe-id: CWE-94
    epss-score: 0.93817
    epss-percentile: 0.99857
    cpe: cpe:2.3:a:dell:emc_idrac7:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dell
    product: emc_idrac7
  tags: cve2018,cve,dell,injection,rce,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/login?LD_DEBUG=files"

    matchers:
      - type: word
        part: response
        words:
          - "calling init: /lib/"
# digest: 4b0a00483046022100cbd0cf54ceb222b2198c1b6a7c845ec84ebe9530e9ae683aceb00083a82e62b702210094a3f320ab25124105f06fc93e589ca3c52a58978d78671f992494e1e2968b12:922c64590222798bb761d5b6d8e72950