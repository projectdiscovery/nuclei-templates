id: CVE-2018-1000671

info:
  name: Sympa version =>6.2.16 - Cross-Site Scripting
  author: 0x_Akoko
  severity: medium
  description: Sympa version 6.2.16 and later contains a URL Redirection to Untrusted Site vulnerability in the referer parameter of the wwsympa fcgi login action that can result in open redirection and reflected cross-site scripting via data URIs.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of Sympa (>=6.2.17) or apply the necessary security patches provided by the vendor.
  reference:
    - https://github.com/sympa-community/sympa/issues/268
    - https://vuldb.com/?id.123670
    - https://nvd.nist.gov/vuln/detail/CVE-2018-1000671
    - https://lists.debian.org/debian-lts-announce/2018/09/msg00023.html
    - https://lists.debian.org/debian-lts-announce/2020/11/msg00015.html
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2018-1000671
    cwe-id: CWE-601
    epss-score: 0.00769
    epss-percentile: 0.72689
    cpe: cpe:2.3:a:sympa:sympa:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: sympa
    product: sympa
    shodan-query: http.html:"sympa"
    fofa-query: body="sympa"
  tags: cve,cve2018,redirect,sympa,debian

http:
  - method: GET
    path:
      - '{{BaseURL}}/sympa?referer=http://interact.sh&passwd=&previous_action=&action=login&action_login=&previous_list=&list=&email='

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$' # https://regex101.com/r/L403F0/1
# digest: 4a0a0047304502207ba04785bfa99d7a401789203ccd999bd9e665a2274ff1cdf0f672d5bd59fcb2022100f1cea37c4344f1de1ca669101217e1388cba1e6653c38765deb3c79e6349eea3:922c64590222798bb761d5b6d8e72950