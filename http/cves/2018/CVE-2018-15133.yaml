id: CVE-2018-15133

info:
  name: Laravel Framework - RCE via X-SRF-TOKEN
  author: Psiquis-X
  severity: critical
  description: |
    Laravel Framework through 5.5.40 and 5.6.x through 5.6.29 are vulnerable to remote code execution
    due to an unserialize call on a potentially untrusted X-XSRF-TOKEN value in the decrypt method.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2018-15133
    - https://github.com/kozmic/laravel-poc-CVE-2018-15133
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-15133
  tags: cve,cve2018,laravel,rce,unserialize

http:
  - method: POST
    path:
      - "{{BaseURL}}"

    headers:
      X-XSRF-TOKEN: "eyJpdiI6InYxa2pXSkpXSkpXSkpXSkpXSkpXSkpSIn0=" # Mock encrypted payload

    matchers-condition: or
    matchers:
      # Detection for vulnerable installations often involves 500 errors or specific debug info if enabled
      - type: word
        words:
          - "Illuminate\\Encryption\\DecryptException"
          - "The payload is invalid."
        part: body

      - type: status
        status:
          - 500
