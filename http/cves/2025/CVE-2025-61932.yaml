id: CVE-2025-61932

info:
  name: LANSCOPE Endpoint Manager - Improper Verification RCE
  author: intelligent-ears
  severity: critical
  description: |
    Lanscope Endpoint Manager (On-Premises) Client program (MR) and Detection agent (DA)
    improperly verifies the origin of incoming requests (CWE-940), allowing an attacker
    to execute arbitrary code by sending specially crafted packets.
    MOTEX Inc. confirmed cases where customers received malicious packets exploiting this vulnerability.
    BRONZE BUTLER (Tick) APT group actively exploited this zero-day in mid-2025.

    Affected versions: Ver.9.4.7.1 and earlier
    Fixed versions: 9.3.2.7, 9.3.3.9, 9.4.0.5, 9.4.1.5, 9.4.2.6, 9.4.3.8, 9.4.4.6, 9.4.5.4, 9.4.6.3, 9.4.7.3
  reference:
    - https://jvn.jp/en/jp/JVN86318557/
    - https://www.motex.co.jp/news/notice/2025/release251020/
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
    - https://www.jpcert.or.jp/newsflash/2025102001.html
    - https://nvd.nist.gov/vuln/detail/CVE-2025-61932
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-61932
    cwe-id: CWE-940
    epss-score: 0.96
    cpe: cpe:2.3:a:motex:lanscope_endpoint_manager:*:*:*:*:on-premise:*:*:*
  metadata:
    verified: true
    max-request: 10
    vendor: motex
    product: lanscope_endpoint_manager
    shodan-query: 'http.title:"LANSCOPE"'
    fofa-query: 'title="LANSCOPE" && body="デバイス検査" && country="JP"'
  tags: cve,cve2025,lanscope,rce,motex,bronze-butler,apt,tick,critical,kev,cwe-940

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /mrai/login HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/version HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /version.txt HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/server/info HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /client/mr/status HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /client/da/status HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /assets/index-DjnHEglY.js HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /assets/index-DDiG7ZMQ.js HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true
    matchers-condition: and
    matchers:
      - type: dsl
        name: product-identification
        dsl:
          - 'contains(body_1, "LANSCOPE") || contains(body_2, "LANSCOPE")'
          - 'contains(body_1, "デバイス検査") || contains(body_2, "デバイス検査") || contains(body_1, "Endpoint Manager") || contains(body_2, "Endpoint Manager")'
          - 'len(body_1) > 500 || len(body_2) > 500'
          - 'contains(tolower(content_type_1), "text/html") || contains(tolower(content_type_2), "text/html")'
        condition: and

      - type: dsl
        name: vulnerability-indicators
        dsl:
          - 'contains(body_8, "クライアントプログラム") || contains(body_9, "クライアントプログラム") || contains(body_8, "検知エージェント") || contains(body_9, "検知エージェント") || contains(body_8, "Client") || contains(body_9, "Client") || contains(body_1, "mrai") || contains(body_2, "mrai")'

      - type: dsl
        name: response-validation
        dsl:
          - 'status_code_1 == 200 || status_code_2 == 200'

    extractors:
      - type: regex
        name: asset-hashes
        regex:
          - 'index-([A-Za-z0-9_-]{8,})\.js'
          - 'assets/([A-Za-z0-9_-]+)\.(js|css)'
          - '/([A-Za-z0-9_-]+)\.chunk\.js'

      - type: kval
        name: server-headers
        kval:
          - Server
          - X-Powered-By
          - X-Frame-Options
          - X-Content-Type-Options

      - type: regex
        name: api-endpoints
        regex:
          - '/api/[a-zA-Z0-9/_-]+'
          - '/mrai/[a-zA-Z0-9/_-]+'
          - '/client/[a-zA-Z0-9/_-]+'
