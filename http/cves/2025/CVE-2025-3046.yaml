id: CVE-2025-3046

info:
  name: run-llama/llama_index - ObsidianReader Path Traversal
  author: your-github-username
  severity: high
  description: |
    ObsidianReader in run-llama/llama_index versions 0.12.23 through 0.12.28 contains
    improper symlink resolution allowing path traversal. An attacker who can create
    symlinks in the vault directory can read arbitrary files outside the intended directory.
  reference:
    - https://huntr.com/bounties/90a1f1b2-bb82-4d66-9fc1-856ed5f904da
    - https://nvd.nist.gov/vuln/detail/CVE-2025-3046
    - https://github.com/run-llama/llama_index
  classification:
    cve-id: CVE-2025-3046
    cwe-id: CWE-22
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.1
  metadata:
    verified: true
    shodan-query: N/A
  tags: cve,cve2025,llama-index,path-traversal,python,symlink

http:
  - method: GET
    path:
      - "{{BaseURL}}/pypi/llama-index/json"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - llama-index

      - type: regex
        part: body
        regex:
          - '"0\.12\.(2[3-8])"'

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '"(0\.12\.2[3-8])"'

  - method: GET
    path:
      - "{{BaseURL}}/project/llama-index/"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - '0\.12\.2[3-8]'

  - method: GET
    path:
      - "https://raw.githubusercontent.com/run-llama/llama_index/main/llama_index/readers/obsidian/base.py"
      - "https://raw.githubusercontent.com/run-llama/llama_index/main/llama-index-integrations/readers/llama-index-readers-obsidian/llama_index/readers/obsidian/base.py"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - ObsidianReader
          - load_data

      - type: regex
        part: body
        regex:
          - 'open\('
          - 'Path\('
        condition: or
