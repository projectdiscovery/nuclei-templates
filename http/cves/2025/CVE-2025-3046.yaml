id: CVE-2025-3046

info:
  name: run-llama/llama_index - ObsidianReader Path Traversal
  author: AJ0070
  severity: high
  description: |
    ObsidianReader in run-llama/llama_index versions 0.12.23 through 0.12.28 contains
    improper symlink resolution allowing path traversal. An attacker who can create
    symlinks in the vault directory can read arbitrary files outside the intended directory.
  reference:
    - https://huntr.com/bounties/90a1f1b2-bb82-4d66-9fc1-856ed5f904da
    - https://nvd.nist.gov/vuln/detail/CVE-2025-3046
    - https://github.com/run-llama/llama_index
  classification:
    cve-id: CVE-2025-3046
    cwe-id: CWE-22
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.1
  metadata:
    verified: true
    shodan-query: N/A
  tags: cve,cve2025,llama-index,path-traversal,python,symlink

requests:
  - method: GET
    path:
      - "{{BaseURL}}/pypi/llama-index/json"
    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "application/json"

      - type: word
        part: body
        words:
          - '"name":'
          - '"llama-index"'
        condition: and

      - type: regex
        part: body
        regex:
          - '"(0\.12\.(2[3-8]))":\s*\['

    extractors:
      - type: regex
        part: body
        regex:
          - '"(0\.12\.2[3-8])"'
        group: 1
        name: version
        