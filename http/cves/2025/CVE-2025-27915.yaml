id: zimbra-cve-2025-27915

info:
  name: Zimbra CVE-2025-27915 - Stored XSS via ICS Files Detection
  author: Snbig,EhsanCreator,eliotworkspac-max

  severity: medium
  description: |
    Detects Zimbra Collaboration Suite versions vulnerable to CVE-2025-27915, a stored XSS vulnerability 
    in the Classic Web Client due to insufficient sanitization of HTML content in ICS files. When a user 
    views an email with a malicious ICS entry, embedded JavaScript executes via an ontoggle event inside 
    a details tag, allowing attackers to perform unauthorized actions like email redirection and data exfiltration.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-27915
    - https://wiki.zimbra.com/wiki/Security_Center
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2025-27915
    cwe-id: CWE-79
    epss-score: 27.61
    epss-percentile: 96.17
  metadata:
    max-request: 1
    verified: true
    vendor: zimbra
    product: collaboration
    fofa-query: title="Zimbra Collaboration Suite"
    shodan-query: http.title:"Zimbra Collaboration Suite"
  tags: cve,cve2025,zimbra,xss,ics,stored-xss,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Zimbra Collaboration Suite"

      - type: word
        part: header
        words:
          - "application/x-javascript"

      - type: regex
        part: body
        name: vulnerable-version
        regex:
          # Vulnerable 9.0.0 versions (all patches from initial to p43)
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"9\.0\.0'
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"9\.0\.0'
          # Vulnerable 10.0.x versions (10.0.0 to < 10.0.13) 
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"10\.0\.[0-9]'
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"10\.0\.1[0-2]'
          # Vulnerable 10.1.x versions (10.1.0 to < 10.1.5)
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"10\.1\.[0-4]'
        condition: or

    extractors:
      - type: regex
        part: body
        name: version
        group: 1
        regex:
          - 'CLIENT_VERSION",\s*\{type:ZmSetting\.T_CONFIG,\s*defaultValue:"([^"]+)"'