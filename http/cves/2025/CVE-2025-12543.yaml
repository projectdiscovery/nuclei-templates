id: CVE-2025-12543

info:
  name: Undertow Host Header Validation Bypass
  author: ahmetartuc
  severity: critical
  description: |
    Undertow-core prior to 2.3.8.Final does not properly validate HTTP Host headers, accepting malformed or ambiguous host values. Attackers can exploit this flaw to bypass host-based access controls, trigger cache poisoning, facilitate SSRF conditions, or circumvent security policies in upstream deployments.
  impact: Bypass of host header validation, leading to SSRF and cache poisoning.
  reference:
    - https://access.redhat.com/security/cve/CVE-2025-12543
    - https://bugzilla.redhat.com/show_bug.cgi?id=2261577
    - https://github.com/undertow-io/undertow/pull/1536
    - https://nvd.nist.gov/vuln/detail/CVE-2025-12543
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.6
    cve-id: CVE-2025-12543
    cwe-id: CWE-20
  metadata:
    verified: true
    max-requests: 3
    shodan-query: html:"Undertow"
  tags: cve,cve2025,undertow,wildfly,jboss,cache-poisoning,bypass

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{hostpayload}}
        User-Agent: test
        Connection: close

    payloads:
      hostpayload:
        - "valid.local:2$"
        - "valid.local%20"
        - "valid.local "
        - "valid.local\t"
        - "valid.local:80%20"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302

      - type: word
        part: header
        words:
          - "Undertow"
          - "WildFly"
          - "JBoss"
        condition: or

  - raw:
      - |
        GET / HTTP/1.1
        Host:
        User-Agent: test
        Connection: close

      - |
        GET / HTTP/1.1
        Host: a.com
        Host: b.com
        User-Agent: test
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302

      - type: word
        part: header
        words:
          - "Undertow"
          - "WildFly"
          - "JBoss"
        condition: or
