id: CVE-2025-12543

info:
  name: Undertow Host Header Validation Bypass (Malformed Host Accepted)
  author: ahmetartuc
  severity: critical
  description: |
    Undertow-core fails to properly validate the Host header and may accept malformed or
    ambiguous Host headers that should be rejected, enabling cache poisoning, SSRF-like
    behavior, or upstream policy bypass.
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2025-12543
    - https://access.redhat.com/security/cve/CVE-2025-12543
  classification:
    cwe-id:
      - CWE-20
    cvss-score: 9.6
  tags: cve,cve2025,undertow,wildfly,jboss,host-header,http

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    headers:
      Host: "{{hostpayload}}"
      User-Agent: nuclei
      Connection: close

    payloads:
      hostpayload:
        - "valid.local:2$"
        - "valid.local%20"
        - "valid.local "
        - "valid.local\t"
        - "valid.local:80%20"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302
          - 401
          - 403

      - type: word
        part: header
        words:
          - "Undertow"
          - "WildFly"
          - "JBoss"
        condition: or

  - raw:
      - |
        GET / HTTP/1.1
        Host:
        User-Agent: nuclei
        Connection: close

      - |
        GET / HTTP/1.1
        Host: a.com
        Host: b.com
        User-Agent: nuclei
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 301
          - 302
          - 401
          - 403

      - type: word
        part: header
        words:
          - "Undertow"
          - "WildFly"
          - "JBoss"
        condition: or
