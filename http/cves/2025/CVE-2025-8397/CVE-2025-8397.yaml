id: cve-2025-8397-save-as-pdf-button-xss
info:
  name: WordPress Save as PDF Button - Stored XSS via restpackpdfbutton shortcode (CVE-2025-8397)
  author: nikhil-assisted
  severity: medium
  description: |
    Detects the Save as PDF Button WordPress plugin (common files and shortcode registration) and extracts version from readme or plugin header. Useful for manual verification of stored XSS via restpackpdfbutton shortcode.
  reference:
    - https://www.tenable.com/cve/CVE-2025-8397
  tags: wordpress,cve,plugin,xss
requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/save-as-pdf/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/save-as-pdf/save-as-pdf.php"
      - "{{BaseURL}}/wp-content/plugins/save-as-pdf.php"
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "Save as PDF Button"
          - "restpackpdfbutton"
          - "Restpack Inc"
      - type: regex
        part: body
        regex:
          - "Version:\\s*([0-9]+\\.[0-9]+\\.[0-9]+)"
          - "add_shortcode\\(\\s*'restpackpdfbutton'\\s*,"
          - "add_shortcode\\(\\s*\"restpackpdfbutton\"\\s*,"
    extractors:
      - type: regex
        part: body
        regex:
          - "Version:\\s*([0-9]+\\.[0-9]+\\.[0-9]+)"
