id: CVE-2025-22457

info:
  name: Ivanti Connect Secure - Unauthenticated RCE (CVE-2025-22457)
  author: shahil
  severity: critical
  description: |
    Ivanti Connect Secure, Ivanti Policy Secure, and ZTA gateways are vulnerable 
    to a stack-based buffer overflow (CVE-2025-22457). Versions **22.7R2.5 and earlier**
    are affected. This template checks the product version from the web interface 
    to determine if the instance is likely vulnerable.
  reference:
    - https://forums.ivanti.com/s/article/April-Security-Advisory-Ivanti-Connect-Secure-Policy-Secure-ZTA-Gateways-CVE-2025-22457
    - https://attackerkb.com/topics/0ybGQIkHzR/cve-2025-22457/rapid7-analysis
    - https://github.com/sfewer-r7/CVE-2025-22457
  classification:
    cve-id: CVE-2025-22457
    cwe-id: CWE-121
  metadata:
    vendor: ivanti
    product: connect-secure
    shodan-query: http.title:"Ivanti Connect Secure"
  tags: cve,ivanti,rce,overflow

http:
  - method: GET
    path:
      - "{{BaseURL}}/dana-na/auth/url_admin/welcome.cgi?type=inter"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - 'name="productversion"\s+value="([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)"'

    extractors:
      - type: regex
        name: product_version
        part: body
        group: 1
        regex:
          - 'name="productversion"\s+value="([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)"'
