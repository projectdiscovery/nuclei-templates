id: CVE-2025-55182
info:
  name: Next.js RSC Malformed Multipart Deserialization Error Detector
  author: jaiswalakshansh
  severity: high
  description: |
    Detects potential Next.js RSC unsafe deserialization / malformed multipart request
    behavior. The template sends a crafted multipart/form-data payload using Next.js
    server action headers that frequently trigger 500 responses and RSC component
    error output (content-type: text/x-component).
  metadata:
    tags: nextjs,rsc,deserialization,rce,react,cloudfront,attack-surface
    cve: CVE-2025-55182
  reference:
    - https://slcyber.io/research-center/high-fidelity-detection-mechanism-for-rsc-next-js-rce-cve-2025-55182-cve-2025-66478/

requests:
  - method: POST
    path:
      - "{{BaseURL}}/"

    headers:
      Next-Action: "x"
      X-Nextjs-Request-Id: "b5dce965"
      Next-Router-State-Tree: "%5B%22%22%2C%7B%22children%22%3A%5B%22__PAGE__%22%2C%7B%7D%2Cnull%2Cnull%5D%7D%2Cnull%2Cnull%2Ctrue%5D"
      X-Nextjs-Html-Request-Id: "SSTMXm7OJ_g0Ncx6jpQt9"
      Content-Type: "multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad"

    body: |
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="1"

      {}
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad
      Content-Disposition: form-data; name="0"

      nuclei-test
      ------WebKitFormBoundaryx8jO2oVc6SWP3Sad--

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: regex
        part: header
        regex:
          - "(?i)text/x-component"
      - type: word
        part: body
        words:
          - '0:["$@1"'
        condition: or
