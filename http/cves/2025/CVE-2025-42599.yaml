id: CVE-2025-42599

info:
  name: Active! mail - Product Fingerprint (Pre-Auth, Staging for CVE-2025-42599)
  author: Excellencedev
  severity: critical
  description: |
    This template safely fingerprints Active! mail by requesting the public login endpoint and matching
    on product-specific assets and form structure. It does NOT validate or exploit CVE-2025-42599.
    Use only for discovery while awaiting public disclosure of the exact exploit request (endpoint,
    method, headers, payload) required to confirm the vulnerability.

  remediation: |
    Upgrade Active! mail to BuildInfo 6.60.06008562 or later, as advised by the vendor, to remediate
    CVE-2025-42599. If immediate upgrade is not possible, restrict exposure to the login interface and
    apply compensating controls (WAF, IP allowlisting) until patched.

    Verified endpoints and parameters collected from public instances include:
    - GET /am_bin/amlogin (login page)
    - POST /am_bin/amlogin/login_auth (auth action)
    - Typical fields: am_authid, am_authpasswd, language, save_authinfo
    - Hidden fields: login_page_lang, charset, http_user_agent

    Notes:
    - This is a product fingerprint only and should not be used to claim vulnerability existence.
    - Once the exact PoC request is available, a separate exploit-based validation will replace this.
  reference:
    - https://jvn.jp/en/jp/JVN22348866/
    - https://www.qualitia.com/jp/news/2025/04/18_1030.html
    - https://nvd.nist.gov/vuln/detail/CVE-2025-42599
  classification:
    cwe-id: CWE-121
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    product: "Active! mail"
    vendor: qualitia
    shodan-query: 'http.title:"Active! mail"'
    fofa-query: 'title="Active! mail"'
    max-request: 1
    verified: false
  tags: cve,cve2025,active-mail,fingerprint,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/am_bin/amlogin"

    redirects: true
    stop-at-first-match: true

    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-US,en;q=0.9

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "<title>\\s*Active! mail.*</title>"
      - type: word
        part: content_type
        words:
          - "text/html"
      - type: regex
        part: body
        regex:
          - "am_viz/common/js/activemail\\.js"
      - type: regex
        part: body
        regex:
          - 'action="(?:https?://[^\"]+)?/am_bin/amlogin/login_auth"'
      - type: word
        part: body
        words:
          - 'name="am_authid"'
          - 'name="am_authpasswd"'
        condition: and
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        name: am_buildid
        group: 1
        regex:
          - 'BUILDID:\\"([0-9\\.]+)\\"'
