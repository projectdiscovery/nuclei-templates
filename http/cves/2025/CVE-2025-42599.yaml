id: CVE-2025-42599

info:
  name: Active! mail - Product Fingerprint (Pre-Auth) (CVE-2025-42599)
  author: Excellencedev
  severity: critical
  description: |
    Detects Active! mail installations via the public login interface (/am_bin/amlogin) using product-specific
    indicators such as page title, asset path, form action, and required fields.
  remediation: |
    Upgrade Active! mail to BuildInfo 6.60.06008562 or later per the vendor advisory for CVE-2025-42599.
    If immediate upgrade is not possible, restrict exposure to the login interface and apply compensating
    controls (WAF, IP allowlisting) until patched.
  reference:
    - https://jvn.jp/en/jp/JVN22348866/
    - https://www.qualitia.com/jp/news/2025/04/18_1030.html
    - https://nvd.nist.gov/vuln/detail/CVE-2025-42599
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2025-42599
    - https://www.jpcert.or.jp/at/2025/at250010.html
    - https://www.cve.org/CVERecord?id=CVE-2025-42599
    - https://github.com/cisagov/vulnrichment/blob/develop/2025/42xxx/CVE-2025-42599.json
  classification:
    cve-id: CVE-2025-42599
    cwe-id: CWE-121
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    product: "Active! mail"
    vendor: qualitia
    shodan-query: 'http.title:"Active! mail"'
    fofa-query: 'title="Active! mail"'
    max-request: 1
    verified: false
    template-type: discovery
  tags: cve,cve2025,active-mail,fingerprint,discovery,rce,buffer-overflow,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/am_bin/amlogin"

    redirects: true
    stop-at-first-match: true

    headers:
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-US,en;q=0.9

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "<title>\\s*Active! mail.*</title>"
      - type: word
        part: content_type
        words:
          - "text/html"
      - type: regex
        part: body
        regex:
          - "am_viz/common/js/activemail\\.js"
      - type: regex
        part: body
        regex:
          - 'action="(?:https?://[^\"]+)?/am_bin/amlogin/login_auth"'
      - type: word
        part: body
        words:
          - 'name="am_authid"'
          - 'name="am_authpasswd"'
        condition: and
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        name: am_buildid
        group: 1
        regex:
          - 'BUILDID:\\"([0-9\\.]+)\\"'
