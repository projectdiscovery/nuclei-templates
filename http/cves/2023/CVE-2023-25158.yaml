id: CVE-2023-25158

info:
  name: GeoServer OGC Filter - SQL Injection
  author: princechaddha
  severity: critical
  description: |
    GeoServer versions before 2.21.4, 2.22.2, 2.20.7, 2.19.7, and 2.18.7 contain a SQL injection vulnerability in OGC Filter expressions within JDBCDataStore implementations. The vulnerability allows unauthenticated attackers to execute arbitrary SQL commands through unsanitized CQL_FILTER parameters in WFS/WMS service requests, affecting PropertyIsLike, strStartsWith, strEndsWith filters.
  remediation: Update to GeoServer 2.21.4, 2.22.2, 2.20.7, 2.19.7, 2.18.7 or later versions.
  reference:
    - https://github.com/geoserver/geoserver/security/advisories/GHSA-7g5f-wrx8-5ccf
    - https://github.com/geotools/geotools/security/advisories/GHSA-99c3-qc2q-p94m
    - https://nvd.nist.gov/vuln/detail/CVE-2023-25158
    - https://geoserver.org/vulnerability/2023/02/20/ogc-filter-injection.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-25158
    cwe-id: CWE-89
    epss-score: 0.78432
    epss-percentile: 0.97934
    cpe: cpe:2.3:a:geoserver:geoserver:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: geoserver
    product: geoserver
    shodan-query: title:"GeoServer"
  tags: cve,cve2023,geoserver,sqli,injection,kev

http:
  - raw:
      - |
        GET /geoserver/wfs?service=WFS&version=1.0.0&request=GetFeature&typeName=topp:states&CQL_FILTER=strStartsWith(STATE_NAME,'A')%3Dtrue HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "wfs:FeatureCollection"
        part: body

      - type: word
        words:
          - "topp:states"
        part: body

      - type: status
        status:
          - 200