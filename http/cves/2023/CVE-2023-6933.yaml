id: CVE-2023-6933

info:
  name: Better Search Replace < 1.4.5 - PHP Object Injection RCE
  author: Trex
  severity: critical
  description: |
    The Better Search Replace WordPress plugin before 1.4.5 contains a PHP Object Injection vulnerability due to unsafe deserialization of user input. This allows unauthenticated attackers to inject arbitrary PHP objects into the application, potentially leading to Remote Code Execution through gadget chain exploitation.
  impact: |
    Allows attackers to execute arbitrary code on the server through PHP object injection and gadget chain exploitation.
  remediation: |
    Update Better Search Replace WordPress Plugin to version 1.4.5 or later to mitigate the vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6933
    - https://github.com/w2xim3/CVE-2023-6933
    - https://plugins.trac.wordpress.org/browser/better-search-replace/trunk/includes/class-bsr-db.php#L334
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2023-6933
    cwe-id: CWE-502
    epss-score: 0.00043
    epss-percentile: 0.09271
    cpe: cpe:2.3:a:deliciousbrains:better_search_replace:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: deliciousbrains
    product: better_search_replace
    framework: wordpress
  tags: cve,cve2023,wp,wp-plugin,wordpress,better-search-replace,rce,php-object-injection

flow: http(1)

http:
  - raw:
      - |
        GET /wp-content/plugins/better-search-replace/readme.txt HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Better Search Replace"

      - type: word
        part: body
        words:
          - "1.4.4"
          - "1.4.3"
          - "1.4.2"
          - "1.4.1"
          - "1.4.0"
        condition: or

      - type: status
        status:
          - 200