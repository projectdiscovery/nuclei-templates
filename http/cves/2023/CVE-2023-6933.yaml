id: CVE-2023-6933

info:
  name: Better Search Replace <= 1.4.4 - PHP Object Injection (CVE-2023-6933)
  author: Trex
  severity: critical
  description: |
    Better Search Replace plugin versions 1.4.4 and below for WordPress are vulnerable to PHP Object Injection.
    This vulnerability allows unauthenticated attackers to inject arbitrary PHP objects,
    leading to potential remote code execution, data deletion, and arbitrary file reads.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6933
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6933
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/better-search-replace/better-search-replace-144-php-object-injection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-6933
    cwe-id: CWE-502
  metadata:
    verified: true
    max-request: 2
  tags: cve,cve2023,wordpress,plugin,object-injection,rce,critical

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/better-search-replace/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/better-search-replace/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Better Search Replace"
          - "wpengine"
        condition: and

      - type: word
        part: body
        words:
          - "Stable tag: trunk"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: plugin_version
        part: body
        group: 1
        regex:
          - "(?i)Better Search Replace.*?Contributors.*?(wpengine)"
          - "(?i)Version:\\s*([0-9.]+)"