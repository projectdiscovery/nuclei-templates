id: CVE-2023-43261

info:
  name: Milesight Routers - Information Disclosure
  author: gy741
  severity: high
  description: |
    A critical security vulnerability has been identified in Milesight Industrial Cellular Routers, compromising the security of sensitive credentials and permitting unauthorized access. This vulnerability stems from a misconfiguration that results in directory listing being enabled on the router systems, rendering log files publicly accessible. These log files, while containing sensitive information such as admin and other user passwords (encrypted as a security measure), can be exploited by attackers via the router's web interface. The presence of a hardcoded AES secret key and initialization vector (IV) in the JavaScript code further exacerbates the situation, facilitating the decryption of these passwords. This chain of vulnerabilities allows malicious actors to gain unauthorized access to the router.
  reference:
    - https://medium.com/@win3zz/inside-the-router-how-i-accessed-industrial-routers-and-reported-the-flaws-29c34213dfdf
    - https://github.com/win3zz/CVE-2023-43261
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
  metadata:
    max-request: 1
    shodan-query: http.html:rt_title
    verified: true
  tags: cve,cve2023,router,milesight,disclosure,unauth,iot

http:
  - method: GET
    path:
      - "{{BaseURL}}/lang/log/httpd.log"

    max-size: 5000
    extractors:
      - type: regex
        regex:
          - '"username":"([^"]+)","password":"(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)"'
