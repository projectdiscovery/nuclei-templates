id: cve-2023-32784-password-leak
info:
  name: KeePass 2.x Master Password Memory Leak
  author: nikhilpatidar01
  severity: critical
  description: |
    KeePass version 2.53.1 and prior are susceptible to a memory leak vulnerability. When a user types a password into the master password field, the program may leave behind fragments or even the full password in the system's memory. An attacker with local access to the machine and the ability to dump the memory of the running KeePass process could potentially recover the master password in cleartext. This template checks for a running KeePass process as a prerequisite for potential vulnerability, which requires the '-unsafe' flag to be used with Nuclei.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-32784
    - https://keepass.info/news/n230624_2.54.html
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.8
    cve-id: CVE-2023-32784
    cwe-id: CWE-522 # Insufficiently Protected Credentials
  tags: cve,cve2023,keepass,memory-leak,local

http:
  - method: GET
    path:
      - "{{BaseURL}}"
    host-redirects: true
    max-redirects: 2

    matchers:
      - type: dsl
        dsl:
          - "len(system('pgrep -f KeePass')) > 0"
