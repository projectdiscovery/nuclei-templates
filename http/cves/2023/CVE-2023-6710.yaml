id: CVE-2023-6710
info:
  name: Apache mod_cluster Cluster Manager Exposed
  author: oleveloper
  severity: medium
  description: >
    Detects exposed mod_cluster cluster-manager UI. Non-destructive.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6710
  tags: apache,mod_cluster,exposure,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/cluster-manager"
      - "{{BaseURL}}/mod_cluster_manager"
      - "{{BaseURL}}/mcm"
    redirects: true
    max-redirects: 2
    max-size: 2097152
    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200 && !contains(all_headers, 'WWW-Authenticate')"
      - type: word
        part: body
        condition: or
        words:
          - "Mod_cluster Status"
          - "Cluster Manager"

    extractors:
      - type: regex
        part: body
        name: title
        regex:
          - "<title>([^<]+)</title>"
      - type: regex
        part: header
        name: server
        regex:
          - "(?i)^server:\\s*(.+)$"
      - type: regex
        part: body
        name: module-hints
        regex:
          - "(?i)mod_?(proxy_)?cluster"