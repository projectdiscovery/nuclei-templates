id: CVE-2026-25049

info:
  name: n8n - Expression Injection Leading to RCE
  author: s4e-io
  severity: critical
  description: |
    n8n versions < 1.123.17 and >= 2.0.0 < 2.5.2 are vulnerable to expression injection. An authenticated user with permission to create or modify workflows could abuse crafted expressions in workflow parameters to trigger unintended system command execution on the host running n8n.
  impact: |
    Successful exploitation allows an authenticated attacker to execute arbitrary commands on the host system, potentially leading to complete system compromise.
  remediation: |
    Update to version 1.123.17, 2.5.2 or later.
  reference:
    - https://github.com/advisories/GHSA-6cqr-8cfr-67f8
    - https://nvd.nist.gov/vuln/detail/CVE-2026-25049
    - https://thehackernews.com/2026/02/critical-n8n-flaw-cve-2026-25049.html
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H
    cvss-score: 9.4
    cve-id: CVE-2026-25049
    epss-score: 0.00027
    epss-percentile: 0.07200
    cwe-id: CWE-913
    cpe: cpe:2.3:a:n8n:n8n:*:*:*:*:*:node.js:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: n8n
    product: n8n
    shodan-query: http.favicon.hash:-831756631
    fofa-query: icon_hash="-831756631"
  tags: cve,cve2026,n8n,workflow,rce,authenticated,passive

http:
  - method: GET
    path:
      - "{{BaseURL}}/signin"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<title>n8n.io"
        case-insensitive: true

      - type: dsl
        name: vulnerable
        dsl:
          - 'compare_versions(version, "< 1.123.17") || (compare_versions(version, ">= 2.0.0") && compare_versions(version, "< 2.5.2"))'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: base64_content
        group: 1
        regex:
          - '<meta name="n8n:config:sentry" content="([A-Za-z0-9+/=]+)"'
        internal: true

      - type: dsl
        name: version
        dsl:
          - 'replace_regex(base64_decode(base64_content), ".*n8n@([0-9]+\\.[0-9]+\\.[0-9]+).*", "$1")'
        internal: true

      - type: dsl
        dsl:
          - '"n8n Version: " + version'