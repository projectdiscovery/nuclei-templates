id: CVE-2024-28000

info:
  name: WordPress LiteSpeed Cache - Privilege Escalation (Detection)
  author: padsalatushal
  severity: critical
  description: |
    LiteSpeed Cache for WordPress prior to the patched versions is vulnerable to a
    privilege escalation via the unauthenticated `admin-ajax.php` action `litespeed_crawler`,
    where an attacker may set an arbitrary role via the `litespeed_role` parameter when a
    weak/known `litespeed_hash` is accepted. This template performs a version-based check by
    parsing the plugin `readme.txt` and comparing the `Stable tag` against the fixed version,
    without sending any privileged or state-changing requests.
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2024-28000
    - https://patchstack.com/articles/critical-privilege-escalation-in-litespeed-cache-plugin-affecting-5-million-sites?_s_id=cve
    - https://github.com/projectdiscovery/nuclei-templates/issues/13222
    - https://github.com/JohnDoeAnonITA/CVE-2024-28000/blob/main/exp.go
    - https://github.com/SSSSuperX/CVE-2024-28000/blob/main/CVE-2024-28000_Scan.py
    - https://github.com/arch1m3d/CVE-2024-28000/blob/main/exploit.py
    - https://github.com/ebrasha/CVE-2024-28000
    - https://github.com/Alucard0x1/CVE-2024-28000/blob/main/litespeed_cache_poc.py
    - https://www.exploit-db.com/exploits/52328
    - https://blog.securelayer7.net/cve-2024-28000-litespeed-cache-plugin/
  metadata:
    cve: CVE-2024-28000
    vendor: litespeed
    product: litespeed-cache
    framework: wordpress
  tags: CVE-2024-28000,wordpress,litespeed,plugin,privilege-escalation

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/litespeed-cache/readme.txt"
    headers:
      Accept: "text/plain, */*"
      User-Agent: "Nuclei"
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "LiteSpeed Cache"
          - "Stable tag:"
        condition: and
      - type: regex
        part: body
        regex:
          - "Stable tag:\\s*([0-9.]+)"
      - type: dsl
        dsl:
          - compare_versions(version, "< 6.4.1")
    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        internal: true
        regex:
          - "Stable tag:\\s*([0-9.]+)"


