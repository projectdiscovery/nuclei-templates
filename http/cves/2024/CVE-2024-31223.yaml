id: CVE-2024-31223

info:
  name: Fides Privacy Center ≤ 2.39.1 – Server-Side URL Disclosure
  author: hnd3884
  severity: medium
  description: |
    Fides Privacy Center (part of the Fides open-source privacy engineering platform) is vulnerable to information disclosure in versions from 2.19.0 through 2.39.1. An unauthenticated attacker can trigger a crafted request which exposes the value of the server-side configuration variable `SERVER_SIDE_FIDES_API_URL`. This leaks internal service URLs, IPs, and ports, weakening network isolation and aiding further attacks.
  impact: |
    Exposure of internal server URLs may reveal private IP ranges, internal domain names, or sensitive API endpoints, enabling attackers to map internal infrastructure and pivot further into the environment.
  remediation: |
    Update to Fides version 2.39.2 or later, where the issue has been patched.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-31223
    - https://github.com/ethyca/fides/security/advisories/GHSA-cc6p-4vc8-6v5q
    - https://github.com/ethyca/fides/releases/tag/2.39.2rc0
  classification:
    cve-id: CVE-2024-31223
    cwe-id: CWE-200
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    epss-score: 0.00334
    epss-percentile: 0.67532
    cpe: cpe:2.3:a:ethyca:fides:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    vendor: ethyca
    product: fides
    max-request: 1
  tags: cve,cve2024,fides,information-disclosure,unauthenticated

http:
  - method: get
    path:
      - "{{BaseURL}}"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "SERVER_SIDE_FIDES_API_URL"
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: server_side_fides_api_url
        group: 1
        regex:
          - '"SERVER_SIDE_FIDES_API_URL":"(.+?)"'
