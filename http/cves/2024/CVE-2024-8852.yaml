id: CVE-2024-8852

info:
  name: All-in-One WP Migration < 7.87 - Unauthenticated Information Disclosure
  author: FLX
  severity: medium
  description: |
    The All-in-One WP Migration and Backup plugin for WordPress is vulnerable to unauthenticated information disclosure
    due to its error.log file being publicly accessible in versions before 7.87.
  impact: |
    An unauthenticated attacker can access the error.log file, which may contain sensitive information
    such as full server path disclosures, backup filenames, and other debugging details.
    This information could be used in further attacks.
  remediation: |
    Update the All-in-One WP Migration and Backup plugin to version 7.87 or later.
  reference:
    - https://wpscan.com/vulnerability/9f533098-8435-4ee1-a423-5142070ceefc/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2024-8852
    - https://wordpress.org/plugins/all-in-one-wp-migration/#developers
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: cve-2024-8852
    cwe-id: CWE-532
  tags: wpscan,cve,cve2024,wp,wordpress,wp-plugin,all-in-one-wp-migration,ai1wm,disclosure,logs

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/all-in-one-wp-migration/storage/error.log"

    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, 'Number')
          - contains(body, 'Message')
          - contains(tolower(header), 'text/plain')
        condition: and