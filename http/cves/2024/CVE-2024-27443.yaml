id: CVE-2024-27443

info:
  name: Zimbra Collaboration - XSS
  author: rxerium
  severity: medium
  description: |
    An issue was discovered in Zimbra Collaboration (ZCS) 9.0 and 10.0. A Cross-Site Scripting (XSS) vulnerability exists in the CalendarInvite feature of the Zimbra webmail classic user interface, because of improper input validation in the handling of the calendar header. An attacker can exploit this via an email message containing a crafted calendar header with an embedded XSS payload.
  reference:
    - https://wiki.zimbra.com/wiki/Zimbra_Releases/10.0.7#Security_Fixes
    - https://nvd.nist.gov/vuln/detail/CVE-2024-27443
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2024-27443
    cwe-id: CWE-79
  metadata:
    max-request: 1
    vendor: zimbra
    product: collaboration
    shodan-query:
      - http.favicon.hash:"1624375939"
      - http.html:"Zimbra Collaboration Suite Web Client"
    fofa-query: icon_hash="1624375939"
  tags: cve,cve2022,zimbra,kev,passive

http:
  - method: GET
    path:
      - "{{BaseURL}}/js/zimbraMail/share/model/ZmSettings.js"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Zimbra Collaboration Suite Web Client"

      - type: word
        part: header
        words:
          - "application/x-javascript"

      - type: word
        words:
          - "10.0"
          - "9.0"
        part: version

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'CLIENT_VERSION\",                    {type:ZmSetting.T_CONFIG, defaultValue:\"(.*?)"'