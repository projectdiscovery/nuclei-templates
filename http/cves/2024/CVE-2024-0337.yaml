id: CVE-2024-0337

info:
  name: Travelpayouts <= 1.1.16 - Open Redirect
  author: s4e-io
  severity: medium
  description: |
    The plugin is vulnerable to Open Redirect due to insufficient validation on the travelpayouts_redirect variable. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  impact: |
    Unauthenticated attackers can redirect users to malicious sites for phishing attacks, credential harvesting, or malware distribution by exploiting insufficient redirect validation.
  remediation: |
    Upgrade to the latest version of the Travelpayouts plugin that addresses this open redirect vulnerability.
  reference:
    - https://wpscan.com/vulnerability/2f17a274-8676-4f4e-989f-436030527890/
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0337
  classification:
    cve-id: CVE-2024-0337
    epss-score: 0.01388
    epss-percentile: 0.80006
  metadata:
    verified: true
    max-request: 1
    publicwww-query: inurl:"/wp-content/plugins/travelpayouts"
  tags: wpscan,cve,cve2024,wp,wp-plugin,wordpress,redirect,travelpayouts,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/?travelpayouts_redirect=https://oast.me"

    redirects: true
    max-redirects: 2
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
# digest: 4b0a004830460221009d45b9f9400b99931ce1a266932d6b134c1db880dc812a62c27c8fd8c90c71af0221008aca01175a7f28fb24a516bef761958bad339984421d878d49f6f2b9c62380ef:922c64590222798bb761d5b6d8e72950