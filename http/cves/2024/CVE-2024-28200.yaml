id: CVE-2024-28200

info:
  name: N-able N-central < 2024.2 - Authentication Bypass Detection
  author: rxerium
  severity: critical
  description: |
    N-central server versions prior to 2024.2 contain an authentication bypass in the user interface, letting attackers access restricted areas without proper credentials, exploit requires no specific conditions.
  impact: |
    Attackers can access sensitive user interface features, potentially leading to unauthorized data access or control.
  remediation: |
    Update to version 2024.2 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-28200
    - https://status.n-able.com/2024/07/02/n-central-critical-security-fix-details/
    - https://me.n-able.com/s/security-advisory/aArVy0000000673KAA/cve202428200-ncentral-authentication-bypass
    - https://www.incibe.es/incibe-cert/alerta-temprana/vulnerabilidades/cve-2024-28200
  metadata:
    verified: true
    max-request: 1
    vendor: N-able
    product: N-central
    cvss-score: 9.1
    cwe-id: CWE-287
    shodan-query: http.title:"N-central Login"
  tags: cve,cve2024,n-able,ncentral,version-detect

http:
  - method: GET
    path:
      - "{{BaseURL}}/login"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'class="ncentral"'

      - type: dsl
        dsl:
          - compare_versions(version, '< 2024.2')

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - 'ncentralVersion:\s*"(202\d+\.\d+\.\d+\.\d+)"'
