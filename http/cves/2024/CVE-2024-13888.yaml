id: CVE-2024-13888

info:
  name: WPMobile.App <= 11.56 - Open Redirect
  author: s4e-io
  severity: high
  description: |
    The WPMobile.App plugin for WordPress is vulnerable to Open Redirect in all versions up to, and including, 11.56. This is due to insufficient validation on the redirect URL supplied via the 'redirect' parameter. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  impact: |
    Unauthenticated attackers can redirect users to malicious phishing sites or credential harvesting pages via the redirect parameter.
  remediation: |
    Update WPMobile.App plugin to a version newer than 11.56.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpappninja/wpmobileapp-1156-open-redirect-via-redirect-parameter
    - https://nvd.nist.gov/vuln/detail/CVE-2024-13888
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N
    cvss-score: 7.2
    cve-id: CVE-2024-13888
    cwe-id: CWE-601
    epss-score: 0.00803
    epss-percentile: 0.73597
  metadata:
    verified: true
    max-request: 2
    vendor: amauri
    product: wpappninja
    framework: wordpress
    fofa-query: body="/wp-content/plugins/wpappninja"
    publicwww-query: "/wp-content/plugins/wpappninja"
  tags: cve,cve2024,redirect,wp,wordpress,wp-plugin,wpappninja,vuln

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "wpappninja")'
        internal: true

  - raw:
      - |
        GET /?redirect=aHR0cDovL29hc3QubWU=&WPMOBILE_LOCALE=en HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)oast\.me\/?(\/|[^.].*)?$'
# digest: 4a0a0047304502204e44fe12872eeaaae46b47e514571b0008f2928671df2e1529357780d73ca9f4022100e704f7b8ce3c7449de9f420c913c333d7205c2d1ec5a05365caca8e4f5b69440:922c64590222798bb761d5b6d8e72950