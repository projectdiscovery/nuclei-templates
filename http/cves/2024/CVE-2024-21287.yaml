id: CVE-2024-21287

info:
  name: Oracle Agile Product Lifecycle Management (PLM) Incorrect Authorization Vulnerability
  author: n3integration
  tags: cve,cve2024,kev,vuln,disclosure,passive
  description: |
    A vulnerability found within version 9.3.6 of the Oracle Agile PLM Framework allows an unauthenticated
    attacker access to critical data or complete access to all Oracle Agile PLM Framework accessible data.
  reference:
    - https://www.cisa.gov/known-exploited-vulnerabilities-catalog?field_cve=CVE-2024-21287
    - https://www.cve.org/CVERecord?id=CVE-2024-21287
    - https://www.oracle.com/security-alerts/alert-cve-2024-21287.html
  severity: high
  metadata:
    max-request: "1"
    runzero-match: service["product"] contains "Oracle:Agile PLM Framework"
  classification:
    cve-id: CVE-2024-21287
    cwe-id: CWE-863
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    epss-score: 0.66702
    epss-percentile: 0.98462
    cpe: cpe:2.3:a:oracle:agile_product_lifecycle_management:9.3.6:*:*:*:*:*:*:*
  remediation: Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.
requests:
  - path:
      - "{{BaseURL}}/Agile/"
    method: GET
    stop-at-first-match: true

    matchers:
      - type: dsl
        name: is_vulnerable_version
        dsl:
          - 'contains_all(body, "Oracle | Agile", "Build Number")'
          - 'status_code == 200'
          - 'compare_versions(version, "9.3.6")'
        condition: and

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - 'Build Number:\s*(\d+\.\d+\.\d+)'
        internal: true

