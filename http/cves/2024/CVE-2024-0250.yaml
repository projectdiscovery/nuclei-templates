id: CVE-2024-0250

info:
  name: Analytics Insights for Google Analytics 4 < 6.3 - Open Redirect
  author: s4e-io
  severity: medium
  description: |
    The plugin is vulnerable to Open Redirect due to insufficient validation on the redirect oauth2callback.php file. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  impact: |
    Unauthenticated attackers can redirect users to malicious sites for phishing attacks, credential harvesting, or malware distribution by exploiting insufficient redirect validation.
  remediation: |
    Upgrade to Analytics Insights for Google Analytics 4 version 6.3 or later.
  reference:
    - https://wpscan.com/vulnerability/321b07d1-692f-48e9-a8e5-a15b38efa979/
    - https://github.com/fkie-cad/nvd-json-data-feeds
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0250
  classification:
    epss-score: 0.13033
    epss-percentile: 0.93851
  metadata:
    max-request: 1
    verified: true
    fofa-query: body="/wp-content/plugins/analytics-insights"
    publicwww-query: "/wp-content/plugins/analytics-insights"
  tags: cve,cve2024,wpscan,redirect,wp,wp-plugin,wordpress,analytics-insights,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/analytics-insights/tools/oauth2callback.php?state=https://oast.me/%3f&code=x"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
# digest: 4a0a00473045022055ec73ff24bd622ab05a79b7d3e80f50bbda9cd6050c4afd748f1c091db5c1a9022100e13c3395f77e4dacf6ed1c0e5e06aae3d10c43d33dc54c19e3d2cb69d2737bd5:922c64590222798bb761d5b6d8e72950