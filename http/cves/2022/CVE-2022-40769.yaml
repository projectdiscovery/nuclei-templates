id: CVE-2022-40769

info:
  name: Profanity weak cryptography
  author: intelligent-ears
  severity: high
  description: Detects exposure of Profanity vanity address generator scripts that may be vulnerable to private key recovery.
  reference:
    - https://github.com/johguse/profanity
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40769
  tags: cve,cve2022,profanity,exposure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/scripts/generate.sh"
      - "{{BaseURL}}/Dockerfile"
      - "{{BaseURL}}/README.md"
      - "{{BaseURL}}/profanity.conf"

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "profanity --leading"
          - "johguse/profanity"
          - "vanity_address"
        condition: or

      - type: dsl
        dsl:
          - "contains(body, 'profanity --leading')"
          - "contains(body, 'johguse/profanity')"
