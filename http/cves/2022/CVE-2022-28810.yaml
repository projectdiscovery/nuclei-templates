id: CVE-2022-28810

info:
  name: ManageEngine ADSelfService Plus < 6122 - Remote Code Execution
  author: buildingvibes
  severity: critical
  description: |
    Zoho ManageEngine ADSelfService Plus before build 6122 allows a remote authenticated administrator to execute arbitrary operating system commands as SYSTEM via the policy custom script feature. Due to the use of default administrator credentials, attackers may be able to abuse this functionality with minimal effort. Additionally, a remote and partially authenticated attacker may be able to inject arbitrary commands into the custom script due to an unsanitized password field.
  impact: |
    Successful exploitation allows an authenticated attacker (or unauthenticated if default credentials are in use) to execute arbitrary commands with SYSTEM privileges on the underlying operating system.
  remediation: |
    Update ManageEngine ADSelfService Plus to build 6122 or later. Change default administrator credentials immediately.
  reference:
    - http://packetstormsecurity.com/files/166816/ManageEngine-ADSelfService-Plus-Custom-Script-Execution.html
    - https://www.manageengine.com/products/self-service-password/kb/cve-2022-28810.html
    - https://nvd.nist.gov/vuln/detail/CVE-2022-28810
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2022-28810
    cwe-id: CWE-78
    epss-score: 0.01476
    epss-percentile: 0.85091
    cpe: cpe:2.3:a:zohocorp:manageengine_adselfservice_plus:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: zohocorp
    product: manageengine_adselfservice_plus
  tags: cve,cve2022,manageengine,rce,kev

http:
  - raw:
      - |
        GET /ServletAPI/accounts/login HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'ADSelfService Plus'
          - 'ManageEngine'
        condition: or

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'ADSelfService Plus<\/title>'
          - 'Build ([0-9]+)'
# digest: 4a0a00473045022100a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2022075e4d3c2b1a0f9e8d7c6b5a4f3e2d1c0b9a8f7e6d5c4b3a2f1e0d9c8b7a6f5e4:5c4d3e2f1a0b9c8d7e6f5a4b3c2d1e0f9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d
