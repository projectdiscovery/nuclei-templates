id: RM-safe-detection-CVE-2021-4073

info:
  name: RegistrationMagic - Social Login Vulnerability Presence Check (SAFE)
  author: prathammis
  severity: info
  description: >
    Safe detection template that checks whether the RegistrationMagic plugin
    exposes the rm_login_social_user AJAX action which is associated with
    CVE-2021-4073. This does NOT attempt authentication bypass or exploitation.
  tags: wordpress,registrationmagic,safe,detection

variables:
  login_path: "/?page_id=8"

http:
  - method: GET
    path:
      - "{{BaseURL}}{{login_path}}"
    redirects: true

    matchers:
      - type: word
        part: body
        words:
          - "rm_login_social_user"

      - type: word
        part: body
        words:
          - "custom-registration-form-builder-with-submission-manager"
