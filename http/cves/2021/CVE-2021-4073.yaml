id: CVE-2021-4073
info:
  name: WordPress RegistrationMagic <= 5.0.1.7 Authentication Bypass
  author: 0xanis
  severity: critical
  description: |
    RegistrationMagic WordPress plugin versions <= 5.0.1.7 contain an authentication bypass caused by missing identity validation in social_login_using_email(), letting unauthenticated users log in as any site user, exploit requires knowing a valid username.
  reference:
    - https://www.wordfence.com/blog/2021/12/authentication-bypass-vulnerability-patched-in-user-registration-plugin/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-4073
  tags: wordpress,wp-plugin,auth-bypass,registrationmagic,cve,kev


http:
  - name: "Detect RegistrationMagic Stable Tag"
    method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/custom-registration-form-builder-with-submission-manager/readme.txt"
    matchers:
      - type: regex
        regex:
          - 'Stable tag: ([0-4]\.[0-9]+\.[0-9]+\.[0-9]+|5\.0\.[0-1]\.[0-7])'
        part: body
      - type: status
        status:
          - 200
