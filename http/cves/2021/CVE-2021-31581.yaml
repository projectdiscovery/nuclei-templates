id: CVE-2021-31581

info:
  name: Akkadian Provisioning Manager MariaDB Credentials
  author: geeknik
  severity: medium
  description: The restricted shell provided by Akkadian Provisioning Manager Engine (PME) can be escaped by abusing the 'Edit MySQL Configuration' command. This command launches a standard vi editor interface which
    can then be escaped. This issue was resolved in Akkadian OVA appliance version 3.0 (and later), Akkadian Provisioning Manager 5.0.2 (and later), and Akkadian Appliance Manager 3.3.0.314-4a349e0 (and later).
  reference:
    - https://threatpost.com/unpatched-bugs-provisioning-cisco-uc/166882/
    - https://www.rapid7.com/blog/post/2021/06/08/akkadian-provisioning-manager-multiple-vulnerabilities-disclosure/
  classification:
    cvss-metrics: CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 4.4
    cve-id: CVE-2021-31581
    cwe-id: CWE-312
  tags: cve,cve2021,akkadian,mariadb,disclosure

requests:
  - method: GET
    path:
      - "{{BaseURL}}/pme/database/pme/phinx.yml"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "host:"
          - "name:"
          - "pass:"
        condition: and

      - type: word
        words:
          - "html>"
        negative: true
