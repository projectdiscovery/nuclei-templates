id: CVE-2020-8260

info:
  name: Pulse Connect Secure < 9.1R9 - RCE via Uncontrolled Gzip Extraction
  author: buildingvibes
  severity: high
  description: |
    Pulse Connect Secure versions before 9.1R9 contain a vulnerability in the admin web interface that allows authenticated attackers to exploit uncontrolled gzip extraction during configuration restoration. The vulnerability allows arbitrary file overwriting, leading to remote code execution with root privileges.
  impact: |
    Successful exploitation allows authenticated administrative users to achieve remote code execution with root privileges on the Pulse Connect Secure appliance.
  remediation: |
    Upgrade to Pulse Connect Secure 9.1R9 or later.
  reference:
    - https://www.nccgroup.com/research-blog/technical-advisory-pulse-connect-secure-rce-via-uncontrolled-gzip-extraction-cve-2020-8260/
    - http://packetstormsecurity.com/files/160619/Pulse-Secure-VPN-Remote-Code-Execution.html
    - https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44601
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8260
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2020-8260
    cwe-id: CWE-22
    epss-score: 0.96969
    epss-percentile: 0.99797
    cpe: cpe:2.3:a:pulsesecure:pulse_connect_secure:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: pulsesecure
    product: pulse_connect_secure
    shodan-query: 'title:"Pulse Secure"'
  tags: cve,cve2020,pulse,pulsesecure,rce,kev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/dana-na/nc/nc_gina_ver.txt"
      - "{{BaseURL}}/dana-cached/hc/HostCheckerInstaller.osx"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Pulse Connect Secure"
          - "ProductVersion"
          - "CFBundleVersion"
        condition: or

      - type: regex
        regex:
          - "ProductVersion.*([0-8]\\.[0-9]|9\\.[0-1]R[0-8])"
          - "version<\\/key>[^<]*<string>([0-8]\\.[0-9]|9\\.[0-1]R[0-8])"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: version
        group: 1
        regex:
          - "ProductVersion.*([\\d.R]+)"
          - "version<\\/key>[^<]*<string>([^<]+)<"
