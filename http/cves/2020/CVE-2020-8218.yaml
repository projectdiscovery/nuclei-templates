id: CVE-2020-8218

info:
  name: Pulse Connect Secure < 9.1R8 - Remote Code Injection
  author: buildingvibes
  severity: critical
  description: |
    A code injection vulnerability exists in Pulse Connect Secure versions prior to 9.1R8 that allows an authenticated attacker to craft a URI to perform arbitrary code execution via the admin web interface.
  impact: |
    Successful exploitation allows an authenticated attacker with administrative access to execute arbitrary code on the underlying system, potentially leading to complete system compromise.
  remediation: |
    Update Pulse Connect Secure to version 9.1R8 or later. Follow vendor security advisories for additional hardening measures.
  reference:
    - https://www.gosecure.net/blog/2020/11/13/forget-your-perimeter-part-2-four-vulnerabilities-in-pulse-connect-secure/
    - https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44516
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8218
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 7.2
    cve-id: CVE-2020-8218
    cwe-id: CWE-94
    epss-score: 0.00917
    epss-percentile: 0.81636
    cpe: cpe:2.3:a:ivanti:connect_secure:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: ivanti
    product: connect_secure
  tags: cve,cve2020,pulse,vpn,rce,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/dana-na/auth/url_default/welcome.cgi"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'Pulse Connect Secure'
          - 'Pulse Secure'
        condition: or

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - 'Version ([0-9.R]+)'
          - 'iver=([0-9.R]+)'
# digest: 4a0a00473045022100f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d1c2b3a4f5e6d7c8b9a0f1e2022064c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5:6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e
