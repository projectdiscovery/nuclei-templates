id: CVE-2020-9496

info:
  name: Apache OFBiz 17.12.03 - Cross-Site Scripting
  author: dwisiswant0
  severity: medium
  description: Apache OFBiz 17.12.03 contains cross-site scripting and unsafe deserialization vulnerabilities via an XML-RPC request.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or upgrade to a non-vulnerable version of Apache OFBiz.
  reference:
    - http://packetstormsecurity.com/files/158887/Apache-OFBiz-XML-RPC-Java-Deserialization.html
    - http://packetstormsecurity.com/files/161769/Apache-OFBiz-XML-RPC-Java-Deserialization.html
    - https://securitylab.github.com/advisories/GHSL-2020-069-apache_ofbiz
    - https://s.apache.org/l0994
    - https://nvd.nist.gov/vuln/detail/CVE-2020-9496
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-9496
    cwe-id: CWE-502
    epss-score: 0.92981
    epss-percentile: 0.99762
    cpe: cpe:2.3:a:apache:ofbiz:17.12.03:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: apache
    product: ofbiz
    shodan-query:
      - http.html:"ofbiz"
      - ofbiz.visitor=
    fofa-query:
      - body="ofbiz"
      - app="apache_ofbiz"
  tags: cve,cve2020,ofbiz,packetstorm,apache,java,vkev,vuln

http:
  - raw:
      - |
        POST /webtools/control/xmlrpc HTTP/1.1
        Host: {{Hostname}}
        Origin: http://{{Hostname}}
        Content-Type: application/xml

        <?xml version="1.0"?><methodCall><methodName>ProjectDiscovery</methodName><params><param><value>dwisiswant0</value></param></params></methodCall>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "faultString"
          - "No such service [ProjectDiscovery]"
          - "methodResponse"
        condition: and

      - type: word
        part: header
        words:
          - "Content-Type: text/xml"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100e45a99b3b5622ca4c8ad27e2de3c6c607a0bfa9356caff876f72b40869b543bb022100ed0393b2e17300d6e7a7dca61cce15a0a848f8e7467353e90abd0a7f2f88c223:922c64590222798bb761d5b6d8e72950