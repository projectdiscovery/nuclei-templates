id: CVE-2016-10368

info:
  name: Opsview Monitor Pro - Open Redirect
  author: 0x_Akoko
  severity: medium
  description: |
    Opsview Monitor Pro before 5.1.0.162300841, before 5.0.2.27475, before 4.6.4.162391051, and 4.5.x without a certain 2016 security patch contains an open redirect vulnerability. An attacker can redirect users to arbitrary web sites and conduct phishing attacks via the back parameter to the login URI.
  impact: |
    An attacker can redirect users to malicious websites, leading to phishing attacks or the download of malware.
  remediation: |
    Apply the latest patch or upgrade to a version that is not affected by the vulnerability.
  reference:
    - https://www.trustwave.com/en-us/resources/security-resources/security-advisories/?fid=18774
    - https://www.trustwave.com/Resources/Security-Advisories/Advisories/TWSL2016-016/?fid=8341
    - https://nvd.nist.gov/vuln/detail/CVE-2016-10368
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2016-10368
    cwe-id: CWE-601
    epss-score: 0.01027
    epss-percentile: 0.76796
    cpe: cpe:2.3:a:opsview:opsview:4.5.0:*:*:*:pro:*:*:*
  metadata:
    max-request: 1
    vendor: opsview
    product: opsview
    shodan-query: http.title:"opsview"
    fofa-query: title="opsview"
    google-query: intitle:"opsview"
  tags: cve2016,cve,redirect,opsview,authenticated,vuln

http:
  - raw:
      - |
        POST /login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        login_username={{username}}&login_password={{password}}&login=&back=//www.interact.sh&app=OPSVIEW

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh\/?(\/|[^.].*)?$' # https://regex101.com/r/L403F0/1

      - type: status
        status:
          - 302
# digest: 4b0a00483046022100be9db91b448a1a7023b01d82c2c605974b593466f6bd74ff040c3601b79f1167022100d9a11ac33b73e92c69ae0c3c120cb878b3f7f0f3c3fd34316aaee71c3f4bbe81:922c64590222798bb761d5b6d8e72950