id: CVE-2019-6703

info:
  name: Total Donations Plugin for WordPress < 2.0.6 - Arbitrary Options Update
  author: DhiyaneshDK
  severity: critical
  description: |
    Incorrect access control in migla_ajax_functions.php in the Calmar Webmedia Total Donations plugin through 2.0.5 for WordPress allows unauthenticated attackers to update arbitrary WordPress option values, leading to site takeover. These attackers can send requests to wp-admin/admin-ajax.php to call the miglaA_update_me action to change arbitrary options on affected sites. This can be used to enable new user registration and set the default role for new users to Administrator.
  impact: |
    Attackers can modify site options, enabling new user registration as Administrator, leading to site takeover.
  remediation: Update to the latest version of the plugin where this issue is fixed.
  reference:
    - https://wpscan.com/vulnerability/6e6342b0-82ca-4f5f-8b59-92ec3bdf1d02/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-6703
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-6703
    epss-score: 0.53839
    epss-percentile: 0.9791
    cpe: cpe:2.3:a:calmar-webmedia:total_donations:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: calmar-webmedia
    product: total_donations
    framework: wordpress
    fofa-query: body="/wp-content/plugins/total-donations/"
  tags: cve,cve2019,wpscan,wordpress,wp,wp-plugin,total-donations,passive,vkev,vuln

http:
  - raw:
      - |
        GET /wp-content/plugins/total-donations/readme.txt HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'compare_versions(version, "< 2.0.6")'
          - 'contains(body, "Total Donations")'
          - 'status_code == 200'
        condition: and

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "(?mi)Stable tag: ([0-9.]+)"
        internal: true
# digest: 4b0a00483046022100ee7d8e8d2bfe2ff3809ae070214fe101b599c9a555821a8b933eab7b15c0cef6022100f120273bd539a9497e18697ad87b147a53fcea4261a8aac0cf3756aaa986b339:922c64590222798bb761d5b6d8e72950