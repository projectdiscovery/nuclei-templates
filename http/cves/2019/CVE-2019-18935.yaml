id: CVE-2019-18935

info:
  name: Progress Telerik UI for ASP.NET AJAX - Insecure Deserialization
  author: YourGitHubUsername
  severity: critical
  description: |
    Progress Telerik UI for ASP.NET AJAX through 2019.3.1023 contains a .NET deserialization vulnerability in the RadAsyncUpload function. This is exploitable when the encryption keys are known due to the presence of CVE-2017-11317 or CVE-2017-11357, or other means. Exploitation can result in remote code execution.
  remediation: |
    Upgrade to Telerik UI for ASP.NET AJAX R3 2019 SP1 (2019.3.1023) or later and ensure the TypeWhitelist feature is enabled.
  reference:
    - https://github.com/projectdiscovery/nuclei-templates/issues/14278
    - https://nvd.nist.gov/vuln/detail/CVE-2019-18935
    - https://github.com/noperator/CVE-2019-18935
    - https://know.bishopfox.com/research/cve-2019-18935-remote-code-execution-in-telerik-ui
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-18935
    cwe-id: CWE-502
  metadata:
    max-request: 2
    vendor: progress
    product: telerik_ui_for_asp.net_ajax
    shodan-query: http.component:"Telerik"
  tags: cve,cve2019,telerik,rce,deserialization,aspnet,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/Telerik.Web.UI.WebResource.axd?type=rau"
      - "{{BaseURL}}/Telerik.Web.Ui.WebResource.axd?type=rau"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "RadAsyncUpload handler is registered succesfully"

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: version
        part: body
        group: 1
        regex:
          - "20[0-9]{2}\\.[0-9]+\\.[0-9]+"