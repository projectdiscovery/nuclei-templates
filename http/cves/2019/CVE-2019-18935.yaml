id: CVE-2019-18935

info:
  name: Telerik UI for ASP.NET AJAX - Remote Code Execution
  author: buildingvibes
  severity: critical
  description: |
    Telerik UI for ASP.NET AJAX contains a .NET deserialization vulnerability in RadAsyncUpload component. An attacker can exploit this vulnerability to upload malicious files and execute arbitrary code on the server. This affects Progress Telerik UI for ASP.NET AJAX versions prior to R1 2020 (2020.1.114).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-18935
    - https://www.telerik.com/support/kb/aspnet-ajax/details/cryptographic-weakness
    - https://www.zerodayinitiative.com/advisories/ZDI-20-126/
    - https://labs.bishopfox.com/tech-blog/cve-2019-18935-remote-code-execution-in-telerik-ui
    - https://know.bishopfox.com/research/cve-2019-18935-exploiting-telerik-ui
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-18935
    cwe-id: CWE-502
    epss-score: 0.97500
    epss-percentile: 0.99997
  metadata:
    verified: true
    max-request: 1
    vendor: progress
    product: telerik_ui_for_asp.net_ajax
    shodan-query: http.html:"Telerik.Web.UI.WebResource.axd"
  tags: cve,cve2019,rce,telerik,deserialization,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/Telerik.Web.UI.WebResource.axd?type=rau"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "RadAsyncUpload handler is registered"
          - "Telerik.Web.UI"
        condition: or

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
