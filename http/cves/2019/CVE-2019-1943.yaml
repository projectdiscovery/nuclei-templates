id: CVE-2019-1943

info:
  name: Cisco Small Business 200,300 and 500 Series Switches - Open Redirect
  author: bhutch
  severity: medium
  description: |
    Cisco Small Business 200,300 and 500 Series Switches contain an open redirect vulnerability in the Web UI. An attacker can redirect a user to a malicious site and possibly obtain sensitive information, modify data, and/or execute unauthorized operations.
  impact: |
    An attacker can exploit this vulnerability to redirect users to malicious websites, leading to phishing attacks or the download of malware.
  remediation: |
    Apply the necessary patches or updates provided by Cisco to fix the open redirect vulnerability.
  reference:
    - https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190717-sbss-redirect
    - https://www.exploit-db.com/exploits/47118
    - https://nvd.nist.gov/vuln/detail/CVE-2019-1943
    - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190717-sbss-redirect
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-1943
    cwe-id: CWE-601
    epss-score: 0.22946
    epss-percentile: 0.95718
    cpe: cpe:2.3:o:cisco:sg200-50_firmware:-:*:*:*:*:*:*:*
  metadata:
    verified: "true"
    max-request: 1
    vendor: cisco
    product: sg200-50_firmware
    shodan-query: "/config/log_off_page.htm"
    censys-query: "services.http.response.headers.location: /config/log_off_page.htm"
  tags: cve,cve2019,redirect,cisco,vuln

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: interact.sh

    matchers-condition: and
    matchers:
      - type: word
        part: server
        words:
          - 'GoAhead-Webs'

      - type: regex
        part: header
        regex:
          - '(?i)Location:\shttps?:\/\/interact\.sh/cs[\w]+/'

      - type: status
        status:
          - 302
# digest: 4a0a00473045022100af107a2fe59d3b10ac3c3e96acd75f00ec5fd56b2a7831906da589b287a517310220112b2227806a8ac02f8ef948f541cf90f6f16d29938c9e94c5c35225a47d7229:922c64590222798bb761d5b6d8e72950