id: tinlance-paystack-secret-exposure

info:
  name: Paystack Secret/Live Key Exposure - Tinlance Detection
  author: Lloydcoder
  severity: critical
  description: Detects accidentally exposed Paystack secret keys (test or live) commonly used by Nigerian startups and fintech companies.
  reference:
    - https://support.paystack.com/en/articles/xx
  classification:
    cvss-score: 9.8
  tags: exposure,secret,paystack,nigeria,fintech,tinlance

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "sk_(live|test)_[0-9a-zA-Z]{50,}"
      - type: word
        words:
          - "paystack"
          - "secret_key"
          - "sk_live"
          - "sk_test"
        condition: or
        case-insensitive: true
