  id: dionaea-http-honeypot-detect

  info:
    name: Dionaea HTTP Honeypot - Detect
    author: UnaPibaGeek
    severity: info
    description: |
      Dionaea HTTP honeypot has been identified.
      The response to an incorrect HTTP method reveals a possible setup of the Dioanea web application honeypot.
    metadata:
      max-request: 1
      vendor: dionaea
      product: http
    tags: dionaea,honeypot,ir,cti

  http:
    - raw:
        - |
          AAAA / HTTP/1.1
          Host: {{Hostname}}

      unsafe: true
      matchers-condition: and
      matchers:
        - type: status
          status:
            - 501

        - type: word
          part: header
          words:
            - "nginx"

        - type: word
          part: body
          words:
            - '<?xml version="1.0" encoding="ascii"?>'