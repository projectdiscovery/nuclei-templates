id: newrelic-rum-detect

info:
  name: New Relic Browser Monitoring (RUM) - Tech Detect
  author: Shivam Kamboj
  severity: info
  description: |
    Detected New Relic Browser Monitoring (RUM) agent artifacts
  reference:
    - https://docs.newrelic.com/docs/browser/
  metadata:
    verified: true
    max-request: 1
    fofa-query: 'body="NREUM" || body="nr-data" || body="js-agent.newrelic.com" || body="newrelic-browser-agent"'
  tags: tech,discovery,rum,newrelic

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: dsl
        dsl:
          - status_code == 200 || status_code == 400
          - contains_any(body, 'nreum.loader_config','newrelic-browser-agent','js-agent.newrelic.com','nreum','nr-data')
        condition: and
