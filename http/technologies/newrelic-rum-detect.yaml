id: newrelic-rum-detect

info:
  name: New Relic Browser Monitoring (RUM) - Tech Detect
  author: Shivam Kamboj
  severity: info
  description: |
    Detected New Relic Browser Monitoring (RUM) agent artifacts
  reference:
    - https://docs.newrelic.com/docs/browser/
  metadata:
    verified: true
    max-request: 1
    fofa-query: 'body="NREUM" || body="nr-data" || body="js-agent.newrelic.com" || body="newrelic-browser-agent"'
  tags: tech,discovery,rum,newrelic

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: dsl
        dsl:
          - status_code == 200 || status_code == 400
          - contains_any(body, 'nreum.loader_config','newrelic-browser-agent','js-agent.newrelic.com','nreum','nr-data')
        condition: and
# digest: 4a0a0047304502207087d2e56c0063e422aad948ad54ba7d12770a88cfefff3a6d817cb970a16a7a022100ca5ebea5c7dc6ba632596a733939537e4ac73914b87f0cb6e1193aa1c12d1352:922c64590222798bb761d5b6d8e72950