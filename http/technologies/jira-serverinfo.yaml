id: jira-serverinfo

info:
  name: Jira Rest API Server Information
  author: pdteam,0x_Akoko
  severity: info
  description: |
    Detected Jira REST API serverInfo endpoint is accessible without authentication, exposing sensitive server information including version, build number, server title, base URL, and server time.
  impact: |
    An attacker can obtain detailed information about the Jira instance including exact version and build number, which can be used to identify known vulnerabilities and plan targeted attacks.
  remediation: |
    Restrict access to the /rest/api/2/serverInfo endpoint by configuring authentication requirements or blocking anonymous access using URL rewrite rules or a reverse proxy.
  reference:
    - https://jira.atlassian.com/browse/JRASERVER-62282
    - https://jira.atlassian.com/browse/JRASERVER-71317
    - https://developer.atlassian.com/cloud/jira/platform/rest/v2/api-group-server-info/
    - https://support.atlassian.com/jira/kb/restrict-unauthenticated-access-for-some-jira-endpoints/
  classification:
    cwe-id: CWE-200
  metadata:
    verified: true
    max-request: 2
  tags: jira,tech,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/rest/api/latest/serverInfo"
      - "{{BaseURL}}/rest/api/2/serverInfo"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"baseUrl"'
          - '"deploymentType"'
        condition: and

      - type: status
        status:
          - 200

    extractors:
      - type: json
        json:
          - ".baseUrl"
          - ".version"
# digest: 4a0a0047304502200ab80364b7aaf9e317f8b5e8f52205b3d9dfd78c7da1604bdb3f873df84fc7b10221009facd469ad7743d360c902704d09c0a4d703bfaf3045f97b81eacfed84eadbcf:922c64590222798bb761d5b6d8e72950
