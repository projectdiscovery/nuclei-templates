id: centos-eol

info:
  name: CentOS EOL - Detect
  author: staticnoise
  severity: info
  description: |
    Detected CentOS systems that had reached End-of-Life (EOL) status by identifying outdated version information in HTTP response.
  reference:
    - https://endoflife.date/centos
    - https://blog.centos.org/2023/04/end-dates-are-coming-for-centos-stream-8-and-centos-linux-7/
  metadata:
    max-request: 1
    shodan-query: '"Server: Apache/" "centos"'
    fofa-query: 'header="Server: Apache/" && "centos"'
  tags: centos,eol,tech,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: regex
        part: header
        regex:
          - 'Apache/(\d+\.\d+\.\d+) \((centos|CentOS)\)'
# digest: 4a0a00473045022100c3d91a335467f645fbbac3208360007e5daa9b81892ccafd04d4695aff9a60110220581f9a94e1679c95b37671c99208b6bfe2caa9076a78cecf8996549b814766c1:922c64590222798bb761d5b6d8e72950