id: krpano-detect

info:
  name: Krpano Panorama Viewer - Detection
  author: matejsmycka
  severity: info
  description: |
    Detected Krpano Panorama Viewer by identifying known Krpano-specific resources and response patterns.
  reference:
    - https://krpano.com/
  metadata:
    vendor: krpano
    product: panorama_viewer
    shodan-query: http.html:"embedpano"
  tags: tech,krpano,viewer,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/krpano.html"

    stop-at-first-match: true

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: word
        part: body
        words:
          - "embedpano({"
          - "passQueryParameters:true"
          - "swf"
        condition: and
