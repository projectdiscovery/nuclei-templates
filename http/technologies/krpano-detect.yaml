id: krpano-detect

info:
  name: Krpano Panorama Viewer - Detection
  author: matejsmycka
  severity: info
  description: |
    Detected Krpano Panorama Viewer by identifying known Krpano-specific resources and response patterns.
  reference:
    - https://krpano.com/
  metadata:
    vendor: krpano
    product: panorama_viewer
    shodan-query: http.html:"embedpano"
  tags: tech,krpano,viewer,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/krpano.html"

    stop-at-first-match: true

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: word
        part: body
        words:
          - "embedpano({"
          - "passQueryParameters:true"
          - "swf"
        condition: and
# digest: 490a00463044022051dcc13aaac125eb9d3e2650cfc877df51abcf2d3325789486dd64fb4b39041602201831972d1f21b96e434c0739313c50affe422e6034f2b8fc53cb99ced3b11d4a:922c64590222798bb761d5b6d8e72950