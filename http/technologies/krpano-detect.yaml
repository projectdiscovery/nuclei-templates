id: krpano-detect

info:
  name: Detect Krpano Panorama Viewer
  author: matejsmycka
  severity: info
  description: |
    Krpano Panorama Viewer is lib for displaying 360Â° panoramas and virtual tours. Most of the instances in the wild are vulnerable to CVE-2020-24900 reflected XSS.
    To find version information, look for "krpano Embedding Script" string in the js files.
  reference:
    - https://krpano.com/
  metadata:
    vendor: krpano
    product: panorama_viewer
    shodan: http.html:"embedpano"
  tags: tech,krpano,viewer,discovery

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/krpano.html"

    matchers:
      - type: word
        part: body
        condition: and
        words:
          - "embedpano({"
          - "passQueryParameters:true"
          - "swf"