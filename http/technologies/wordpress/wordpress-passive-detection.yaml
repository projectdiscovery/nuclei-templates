id: wordpress-passive-detection

info:
  name: WordPress Passive Detection - Plugins & Themes
  author: princechaddha
  severity: info
  description: |
    Passively enumerates WordPress plugins and themes through REST API discovery and HTML source analysis without brute-forcing, based on wpprobe methodology.
  reference:
    - https://developer.wordpress.org/rest-api/using-the-rest-api/discovery/
    - https://github.com/Chocapikk/wpprobe
    - https://chocapikk.com/posts/2025/wpprobe/
  classification:
    cpe: cpe:2.3:a:wordpress:wordpress:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 3
    vendor: wordpress
    product: wordpress
    shodan-query:
      - http.component:"wordpress"
  tags: tech,wordpress,cms,wp,plugin,theme,discovery,passive,enum

http:
  - method: GET
    path:
      - "{{BaseURL}}/?rest_route=/"
      - "{{BaseURL}}/wp-json/"
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 2

    extractors:
      - type: regex
        name: plugin_slug
        part: body
        group: 1
        regex:
          - '\/wp-content\/plugins\/([a-zA-Z0-9_-]+)\/'

      - type: regex
        name: theme_slug
        part: body
        group: 1
        regex:
          - '\/wp-content\/themes\/([a-zA-Z0-9_-]+)\/'
          - 'themes\/([a-zA-Z0-9_-]+)\/style\.css'
# digest: 4b0a00483046022100c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8e9f0a1b2022100b2a1f0e9d8c7b6a5f4e3d2c1b0a9f8e7d6c5b4a3f2e1d0c9b8a7f6e5d4c3b2a1:922c64590222798bb761d5b6d8e72950
