id: sap-message-server-console-exposed

info:
  name: SAP Message Server Console Exposed
  author: LRVT, l4rm4nd
  severity: info
  description: |
    Detects the SAP Message Server HTTP console exposed on /msgserver.

    When accessed directly, the message server returns an HTML page titled
    "List of commands" which lists available /msgserver/* URLs such as
    /msgserver/commands, along with a Server header like:
      - Server: SAP Message Server, release <kernel> (<SID>)

    The presence of this console can aid reconnaissance by exposing internal
    hostnames (via links and Location headers) and offering insight into the
    SAP message server configuration and available commands. The template
    also extracts the full SAP Message Server banner from the Server header
    for quick version and SID fingerprinting.
  tags: sap,message-server,http,console,panel,discovery,recon

http:
  - method: GET
    path:
      - "{{RootURL}}/msgserver"

    headers:
      User-Agent: Mozilla/5.0

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      # SAP Message Server banner present
      - type: word
        part: header
        words:
          - "SAP Message Server"

      # Console HTML content
      - type: word
        part: body
        words:
          - "<TITLE>List of commands</TITLE>"
          - "List of commands"
          - "/msgserver/commands"
        condition: or

    extractors:
      # Grab the full Server header line including release / SID
      - type: regex
        part: header
        name: version
        group: 1
        regex:
          - "(?i)server:\\s*(SAP Message Server[^\\r\\n]*)"
