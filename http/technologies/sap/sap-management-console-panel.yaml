id: sap-management-console-panel

info:
  name: SAP Management Console Panel
  author: LRVT, l4rm4nd
  severity: info
  description: |
    Detects the SAP Management Console (SAP MC) web panel by requesting
    /sapmc/sapmc.html and checking for a gSOAP server header and the
    "SAP Management Console" HTML title.

    This identifies the presence of the SAP MC interface, which is often
    backed by the SAPControl (sapstartsrv) SOAP interface on the same host
    and port. Exposure of SAP MC on untrusted networks can increase the
    attack surface for SAP-specific vulnerabilities.
  tags: sap,sapmc,panel,ui,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/sapmc/sapmc.html"

    headers:
      User-Agent: Mozilla/5.0

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      # gSOAP server header
      - type: word
        part: header
        words:
          - "gSOAP/2.8"

      # Page title or visible text
      - type: word
        part: body
        words:
          - "SAP Management Console"
