id: sap-message-server-console

info:
  name: SAP Message Server Console - Exposure
  author: LRVT,l4rm4nd
  severity: info
  description: |
    Detected the SAP Message Server HTTP console on /msgserver. When accessed directly, the message server returns an HTML page.
  metadata:
    max-request: 1
    shodan-query: http.html:SAP Message Server
  tags: sap,console,exposure

http:
  - method: GET
    path:
      - "{{RootURL}}/msgserver"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<TITLE>List of commands</TITLE>"
          - "/msgserver/commands"
        condition: and

      - type: word
        part: header
        words:
          - "SAP Message Server"

      - type: status
        status:
          - 200
