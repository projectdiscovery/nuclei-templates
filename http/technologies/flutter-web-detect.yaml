id: flutter-web-detect

info:
  name: Flutter Web Application - Detect
  author: incogbyte
  severity: info
  description: |
    Detect flutter web apps looking for flutter_bootstrap.js,main.dart.js and flutter_service_worker.js files.
  metadata:
    max-request: 1
    verified: true
    shodan-query: http.html:"flutter_bootstrap.js"
    fofa-query: body="flutter_bootstrap.js"
  tags: tech,detect,flutter

http:
  - method: GET
    path:
      - "{{BaseURL}}/flutter_service_worker.js"
      - "{{BaseURL}}/main.dart.js"
      - "{{BaseURL}}/flutter_bootstrap.js"

    stop-at-first-match: true
    matchers:
      - type: word
        part: body
        words:
          - "_flutter.loader.didCreateEngineInitializer"
          - "_flutter.buildConfig"
          - "flutter-app-manifest"
          - "flutter-temp-cache"
          - "flutter-app-cache"
          - "ext.flutter.disassemble"
          - "#flutterweb-theme"
        condition: or
