id: thanos-tech-detect

info:
  name: Thanos Monitoring - Tech Detection
  author: Shivam Kamboj
  severity: info
  description: |
    Detects Thanos monitoring components. Thanos is a highly available Prometheus setup with long-term storage capabilities.
  reference:
    - https://thanos.io/
    - https://github.com/thanos-io/thanos
  metadata:
    verified: true
    max-request: 1
    shodan-query: 'http.title:"Thanos" http.html:"THANOS_COMPONENT"'
    fofa-query: 'title="Thanos" && body="THANOS_COMPONENT"'
  tags: tech,thanos,monitoring,discovery,detect

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    matchers:
      - type: dsl
        name: thanos
        dsl:
          - 'status_code == 200'
          - 'contains(body, "<title>") && contains(body, "</title>")'
          - 'contains(body, "THANOS_COMPONENT") || contains(body, "Thanos | Highly available Prometheus setup")'
        condition: and
