id: centos-eol

info:
  name: CentOS EOL - Detect
  author: staticnoise
  severity: info
  description: |
    Detected CentOS systems that had reached End-of-Life (EOL) status by identifying outdated version information in HTTP response.
  reference:
    - https://endoflife.date/centos
    - https://blog.centos.org/2023/04/end-dates-are-coming-for-centos-stream-8-and-centos-linux-7/
  metadata:
    max-request: 1
    shodan-query: '"Server: Apache/" "centos"'
    fofa-query: 'header="Server: Apache/" && "centos"'
  tags: centos,eol,tech

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers:
      - type: regex
        part: header
        regex:
          - 'Apache/(\d+\.\d+\.\d+) \((centos|CentOS)\)'
# digest: 4a0a00473045022064ac81bed45b78570935c7eb6b4e5c8988748e7ce6346a0de70033cd5a2e2483022100e7f2b637a3f040f422db4f993fb1296dfa727d4ad2c0e3a5df2ee923227dc74e:922c64590222798bb761d5b6d8e72950