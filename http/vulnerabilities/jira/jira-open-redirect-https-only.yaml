id: jira-open-redirect-https-only

info:
  name: Open redirect in JIRA in HTTPS mode only
  author: 0x_Akoko
  severity: medium
  description: |
    Detected Open redirect vulnerability in Jira via os_destination parameter versions 5.2.11, 6.2, and 6.2.2.
  reference:
    - https://jira.atlassian.com/browse/JRASERVER-38075
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:P/I:P/A:N
    cvss-score: 5.8
    cwe-id: CWE-601
  metadata:
    verified: true
    max-request: 1
  tags: confluence,atlassian,jira,redirect,atlassian

http:
  - method: GET
    path:
      - "{{BaseURL}}/ThisCanBeAnything?os_destination=%2F%2Foast.pro"

    matchers-condition: and
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*)(?:https?://|//|/\\\\)?[a-zA-Z0-9._@-]*oast\.pro.*$'

      - type: status
        status:
          - 302
