id: wordpress-storefront-fpd

info:
  name: WordPress Storefront Theme - Full Path Disclosure
  author: pussycat0x
  severity: low
  description: |
    The Storefront theme for WordPress was detected to be vulnerable to Full Path Disclosure, allowing unauthenticated attackers to obtain the full application path that could aid other attacks when combined with another vulnerability.
  reference:
    - https://wordpress.org/themes/storefront/
    - https://woocommerce.com/products/storefront/
  tags: wordpress,wp-theme,fpd,disclosure,storefront,theme,woocommerce

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/themes/storefront/functions.php"
      - "{{BaseURL}}/wp-content/themes/storefront/header.php"
      - "{{BaseURL}}/wp-content/themes/storefront/footer.php"

    stop-at-first-match: true

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200 || status_code == 500'
          - 'contains(body, "wp-content/themes/storefront")'
          - 'contains_all(body, "Fatal error", "Uncaught Error:") || contains_all(body, "Warning:","failed to open stream")'
        condition: and
