id: justboil-me-image-upload

info:
  name: JustBoil.me Images Plugin - Exposed Image Upload
  author: 0xr2r
  severity: medium
  description: |
    JustBoil.me Images Plugin for TinyMCE contains an exposed dialog interface that could lead to potential security vulnerabilities. The plugin's dialog-v4.htm file is accessible without proper access controls, which may allow unauthorized access to image upload functionality.
  reference:
    - https://cxsecurity.com/issue/WLB-2019050108
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="/plugins/generic/tinymce/plugins/justboil.me/"
    shodan-query: inurl:"/plugins/generic/tinymce/plugins/justboil.me/"
  tags: justboil,tinymce,plugin,exposure,misconfig,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/plugins/generic/tinymce/plugins/justboil.me/dialog-v4.htm"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "JustBoil.me Images Plugin"
          - "TinyMCE"
          - "upload_infobar"
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502207125d7bad948fe1625b4ba0d6dbb6e2615895cef7b11a7372e2045c96dffbfd0022100dd2ad29c4812490b6dcbd3569bb0c05c603c2f118e1e1328a9667be5fe8adc31:922c64590222798bb761d5b6d8e72950