id: registrationmagic-auth-bypass-cve-2021-4073

info:
  name: RegistrationMagic Authentication Bypass (CVE-2021-4073)
  author: lau90eth
  severity: medium
  description: |
    Detects a potential authentication bypass in the RegistrationMagic
    plugin for WordPress, where admin-only pages may be accessible
    without authentication (CVE-2021-4073).
  reference:
    - https://wpscan.com/vulnerability/ # riferimento generico
  tags: wordpress,plugin,registrationmagic,auth-bypass

http:
  - method: GET
    max-redirects: 0
    path:
      - "{{BaseURL}}/wp-admin/admin.php?page=rm_form_manage"
      - "{{BaseURL}}/wp-admin/admin.php?page=rm_submissions"
      - "{{BaseURL}}/wp-admin/admin.php?page=rm_user_manage"

    headers:
      User-Agent: nuclei-scanner

    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "RegistrationMagic"
          - "RM Forms"
          - "Form Manager"
        condition: or

    matchers-condition: and
