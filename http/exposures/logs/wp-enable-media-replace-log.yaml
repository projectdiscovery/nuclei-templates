id: wp-enable-media-replace-log

info:
  name: WordPress Plugin Enable Media Replace - Log File Exposure
  author: DhiyaneshDk
  severity: medium
  description: |
    The WordPress plugin "Enable Media Replace" (enable-media-replace) bundles a ShortPixel-based logger that writes a plugin-specific log file into the WordPress uploads directory, typically as `wp-content/uploads/EnableMediaReplace.log`.
  reference:
    - https://wordpress.org/plugins/enable-media-replace/
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="/plugins/enable-media-replace/"
  tags: wordpress,wp,wp-plugin,enable-media-replace,log,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/uploads/EnableMediaReplace.log"

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "Deprecated", "enable-media-replace")'
          - 'status_code == 200'
        condition: and
