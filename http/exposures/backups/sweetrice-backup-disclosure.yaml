id: sweetrice-backup-disclosure

info:
  name: SweetRice CMS 1.5.1 - Backup Disclosure
  author: mananispiwpiw
  severity: medium
  description: |
    Detected SweetRice-specific backups and generic .sql files exposed via directory listing in the SweetRice mysql_backup directory.
  reference:
    - https://www.exploit-db.com/exploits/40718
  tags: sweetrice,cms,exposure,backup,misconfig

http:
  - raw:
      - | 
        GET /inc/mysql_backup/ HTTP/1.1
        Host: {{Hostname}}

      - | 
        GET /inc/mysql_backup/{{backup_file}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - contains(body_1, 'Index of /sweetrice/inc/mysql_backup')
          - contains_any(body_2, 'INSERT INTO', 'CREATE TABLE', 'Table structure for')
          - status_code_1 == 200 && status_code_2 == 200
        condition: and