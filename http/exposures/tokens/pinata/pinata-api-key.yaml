id: pinata-api-key

info:
  name: Pinata API Key - Expose
  author: 0xpugal
  severity: info
  tags: pinata,exposure,api-keys,tokens

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: false
    matchers:
      - type: word
        words:
          - "pinata_api_key"
          - "pinata_api_secret"
          - "pinataKey"
          - "pinataSecret"
          - "pinata-key"
          - "pinata_secret"
        case-insensitive: true
        condition: or

    extractors:
      - type: regex
        part: body
        regex:
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?key\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?secret\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?KEY\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?SECRET\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:key|Key)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:secret|Secret)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?key\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?secret\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?key\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?secret\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)pinata[^A-Za-z0-9]{0,8}([A-Za-z0-9_\-]{16,128})
# digest: 4a0a00473045022021dd618e7eec7e8a25ec5bd3abbce9c230e52c00a78671343c2e2deac3bfa19d022100bba3a9a1e9537ed044a8ed3ace5bba63db9ec0329c1c01bb4c3ff976a215b0f5:922c64590222798bb761d5b6d8e72950