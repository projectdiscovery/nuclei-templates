id: joe-deadjoe-file-exposure

info:
  name: Joe Editor DEADJOE File - Exposure
  author: 0x_Akoko
  severity: low
  description: |
    Detected Deadjoe file,this file was created by Joe's Own Editor when a session terminated abnormally. It contained the full contents of the file being edited at the time of the crash, potentially exposing sensitive information such as passwords, configuration files, or credentials. 
  reference:
    - https://www.acunetix.com/vulnerabilities/web/joe-editor-deadjoe-file/
    - https://www.invicti.com/web-application-vulnerabilities/joe-editor-deadjoe-file
    - https://www.freebsd.org/security/advisories/FreeBSD-SA-01:04.joe.asc
  classification:
    cwe-id: CWE-538
  metadata:
    verified: true
    max-request: 1
  tags: exposure,deadjoe,misconfig,files

http:
  - method: GET
    path:
      - "{{BaseURL}}/DEADJOE"

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains_any(body, "JOE was aborted", "modified files were found in JOE", "JOE when it aborted")'
          - 'contains_all(body, "***", "JOE")'
        condition: and
