id: vtigercrm-data-exposed
info:
  name: Vtiger CRM - Data Exposed
  author: icarot
  severity: high
  description: |
    Detects if a Vtiger CRM exposes uploaded files. This web application is a PHP based web application that enables businesses to increase sales wins, marketing ROI, and support satisfaction capabilities.
  reference:
    - https://github.com/vtiger-crm/vtigercrm
    - https://code.vtiger.com/vtiger/vtigercrm
  classification:
    cpe: cpe:2.3:a:vtiger:vtiger_crm:*:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: vtiger
    product: vtiger_crm
    shodan-query: title:"vtiger"
  tags: exposed,vtiger,vtiger_crm,vuln

http:
  - raw:
      - |
        GET /{{exposed_path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

    attack: pitchfork
    payloads:
      exposed_path:
        - /logs/
        - /data/
        - /storage/

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '<title>Index of'
      - type: status
        status:
          - 200
