id: kcfinder-exposure

info:
  name: KCFinder - Exposure
  author: theamanrawat
  severity: high
  description: |
    Detects publicly accessible KCFinder instances which may allow arbitrary file upload and remote code execution (RCE). Exposure of KCFinder can allow an attacker to gain unauthorized access to the file manager and upload malicious files.
  reference:
    - https://github.com/sunhater/kcfinder
  metadata:
    verified: true
    max-request: 6
  tags: exposure,kcfinder,fileupload

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/kcfinder/browse.php"
      - "{{BaseURL}}/assets/kcfinder/browse.php"
      - "{{BaseURL}}/lib/kcfinder/browse.php"
      - "{{BaseURL}}/admin/kcfinder/browse.php"
      - "{{BaseURL}}/includes/kcfinder/browse.php"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>KCFinder:"
          - "id=\"files\""
        condition: and

      - type: status
        status:
          - 200
