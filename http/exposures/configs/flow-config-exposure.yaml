id: flow-config-exposure

info:
  name: Flow Configuration - Exposure
  author: theamanrawat
  severity: high
  description: |
    Detects an exposed Flow configuration file. These files may contain sensitive information such as credentials, internal endpoints, or environment settings.
  reference:
    - https://flow.org/en/docs/config/
  metadata:
    verified: false
    max-request: 1
  tags: exposure,config,flow,devops

http:
  - method: GET
    path:
      - "{{BaseURL}}/.flowconfig"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "[include]"
          - "[ignore]"
          - "build"
          - "lib"
        condition: and
        part: body

      - type: status
        status:
          - 200
