id: deployment-ini

info:
  name: FTP Deployment config file
  author: Michal Mikolas (nanuqcz)
  severity: critical
  description: Config file for "FTP deployment" utility usually contains server's FTP credentials in plain text.
  remediation: Delete the config file from server & add it to `ignore` section of the deployment file. Or block access to the file using `.htaccess` on the server.
  reference: https://github.com/dg/ftp-deployment
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
  metadata:
    vendor: dg
    product: ftp-deployment
  tags: config,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/deployment.ini"
      - "{{BaseURL}}/deploy.ini"
      - "{{BaseURL}}/production.ini"
      - "{{BaseURL}}/prod.ini"
      - "{{BaseURL}}/deployment.production.ini"
      - "{{BaseURL}}/deployment.prod.ini"
      - "{{BaseURL}}/deploy.production.ini"
      - "{{BaseURL}}/deploy.prod.ini"
      - "{{BaseURL}}/server.ini"
      - "{{BaseURL}}/ftp.ini"
      - "{{BaseURL}}/ftps.ini"
      - "{{BaseURL}}/sftp.ini"

    matchers-condition: or
    matchers:
      - type: regex
        regex:
          - "remote\\s*=\\s*"
