id: exposed-filezilla-config

info:
  name: Exposed FileZilla Configuration File - Exposure
  author: pussycat0x
  severity: medium
  description: |
    Detected publicly accessible FileZilla client configuration files (sitemanager.xml, recentservers.xml, filezilla.xml).
  reference:
    - https://wiki.filezilla-project.org/Xml_files
  metadata:
    verified: true
    max-request: 4
  tags: exposure,config,filezilla,ftp

http:
  - method: GET
    path:
      - "{{BaseURL}}/files/FileZilla.xml"
      - "{{BaseURL}}/recentservers.xml"
      - "{{BaseURL}}/filezilla.xml"

    stop-at-first-match: true

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains_all(body, '<filezilla','<User>','<Pass>','<Logontype>')"
        condition: and
