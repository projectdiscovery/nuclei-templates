id: cacti-guest-access-enabled

info:
  name: Cacti - Guest User Access Enabled
  author: DhiyaneshDk
  severity: medium
  description: |
    Cacti instance has guest user access enabled, allowing unauthenticated users to access graph_view.php and potentially other resources.
  metadata:
    verified: true
    max-request: 1
    vendor: cacti
    product: cacti
    shodan-query: html:"graph_view.php" html:"cacti"
  tags: cacti,misconfig,unauth,guest-access,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/graph_view.php"
      - "{{BaseURL}}/cacti/graph_view.php"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Tree Mode"
          - "List Mode"
          - "Preview Mode"
        condition: or

      - type: word
        part: body
        words:
          - "Login to Cacti"
          - "Please enter your Cacti"
        negative: true

      - type: status
        status:
          - 200
# digest: 4a0a00473045022008858e13e74008e68ab296668a725ac3e7b37a5322b5316b842921fdc083f11c022100ed6e6fa1ccd4ded2fa81882a2c91d0be57d8aa7e541df4917f7d9136c2c39cf8:922c64590222798bb761d5b6d8e72950