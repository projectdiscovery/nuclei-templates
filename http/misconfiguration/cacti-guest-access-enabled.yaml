id: cacti-guest-access-enabled

info:
  name: Cacti - Guest User Access Enabled
  author: DhiyaneshDk
  severity: medium
  description: |
    Cacti instance has guest user access enabled, allowing unauthenticated users to access graph_view.php and potentially other resources.
  metadata:
    verified: true
    max-request: 1
    vendor: cacti
    product: cacti
    shodan-query: html:"graph_view.php" html:"cacti"
  tags: cacti,misconfig,unauth,guest-access

http:
  - method: GET
    path:
      - "{{BaseURL}}/graph_view.php"
      - "{{BaseURL}}/cacti/graph_view.php"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Tree Mode"
          - "List Mode"
          - "Preview Mode"
        condition: or

      - type: word
        part: body
        words:
          - "Login to Cacti"
          - "Please enter your Cacti"
        negative: true

      - type: status
        status:
          - 200
