id: seafile-public-registration

info:
  name: Seafile - Public Registration Enabled
  author: theamanrawat
  severity: info
  description: |
    Detected public user registration is enabled on a Seafile instance.
  reference:
    - https://forum.seafile.com/t/seafile-disable-email-registration-for-users/4957
  metadata:
    verified: true
    max-requests: 1
    shodan-query: http.title:"Seafile"
    fofa-query: title="Seafile"
  tags: misconfig,seafile,registration,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/accounts/register/"

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains_all(body, "id_email", "id_password1", "csrfmiddlewaretoken", "seafile-ui.css", "SEAFILE_GLOBAL")'
        condition: and
