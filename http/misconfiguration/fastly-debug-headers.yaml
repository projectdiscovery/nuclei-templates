id: fastly-debug-headers

info:
  name: Fastly CDN Debug Headers Exposure
  author: pussycat0x
  severity: info
  description: |
    Detected Fastly CDN debug headers being exposed when the Fastly-Debug header was sent in a request.This exposure disclosed sensitive debugging information such as cache paths, TTL values, content digests, surrogate keys, and cache server identities, which could help attackers understand CDN configuration and cache behavior.
  reference:
    - https://www.fastly.com/documentation/reference/http/http-headers/Fastly-Debug/
  metadata:
    max-request: 1
    verified: true
    shodan-query: 'X-Served-By: cache'
  tags: fastly,cdn,exposure,misconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    headers:
      Fastly-Debug: "1"

    matchers-condition: or
    matchers:
      - type: regex
        name: fastly-debug-path
        part: header
        regex:
          - '(?i)fastly-debug-path:\s*.+'

      - type: regex
        name: fastly-debug-ttl
        part: header
        regex:
          - '(?i)fastly-debug-ttl:\s*.+'

      - type: regex
        name: fastly-debug-digest
        part: header
        regex:
          - '(?i)fastly-debug-digest:\s*.+'
