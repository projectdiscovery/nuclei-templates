id: envoy-metadata-disclosure

info:
  name: Envoy Proxy - Metadata Disclosure
  author: theamanrawat
  severity: info
  description: |
    Detected misconfigured Envoy proxy instances that disclose sensitive information about the target infrastructure via the "x-envoy-peer-metadata" response header.
  reference:
    - https://www.acunetix.com/vulnerabilities/web/envoy-metadata-disclosure/
    - https://www.envoyproxy.io/docs/envoy/latest/configuration/configuration
  metadata:
    max-request: 1
    shodan-query: "x-envoy-peer-metadata"
  tags: envoy,exposure,misconfig,disclosure

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        part: header
        words:
          - "x-envoy-peer-metadata"
        case-insensitive: true
