id: envoy-metadata-disclosure

info:
  name: Envoy Proxy - Metadata Disclosure
  author: theamanrawat
  severity: info
  description: |
    Detected misconfigured Envoy proxy instances that disclose sensitive information about the target infrastructure via the "x-envoy-peer-metadata" response header.
  reference:
    - https://www.acunetix.com/vulnerabilities/web/envoy-metadata-disclosure/
    - https://www.envoyproxy.io/docs/envoy/latest/configuration/configuration
  metadata:
    max-request: 1
    shodan-query: "x-envoy-peer-metadata"
  tags: envoy,exposure,misconfig,disclosure,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        part: header
        words:
          - "x-envoy-peer-metadata"
        case-insensitive: true
# digest: 490a0046304402200e7edc4d927689d787db0c5c7299b96badd1569db0b4db079fe41a26939378fb02205b91d5a04317216f0f32f6a1a7cd1d524a5c926be7f866242e6b27e251aca71f:922c64590222798bb761d5b6d8e72950