id: unauth-ckfinder

info:
  name: CKFinder - Unauthenticated Exposure
  author: Amjad Ali
  severity: high
  description: |
    The CKFinder file manager was found to be exposed without authentication, allowing unauthenticated users to directly access its web interface. Due to this misconfiguration, attackers were able to browse server directories, upload arbitrary files, and manage existing files.
  reference:
    - https://cksource.com/ckfinder
    - https://owasp.org/Top10/A01_2021-Broken_Access_Control/
  metadata:
    verified: true
    max-request: 1
    google-query: inurl:ckfinder/ckfinder.html ext:html
  tags: ckfinder,misconfig,unauth

http:
  - method: GET
    path:
      - "{{BaseURL}}/ckfinder/ckfinder.html"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>CKFinder</title>"
          - "CKFinderFrameWindow"
          - "var ckfinder = new CKFinder"
          - "CKFinder.start()"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        group: 1
        regex:
          - "<title>([^<]+)</title>"
# digest: 4a0a00473045022060026d658f9cc2129c86af43f4331e9286fed5d2221a0b839db91f66b64b96eb022100f3c14feaea0c6181998dc378f0d646f4bda745186d42f5bb101f5b2a06283074:922c64590222798bb761d5b6d8e72950