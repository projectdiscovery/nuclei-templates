id: static-directory-listing

info:
  name: Static Directory Listing Exposure
  author: nikhilpatidar01
  severity: info
  description: |
    Detects directory listing exposure on common static asset directories (/includes/, /css/, /js/, /img/, /images/).
    This template directly probes commonly exposed paths that may be missed by crawler-based detection.
    Directory listing can expose sensitive files, directory structures, and other information to attackers.
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review-Old_Backup-and-Unreferenced-Files-for-Sensitive-Information
    - https://portswigger.net/kb/issues/00600100_directory-listing
  metadata:
    max-request: 5
  tags: misconfig,exposure,listing,detection

http:
  - method: GET
    path:
      - "{{BaseURL}}/includes/"
      - "{{BaseURL}}/css/"
      - "{{BaseURL}}/js/"
      - "{{BaseURL}}/img/"
      - "{{BaseURL}}/images/"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "<title>Index of"
          - "<h1>Index of"
        condition: or 
