id: php-debugbar-exposure

info:
  name: Php Debug Bar - Exposure
  author: ritikchaddha, pdteam, dhiyaneshDk, geeknik
  severity: high
  description: |
    The DebugBar integrates easily into projects and can display profiling data from any part of your application. This template detects exposed PHP Debug Bars by looking for known response bodies and the `phpdebugbar-id` in headers.
  reference:
    - https://hackerone.com/reports/1883806
    - http://phpdebugbar.com/
    - https://github.com/maximebf/php-debugbar
  metadata:
    verified: true
    max-request: 2
    shodan-query: html:"phpdebugbar"
  tags: hackerone, misconfig, php, phpdebug, exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/_debugbar/open"
    host-redirects: true
    max-redirects: 2
    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "phpdebugbar")'
          - 'contains(body, "widget")'
        condition: and
      - type: dsl
        dsl:
          - 'contains(header, "phpdebugbar-id")'
        
  - method: HEAD
    path:
      - "{{BaseURL}}/_debugbar/open"
    host-redirects: true
    max-redirects: 1
    matchers:
      - type: status
        status:
          - 200
      - type: dsl
        dsl:
          - 'contains(header, "phpdebugbar-id")'
