id: really-simple-captcha-fpd

info:
  name: WordPress Plugin Really Simple CAPTCHA - Full Path Disclosure
  author: pussycat0x
  severity: low
  description: |
     WordPress Plugin Really Simple CAPTCHA for WordPress was detected to be vulnerable to Full Path Disclosure, allowing unauthenticated attackers to obtain the full application path that could aid other attacks when combined with another vulnerability.
  reference:
    - https://wordpress.org/plugins/really-simple-captcha/
  metadata:
    max-request: 3
    fofa-query: body="wp-content/plugins/really-simple-captcha/"
  tags: wordpress,wp,wp-plugin,fpd,wp-really-simple-captcha

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/really-simple-captcha/really-simple-captcha.php"
      - "{{BaseURL}}/wp-content/plugins/really-simple-captcha/includes/filesystem.php"
      - "{{BaseURL}}/wp-content/plugins/really-simple-captcha/uninstall.php"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - 'contains_all(body, "Fatal error", "Uncaught Error:") || contains_all(body, "Warning:", "failed to open stream")'
          - 'status_code == 200 || status_code == 500'
          - 'contains(body, "really-simple-captcha")'
        condition: and
