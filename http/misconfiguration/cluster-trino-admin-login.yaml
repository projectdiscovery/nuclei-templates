id: cluster-trino-admin-login

info:
  name: Cluster Overview Trino - Admin Login
  author: DhiyaneshDK
  severity: high
  description: |
    The /ui/login endpoint accepted a POST request with username=admin and an empty password, which resulted in a successful login. This indicated improper authentication validation or a default/admin account misconfiguration.
  metadata:
    verified: true
    max-request: 1
  tags: vuln,misconfig,dashboard,cluster,trino

variables:
  username: admin

http:
  - raw:
      - |
        POST /ui/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        username={{username}}&password=&redirectPath=

    matchers-condition: and
    matchers:
      - type: word
        part: set_cookie
        words:
          - "Trino-UI-Token"

      - type: status
        status:
          - 303
