id: kace-sma-installer

info:
  name: KACE Systems Management Appliance - Installer
  author: ritikchaddha
  severity: high
  description: |
    The exposure of the KACE Systems Management Applianceâ€™s installer interface through the /common/setup.php endpoint allowed unauthorized access to the system setup wizard. This interface was publicly accessible when it should have been restricted, potentially granting attackers the ability to initiate or manipulate the setup process, leading to system compromise or unauthorized configuration changes.
  metadata:
    verified: true
    max-request: 1
    vendor: quest
    product: kace_systems_management_appliance
    fofa-query: icon_hash="-463230636" && body="setup"
  tags: kace,sma,installer,exposure,quest

http:
  - method: GET
    path:
      - "{{BaseURL}}/common/setup.php"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Initial Setup"
          - "setup_wizard"
          - "KACE"
        condition: and
        case-insensitive: true

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100c7ac2ea236bc6f3aebf88304a90d51c212ccb019160e5fa3ce047eb7eef03e2d022100e76f9ac3820b68c84bcf270fe2cbb4423363bc6b4fc52f7f980dc1edf767ebb7:922c64590222798bb761d5b6d8e72950