id: dlink-unauth-cgi-script

info:
  name: D-Link DNS Series  CGI Script - Unauthenticated
  author: pussycat0x
  severity: low
  description: |
    A vulnerability has been identified in the D-Link DNS series network storage devices, allowing for the exposure of sensitive device information to unauthorized actors. This vulnerability is due to an unauthenticated access flaw in the info.cgi script, which can be exploited via a simple HTTP GET request, affecting over 920,000 devices on the Internet.
  reference:
    - https://github.com/netsecfish/info_cgi
  classification:
    cpe: cpe:2.3:h:dlink:dns-345:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: dlink
    product: dns-345
    fofa-query: "app=\"D_Link-DNS\""
  tags: unauth,dlink,misconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/info.cgi"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Product="
          - "Version="
          - "Model="
        condition: and

      - type: status
        status:
          - 200
# digest: 490a0046304402203a699b7755ab9dbcaf247d63876bbbcf0ef7f679f4a0f4db30278e05f18ee2ed022069eacfa7b8fa12fd1ec7359e1ec70e09f191d7c26c54896473402eb343960953:922c64590222798bb761d5b6d8e72950