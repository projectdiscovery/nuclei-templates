id: fortinet-ssl-vpn-cve-2022-42475

info:
  name: Fortinet SSL-VPN CVE-2022-42475 - Heap-based Buffer Overflow
  author: sambit003
  severity: critical
  description: |
    A heap-based buffer overflow vulnerability [CWE-122] in FortiOS SSL-VPN (versions 7.2.0 through 7.2.2, 7.0.0 through 7.0.8, 6.4.0 through 6.4.10, 6.2.0 through 6.2.11, 6.0.15 and earlier) and FortiProxy SSL-VPN (versions 7.2.0 through 7.2.1, 7.0.7 and earlier) may allow a remote unauthenticated attacker to execute arbitrary code or commands via specifically crafted requests.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-122
    cpe: cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:* cpe:2.3:a:fortinet:fortiproxy:*:*:*:*:*:*:*:*
  reference:
    - https://fortiguard.com/psirt/FG-IR-22-398
    - https://github.com/0xhaggis/CVE-2022-42475
    - https://github.com/CKevens/CVE-2022-42475-RCE-POC
    - https://github.com/Amir-hy/cve-2022-42475
    - https://github.com/Mustafa1986/cve-2022-42475-Fortinet
    - https://github.com/natceil/cve-2022-42475
    - https://github.com/scrt/cve-2022-42475
  metadata:
    shodan-query: |
      port:10443 http.favicon.hash:945408572
      cpe:"cpe:2.3:o:fortinet:fortios"
      http.html:"/remote/login" "xxxxxxxx"
  tags: fortinet,ssl-vpn,heap-overflow

http:
  - method: GET
    path:
      - "{{BaseURL}}/remote/login"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "/remote/login"
        condition: and

      - type: word
        part: header
        words:
          - "Server: xxxxxxxx-xxxxx"

      - type: status
        status:
          - 200
