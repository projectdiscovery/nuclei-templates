id: headlamp-exposed-panel
info:
  name: Headlamp Kubernetes UI Exposed Panel
  author: shamo0
  severity: medium
  description: |
    Detects exposed Headlamp Kubernetes UI panels by verifying specific HTML content and metadata on the main page and common endpoints.
    This could lead to unauthorized access to the Kubernetes UI if not properly secured.
  tags: kubernetes,ui,exposed

http:
  - method: GET
    path:
      - "{{BaseURL}}/"
      - "{{BaseURL}}/settings/plugins"
      - "{{BaseURL}}/settings/cluster"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Headlamp: Kubernetes Web UI"
          - "<div id=\"root\">"
      - type: word
        part: header
        words:
          - "text/html"
      - type: status
        status:
          - 200
