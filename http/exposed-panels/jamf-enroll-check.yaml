id: jamf-enroll-check

info:
  name: Jamf /enroll/ Exposure Check
  author: Th3l0newolf
  severity: Medium
  description: Detects if the /enroll/ endpoint is accessible on Jamf environments with basic auth being used and allows users to manually enroll their Mac, iPhone, or iPad into the organizationâ€™s Jamf environment
  tags: jamf,exposure,mdm,enroll
  metadata:
    verified: true
    shodan-query: 'ttitle:"Jamf Pro" http.html:"/enroll/"'
    vendor: jamf
    product: jamf
    cvss-metrics: 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N'
    cwe-id: 'CWE-307'  # Improper Restriction of Excessive Authentication Attempts

requests:
  - method: GET
    path:
      - "{{BaseURL}}/enroll/"

    matchers:
      - type: status
        status:
          - 200
          - 403
          - 401
