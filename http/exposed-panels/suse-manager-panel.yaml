id: suse-manager-panel

info:
  name: SUSE Manager Server - Panel
  severity: info
  author: darses
  description: |
    SUSE Manager login panel detected.
  metadata:
    verify: true
    shodan-query:
      - title:"SUSE Manager - Sign In"
      - title:"SUSE Multi-Linux Manager - Sign In"
      - title:"Uyuni - Sign In"
      - http.favicon.hash:1158194469
    fofa-query:
      - title="SUSE Manager - Sign In"
      - title="SUSE Multi-Linux Manager - Sign In"
      - title="Uyuni - Sign In"
      - icon_hash="1158194469"
  tags: panel,detect,suse,login

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 1

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>SUSE Manager - Sign In</title>"
          - "<title>SUSE Multi-Linux Manager - Sign In</title>"
          - "<title>Uyuni - Sign In</title>"
        condition: or

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        group: 1
        regex:
          - "webVersion:\\s+'([\\d\\.\\s\\w]+)',"
# digest: 4a0a004730450220216b4a9b2e92b585495f5a1d2b7bbeb587d2fc236528e415c89be05bd9923753022100fdd032dfce466eb6430973fa7ad1a2d7a85df04a35faa50bfc47ca332d662d86:922c64590222798bb761d5b6d8e72950