id: usergate-ngfw-admin-panel

info:
  name: UserGate NGFW/UTM Admin Panel - Detect
  author: darses
  severity: info
  description: |
    Detect UserGate NGFW/UTM Admin Panel.
  metadata:
    max-request: 2
    shodan-query: "Server: UserGate-UTM/42"
    fofa-query: icon_hash="-782553370"
  tags: detect,panel,usergate,ngfw,utm

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/static/console-utm-webui/js/preinit.js"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - status_code == 200
          - contains(body, "Entensys.console")
        condition: and
