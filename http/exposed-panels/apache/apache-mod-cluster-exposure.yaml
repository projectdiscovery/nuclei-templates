id: apache-mod-cluster-exposure

info:
  name: Apache `mod_proxy_cluster` Cluster Manager Interface - Exposure
  author: oleveloper
  severity: info
  description: |
    The Apache mod_proxy_cluster management interface provides administrative control and visibility into the load balancerâ€™s nodes and contexts.
  reference:
    - https://httpd.apache.org/docs/2.4/mod/mod_proxy_cluster.html
  metadata:
    verified: true
    max-request: 3
  tags: apache,mod_proxy,cluster,exposure,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/mcm"
      - "{{BaseURL}}/cluster-manager"
      - "{{BaseURL}}/mod_cluster_manager"

    host-redirects: true
    max-redirects: 2

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains_any(body, "Mod_cluster Status","Protocol supported","mod_proxy_cluster")'
          - 'contains(header, "text/html")'
          - 'status_code == 200'
        condition: and
# digest: 4b0a00483046022100c1611e8a5cba8aed95abc4c17334b16a3cae422450a46f1845f93782431bb56b0221009a77510fa39e8a4ce8a66f477a990189071037d50ec24e62a400aa394bab38e8:922c64590222798bb761d5b6d8e72950