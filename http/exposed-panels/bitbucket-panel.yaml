id: bitbucket-panel

info:
  name: Bitbucket Panel - Detect
  author: Shivam Kamboj
  severity: info
  description: |
    Bitbucket panel was detected. Bitbucket is a Git-based source code repository hosting service owned by Atlassian, providing CI/CD and collaboration features.
  reference:
    - https://bitbucket.org/
    - https://www.atlassian.com/software/bitbucket
  metadata:
    verified: true
    max-request: 2
    vendor: atlassian
    product: bitbucket
    shodan-query:
      - http.title:"Bitbucket"
      - http.component:"Atlassian Bitbucket"
    fofa-query:
      - title="Bitbucket"
      - body="atlassian-token"
    google-query: intitle:"Bitbucket" inurl:"/login"
  tags: panel,bitbucket,login,detect,discovery

http:
  - method: GET
    path:
      - "{{BaseURL}}/login"
      - "{{BaseURL}}"

    stop-at-first-match: true
    host-redirects: true
    max-redirects: 2

    matchers:
      - type: dsl
        dsl:
          - 'contains_any(body, "com.atlassian.bitbucket.server", "/download/contextbatch/css/bitbucket.page", "/download/contextbatch/js/bitbucket", "bitbucket-webpack-INTERNAL", "bitbucket-header-logo", "bitbucket-theme")'
          - 'status_code == 200 || status_code == 302'
        condition: and
