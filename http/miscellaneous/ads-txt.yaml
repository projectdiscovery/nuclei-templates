id: ads-txt

info:
  name: Detect ads.txt File
  author: rxerium
  severity: info
  description: Detects the presence of ads.txt or .well-known/ads.txt and extracts valid advertising entries.
  reference:
    - https://iabtechlab.com/ads-txt/
  tags: exposure,ads,ads.txt,discovery

requests:
  - method: GET
    path:
      - "{{BaseURL}}/.well-known/ads.txt"

    matchers:
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        name: ad-entries
        regex:
          - '^[a-zA-Z0-9._-]+\.[a-z]{2,},\s*[^,\s]+,\s*(DIRECT|RESELLER)(,\s*[a-fA-F0-9]+)?'
        part: body