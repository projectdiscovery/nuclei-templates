id: moodle-changelog

info:
  name: Moodle Changelog File Detect
  author: oppsec,lap1nou
  severity: info
  description: |
    Moodle has a file which describes API changes in core libraries and APIs, and can be used to discover Moodle version.
  reference:
    - https://moodledev.io/general/development/upgradenotes
    - https://moodle.atlassian.net/browse/MDL-81125
    - https://github.com/moodle/moodle
  metadata:
    verified: true
    max-request: 2
  tags: moodle,exposure,misc,vuln

http:
  - method: GET
    path:
      - "{{BaseURL}}/lib/upgrade.txt"
      - "{{BaseURL}}/UPGRADING.md"

    stop-at-first-match: true

    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(tolower(content_type), "text/plain")'
          - 'contains(body, "This files describes API changes")'
        condition: and

      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(tolower(content_type), "text/")'
          - 'contains(body, "Developer update notes")'
        condition: and
# digest: 4b0a00483046022100a3d2270274aa388a10342efe221628802043f45ef25e2d71d34e59ce36ecd9990221008c4e0e6d388fb521510457374c42279195602613d6b0ae0d8e1204b146fde9e1:922c64590222798bb761d5b6d8e72950