id: activemq-artemis-default-login

info:
  name: Apache ActiveMQ Artemis Console Default Login
  author: pdteam
  severity: high
  description: Apache ActiveMQ Artemis console default login credentials were discovered.
  reference:
  - https://activemq.apache.org/components/artemis/documentation/latest/management-console.html
  metadata:
    max-request: 2
    vendor: apache
    product: activemq
    shodan-query: title:"ActiveMQ Artemis Console"
  tags: apache,activemq,artemis,default-login

http:
- method: POST
  path: 
    - "{{BaseURL}}/console/auth/login"
  headers:
    Content-Type: application/json
  body: |-
     {"username":"{{username}}","password":"{{password}}"}

  stop-at-first-match: true
  payloads:
    username:
      - artemis
    password:
      - artemis
  attack: pitchfork
  matchers:
    - type: word
      words:
        - '{"credentials"'
  extractors:
    - type: regex
      name: credential
      part: body
      group: 0
      regex:
        - '{"credentials":.*}'