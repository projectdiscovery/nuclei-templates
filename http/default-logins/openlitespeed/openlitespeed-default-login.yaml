id: openlitespeed-default-login

info:
  name: OpenLiteSpeed WebAdmin - Default Login
  author: 0x_Akoko
  severity: high
  description: |
    Detected OpenLiteSpeed WebAdmin Console was using default credentials.
  reference:
    - https://www.digitalocean.com/community/tutorials/how-to-install-the-openlitespeed-web-server-on-ubuntu-18-04
  metadata:
    verified: true
    max-request: 1
    fofa-query: title="OpenLiteSpeed WebAdmin"
  tags: default-login,openlitespeed,litespeed,webadmin

variables:
  username: "admin"
  password: "123456"

http:
  - raw:
      - |
        POST /login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        userid={{username}}&pass={{password}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 302'
          - 'contains_all(header, "LSID", "LSPA", "Location: /index.php")'
        condition: and
