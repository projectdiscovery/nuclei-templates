id: openlitespeed-default-credentials

info:
  name: OpenLiteSpeed WebAdmin - Default Credentials
  author: 0x_Akoko
  severity: high
  description: |
    Detected OpenLiteSpeed WebAdmin Console was using default credentials.
  reference:
    - https://www.digitalocean.com/community/tutorials/how-to-install-the-openlitespeed-web-server-on-ubuntu-18-04
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"OpenLiteSpeed WebAdmin"
    fofa-query: title="OpenLiteSpeed WebAdmin"
  tags: default-login,openlitespeed,litespeed,webadmin

http:
  - raw:
      - |
        POST /login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        userid={{username}}&pass={{password}}

    attack: pitchfork
    payloads:
      username:
        - admin
      password:
        - 123456

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 302'
          - 'contains_all(header, "LSID", "LSPA", "Location: /index.php", "LiteSpeed")'
        condition: and
