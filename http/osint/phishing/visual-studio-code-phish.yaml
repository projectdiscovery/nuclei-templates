id: visual-studio-code-phish

info:
  name: visual studio code phishing Detection
  author: rxerium
  severity: info
  description: |
    A visual studio code phishing website was detected
  reference:
    - https://visualstudio.com
  metadata:
    max-request: 1
  tags: phishing,visual-studio-code,osint
http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'Visual Studio Code is a code editor redefined and optimized for building and debugging modern web and cloud applications.  Visual Studio Code is free and available on your favorite platform - Linux, macOS, and Windows.'
          - 'Visual Studio Code - Code Editing. Redefined'
        condition: and

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - '!contains(host,"visualstudio.com")'
# digest: 4b0a00483046022100c004a061e1768fa358db3a15f1c632e4cf4f2de34885385f47107a90a9e93e5d022100ddf9f3927b5b2c3aad30301f733ce6a018c498b10896cb2eef14af21c699b461:922c64590222798bb761d5b6d8e72950