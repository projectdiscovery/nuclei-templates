id: srv-record-detect

info:
  name: SRV Record - Service Detection
  author: rxerium
  severity: info
  description: |
    An SRV record was detected. SRV records are used to define the location of services such as SIP, XMPP, LDAP, and others.
  reference:
    - https://en.wikipedia.org/wiki/SRV_record
    - https://www.cloudflare.com/learning/dns/dns-records/dns-srv-record/
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 4
  tags: dns,srv,service,discovery

dns:
  - name: "_sip._tcp.{{FQDN}}"
    type: SRV
    
  - name: "_xmpp-server._tcp.{{FQDN}}"
    type: SRV
    
  - name: "_ldap._tcp.{{FQDN}}"
    type: SRV
    
  - name: "_kerberos._tcp.{{FQDN}}"
    type: SRV
    
    matchers:
      - type: regex
        regex:
          - "IN\\s+SRV\\s+([0-9]+\\s+[0-9]+\\s+[0-9]+\\s+.+)"
    
    extractors:
      - type: regex
        group: 1
        regex:
          - "IN\\s+SRV\\s+([0-9]+\\s+[0-9]+\\s+[0-9]+\\s+.+)"
