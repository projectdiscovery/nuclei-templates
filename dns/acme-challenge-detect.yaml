id: acme-challenge-detect

info:
  name: ACME DNS Challenge - Detect
  author: rxerium
  severity: info
  description: |
    Detects ACME (Automated Certificate Management Environment) DNS-01 challenge records used by Let's Encrypt and other certificate authorities.
  reference:
    - https://www.rfc-editor.org/rfc/rfc8555
    - https://letsencrypt.org/docs/challenge-types/
  metadata:
    max-request: 1
  tags: dns,acme,letsencrypt,certificate,discovery

dns:
  - name: "_acme-challenge.{{FQDN}}"
    type: TXT

    matchers:
      - type: regex
        regex:
          - "IN\tTXT"
          - "[A-Za-z0-9_-]{43}"

    extractors:
      - type: regex
        regex:
          - 'TXT\s+"([^"]+)"'
