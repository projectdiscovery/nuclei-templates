id: tlsa-record-detect

info:
  name: TLSA Record - DANE Detection
  author: rxerium
  severity: info
  description: |
    A TLSA record was detected. TLSA records are used for DANE (DNS-based Authentication of Named Entities) to bind TLS certificates to domain names.
  reference:
    - https://en.wikipedia.org/wiki/DNS-based_Authentication_of_Named_Entities
    - https://www.internetsociety.org/resources/deploy360/dane/
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,tlsa,dane,ssl,discovery

dns:
  - name: "_443._tcp.{{FQDN}}"
    type: TLSA
    
    matchers:
      - type: regex
        regex:
          - "IN\\s+TLSA\\s+(.+)"
    
    extractors:
      - type: regex
        group: 1
        regex:
          - "IN\\s+TLSA\\s+([0-9]+\\s+[0-9]+\\s+[0-9]+\\s+.+)"
