id: dmarc-validation

info:
  name: DMARC - Validation
  author: theamanrawat
  severity: info
  description: |
    Checked for the presence of a DMARC TXT record and validates its basic syntax and the policy.
  reference:
    - https://mxtoolbox.com/dmarc/details/dmarc-tags/dmarc-policy-options
  tags: dns,dmarc,config,email,security

dns:
  - name: "_dmarc.{{FQDN}}"
  
    type: TXT
    class: inet

    recursion: true
    retries: 3

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "v=DKIM1"
        case-insensitive: true

      - type: regex
        regex:
          - "p=none"
