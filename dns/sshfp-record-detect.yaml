id: sshfp-record-detect

info:
  name: SSHFP Record - SSH Fingerprint Detection
  author: rxerium
  severity: info
  description: |
    An SSHFP record was detected. SSHFP records are used to publish SSH host key fingerprints in DNS to verify host authenticity.
  reference:
    - https://en.wikipedia.org/wiki/SSHFP_record
    - https://www.rfc-editor.org/rfc/rfc4255.html
  classification:
    cwe-id: CWE-200
  metadata:
    max-request: 1
  tags: dns,sshfp,ssh,fingerprint,discovery

dns:
  - name: "{{FQDN}}"
    type: SSHFP
    
    matchers:
      - type: regex
        regex:
          - "IN\\s+SSHFP\\s+(.+)"
    
    extractors:
      - type: regex
        group: 1
        regex:
          - "IN\\s+SSHFP\\s+([0-9]+\\s+[0-9]+\\s+[0-9a-fA-F]+)"
