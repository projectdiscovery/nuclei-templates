id: sensitive-path-exposure

info:
  name: Sensitive Path Exposure
  author: @sbksibi
  severity: critical
  description: Detects exposure of the most common sensitive files and directories (credentials, API keys, configs, version control metadata).

requests:
  - method: GET
    path:
      # Cloud credentials
      - "{{BaseURL}}/.aws/credentials"
      - "{{BaseURL}}/.npmrc"
      - "{{BaseURL}}/.dockercfg"
      - "{{BaseURL}}/azureauth.json"
      - "{{BaseURL}}/gcp-creds.json"
      - "{{BaseURL}}/.kube/config"

      # Directories or files named “secret(s)” / “keys”
      - "{{BaseURL}}/secrets/"
      - "{{BaseURL}}/secret/"
      - "{{BaseURL}}/keys/"
      - "{{BaseURL}}/private_keys/"
      - "{{BaseURL}}/api_keys/"
      - "{{BaseURL}}/credentials/"
      - "{{BaseURL}}/db_credentials/"
      - "{{BaseURL}}/aws_keys/"
      - "{{BaseURL}}/azure_keys/"
      - "{{BaseURL}}/gcp_keys/"
      - "{{BaseURL}}/jwt_secret/"
      - "{{BaseURL}}/auth_tokens/"
      - "{{BaseURL}}/access_tokens/"
      - "{{BaseURL}}/tokens/"
      - "{{BaseURL}}/oauth_secrets/"
      - "{{BaseURL}}/passwords/"
      - "{{BaseURL}}/admin-creds/"
      - "{{BaseURL}}/remember_me_tokens/"
      - "{{BaseURL}}/user_tokens/"
      - "{{BaseURL}}/forgot_password_tokens/"
      - "{{BaseURL}}/user_auth_backup/"
      - "{{BaseURL}}/hardcoded_keys/"
      - "{{BaseURL}}/master_key/"
      - "{{BaseURL}}/ssl_keys/"
      - "{{BaseURL}}/certificates/"
      - "{{BaseURL}}/passphrases/"
      - "{{BaseURL}}/salts/"
      - "{{BaseURL}}/nonces/"
      - "{{BaseURL}}/hashes/"
      - "{{BaseURL}}/digests/"
      - "{{BaseURL}}/signatures/"
      - "{{BaseURL}}/secure_storage/"
      - "{{BaseURL}}/recovery_keys/"
      - "{{BaseURL}}/keychain_dump/"
      - "{{BaseURL}}/firebase_admin_keys/"
      - "{{BaseURL}}/vault_config/"
      - "{{BaseURL}}/topsecr3tdonotlook/"
      - "{{BaseURL}}/admin_backdoor.js"

      # Environment files
      - "{{BaseURL}}/.env"
      - "{{BaseURL}}/.env.local"
      - "{{BaseURL}}/.env.dev"
      - "{{BaseURL}}/.env.production"
      - "{{BaseURL}}/.env.staging"
      - "{{BaseURL}}/.env.testing"
      - "{{BaseURL}}/.env.example"
      - "{{BaseURL}}/.env.backup"
      - "{{BaseURL}}/.env.bak"
      - "{{BaseURL}}/.env.old"
      - "{{BaseURL}}/.env~"
      - "{{BaseURL}}/.env.default"
      - "{{BaseURL}}/opt/app/.env"
      - "{{BaseURL}}/home/user/.env"

      # JS configuration files
      - "{{BaseURL}}/js/config.js"
      - "{{BaseURL}}/js/config.prod.js"
      - "{{BaseURL}}/js/config.dev.js"
      - "{{BaseURL}}/js/config.local.js"
      - "{{BaseURL}}/js/private_config.js"
      - "{{BaseURL}}/js/hidden_config.js"
      - "{{BaseURL}}/js/.env.js"
      - "{{BaseURL}}/js/.env.local.js"
      - "{{BaseURL}}/js/.env.development.js"
      - "{{BaseURL}}/js/.env.production.js"
      - "{{BaseURL}}/js/.secret.js"
      - "{{BaseURL}}/js/.credentials.js"
      - "{{BaseURL}}/js/.backup_config.js"
      - "{{BaseURL}}/js/.vault_secrets.js"

      # Version control metadata
      - "{{BaseURL}}/.git/"
      - "{{BaseURL}}/.git/config"
      - "{{BaseURL}}/.git/HEAD"
      - "{{BaseURL}}/.git/index"
      - "{{BaseURL}}/.git/logs/"
      - "{{BaseURL}}/.git/logs/HEAD"
      - "{{BaseURL}}/.git/logs/refs/"
      - "{{BaseURL}}/.git/logs/refs/heads/"
      - "{{BaseURL}}/.git/logs/refs/remotes/"
      - "{{BaseURL}}/.git/objects/"
      - "{{BaseURL}}/.git/hooks/"
      - "{{BaseURL}}/.git/info/"
      - "{{BaseURL}}/.git/packed-refs"
      - "{{BaseURL}}/.git/modules/"
      - "{{BaseURL}}/.git/objects/info/"
      - "{{BaseURL}}/.git/objects/pack/"
      - "{{BaseURL}}/.git/shallow"
      - "{{BaseURL}}/.git/COMMIT_EDITMSG"
      - "{{BaseURL}}/.git/FETCH_HEAD"
      - "{{BaseURL}}/.git/ORIG_HEAD"
      - "{{BaseURL}}/.git/description"
      - "{{BaseURL}}/.git/branches/"
      - "{{BaseURL}}/.gitkeep"
      - "{{BaseURL}}/.git-rewrite"
      - "{{BaseURL}}/.gitreview"
      - "{{BaseURL}}/.gitignore"
      - "{{BaseURL}}/.svn/"
      - "{{BaseURL}}/.svn/entries"
      - "{{BaseURL}}/.hg/"
      - "{{BaseURL}}/.bzr/"

      # Database configuration/backups
      - "{{BaseURL}}/wp-config.php"
      - "{{BaseURL}}/database.sql"
      - "{{BaseURL}}/db-dump.tar.gz"
      - "{{BaseURL}}/pg_dump"
      - "{{BaseURL}}/mysqldump.log"
      - "{{BaseURL}}/.htaccess"

    matchers:
      - type: status
        status:
          - 200   # OK (file served)
          - 401   # Unauthorized (file exists)
          - 403   # Forbidden (file exists)
    matchers-condition: or
