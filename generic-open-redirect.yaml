id: generic-open-redirect
info:
  name: Comprehensive Generic Open Redirect Detection
  author: nikhilpatidar01
  severity: medium
  description: |
    Detects Open Redirect by checking an extensive list of common parameters 
    across multiple common paths including common files and directory structures.
  tags: generic, open-redirect, exposure

requests:
  - method: GET
    path:
      - '{{BaseURL}}/?{{param}}=https://evil.com'
      - '{{BaseURL}}/index.php?{{param}}=https://evil.com'
      - '{{BaseURL}}/login.php?{{param}}=https://evil.com'
      - '{{BaseURL}}/logout.php?{{param}}=https://evil.com'
      - '{{BaseURL}}/redirect.php?{{param}}=https://evil.com'
      - '{{BaseURL}}/app/?{{param}}=https://evil.com'
      - '{{BaseURL}}/public/?{{param}}=https://evil.com'
      - '{{BaseURL}}/auth/?{{param}}=https://evil.com'
    payloads:
      param:
        - q
        - url
        - next
        - dest
        - link
        - redir
        - goto
        - return
        - continue
        - view
        - file
        - page
        - id
        - callback
        - target
        - out
        - image_url
        - service
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "evil.com"
          - "www.evil.com"
          - "https://evil.com"
        condition: or
