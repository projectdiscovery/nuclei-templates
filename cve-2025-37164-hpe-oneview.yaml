id: cve-2025-37164-hpe-oneview

info:
  name: HPE OneView Remote Code Execution CVE-2025-37164 â€” Vulnerable Version Detection
  author: Sourabh Singh
  severity: critical
  description: |
    Detects HPE OneView instances and extracts version information for CVE-2025-37164.
    This vulnerability allows remote unauthenticated code execution on unpatched OneView
    prior to v11.00. Patch immediately if found. (HPE advisory)
  reference:
    - https://support.hpe.com/hpesc/public/docDisplay?docId=hpesbgn04985en_us&docLocale=en_US
    - https://nvd.nist.gov/vuln/detail/CVE-2025-37164
  metadata:
    shodan-query: title:"OneView"
  tags: panel,hpe,hp,oneview,login,cve,cve2025,rce,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/login"
      - "{{BaseURL}}/ui"
      - "{{BaseURL}}/rest/version"
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "OneView"
          - "HPE OneView"
      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - "(?i)\"version\"\\s*:\\s*\"([0-9]+\\.[0-9]+\\.[0-9]+)\""

  - method: GET
    path:
      - "{{BaseURL}}/rest/version"
    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - "(?i)\"version\"\\s*:\\s*\"([0-9]+)\\.([0-9]+)\\.([0-9]+)\""
      - type: dsl
        dsl:
          - |
            contains(match, "\"version\" : \"10")
            || contains(match, "\"version\" : \"9")
            || contains(match, "\"version\" : \"8")
            || contains(match, "\"version\" : \"7")
            || contains(match, "\"version\" : \"6")
            || contains(match, "\"version\" : \"5")
            || contains(match, "\"version\" : \"4")
            || contains(match, "\"version\" : \"3")
            || contains(match, "\"version\" : \"2")
            || contains(match, "\"version\" : \"1")
          